<html>
<head>
	<title>Transformations and prediction</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="nonlinear model, nonlinear relationship, curvature, transformations">
	<meta name="dataset" content="House prices in Palmerston North">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Point prediction using transformed variables</p>
<p>If a transformation of <em>Y</em> follows a normal linear model with an explanatory 
variable that is a transformation of <em>X</em>, a least squares line that is 
fitted to the transformed data is used for predictions.</p>
<p>To obtain a prediction of <em>Y</em> at any value <em>x,</em></p>

<ol>
<li>Transform <em>x</em></li>
<li>Put this transformed <em>x</em>-value into the least squares equation to obtain 
a prediction of the <strong>transformed</strong> <em>Y</em>.</li>
<li>Apply the <strong>inverse transformation</strong> to the one that was used 
on <em>Y</em> to obtain the prediction of <em>Y</em> itself</li>
</ol>

<p>For example, if the square root of <em>Y</em> is linearly related to <em>X</em>, 
we use the least squares line to obtain a prediction of sqrt(<em>Y</em>), then 
square this to get a prediction of <em>Y</em> itself.</p>

<div class="diagram"> 
<p class="heading">House prices in Palmerston North</p>
<p>The scatterplot below shows the sale prices ($thousand) and floor areas (square 
metres) from a sample of 143 houses that were sold in two suburbs of Palmerston 
North, New Zealand in 1999. All houses had been built in the previous 30 years.</p>
<p class=eqn> <span class="reference"><object data="images/housePrice.svg" width="338" height="281"></object> 
</span></p>
<p>The prices of large houses are more variable than these of small houses, suggesting 
that a transformed sale price might satisfy a normal linear model better.</p>
<p class=eqn> <span class="reference"><object data="images/housePriceL.svg" width="362" height="289"></object>
</span></p>
<p>Although the error variance now seems reasonably constant, there is an indication 
of nonlinearity at high house areas. A log transformation of the house areas fixes 
this problem too.</p>
<p class=eqn> <span class="reference"><object data="images/housePriceLL.svg" width="362" height="289"></object>
</span></p>
<p>A normal linear model for the transformed variables implies that</p>
<p class=eqn><strong>log </strong>(<em>price</em>) &nbsp; ≈ &nbsp;<em>a</em>&nbsp;+ &nbsp;<em>b</em> × <strong>log</strong> (<em>area</em>)</p>
<p>and this can be re-expressed in the form</p>
<p class=eqn><em>price</em> &nbsp; ≈ &nbsp; <em>e<sup>a</sup></em>&nbsp; ×&nbsp; <em>area<sup>b</sup></em></p>
<p>so the model implies that prices are proportional to area raised to a power. 
(If <em>b</em>&nbsp;=&nbsp;1, there is a constant price per m<sup>2</sup>, on 
average &mdash; a hypothesis test can assess this.)</p>
<p>The transformed variables are shown on the diagram below with the least squares 
line, both on the transformed scatterplot and on a scatterplot of the original 
data.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="650" height="380">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="loessProg.LogLogLSApplet">
<param name="xVarName" value="area">
<param name="yVarName" value="price">
<param name="xValues" value="160 100 170 160 160 130 220 220 110 130 100 90 290 140 90 140 100 220 150 190 110 90 300 90 300 90 210 220 210 190 190 150 140 100 230 290 110 120 330 300 150 90 260 100 210 200 170 100 220 170 100 250 120 110 250 210 150 190 210 200 260 220 330 150 130 190 130 180 140 200 230 100 240 140 150 260 90 140 140 130 320 140 210 160 170 160 220 150 140 140 220 160 160 160 160 160 90 300 130 130 90 90 180 210 210 150 90 130 230 140 150 180 150 80 250 160 180 230 290 170 260 210 280 220 120 290 300 200 180 140 250 110 270 290 300 140 190 220 270 220 490 421 371">
<param name="yValues" value="158.0 123.0 175.0 140.0 157.5 132.0 210.0 238.0 122.5 168.0 132.0 105.0 245.0 167.0 105.5 135.0 120.0 196.0 150.0 178.0 105.0 105.0 319.0 113.0 335.0 122.0 170.0 230.0 205.0 175.0 183.0 166.0 139.0 105.5 236.5 280.0 125.0 146.0 345.0 292.0 169.0 111.0 290.0 105.0 204.0 195.0 135.0 134.5 177.0 195.0 175.0 158.0 155.0 111.0 289.0 236.0 155.0 134.0 195.0 153.0 216.0 265.0 342.0 139.0 160.0 218.0 168.0 200.0 172.0 212.0 250.0 125.8 240.0 160.0 135.0 272.0 122.0 151.0 152.0 152.0 280.3 130.0 245.0 195.0 186.0 127.0 220.0 175.0 158.0 126.0 190.0 153.0 163.0 155.0 163.0 190.0 113.0 295.0 150.0 136.5 99.5 106.5 240.0 180.0 180.0 185.0 113.0 136.5 205.0 180.0 146.0 215.0 146.0 107.5 194.0 136.0 245.0 145.0 310.0 119.5 220.0 270.0 350.0 263.5 140.0 240.0 345.0 132.5 220.0 219.0 170.0 111.3 203.5 210.0 360.0 195.0 210.0 167.5 240.0 285.0 302.0 431.0 294.0">
<param name="horizAxis" value="70 550 100 100">
<param name="horizAxis2" value="70 550 100 100">
<param name="vertAxis" value="80 450 100 100 150">
<param name="vertAxis2" value="80 450 100 100">
<param name="transXAxis" value="(200,-2) (500,-2)">
<param name="maxXTransformed" value="0.0 1.0">
<param name="transYAxis" value="(200,-2) (500,-2)">
<param name="maxYTransformed" value="-1.00 1.00">
<param name="labelAxes" value="true">
<param name="extraAxisSpace" value="10 10">
<param name="betaExtremes" value="3 4 99.99 3 4 99.99">
<param name="maxValues" value="999 9.999 999.9">
<param name="factorDecimals" value="4">
<param name="customText" value="Least Squares Fit=Least Squares Fit#Original Scale=Original Scale#Show prediction using=Show prediction using#Using log scale=Using log scale#Using original scale=Using original scale">
</applet>
</div>

<p>Click on the scatterplot at any house area (or log-area) to see how log(price) 
is predicted using the least squares slope and intercept. From this, the price 
is predicted by raising 10 to this power &mdash; the inverse transformation to log<sub>10</sub>.</p>
</div>

<p class="heading">Prediction intervals</p>
<p>Prediction intervals can be obtained in a similar way.</p>
<ol>
<li>Transform <em>x</em></li>
<li>Use the ordinary linear model methods to find a prediction interval for the 
<strong>transformed</strong> <em>Y</em>.</li>
<li>Apply the inverse transformation to <strong>both ends</strong> of the prediction 
interval to get a prediction interval for <em>Y</em> itself.</li>
</ol>
<p>For example, if the square root of <em>Y</em> is linearly related to <em>X</em>, 
we find a prediction interval for sqrt(<em>Y</em>), then square both ends of this 
interval to get a prediction interval for <em>Y</em> itself.</p>
<p>Although the prediction interval for the transformed <em>Y</em> has a similar 
width over the range of x-values in the data, the resulting prediction interval 
for <em>Y</em> itself may vary much more in width.</p>


<div class="diagram"> 
<p class="heading">House prices in Palmerston North</p>
<p>The red band on the scatterplot of log(price) against log(area) on the left 
below shows 95% prediction intervals. Use the slider under the diagram to display 
the prediction interval for the price of a house of any area.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="650" height="370">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="loessProg.LogLogPIApplet">
<param name="xVarName" value="area">
<param name="yVarName" value="price">
<param name="xValues" value="160 100 170 160 160 130 220 220 110 130 100 90 290 140 90 140 100 220 150 190 110 90 300 90 300 90 210 220 210 190 190 150 140 100 230 290 110 120 330 300 150 90 260 100 210 200 170 100 220 170 100 250 120 110 250 210 150 190 210 200 260 220 330 150 130 190 130 180 140 200 230 100 240 140 150 260 90 140 140 130 320 140 210 160 170 160 220 150 140 140 220 160 160 160 160 160 90 300 130 130 90 90 180 210 210 150 90 130 230 140 150 180 150 80 250 160 180 230 290 170 260 210 280 220 120 290 300 200 180 140 250 110 270 290 300 140 190 220 270 220 490 421 371">
<param name="yValues" value="158.0 123.0 175.0 140.0 157.5 132.0 210.0 238.0 122.5 168.0 132.0 105.0 245.0 167.0 105.5 135.0 120.0 196.0 150.0 178.0 105.0 105.0 319.0 113.0 335.0 122.0 170.0 230.0 205.0 175.0 183.0 166.0 139.0 105.5 236.5 280.0 125.0 146.0 345.0 292.0 169.0 111.0 290.0 105.0 204.0 195.0 135.0 134.5 177.0 195.0 175.0 158.0 155.0 111.0 289.0 236.0 155.0 134.0 195.0 153.0 216.0 265.0 342.0 139.0 160.0 218.0 168.0 200.0 172.0 212.0 250.0 125.8 240.0 160.0 135.0 272.0 122.0 151.0 152.0 152.0 280.3 130.0 245.0 195.0 186.0 127.0 220.0 175.0 158.0 126.0 190.0 153.0 163.0 155.0 163.0 190.0 113.0 295.0 150.0 136.5 99.5 106.5 240.0 180.0 180.0 185.0 113.0 136.5 205.0 180.0 146.0 215.0 146.0 107.5 194.0 136.0 245.0 145.0 310.0 119.5 220.0 270.0 350.0 263.5 140.0 240.0 345.0 132.5 220.0 219.0 170.0 111.3 203.5 210.0 360.0 195.0 210.0 167.5 240.0 285.0 302.0 431.0 294.0">
<param name="horizAxis" value="40 700 200 200 50 100">
<param name="horizAxis2" value="40 700 100 100">
<param name="vertAxis" value="50 650 100 100">
<param name="vertAxis2" value="50 650 100 100">
<param name="transXAxis" value="(200,-2) (500,-2)">
<param name="maxXTransformed" value="0.0 1.0">
<param name="transYAxis" value="(200,-2) (500,-2)">
<param name="maxYTransformed" value="-1.00 1.00">
<param name="labelAxes" value="true">
<param name="extraAxisSpace" value="10 10">
<param name="betaExtremes" value="3 4 99.99 3 4 99.99">
<param name="xLimits" value="50 650 1 200">
<param name="maxPrediction" value="999.9">
<param name="predictName" value="Price of house">
<param name="customText" value="Least Squares Fit=Least Squares Fit#Original Scale=Original Scale#to=to#95% P.I. for * with * is=95% P.I. for * with * is">
</applet>
</div>

<p>The scatterplot on the right shows the corresponding data and prediction intervals 
on a plot of the untransformed variables. Observe that the prediction interval 
for the price of a large house is much wider than that for a small house.</p>
</div>

<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
