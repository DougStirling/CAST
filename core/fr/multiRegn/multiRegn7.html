<!DOCTYPE HTML>
<html>
<head>
	<title>Least squares estimation</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="estimation, least squares">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Goal of small residuals</p>
<p>Recapping, any linear equation provides <strong>fitted values</strong> &mdash; predictions 
of the response for each combination of values of the explanatory variables. For example, with two explanatory variables, the fitted values are,</p>
<p class="eqn"><span class="black"><span style="position:relative; top:4px"><img src="../../images/symbol.yiHatBlue.png" width="11" height="18" align="baseline"></span> &nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x<sub>i</sub></em> + <em>b</em><sub>2 </sub><em>z<sub>i</sub></em></span></p>
<p>These fitted values are unlikely to match exactly the observed response values 
and the prediction 'errors' are called the <strong>residuals</strong>, </p>
<p class="eqn"><span class="red"><em>e</em><sub><em>i</em></sub></span> <span class="black">&nbsp;=&nbsp; <em>y<sub>i</sub></em> &minus;</span> <span style="position:relative; top:4px"><img src="../../images/symbol.yiHatBlue.png" width="11" height="18" align="baseline"></span></p>
<p>'Small' residuals are desirable but adjusting the parameters 'by eye' is neither 
a scientifically objective nor a practical method to achieve small residuals.</p>
<p class="heading">Least squares</p>
<p>A combined measure of the size of the residuals is their sum of squares,</p>
<p class="eqn"><span class="black">SS<sub>Residual</sub></span> &nbsp;<span style="position:relative; top:7px"><img class="gif" width="110" height="29"></span></p>
<p>An objective estimation method estimates the parameters with the values that <strong>minimise the residual sum of squares</strong>. This is called the method 
	of <strong>least squares</strong> and is similar to least squares estimation for 
	the simple linear model.</p>
<p>The principle of least squares reduces parameter 
	estimation to a relatively straightforward mathematical problem &mdash; when there are two explanatory variables, we must find the values 
	of <em>b</em><sub>0</sub>, <em>b</em><sub>1</sub> and <em>b</em><sub>2</sub> to 
	minimise:</p>
<p class="eqn"><span class="black">SS<sub>Residual</sub></span> &nbsp;<span style="position:relative; top:11px"><img class="gif" src="../../en/multiRegn/images/residSsq2Multi.gif" width="222" height="37"></span></p>
<p>The solution can be obtained algebraically but the formulae for the least squares estimates are more complicated than those for simple linear regression, and we will not give them here.</p>
<div class="boxed">
  <p>In practice, statistical software should always be used 
to obtain least squares parameter estimates.<br>
  </p>
</div>
<div class="diagram">
<p class="heading">Illustration</p>


  
<p>The diagram below shows an artificial data set. A square is drawn beside each residual &mdash; its area is the squared residual. 
The total red area is therefore the sum of the squared residuals.</p>
<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="450" height="480">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="multiRegnProg.DragResidSquareApplet">
<param name="yAxis" value="0 50 0 10">
<param name="xAxis" value="-0.2 1.2 0 0.2">
<param name="zAxis" value="-0.3 2.3 0 0.5">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="initialParams" value="20.00 15.00 0.00 0">
<param name="paramMinMax" value="-100.0 100.0 -100.00 100.00 -100.00 100.00">
<param name="yValues" value="32.5 22.8 25.8 32.1 16.5 15.7 34.9 16.4 21.2 19.2 31.8 31.2 25.1 11.7 29.5 31.0 37.3 27.2 25.5 22.7 21.6 24.4 16.3 22.2 31.9 23.4 35.8 36.2 24.7 5.7 26.9 16.9 32.9 21.2 16.3 29.6 32.3 35.9 10.6 13.4">
<param name="xValues" value="0.79 0.71 0.72 0.81 0.42 0.56 0.62 0.32 0.37 0.86 0.96 0.93 0.34 0.43 0.44 0.81 0.87 0.81 0.73 0.02 0.18 0.25 0.50 0.46 0.96 0.11 0.95 0.70 0.71 0.02 0.66 0.10 0.59 0.28 0.39 0.72 0.99 0.96 0.15 0.15">
<param name="zValues" value="0.16 0.71 1.88 0.49 1.82 1.83 0.06 1.59 0.25 1.46 0.55 0.97 0.56 1.95 0.47 0.48 1.06 1.18 0.52 0.31 0.16 0.42 1.83 2.00 0.11 0.69 0.59 0.16 1.36 1.89 0.96 0.02 0.83 1.65 1.61 0.27 1.76 0.01 1.28 1.45">
<param name="maxRss" value="99999.99">
</applet>
</div>

  
<p>The least squares plane can be moved by dragging the three arrows. Your aim should be to minimise 
the red area or, numerically, to minimise the residual sum of squares that is 
displayed at the top right of the diagram.</p>
<p>Finally, click the button <strong>Least squares</strong> to see the parameter 
values that the computer calculates to minimise the residual sum of squares.</p>
</div>

<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
