<!DOCTYPE HTML>
<html>
<head>
	<title>AR(1) model and trend</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="autoregression model, forecasting">
	<meta name="dataset" content="New company registrations in NZ">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class=heading>Forecasting when there is trend</p>
	<p>The method described in the previous page works well if there is no trend in the time series. However if there is trend, the forecasting method should specifically model this.</p>
	<p>In time series with both trend <strong>and</strong> autocorrelation, the 
		trend should be removed from the series before an AR(1) model is used for forecasting. 
		The  sequence for forecasting a future value is therefore...</p>
	<ol>
		<li>Estimate the trend in the series.</li>
		<li>Fit an AR(1) model to the detrended values (residuals).</li>
		<li>Forecast future residuals by applying the AR(1) model to the final residual 
			in the time series.</li>
		<li>Forecast the trend (using the model fitted in step 1) and add the residual 
			forecast.</li>
	</ol>
	
	<p><font color="#666666">(Actually there are more efficient ways to do steps 
		1 and 2 together, but these are beyond the scope of an introductory course.)</font></p>
	
	<div class="diagram">
		<p class="heading">New company registrations</p>

			
		<p>The diagram below illustrates the use of an AR(1) model for forecasting 
			in the presence of trend. The data are new company 
			registrations in New Zealand (per 100,000 population) each year from 1960 
			to 1998.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="600" height="550">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="timeProg.AR1Applet">
<param name="varName" value="New company registrations">
<param name="values" value="157 145 133 162 192 209 207 176 181 228 225 189 221 292 250 247 201 167 173 183 193 211 197 192 220 301 309 375 479 368 342 322 360 392 483 529 625 634 641 ? ? ? ? ? ?">
<param name="yAxis" value="0 800 0 200">
<param name="timeAxis" value="0 10 1960 10">
<param name="timeName" value="Year">
<param name="timeSequence" value="1960 1 45">
<param name="residAxis" value="-200 400 -200 200">
<param name="decimals" value="3 3 3 3">
<param name="labelAxes" value="true">
<param name="timeAxisName" value="Year">
<param name="maxAR1Params" value="999.000 1.000">
<param name="customText" value="Detrending=Detrending#None=None#Linear=Linear#Quadratic=Quadratic#Predict residual with=Predict residual with#lagged residual=lagged residual#Zero=Zero#Previous=Previous#Least sqrs=Least sqrs">
</applet> 
</div>

		<p>The diagram initially ignores the trend and forecasts each residual from the previous residual to be zero, so all forecast values are the same.</p>
		<p>Select <strong>Linear</strong> and then <strong>Quadratic</strong> from the pop-up menu to fit trend to the data. The scatterplot below the time series shows that the residuals are autocorrelated (but not strongly so).</p>
		<p>Click the button <strong>Previous</strong> to forecast each residual with the previous one. The blue lines on the time series plot show the resulting forecasts (after the trend is added back to the forecast residuals). When any value is above the quadratic trend and therefore has a positive residual, the forecast for the following time is the same distance above the quadratic trend.</p>
		<p>Finally click <strong>Least squares</strong> to find the best forecasts for the residuals. The forecast residuals are a little closer to zero than those from the previous time period, so the blue line is a little closer to the quadratic trend.</p>
		<p>(You might like to experiment with the other options in this diagram, but 
			use of a quadratic model and fitting the AR(1) line by least squares are 
			best!)</p>
		</div>

<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
