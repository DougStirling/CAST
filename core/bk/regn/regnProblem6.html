<!DOCTYPE HTML>
<html>
<head>
	<title>Non-normal errors</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="probability plot, normal scores, outliers, curvature">
	<meta name="dataset" content="Deer weight and jaws">
	<meta name="dataset" content="Antibiotic effectiveness">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Normal errors</p>
<p>Another assumption in the normal linear model is that the model errors are 
normally distributed.</p>
<p class=eqn><span class="black">&epsilon;&nbsp; ~ &nbsp;<font face="Arial, Helvetica, sans-serif">normal</font> (0<sub></sub>&nbsp;, &sigma;)</span> 
</p>
<p>If the model holds, the least squares residuals will also be normally distributed, 
so a histogram of the residuals can be examined for normality.</p>

<div class="centred"><div class="boxed">
<p>Normal errors are the least important of the model assumptions. If 
the other assumptions hold, it is reasonable to continue with the analysis, even 
if the errors have a skew distribution.</p>
</div></div>

<p class="heading">Normal probability plot</p>
<p>A better way to graphically examine a data set for normality is with a <strong>normal 
probability plot</strong>. This can be used to examine any data set for normality, 
not just residuals.</p>

<ol>
<li>Sort the data values into order, <em>x</em><sub>(1)</sub>&nbsp;&lt;&nbsp;<em>x</em><sub>(2)</sub>&nbsp;&lt;&nbsp;...&nbsp;&lt;&nbsp;<em>x</em><sub>(<em>n</em>)</sub></li>
<li>Find ordered values that are spaced out as you would <strong>expect</strong> 
from a normal distribution, <em>q</em><sub>1</sub>&nbsp;&lt;&nbsp;<em>q</em><sub>2</sub>&nbsp;&lt;&nbsp;...&nbsp;&lt;&nbsp;<em>q</em><sub><em>n</em></sub>. 
These are called <strong>normal scores</strong>.</li>
<li>Plot <em>x</em><sub>(<em>i</em>)</sub> against <em>q</em><sub><em>i</em></sub></li>
</ol>
<p>If the data set is from a normal distribution, the crosses in the normal probability 
plot should lie close to a straight line.</p>
<div class="diagram"> 
<p class="heading">Examples</p>
<p>Interpreting the shape of a normal probability plot is most easily explained 
with some examples.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="350" height="370">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="loessProg.ProbPlotBoxApplet">
<param name="xVarName" value="Normal scores">
<param name="yVarName" value="Normal">
<param name="yValues" value="0.00 0.80 1.31 1.71 2.04 2.33 2.59 2.82 3.04 3.24 3.43 3.62 3.79 3.96 4.13 4.29 4.45 4.61 4.77 4.92 5.08 5.23 5.39 5.55 5.71 5.87 6.04 6.21 6.38 6.57 6.76 6.96 7.18 7.41 7.67 7.96 8.29 8.69 9.20 10.00">
<param name="yVarName2" value="Positive skewness">
<param name="yValues2" value="0.00 0.01 0.03 0.06 0.09 0.13 0.18 0.24 0.31 0.38 0.47 0.56 0.66 0.77 0.90 1.03 1.18 1.33 1.50 1.69 1.88 2.09 2.32 2.57 2.83 3.11 3.41 3.73 4.08 4.45 4.85 5.27 5.73 6.22 6.74 7.30 7.91 8.56 9.25 10.00">
<param name="yVarName3" value="Negative skewness">
<param name="yValues3" value="0.00 1.14 1.93 2.55 3.07 3.52 3.92 4.28 4.61 4.92 5.20 5.47 5.72 5.96 6.19 6.41 6.62 6.82 7.01 7.20 7.37 7.55 7.71 7.88 8.04 8.19 8.34 8.48 8.63 8.76 8.90 9.03 9.16 9.29 9.41 9.54 9.65 9.77 9.89 10.00">
<param name="yVarName4" value="Short tails">
<param name="yValues4" value="0.00 0.26 0.51 0.77 1.03 1.28 1.54 1.79 2.05 2.31 2.56 2.82 3.08 3.33 3.59 3.85 4.10 4.36 4.62 4.87 5.13 5.38 5.64 5.90 6.15 6.41 6.67 6.92 7.18 7.44 7.69 7.95 8.21 8.46 8.72 8.97 9.23 9.49 9.74 10.00">
<param name="yVarName5" value="Long tails">
<param name="yValues5" value="0.00 1.22 1.90 2.40 2.80 3.13 3.41 3.66 3.88 4.08 4.25 4.40 4.54 4.65 4.75 4.83 4.90 4.95 4.98 5.00 5.00 5.02 5.05 5.10 5.17 5.25 5.35 5.46 5.60 5.75 5.92 6.12 6.34 6.59 6.87 7.20 7.60 8.10 8.78 10.00">
<param name="yVarName6" value="Outlier">
<param name="yValues6" value="0.00 0.48 0.79 1.03 1.23 1.40 1.55 1.69 1.82 1.94 2.06 2.17 2.28 2.38 2.48 2.58 2.67 2.77 2.86 2.95 3.05 3.14 3.23 3.33 3.42 3.52 3.62 3.72 3.83 3.94 4.06 4.18 4.31 4.45 4.60 4.77 4.97 5.21 5.52 10.00">
<param name="yVarName7" value="Two clusters">
<param name="yValues7" value="0.41 0.86 1.17 1.40 1.61 1.79 1.96 2.12 2.27 2.43 2.57 2.73 2.88 3.04 3.21 3.39 3.60 3.83 4.14 4.59 5.41 5.86 6.17 6.40 6.61 6.79 6.96 7.12 7.27 7.43 7.57 7.73 7.88 8.04 8.21 8.39 8.60 8.83 9.14 9.59">
<param name="horizAxis" value="-2.5 2.5 -2 1">
<param name="vertAxis" value="0 10 0 2">
<param name="labelAxes" value="true">
</applet>
</div>

<p>The values on the horizontal axis are <em>q</em><sub>1</sub>&nbsp;&lt;&nbsp;<em>q</em><sub>2</sub>&nbsp;&lt;&nbsp;...&nbsp;&lt;&nbsp;<em>q</em><sub><em>n</em></sub> 
which are spaced out as you would expect from a normal distribution. Those on 
the vertical axis are the actual data values. Data sets with different features 
can be chosen from the pop-up menu.</p>
<p>Observe how the distribution of the data set affects the shape of the probability 
plot. </p>
</div>

<p class="heading">How much curvature is needed to suggest non-normality?</p>
<p>In the examples above, linearity or nonlinearity in the probability plot was 
clear. In practice however, the randomness of real data means that the probability 
plot will not be exactly straight even when the data are sampled from a normal 
population. </p>

<div class="centred"><div class="boxed">
<p>How much curvature is needed to conclude that the underlying distribution 
is not normal?</p>
</div></div>

<p>This is a difficult question to answer. There are formal tests of normality 
that can be used in conjunction with a probability plot. (We <a href="javascript:showNamedPage('testPValue5')">discussed 
one in an earlier chapter</a> about hypothesis tests.) We however take a less 
formal approach in the example below.</p>
<div class="diagram"> 
<p class="heading">Deer jaw length and weight</p>
<p>Jaw lengths and body weights were recorded from 150 male deer that were shot 
in the Ruahine Ranges in New Zealand between November 1981 and November 1982. 
A scatterplot of the data and a probability plot of the residuals from the least 
squares line are shown below.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="loessProg.ProbPlotRandomApplet">
<param name="yVarName" value="Jaw length (mm)">
<param name="xVarName" value="Weight (kg)">
<param name="yValues" value="226 254 252 224 254 247 273 231 219 226 245 252 249 219 214 247 232 226 211 216 218 232 235 202 253 211 211 236 230 243 240 217 257 236 257 234 227 252 249 279 247 237 273 256 247 267 239 243 262 157 268 267 245 273 256 244 270 257 269 233 276 267 258 253 229 253 272 262 270 267 277 293 254 259 283 245 225 225 262 282 277 229 275 287 296 281 265 293 278 262 257 283 253 289 287 284 301 282 260 292 275 290 294 308 291 301 293 300 280 285 264 291 272 284 292 298 303 290 280 279 265 311 288 290 287 292 258 360">
<param name="xValues" value="36 45 43 37 47 43 56 43 34 41 47 45 44 34 32 46 36 35 35 29 29 43 40 21 53 32 36 42 40 49 46 33 57 47 48 48 44 52 57 66 45 43 58 62 53 70 44 48 53 55 62 62 38 57 55 43 60 52 63 55 63 54 48 48 55 53 64 50 54 50 67 82 42 57 57 40 41 41 56 71 75 77 67 74 95 85 53 82 76 51 55 68 46 76 79 81 76 86 72 85 41 93 83 85 84 89 70 88 73 72 77 71 38 82 89 89 92 80 75 67 81 101 73 87 91 73 65 97">
<param name="horizAxis" value="20 105 20 20">
<param name="vertAxis" value="150 380 150 50">
<param name="residAxis" value="-105 100 -100 50">
<param name="nscoreAxis" value="-2.5 2.5 -2 1">
<param name="random" value="3.0 384958677">
<param name="labelAxes" value="true">
<param name="customText" value="Actual Data=Actual Data#Random Normal Data=Random Normal Data#Ordered residual=Ordered residual">
</applet>
</div>

<p>There is curvature at both ends of the probability plot, suggesting that the 
error distribution has longer tails than the normal distribution.</p>
<p>Could this amount of curvature have occurred by chance? Select <strong>Random 
Normal Data</strong> from the pop-up menu to generate random data from a normal 
linear model whose parameters β<sub>0</sub>, 
β<sub>1</sub> 
and σ 
are the same as the least squares estimates from our data. Click <strong>Take 
Sample</strong> several times to see the variability in the probability plot when 
a normal linear model <strong>does</strong> hold.</p>
<p>The probability plot from the data seems more curved than the random ones, 
suggesting a problem with the assumption of normal errors.</p>
</div>

<p class="heading">Warning</p>
<p>If the assumptions of linearity and constant variance are violated, or if there 
are outliers, the probability plot of residuals will often be curved, irrespective 
of the error distribution.</p>

<div class="centred"><div class="boxed">
<p>Only draw a probability plot if you are sure that the data are linear, 
have constant variance and have no outliers.</p>
</div></div>


<br>

<div class="diagram"> 
<p class="heading">Outliers &mdash; Deer data</p>
<p>In the Deer data above, most of the probabilitiy plot is fairly linear. The 
long tails to the residual distribution could perhaps be caused by a small number 
of outliers in the data.</p>
<p>If possible, it would be worth checking that there were no measurement or transcription 
errors for the most extreme residuals. Perhaps these measurements were made by 
one particular hunter who incorrectly measured jaw length?</p>
<p class="heading">Nonlinearity &mdash; Antibiotic effectiveness</p>
<p>Nonlinearity in the relationship can have the opposite effect on the shape 
of a probability plot &mdash; the tails of the distribution of residuals may be shorter 
than those for a normal distribution.</p>
<p>An experiment was conducted to assess how well an antibiotic, <em>polymyxin 
B</em>, killed the bacterium, <em>Brucella bronchiseptica</em>. Petri dishes containing 
the bacterium (grown in agar) were used and different doses of the antibiotic 
were added. The diameter of the area cleared around the addition point were recorded. 
Each of 6 different doses of antibiotic was used 10 times.</p>
<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="loessProg.ProbPlotRandomApplet">
<param name="yVarName" value="Inhibition diameter(mm)">
<param name="xVarName" value="Conc of antibiotic">
<param name="yValues" value="13.6 13.5 14.9 14.5 14.5 14.8 14.4 14.5 13.9 14.7 14.5 14.4 15.8 15.4 15.4 15.7 15.3 15.4 14.8 15.6 15.6 15.4 16.2 15.9 16.2 16.0 15.9 15.5 16.1 16.5 15.8 15.6 16.8 16.6 16.6 17.0 16.0 15.8 16.2 16.6 16.2 16.0 17.4 17.2 17.2 16.8 17.2 17.4 16.2 17.1 16.5 16.4 17.8 17.7 18.1 17.5 17.3 17.2 16.5 16.7">
<param name="xValues" value="10@40 10@60 10@80 10@100 10@120 10@140">
<param name="horizAxis" value="35 145 40 20">
<param name="vertAxis" value="13.0 18.5 13 1">
<param name="residAxis" value="-1.7 1.7 -1.5 0.5">
<param name="nscoreAxis" value="-2.5 2.5 -2 1">
<param name="random" value="3.0 384958677">
<param name="labelAxes" value="true">
<param name="customText" value="Actual Data=Actual Data#Random Normal Data=Random Normal Data#Ordered residual=Ordered residual">
</applet>
</div>
<p>The diagram above shows the data and a probability plot of the residuals from 
the the least squares line. There is curvature in the probability plot, suggesting 
that the error distribution may have shorter tails than a normal distribution. 
(You can again select random samples where the normal linear model assumptions 
hold in order to help assess whether this amount of curvature in the probability 
plot is unusual.)</p>
<p>In this data set, curvature in the probability plot is probably caused by nonlinearity 
in the relationship. There is some indication that the relationship flattens out 
at high doses &mdash; perhaps a linear model with explanatory variable log(concentration) 
would be more linear?</p>
</div>

<script type='text/javascript'>writePageEnd();</script>


</body>
</html>
