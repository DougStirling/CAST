<html>
<head>
  <title>9. Multiple Regression</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="../../../structure/printStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/summaryStyles.css" type="text/css">
  <script src="../../../structure/videoControls/jquery.js"></script>
  <script src="../../../structure/printFixes.js"></script>
</head>

<body id="body" onLoad="showPrintDialog(true)">
<div id='overlay'>
	<div id='dialogWindow'>
		<div class='printDialog'>
			<script type='text/javascript'>
				document.write("<div class='heading'>" + top.document.title + "</div>");
				if (top.url != null) {
					document.write("<p class='text'>A version of this chapter has already been generated in PDF format and we recommend that it is used for printing. The button below will download and display it.</p>");
					document.write("<p><button onClick='top.showPdf()'>Show PDF version of chapter</button></p>");
					document.write("<p class='text'>However downloading could be slow depending on your internet connection. If this is a problem, click the button below to print the chapter without downloading (but perhaps not formatted as well as the PDF version).</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>If you are <strong>not</strong> using the PDF version, the best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
				else {
					document.write("<p class='text'>Click the button below to print this chapter.</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>The best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
			</script>
			
			<p class='text'>If you don't want to print now,</p>
			<p><button onClick='top.showPrintDialog(false)'>Browse formatted chapter</button></p>
		</div>
	</div>
</div>
<h1 class="chapterName">Chapter 9 &nbsp; Multiple Regression</h1>
<h1 class="sectionName">9.1 &nbsp; The general linear model</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>General linear model</li>
<li>Describing the simple linear model with matrices</li>
<li>General linear model with matrices</li>
<li>Least squares with matrices</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='5'>
<li>Interpreting coefficients</li>
<li>Standard errors</li>
<li>Inference for general linear models</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">9.1.1 &nbsp; General linear model</h2><!DOCTYPE HTML>


<p class="heading">Linear models with 1 and 2 explanatory variables</p>
  <p>We initially described the simple normal linear model,</p>
  <p class="eqn"><img src="../../../en/regnInfTwo/images/normModelUni2.gif" width="359" height="21"></p>
  <p>for <em>i</em>&nbsp;=&nbsp;1 to <em>n</em>, and then extended it with another 
    term to model the effect of two explanatory variables on the response.</p>
  <p class="eqn"><img src="../../../en/regnInfTwo/images/normModelTwo2.gif" width="418" height="21"></p>
  <p class="heading">General linear model</p>
  <p>These models can be further extended with terms involving additional explanatory 
    variables,</p>  
  <p class="eqn"><img src="../../../en/glm/images/generalModel.gif" width="535" height="55"></p>
  <p>In its general form, this is called a <strong>general linear model</strong> 
    (GLM).</p>
  <p class="heading">Least squares</p>
  <p>The parameters in a GLM are estimated in a similar way to those in linear 
    models with one and two explanatory variables. We first define the fitted 
    values for the model &mdash; the best predictions of the response based on parameter 
    estimates <em>b</em><sub>0</sub>, 
    <em>b</em><sub>1</sub>, 
    ...</p>
  <p class="eqn"><img src="../../../en/glm/images/fitValueDefn.gif" width="289" height="24"></p>
  <p>The residuals for the model are the differences between the fitted values 
    and the actual responses,</p>
  <p class="eqn"><img src="../../../en/glm/images/residDefn.gif" width="87" height="21"></p>
  <p>The good estimates of the parameters should result in fitted values that 
    are close to the actual responses and hence small residuals. An objective 
    way to estimate the parameters is therefore with values <em>b</em><sub>0</sub>, 
    <em>b</em><sub>1</sub>, 
    ..., that minimise the sum of squared residuals,</p>
  <p class="eqn"><img src="../../../en/glm/images/residSsqDefn.gif" width="177" height="26"></p>
  <p>The resulting estimates are called <strong>least squares estimates</strong> 
		of the parameters.</p>
	<p class="heading">Evaluating the least squares estimates</p>
  <p>We explained above how the least squares estimates of the model parameters 
    are defined, but we have not given a formula to evaluate them. For the simple 
    linear model (with a single explanatory variable) there are fairly simple 
    formulae for the least squares estimates,</p>

  <p class=eqn><img class="gif" src="../../../en/leastSqrs/images/lsFormulae.gif" id="gif_image_1_1_1" width="350" height="57"><iframe class="svg" src="../../../en/leastSqrs/images/lsFormulae.svg" id="svg_image_1_1_1" width="350" height="57" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_1_1");</script> </p>

  <p>However when there are 2 explanatory variables, the corresponding formulae 
    for the least squares estimates are unwieldy and they become impractically 
    complex if there are more explanatory variables.</p>
  <p>A different approach must be taken to describe the least squares estimates 
    for a GLM with <em>p</em> explanatory variables. The next two pages will show 
    that matrix notation provides a simple formula for the least squares estimates 
    in a GLM.</p>
  
<div class="centred"><div class="boxed">
<p>In practice, it is not necessary to know 
            formulae for the least squares estimates &mdash; you can use a computer 
            to evaluate them.</p>
</div></div>

  


<h2 class="pageName">9.1.2 &nbsp; Describing the simple linear model with matrices</h2><!DOCTYPE HTML>


<p class="heading">Simple linear model</p>  
  <p>The key to describing the general linear model and its least squares estimates 
		is the use of matrix notation. We first consider the response mean for a simple 
		linear model (one explanatory variable),</p>
<p class="eqn"><img src="../../../en/glm/images/simpleLinearPart.gif" width="117" height="17"></p>
  <p>If these <em>n</em> means (for <em>i</em>&nbsp;=&nbsp;1 to <em>n</em>) are 
    stacked in a column (a vector), they can be collectively expressed as the 
    product of two matrices,</p>
  <p class="eqn"><img src="../../../en/glm/images/simpleLinearMatrices.gif" width="381" height="113"></p>
  <div class="diagram"> 
    <p>The diagram below highlights the terms that are multiplied together to 
      get the response mean. Click on any row of the X-matrix to see the highlighted 
      values that are used to form the corresponding response mean.</p>

<div class="centred"> 
<applet codebase="../../../java" code="matrixProg.GenericLinearPartApplet.class" archive="coreCAST.jar" width="400" height="320">
<script type="text/javascript">writeAppletParams();</script>
<param name="xRows" value="12">
<param name="nXColumns" value="1">
<param name="fullNameX1" value="x">
<param name="shortNameX1" value="x">
</applet> 
</div>

    <p>Note how the column of 1's picks out the intercept parameter of the model.</p>
</div>

  <p class="heading">Expressing the complete model with matrices</p>
  <p>Having represented the vector of response means as a product of two matrices, 
    it is relatively straightforward to write the complete normal linear model 
    in terms of matrices:</p>
  <p class="eqn"><img src="../../../en/glm/images/simpleModelMatrices.gif" width="243" height="113"></p>
  <p>where the ε<sub><em>i</em></sub> 
    are independent normally distributed errors. More concisely, we write:</p>
  <p class="eqn"><img src="../../../en/glm/images/generalMatrixModel.gif" width="91" height="17"></p>

  <p>We next show how the linear model for an actual data set is expressed with 
    matrices.</p>

<div class="diagram">
<p class="heading">Tensile strength of concrete</p>
    <p>The tensile strength of concrete increases while it dries (the curing time). 
      The data below arose from an experiment in which slabs of concrete were 
      allowed to cure for different periods and their tensile strength (kg/cm<sup>2</sup>) 
      was measured.</p>
    <div class="centred"><table border="0" class="centred" cellpadding="5" cellspacing="0">
      <tr> 
        <th bgcolor="#FFFFFF">Days curing</th>
		<th bgcolor="#FFFFFF">Tensile strength</th>
		<th width="10">&nbsp;</th>
		<th bgcolor="#FFFFFF">Days curing</th>
		<th bgcolor="#FFFFFF">Tensile strength</th>
	</tr>
	  <tr align="center"> 
        <td bgcolor="#FFFFFF">1<br>
          1<br>1<br>2<br>2<br>2<br>3<br>3<br>3<br>3<br>3
			</td>
		<td bgcolor="#FFFFFF">13.0<br>
          13.3<br>11.8<br>21.9<br>24.5<br>24.7<br>29.8<br>28.0<br>24.1<br>24.2<br>
          26.2</td>
		<td>&nbsp;</td>
		<td valign="top" bgcolor="#FFFFFF">7<br>
          7<br>7<br>7<br>7<br>28<br>28<br>28<br>28<br>28</td>
		<td valign="top" bgcolor="#FFFFFF">32.4<br>
          30.4<br>34.5<br>33.1<br>35.7<br>41.8<br>42.6<br>40.3<br>35.7<br>37.3</td>
	</tr>
</table></div>
		
    <p>To analyse the data, we may assume that the tensile strengths of the 21 
      specimens satisfy a normal linear model. The diagram below expresses this 
      model in matrix notation.</p>

<div class="centred"> 
<applet codebase="../../../java" code="matrixProg.GenericModelEqnApplet.class" archive="coreCAST.jar" width="400" height="470">
<script type="text/javascript">writeAppletParams();</script>
<param name="nXColumns" value="1">
<param name="fullNameX1" value="Curing time, x">
<param name="shortNameX1" value="x">
<param name="valuesX1" value="1 1 1 2 2 2 3 3 3 3 3 7 7 7 7 7 28 28 28 28 28">
<param name="yName" value="Strength, Y">
<param name="errorName" value="error">
<param name="matrixFont" value="standard">
</applet> 
</div>

		
    <p>Click any row to see the model for that specimen.</p>
</div>





<h2 class="pageName">9.1.3 &nbsp; General linear model with matrices</h2><!DOCTYPE HTML>


<p class="heading">Response mean for GLM</p>
  <p>The mean response for the <em>i</em>'th observation in a general linear model 
    depends linearly on the values of the explanatory variables, <span class="em black">x<sub>i</sub></span> , 
    <span class="em black">z<sub>i</sub></span> , ..., <span class="em black">w<sub>i</sub></span> ,</p>
  <p class="eqn"><img src="../../../en/glm/images/generalLinearPart.gif" width="292" height="20"></p>
  <p>We can again use matrices to express the vector of all <em>n</em> response 
    means as the product of two matrices,</p>
  <p class="eqn"><img src="../../../en/glm/images/generalLinearMatrices.gif" width="348" height="264"></p>
  <p>Observe that the only differences from the matrix formulation of the simple 
    linear model are extra columns in the <strong>X</strong> matrix and the corresponding 
    extra entries in the vector of parameters.</p>
  <div class="diagram"> 
    <p>The diagram below illustrates this matrix multiplication for a linear model 
      with two explanatory variables for <em>n</em>&nbsp;=&nbsp;12 observations.</p>

<div class="centred"> 
<applet codebase="../../../java" code="matrixProg.GenericLinearPartApplet.class" archive="coreCAST.jar" width="450" height="320">
<script type="text/javascript">writeAppletParams();</script>
<param name="xRows" value="12">
<param name="nXColumns" value="2">
<param name="fullNameX1" value="x">
<param name="shortNameX1" value="x">
<param name="fullNameX2" value="z">
<param name="shortNameX2" value="z">
<param name="yName" value="Y">
<param name="errorName" value="error">
</applet> 
</div>

    <p>Again click on rows to see the values that are combined in the matrix multiplication 
      to form each mean.</p>
</div>

  <p class="heading">The general linear model</p>
  <p>To fully express the general linear model in matrix notation, we add a vector, 
    &epsilon;, 
    of independent normally distributed errors,</p>
<p class="eqn"><img src="../../../en/glm/images/generalMatrixModel.gif" width="91" height="17"></p>

  <p>We now illustrate the matrix formulation of the general linear model with 
    a numerical example.</p>

<div class="diagram">
		<p class="heading">Water Usage in Production Plant</p>
    <p>A production plant cost-control engineer is responsible for cost reduction. 
      One of the costly items in his plant is the amount of water used by the 
      production facilities each month. He decided to investigate water usage 
      by collecting measurements of his plant's water usage and other variables 
      in 17 months.</p>


		
    <div class="centred"><table class="centred" cellpadding="3" cellspacing="0">
      <tr> 
        <th colspan="3" align="center">Response</th>
      </tr>
      <tr bgcolor="#FFFFFF"> 
        <td align="right">Water</td>
        <td width="20"></td>
        <td>Monthly water usage (gallons)</td>
      </tr>
      <tr> 
        <th colspan="3" align="center" class="darkblue">Explanatory variables</th>
      </tr>
      <tr bgcolor="#FFFFFF"> 
        <td align="right" class="darkblue">Temperature</td>
        <td width="20" class="darkblue">&nbsp;</td>
        <td class="darkblue">Average monthly temperature (°F)</td>
      </tr>
      <tr bgcolor="#FFFFFF"> 
        <td align="right" class="darkblue">Production</td>
        <td width="20" class="darkblue">&nbsp;</td>
        <td class="darkblue">Amount of production (M pounds)</td>
      </tr>
      <tr bgcolor="#FFFFFF"> 
        <td align="right" class="darkblue">Days</td>
        <td width="20" class="darkblue">&nbsp;</td>
        <td class="darkblue">Number of plant operating days in the month</td>
      </tr>
      <tr bgcolor="#FFFFFF"> 
        <td align="right" class="darkblue">Workers</td>
        <td width="20" class="darkblue">&nbsp;</td>
        <td class="darkblue">Number of persons on the monthly plant payroll</td>
      </tr>
    </table></div>
    <p>A reasonable model for the water consumption in month <em>i</em> specifies 
      that it is linearly affected by the four explanatory variables,</p>
    <p class="eqn"><img src="../../../en/glm/images/waterUsageModel.gif" width="471" height="18"></p>
    <p>This model is expressed below in matrix notation with the actual values 
      of the explanatory variables inserted into the <strong>X</strong> matrix.</p>

<div class="centred"> 
<applet codebase="../../../java" code="matrixProg.GenericModelEqnApplet.class" archive="coreCAST.jar" width="550" height="470">
<script type="text/javascript">writeAppletParams();</script>
<param name="nXColumns" value="4">
<param name="fullNameX1" value="Temp, t">
<param name="shortNameX1" value="t">
<param name="valuesX1" value="58.8 65.2 70.9 77.4 79.3 81.0 71.9 63.9 54.5 39.5 44.5 43.6 56.0 64.7 73.0 78.9 79.4">
<param name="fullNameX2" value="Prod, p">
<param name="shortNameX2" value="p">
<param name="valuesX2" value="7107 6373 6796 9208 14792 14564 11964 13526 12656 14119 16691 14571 13619 14575 14556 18573 15618">
<param name="fullNameX3" value="Days, d">
<param name="shortNameX3" value="d">
<param name="valuesX3" value="21 22 22 20 25 23 20 23 20 20 22 19 22 22 21 21 22">
<param name="fullNameX4" value="Wkrs, w">
<param name="shortNameX4" value="w">
<param name="valuesX4" value="129 141 153 166 193 189 175 186 190 187 195 206 198 192 191 200 200">
<param name="yName" value="Water, Y">
<param name="errorName" value="error">
<param name="matrixFont" value="standard">
</applet> 
</div>

    <p>We assume that that observed water usages in the 17 months come from this 
      model.</p>
</div>





<h2 class="pageName">9.1.4 &nbsp; Least squares with matrices</h2><!DOCTYPE HTML>


<p>We next develop the method of least squares using matrices for a general 
    linear model,</p>
  <p class=eqn><img src="../../../en/glm/images/generalMatrixModel.gif" width="91" height="17"></p>
  <p class="heading">Fitted values</p>
  <p>Consider a vector of estimates of the <em>p</em> parameters,</p>
  <p class=eqn><img src="../../../en/glm/images/bVector.gif" width="78" height="112"></p>
  <p>Our predictions of the response based on the explanatory variables and these 
    estimates is:</p>
  <p class=eqn><img src="../../../en/glm/images/fittedVal.gif" width="57" height="22"></p>
  <p>As in the simple linear model, these are called <strong>fitted values</strong>.</p>

  <div class="diagram"> 
    <p>The diagram below shows how this matrix multiplication provides the fitted 
      values for <em>n</em>&nbsp;=&nbsp;12 observations in a model with two explanatory 
      variables. Click on any row to see how the corresponding fitted value is 
      obtained.</p>

<div class="centred"> 
<applet codebase="../../../java" code="matrixProg.GenericFittedValApplet.class" archive="coreCAST.jar" width="420" height="320">
<script type="text/javascript">writeAppletParams();</script>
<param name="xRows" value="12">
<param name="nXColumns" value="2">
<param name="fullNameX1" value="x">
<param name="shortNameX1" value="x">
<param name="fullNameX2" value="z">
<param name="shortNameX2" value="z">
<param name="yName" value="y">
<param name="fitName" value="fit">
</applet> 
</div>

</div>

  <p class="heading">Residual sum of squares</p>
  <p>The fitted values are unlikely to be exactly the equal to the actual response 
    values. The differences are called the model <strong>residuals</strong>.</p>
  <p class=eqn><img src="../../../en/glm/images/residualGlm.gif" width="162" height="22"></p>
 
  <p>The sum of squared residuals summarises how close the fitted values are to 
    the response for any vector of parameters, <em><span class="bold red">b</span> </em>.</p>
  <p class=eqn><img class="gif" src="../../../en/glm/images/residSsq.gif" id="gif_image_1_4_1" width="35" height="21"><iframe class="svg" src="../../../en/glm/images/residSsq.svg" id="svg_image_1_4_1" width="35" height="21" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_4_1");</script></p>
  <p>The residual sum of squares can also be expressed in terms of matrices,</p>
  <p class=eqn><img src="../../../en/glm/images/residSsqMatrix.gif" width="270" height="23"></p>
  <p class="heading">Least squares estimates</p>
  <p>The <strong>least squares estimates</strong> of the parameters are given 
    by the vector <em><span class="bold red">b</span> </em> that 
    minimises the sum of squared residuals.</p>
  <p>The least squares estimates are therefore the solution to a mathematical 
    minimisation problem that is relatively easily specified in terms of matrices 
    &mdash; minimising</p>
  <p class=eqn><img src="../../../en/glm/images/residSsqMatrix2.gif" width="154" height="23"></p>
  <p>with respect to <em><span class="bold red">b</span> </em>. 
    Note that the vector <em><strong>y</strong></em> and the matrix <strong>X</strong> 
    contain known values. The solution to this mathematical problem is given by 
    the equation,</p>
  <p class=eqn><img src="../../../en/glm/images/lsEquation.gif" width="138" height="23"></p>
  
<div class="centred"><div class="boxed">
<p>Neither the proof nor the matrix equation for 
        <span class="em red">b</span>  are important for understanding 
        how to use general linear models.</p>
</div></div>

  <p>It is however important to observe that:</p>
	
<div class="centred"><div class="boxed">
<p>The same matrix equation provides least squares 
				estimates for <strong>all</strong> general linear models.</p>
</div></div>

	<p>We will also show that inference for all general linear models can be expressed 
		in common terms.</p>
  <div class="diagram">
<p class="heading">Sale price of grandfather clocks</p>
    <p>The selling prices at auction of 32 antique grandfather clocks were recorded, 
      with the ages of the clocks and the number of people who made a bid. The 
      least squares estimates of the parameters are shown in the equation below 
      for the fitted values.</p>
    <p class=eqn><img src="../../../en/glm/images/grandfatherFit.gif" width="291" height="20"></p>
    <p>The matrices below shows the matrix equation for the residuals.</p>

<div class="centred"> 
<applet codebase="../../../java" code="matrixProg.ActualResidApplet.class" archive="coreCAST.jar" width="600" height="630">
<script type="text/javascript">writeAppletParams();</script>
<param name="nXColumns" value="2">
<param name="fullNameX1" value="Age, x">
<param name="shortNameX1" value="x">
<param name="valuesX1" value="127 115 127 150 156 182 156 132 137 113 137 117 137 153 117 126 170 182 162 184 143 159 108 175 108 179 111 187 111 115 194 168">
<param name="fullNameX2" value="Bids, z">
<param name="shortNameX2" value="z">
<param name="valuesX2" value="13 12 7 9 6 11 12 10 9 9 15 11 8 6 13 10 14 8 11 10 6 9 14 8 6 9 15 8 7 7 5 7">
<param name="yName" value="Price">
<param name="yValues" value="1235 1080 845 1522 1047 1979 1822 1253 1297 946 1713 1024 1147 1092 1152 1336 2131 1550 1884 2041 854 1483 1055 1545 729 1792 1175 1593 785 744 1356 1262">
<param name="errorName" value="e">
<param name="lsDecimals" value="1 2 2">
<param name="residDecimals" value="1">
<param name="matrixFont" value="standard">
</applet> 
</div>

    <p>Any other values for the three parameter estimates would result in residuals 
      with a greater sum of squares.</p>
</div>





<h2 class="pageName">9.1.5 &nbsp; Interpreting coefficients</h2><!DOCTYPE HTML>


<p class="heading">Warning</p>
	<p>It is important to note that the least squares coefficients associated with 
		the explanatory variables do not describe their overall relationship with 
		the response as displayed in simple scatterplots of the response against the 
		individual explanatory variables.</p>
	<p>The least squares coefficient associated with a variable describes the effect 
		of changes to that variable <strong>if all other variables are held constant</strong>. 
		This is also called the variable's <strong>conditional effect</strong> on 
		the response.</p>
	<div class="diagram">
<p class="heading">Body fat</p>

		<p>Percentage body fat of individuals is an important measure of their health, 
			but is a difficult quantity to measure. Scientists accurately determined 
			body fat from 252 men using an underwater weighing technique and recorded 
			several other body measurements that were easier to obtain.</p>
		<div class="centred"><table class="centred" cellpadding="3" cellspacing="0">
			<tr> 
				<th align="center">Response</th>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td>Body fat (percent)</td>
			</tr>
			<tr> 
				<th align="center" class="darkblue">Explanatory variables</th>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Weight (lbs)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Age (yrs)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Height (inches)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Neck circumference (cm)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Chest circumference (cm)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Abdomen circumference (cm)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Hip circumference (cm)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Thigh circumference (cm)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Knee circumference (cm)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Ankle circumference (cm)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Extended biceps circumference (cm)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Forearm circumference (cm)</td>
			</tr>
			<tr bgcolor="#FFFFFF"> 
				<td class="darkblue">Wrist circumference (cm)</td>
			</tr>
		</table></div>
		<p>The least squares estimates for a linear model predicting body fat from 
			the other variables results in a prediction equation,</p>
		<p class=eqn><img src="../../../en/glm/images/fatPredictionEqn.gif" width="490" height="58"></p>
		<p>The negative signs of some of these coefficients might be unexpected! These 
			coefficients are estimates of the general linear model parameters and they 
			may not be accurate estimates &mdash; we will consider their standard errors 
			in the next page &mdash; but this does not totally explain the signs of the coefficients.</p>
		<p>Use the pop-up menu in the diagram below to investigate how variables that 
			are positively correlated with <em>body fat</em> can have negative least 
			squares coeffients.</p>

<div class="centred"> 
<applet codebase="../../../java" code="corrProg.MultiXApplet.class" archive="coreCAST.jar" width="500" height="400">
<script type="text/javascript">writeAppletParams();</script>
<param name="yVarName" value="Body fat">
<param name="yValues" value="12.6 6.9 24.6 10.9 27.8 20.6 19.0 12.8 5.1 12.0 7.5 8.5 20.5 20.8 21.7 20.5 28.1 22.4 16.1 16.5 19.0 15.3 15.7 17.6 14.2 4.6 8.5 22.4 4.7 9.4 12.3 6.5 13.4 20.9 31.1 38.2 23.6 27.5 33.8 31.3 33.1 31.7 30.4 30.8 8.4 14.1 11.2 6.4 13.4 5.0 10.7 7.4 8.7 7.1 4.9 22.2 20.1 27.1 30.4 24.0 25.4 28.8 29.6 25.1 31.0 28.9 21.1 14.0 7.1 13.2 23.7 9.4 9.1 13.7 12.0 18.3 9.2 21.7 21.1 18.6 30.2 26.0 18.2 26.2 26.1 25.8 15.0 22.6 8.8 14.3 20.2 18.1 9.2 24.2 9.6 17.3 10.1 11.1 17.7 21.7 20.8 20.1 19.8 21.9 24.7 17.8 19.1 18.2 17.2 21.0 19.5 27.1 21.6 20.9 25.9 16.7 19.8 14.1 25.1 17.9 27.0 24.6 14.8 16.0 14.0 17.4 26.4 17.4 20.4 15.0 18.0 22.2 23.1 25.3 23.8 26.3 21.4 28.4 21.8 20.1 24.3 18.1 22.7 9.9 10.8 14.4 19.0 28.6 6.1 24.5 9.9 19.1 10.6 16.5 20.5 17.2 30.1 10.5 12.8 22.0 9.9 14.8 13.3 15.2 26.5 19.0 21.4 20.0 34.7 16.5 4.1 1.9 20.2 16.8 24.6 10.4 13.4 28.8 22.0 16.8 25.8 0.0 11.9 12.4 17.4 9.2 23.0 20.1 20.2 23.8 11.8 36.5 16.0 24.0 22.3 24.8 21.5 17.6 7.3 22.6 12.5 21.7 27.7 6.8 33.4 16.6 31.7 31.5 10.1 11.3 7.8 26.4 19.3 18.5 19.3 45.1 13.8 8.2 23.9 15.1 12.7 25.3 11.9 6.1 11.3 12.8 14.9 24.5 15.0 16.9 11.1 16.1 15.5 25.9 25.5 18.4 24.0 26.4 12.7 28.8 17.0 33.6 29.3 31.4 28.1 15.3 29.1 11.5 32.3 28.3 25.3 30.7">
<param name="vertAxis" value="0 50 0 10">
<param name="xVarName" value="Weight">
<param name="xValues" value="154.25 173.25 154.00 184.75 184.25 210.25 181.00 176.00 191.00 198.25 186.25 216.00 180.50 205.25 187.75 162.75 195.75 209.25 183.75 211.75 179.00 200.50 140.25 148.75 151.25 159.25 131.50 148.00 133.25 160.75 182.00 160.25 168.00 218.50 247.25 191.75 202.25 196.75 363.15 203.00 262.75 205.00 217.00 212.00 125.25 164.25 133.50 148.50 135.75 127.50 158.25 139.25 137.25 152.75 136.25 198.00 181.50 201.25 202.50 179.75 216.00 178.75 193.25 178.00 205.50 183.50 151.50 154.75 155.25 156.75 167.50 146.75 160.75 125.00 143.00 148.25 162.50 177.75 161.25 171.25 163.75 150.25 190.25 170.75 168.00 167.00 157.75 160.00 176.75 176.00 177.00 179.75 165.25 192.50 184.25 224.50 188.75 162.50 156.50 197.00 198.50 173.75 172.75 196.75 177.00 165.50 200.25 203.25 194.00 168.50 170.75 183.25 178.25 163.00 175.25 158.00 177.25 179.00 191.00 187.50 206.50 185.25 160.25 151.50 161.00 167.00 177.50 152.25 192.25 165.25 171.75 171.25 197.00 157.00 168.25 186.00 166.75 187.75 168.25 212.75 176.75 173.25 167.00 159.75 188.15 156.00 208.50 206.50 143.75 223.00 152.25 241.75 146.00 156.75 200.25 171.50 205.75 182.50 136.50 177.25 151.25 196.00 184.25 140.00 218.75 217.00 166.25 224.75 228.25 172.75 152.25 125.75 177.25 176.25 226.75 145.25 151.00 241.25 187.25 234.75 219.25 118.50 145.75 159.25 170.50 167.50 232.75 210.50 202.25 185.00 153.00 244.25 193.50 224.75 162.75 180.00 156.25 168.00 167.25 170.75 178.25 150.00 200.50 184.00 223.00 208.75 166.00 195.00 160.50 159.75 140.50 216.25 168.25 194.75 172.75 219.00 149.25 154.50 199.25 154.50 153.25 230.00 161.75 142.25 179.75 126.50 169.50 198.50 174.50 167.75 147.75 182.25 175.50 161.75 157.75 168.75 191.50 219.15 155.25 189.75 127.50 224.50 234.25 227.75 199.50 155.50 215.50 134.25 201.00 186.75 190.75 207.50">
<param name="horizAxis" value="100 400 100 100">
<param name="x1VarName" value="Age">
<param name="x1Values" value="23 22 22 26 24 24 26 25 25 23 26 27 32 30 35 35 34 32 28 33 28 28 31 32 28 27 34 31 27 29 32 29 27 41 41 49 40 50 46 50 45 44 48 41 39 43 40 39 45 47 47 40 51 49 42 54 58 62 54 61 62 56 54 61 57 55 54 55 54 55 62 55 56 55 61 61 57 69 81 66 67 64 64 70 72 67 72 64 46 48 46 44 47 46 47 53 38 50 46 47 49 48 41 49 43 43 43 52 43 40 43 43 47 42 48 40 48 51 40 44 52 44 40 47 50 46 42 43 40 42 49 40 47 50 41 44 39 43 40 49 40 40 52 23 23 24 24 25 25 26 26 26 27 27 27 28 28 28 30 31 31 33 33 34 34 35 35 35 35 35 35 35 35 36 36 37 37 37 38 39 39 40 40 40 40 40 41 41 41 41 41 42 42 42 42 42 42 42 42 43 43 43 43 44 44 44 44 47 47 47 49 49 49 50 50 51 51 51 52 53 54 54 54 55 55 55 55 55 56 56 57 57 58 58 60 62 62 63 64 65 65 65 66 67 67 68 69 70 72 72 72 74">
<param name="horiz1Axis" value="20 85 20 10">
<param name="x2VarName" value="Height">
<param name="x2Values" value="67.75 72.25 66.25 72.25 71.25 74.75 69.75 72.50 74.00 73.50 74.50 76.00 69.50 71.25 69.50 66.00 71.00 71.00 67.75 73.50 68.00 69.75 68.25 70.00 67.75 71.50 67.50 67.50 64.75 69.00 73.75 71.25 71.25 71.00 73.50 65.00 70.00 68.25 72.25 67.00 68.75 69.50 70.00 71.50 68.00 73.25 67.50 71.25 68.50 66.75 72.25 69.00 67.75 73.50 67.50 72.00 68.00 69.50 70.75 65.75 73.25 68.50 70.25 67.00 70.00 67.50 70.75 71.50 69.25 71.50 71.50 68.75 73.75 64.00 65.75 67.50 69.50 68.50 70.25 69.25 67.75 67.25 72.75 70.00 69.25 67.50 67.25 65.75 72.50 73.00 70.00 69.50 70.50 71.75 74.50 77.75 73.25 66.50 68.25 72.00 73.50 72.00 71.25 73.75 69.25 68.50 73.50 74.25 75.50 69.25 68.50 70.00 70.00 70.25 71.75 69.25 72.75 72.00 74.00 72.25 74.50 71.50 68.75 66.75 66.50 67.00 68.75 67.75 73.25 69.75 71.50 70.50 73.25 66.75 69.50 69.75 70.75 74.00 71.25 75.00 71.00 69.50 67.75 72.25 77.50 70.75 72.75 69.75 72.50 70.25 69.00 74.50 72.25 67.25 73.50 75.25 69.00 72.25 68.75 71.50 72.25 73.00 68.75 70.50 72.00 73.75 68.00 72.25 69.50 69.50 67.75 65.50 71.00 71.50 71.75 69.25 67.00 71.50 69.25 74.50 74.25 68.00 67.25 69.75 74.25 71.50 74.25 72.00 72.50 68.25 69.25 76.00 70.50 74.75 72.75 68.25 69.00 71.50 72.75 67.50 70.25 69.25 71.50 74.00 69.75 73.00 65.50 72.50 70.25 70.75 68.00 74.50 71.75 70.75 73.00 64.00 69.75 70.00 71.75 69.25 70.50 72.25 67.50 67.25 68.75 66.75 68.25 74.25 69.50 68.50 65.75 71.75 71.50 67.25 67.50 67.50 72.25 69.50 69.50 65.75 65.75 68.25 72.00 72.75 68.50 69.25 70.50 67.00 69.75 66.00 70.50 70.00">
<param name="horiz2Axis" value="63 78 65 5">
<param name="x3VarName" value="Neck">
<param name="x3Values" value="36.2 38.5 34.0 37.4 34.4 39.0 36.4 37.8 38.1 42.1 38.5 39.4 38.4 39.4 40.5 36.4 38.9 42.1 38.0 40.0 39.1 41.3 33.9 35.5 34.5 35.7 36.2 38.8 36.4 36.7 38.7 37.3 38.1 39.8 42.1 38.4 38.5 42.1 51.2 40.2 43.2 36.6 37.3 41.5 31.5 35.7 33.6 34.6 32.8 34.0 34.9 34.3 36.5 35.1 37.8 39.9 39.1 40.5 40.5 38.4 41.4 35.6 38.0 37.4 40.1 40.9 35.6 36.9 37.5 36.3 35.5 38.7 36.4 33.2 36.5 36.0 38.7 38.7 37.8 37.4 38.4 38.1 39.3 38.7 38.5 36.5 37.7 36.5 38.0 36.7 37.2 39.2 37.5 38.0 37.3 41.1 37.5 38.7 35.9 40.0 40.1 37.0 36.3 40.7 39.6 31.1 38.6 42.0 38.5 34.2 37.2 37.1 40.2 35.3 38.0 36.3 36.8 41.0 38.3 38.0 40.8 39.5 36.9 36.9 37.7 36.6 38.9 37.5 39.8 38.3 35.5 36.3 37.8 37.8 36.5 37.8 37.0 37.7 34.3 40.8 37.4 36.5 37.5 35.5 38.0 35.7 39.2 40.9 35.2 40.6 35.4 41.8 34.1 37.9 38.2 35.6 38.5 37.0 35.9 36.2 35.0 38.5 40.7 36.0 39.5 40.5 38.5 43.9 40.4 37.6 37.0 34.0 38.4 38.7 41.5 36.0 35.3 42.1 38.0 42.8 40.0 33.8 35.5 35.3 37.7 39.4 41.9 38.5 40.8 38.0 36.4 41.8 40.7 38.5 35.4 38.5 35.5 36.5 37.6 37.4 37.8 35.2 37.9 37.9 40.9 41.9 39.1 40.2 36.0 34.5 35.8 40.2 38.3 39.0 37.4 41.2 34.8 36.9 39.4 37.6 38.5 42.5 37.4 35.2 41.1 33.4 37.2 38.3 38.1 37.4 35.2 39.4 38.0 35.1 40.4 38.3 40.6 40.2 37.9 40.8 34.7 38.8 41.4 41.3 40.7 36.3 40.8 34.9 40.9 38.9 38.9 40.8">
<param name="horiz3Axis" value="30 53 30 10">
<param name="x4VarName" value="Chest">
<param name="x4Values" value="93.1 93.6 95.8 101.8 97.3 104.5 105.1 99.6 100.9 99.6 101.5 103.6 102.0 104.1 101.3 99.1 101.9 107.6 106.8 106.2 103.3 111.4 86.0 86.7 90.2 89.6 88.6 97.4 93.5 97.4 100.5 93.5 93.0 111.7 117.0 118.5 106.5 105.6 136.2 114.8 128.3 106.0 113.3 106.6 85.1 96.6 88.2 89.8 92.3 83.4 90.2 89.2 89.7 93.3 87.6 107.6 100.0 111.5 115.4 104.8 112.3 102.9 107.6 105.3 105.3 103.0 90.0 95.4 89.3 94.4 97.6 88.5 93.6 87.7 93.4 91.6 91.6 102.0 96.4 102.7 97.7 97.1 103.1 101.8 101.4 98.9 97.5 104.3 97.3 96.7 99.7 101.9 97.2 106.6 99.6 113.2 99.1 99.4 95.1 107.5 106.5 99.1 96.7 103.5 104.0 93.1 105.2 110.0 110.1 97.8 96.3 108.0 99.7 93.5 100.7 97.0 96.0 99.2 95.4 101.8 104.3 99.2 99.3 94.0 98.9 101.0 98.7 95.9 103.9 96.2 97.8 94.6 103.6 100.4 98.4 104.6 92.9 97.8 98.3 104.7 98.6 99.5 102.7 92.1 96.6 92.7 102.0 110.9 92.3 114.1 92.9 108.3 88.5 94.0 101.1 92.1 105.6 98.5 88.7 101.1 94.0 103.8 98.9 89.2 111.4 107.5 99.1 108.2 114.9 99.1 92.2 90.8 100.5 98.2 115.3 96.8 92.6 119.2 102.7 109.5 108.5 79.3 95.5 92.3 98.9 89.5 117.5 107.4 109.2 103.4 91.4 115.2 104.9 106.7 92.2 101.6 97.8 92.0 94.0 103.7 102.7 91.1 107.2 100.8 121.6 105.6 100.6 102.7 99.8 92.9 91.2 115.6 98.3 103.7 98.7 119.8 92.8 93.3 106.8 93.9 99.0 119.9 94.2 92.7 106.9 88.8 101.7 105.3 104.0 98.6 99.6 103.4 100.2 94.9 97.2 104.7 104.0 117.6 95.8 106.4 93.0 119.6 119.7 115.8 118.3 97.4 113.7 89.2 108.5 111.1 108.3 112.4">
<param name="horiz4Axis" value="75 140 80 20">
<param name="x5VarName" value="Abdomen">
<param name="x5Values" value="85.2 83.0 87.9 86.4 100.0 94.4 90.7 88.5 82.5 88.6 83.6 90.9 91.6 101.8 96.4 92.8 96.4 97.5 89.6 100.5 95.9 98.8 76.4 80.0 76.3 79.7 74.6 88.7 73.9 83.5 88.7 84.5 79.1 100.5 115.6 113.1 100.9 98.8 148.1 108.1 126.2 104.3 111.2 104.3 76.0 81.5 73.7 79.5 83.4 70.4 86.7 77.9 82.0 79.6 77.6 100.0 99.8 104.2 105.3 98.3 104.8 94.7 102.4 99.7 105.5 100.3 83.9 86.6 78.4 84.6 91.5 82.8 82.9 76.0 83.3 81.8 78.8 95.0 95.4 98.6 95.8 89.0 97.8 94.9 99.8 89.7 88.1 90.9 86.0 86.5 95.6 93.2 83.1 97.5 88.8 99.2 91.6 86.7 88.2 94.0 95.0 92.0 89.2 95.5 98.6 87.3 102.8 101.6 88.7 92.3 90.6 105.0 95.0 89.6 92.4 86.6 90.0 90.0 92.4 87.5 99.2 98.1 83.3 86.1 84.1 89.9 92.1 78.0 93.5 87.0 90.1 90.3 99.8 89.4 87.2 101.1 86.1 98.6 88.5 106.6 93.1 93.0 91.0 77.1 85.3 81.9 99.1 100.5 76.5 106.8 77.6 102.9 72.8 88.2 100.1 83.5 105.0 90.8 76.6 92.4 81.2 95.6 92.1 83.4 106.0 95.1 90.4 100.4 115.9 90.8 81.9 75.0 90.3 90.3 108.8 79.4 83.2 110.3 92.7 104.5 104.6 69.4 83.6 86.8 90.4 83.7 109.3 98.9 98.0 101.2 80.6 113.7 94.1 105.7 85.6 96.6 86.0 89.7 78.0 89.7 89.2 85.7 103.1 89.1 113.9 96.3 93.9 101.3 83.9 84.4 79.4 104.0 89.7 97.6 87.6 122.1 81.1 81.5 100.0 88.7 91.8 110.4 87.6 82.8 95.3 78.2 91.1 96.7 89.4 93.0 86.4 96.7 88.1 94.9 93.3 95.6 98.2 113.8 82.8 100.5 79.7 118.0 109.0 113.4 106.1 84.3 107.6 83.6 105.0 111.5 101.3 108.5">
<param name="horiz5Axis" value="65 150 80 20">
<param name="x6VarName" value="Hip">
<param name="x6Values" value="94.5 98.7 99.2 101.2 101.9 107.8 100.3 97.1 99.9 104.1 98.2 107.7 103.9 108.6 100.1 99.2 105.2 107.0 102.4 109.0 104.9 104.8 94.6 93.4 95.8 96.5 85.3 94.7 88.5 98.7 99.8 100.6 94.5 108.3 116.1 113.8 106.2 104.8 147.7 102.5 125.6 115.5 114.1 106.0 88.2 97.2 88.5 92.7 90.4 87.2 98.3 91.0 89.1 91.6 88.6 99.6 102.5 105.8 97.0 99.6 103.1 100.8 99.4 99.7 108.3 104.2 93.9 91.8 96.1 94.3 98.5 95.5 96.3 88.6 93.0 94.8 94.3 98.3 99.3 100.2 97.1 96.9 99.6 95.0 96.2 96.2 96.9 93.8 99.3 98.3 102.2 100.6 95.4 100.6 101.4 107.5 102.4 96.2 92.8 103.7 101.7 98.3 98.3 101.6 99.5 96.6 103.6 100.7 102.1 100.6 99.3 103.0 98.6 99.8 97.5 92.6 99.7 96.4 104.3 101.0 104.1 101.4 97.5 95.2 94.0 100.0 98.5 93.2 99.5 97.8 95.8 99.1 103.2 92.3 98.4 102.1 95.6 100.6 98.3 107.7 101.6 99.3 98.9 93.9 102.5 95.3 110.1 106.2 92.1 113.9 93.5 114.4 91.1 95.2 105.0 98.3 106.4 102.5 89.8 99.3 91.5 105.1 103.5 89.6 108.8 104.5 95.6 106.8 111.9 98.1 92.8 89.2 98.7 99.9 114.4 89.2 96.4 113.9 101.9 109.9 109.8 85.0 91.6 96.1 95.5 98.1 108.8 104.1 101.8 103.1 92.3 112.4 102.7 111.8 96.5 100.6 96.2 101.0 99.0 94.2 99.2 96.9 105.5 102.6 107.1 102.0 100.1 101.7 91.8 94.0 89.0 109.0 99.1 104.2 96.1 112.8 96.3 94.4 105.0 94.5 96.2 105.5 95.6 91.9 98.2 87.5 97.1 106.6 98.4 97.0 90.1 100.7 97.8 100.2 94.0 93.7 101.1 111.8 94.5 100.5 87.6 114.3 109.1 109.8 101.6 94.4 110.0 88.8 104.5 101.7 97.8 107.1">
<param name="horiz6Axis" value="80 150 80 20">
<param name="x7VarName" value="Thigh">
<param name="x7Values" value="59.0 58.7 59.6 60.1 63.2 66.0 58.4 60.0 62.9 63.1 59.7 66.2 63.4 66.0 69.0 63.1 64.8 66.9 64.2 65.8 63.5 63.4 57.4 54.9 58.4 55.0 51.7 57.5 50.1 58.9 57.5 58.5 57.3 67.1 71.2 61.9 63.5 66.0 87.3 61.3 72.5 70.6 67.7 65.0 50.0 58.4 53.3 52.7 52.0 50.6 52.6 51.4 49.3 52.6 51.9 57.2 62.1 61.8 59.1 60.6 61.6 60.9 61.0 60.8 65.0 64.8 55.0 54.3 56.0 51.2 56.6 58.9 52.9 50.9 55.5 54.5 56.7 55.0 53.5 56.5 54.8 54.8 58.9 56.0 56.3 54.7 57.2 57.8 61.0 60.4 58.3 58.9 56.9 58.9 57.4 61.7 60.6 62.1 54.7 62.7 59.0 59.3 60.0 59.1 59.5 54.7 61.2 55.8 57.5 57.5 61.9 63.7 62.3 61.5 59.3 55.9 58.8 56.8 64.6 58.5 58.5 57.1 60.5 58.1 58.5 60.7 60.7 53.5 61.7 57.4 57.0 60.3 61.2 56.1 56.0 58.9 58.8 63.6 58.1 66.5 59.1 60.4 57.1 56.1 59.1 56.4 71.2 68.4 51.9 67.6 56.9 72.9 53.6 56.8 62.1 57.3 68.6 60.8 50.1 59.4 52.5 61.4 64.0 52.4 63.8 64.8 55.5 63.3 74.4 60.1 54.7 50.0 57.8 59.2 69.2 50.3 60.0 69.8 64.7 69.5 68.1 47.2 54.1 58.0 55.4 57.3 67.7 63.5 62.8 61.5 54.3 68.5 60.6 65.3 60.2 61.1 57.7 62.3 57.5 58.5 60.2 55.5 68.8 60.6 63.5 63.3 58.9 60.7 53.0 56.0 51.1 63.7 56.3 60.0 57.1 62.5 53.8 54.7 63.9 53.7 57.7 64.2 59.7 54.4 57.4 50.8 56.6 64.0 58.4 55.4 53.0 59.3 57.1 56.8 54.3 54.4 59.3 63.4 61.2 59.2 50.7 61.3 63.7 65.6 58.2 54.3 63.3 49.6 59.6 60.3 56.0 59.3">
<param name="horiz7Axis" value="45 90 50 10">
<param name="x8VarName" value="Knee">
<param name="x8Values" value="37.3 37.3 38.9 37.3 42.2 42.0 38.3 39.4 38.3 41.7 39.7 39.2 38.3 41.5 39.0 38.7 40.8 40.0 38.7 40.6 38.0 40.6 35.3 36.2 35.5 36.7 34.7 36.0 34.5 35.3 38.7 38.8 36.2 44.2 43.3 38.3 39.9 41.5 49.1 41.1 39.6 42.5 40.9 40.2 34.7 38.2 34.5 37.5 35.8 34.4 37.2 34.9 33.7 37.6 34.9 38.0 39.6 39.8 38.0 37.7 40.9 38.0 39.4 40.1 41.2 40.2 36.1 35.4 37.4 37.4 38.6 37.6 37.5 35.4 35.2 37.0 39.7 38.3 37.5 39.3 38.2 38.0 39.0 36.5 36.6 37.8 37.7 39.5 38.4 39.9 38.2 39.7 38.3 40.5 39.6 42.3 39.4 39.3 37.3 39.0 39.4 38.4 38.4 39.8 36.1 39.0 39.3 38.7 40.0 36.8 38.0 40.0 38.1 37.8 38.1 36.3 38.4 38.8 41.1 39.2 39.3 40.5 38.7 36.5 36.6 36.0 36.8 35.8 39.0 36.9 38.7 38.5 38.1 35.6 36.9 37.9 36.1 39.2 38.4 42.5 39.6 38.2 36.7 36.1 37.6 36.5 43.5 40.8 35.7 42.7 35.9 43.5 36.8 37.4 40.0 37.8 40.0 38.5 34.8 39.0 36.6 40.6 37.3 35.6 42.0 41.3 34.2 41.7 40.6 39.1 36.2 34.8 37.3 37.7 42.4 34.8 38.1 42.6 39.5 43.1 42.8 33.5 36.2 39.4 38.9 39.7 41.3 39.8 41.3 40.4 36.3 45.0 38.6 43.3 38.9 38.4 38.6 38.0 40.0 39.0 39.2 35.7 38.3 39.0 40.3 39.8 37.6 39.4 36.2 38.2 35.0 40.3 38.8 40.9 38.1 36.9 36.5 39.0 39.2 36.2 38.1 42.7 40.2 35.2 37.1 33.0 38.5 42.6 37.4 38.8 35.0 38.6 38.9 35.9 35.7 37.1 40.3 41.1 39.1 38.1 33.4 42.1 42.4 46.0 38.8 37.5 44.0 34.8 40.8 37.3 41.6 42.2">
<param name="horiz8Axis" value="32 50 35 5">
<param name="x9VarName" value="Ankle">
<param name="x9Values" value="21.9 23.4 24.0 22.8 24.0 25.6 22.9 23.2 23.8 25.0 25.2 25.9 21.5 23.7 23.1 21.7 23.1 24.4 22.9 24.0 22.1 24.6 22.2 22.1 22.9 22.5 21.4 21.0 21.3 22.6 33.9 21.5 24.5 25.2 26.3 21.9 22.6 24.7 29.6 24.7 26.6 23.7 25.0 23.0 21.0 23.4 22.5 21.9 20.6 21.9 22.4 21.0 21.4 22.6 22.5 22.0 22.5 22.7 22.5 22.9 23.1 22.1 23.6 22.7 24.7 22.7 21.7 21.5 22.4 21.6 22.4 21.6 23.1 19.1 20.9 21.4 24.2 21.8 21.5 22.7 23.7 22.0 23.0 24.1 22.0 33.7 21.8 23.3 23.8 24.4 22.5 23.1 22.1 24.5 24.6 23.2 22.9 23.3 21.9 22.3 22.3 22.4 23.2 25.4 22.0 24.8 23.5 23.4 24.8 22.8 22.3 23.6 23.9 21.9 21.8 22.1 22.8 23.3 24.8 24.5 24.6 23.2 22.6 22.1 23.5 21.9 22.2 20.8 21.8 22.2 23.2 23.0 22.6 20.5 23.0 22.7 22.4 23.8 22.5 24.5 21.6 22.0 22.3 22.7 23.2 22.0 25.2 24.6 22.0 24.7 20.4 25.1 23.8 22.8 24.9 21.7 25.2 25.0 21.8 24.6 21.0 25.0 23.5 20.4 23.4 25.6 21.9 24.6 24.0 23.4 22.1 22.0 22.4 21.5 24.0 22.2 22.0 24.8 24.7 25.8 24.1 20.2 21.8 22.7 22.4 22.6 24.7 23.5 24.8 22.9 21.8 25.5 24.7 26.0 22.4 24.1 24.0 22.3 22.5 24.1 23.8 22.0 23.7 24.0 21.8 24.1 21.4 23.3 22.5 22.6 21.7 23.2 23.0 25.5 21.8 23.6 21.5 22.6 22.9 22.0 23.9 27.0 23.4 22.5 21.8 19.7 22.6 23.4 22.5 23.2 21.3 22.8 23.6 21.0 21.0 22.7 23.0 22.3 22.3 24.0 20.1 23.4 24.6 25.4 24.1 22.6 22.6 21.5 23.2 21.5 22.7 24.6">
<param name="horiz9Axis" value="18 35 20 5">
<param name="x10VarName" value="Biceps">
<param name="x10Values" value="32.0 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 32.8 37.2 32.5 36.9 36.1 31.1 36.2 38.2 37.2 37.1 32.5 33.0 27.9 29.8 31.1 29.9 28.7 29.2 30.5 30.1 32.5 30.1 29.0 37.5 37.3 32.0 35.1 33.2 45.0 34.1 36.4 33.6 36.7 35.8 26.1 29.7 27.9 28.8 28.8 26.8 26.0 26.7 29.6 38.5 27.7 35.9 33.1 37.7 31.6 34.5 36.2 32.5 32.7 33.6 35.3 34.8 29.6 32.8 32.6 27.3 31.5 30.3 29.7 29.3 29.4 29.3 30.2 30.8 31.4 30.3 29.4 29.9 34.3 31.2 29.7 32.4 32.6 29.2 30.2 28.8 29.1 31.4 30.1 33.3 30.3 32.9 31.6 30.6 31.6 35.3 32.2 27.9 31.0 31.0 30.1 31.0 30.5 35.1 35.1 32.1 33.3 33.5 35.3 30.7 31.8 29.8 29.9 33.4 33.6 32.1 33.9 33.0 34.4 30.6 34.4 35.6 33.8 33.9 33.3 31.6 27.5 31.2 33.5 33.6 34.0 30.9 32.7 34.3 31.7 35.5 30.8 32.0 31.6 30.5 31.8 33.5 36.1 33.3 25.8 36.0 31.6 38.5 27.8 30.6 33.7 32.2 35.2 31.6 27.0 30.1 27.0 31.3 33.5 28.3 34.0 36.4 30.2 37.2 36.1 32.5 30.4 24.8 31.0 32.4 35.4 31.0 31.5 34.4 34.8 39.1 35.6 27.7 31.4 30.0 30.5 32.9 37.2 36.4 36.6 33.4 29.6 37.1 34.0 33.7 31.7 32.9 31.2 30.8 30.6 33.8 31.7 29.4 32.1 32.9 34.8 37.3 33.1 36.7 31.4 29.0 30.9 36.8 29.5 32.7 28.6 34.7 31.3 27.5 35.7 28.5 31.4 38.4 27.9 29.4 34.1 25.3 33.4 33.2 34.6 32.4 31.7 31.8 30.9 27.8 31.3 30.3 32.6 35.1 29.8 35.9 28.5 34.9 35.6 35.3 32.1 29.2 37.5 25.6 35.2 31.3 30.5 33.7">
<param name="horiz10Axis" value="24 46 25 5">
<param name="x11VarName" value="Forearm">
<param name="x11Values" value="27.4 28.9 25.2 29.4 27.7 30.6 27.8 29.0 31.1 30.0 29.4 30.2 28.6 31.6 30.5 26.4 30.8 31.6 30.5 30.1 30.3 32.8 25.9 26.7 28.0 28.2 27.0 26.6 27.9 26.7 27.7 26.4 30.0 31.5 31.7 29.8 30.6 30.5 29.0 31.0 32.7 28.7 29.8 31.5 23.1 27.4 26.2 26.8 25.5 25.8 25.8 26.1 26.0 27.4 27.5 30.2 28.3 30.9 28.8 29.6 31.8 29.8 29.9 29.0 31.1 30.1 27.4 27.4 28.1 27.1 27.3 27.3 27.3 25.7 27.0 27.0 29.2 25.7 26.8 28.7 27.2 25.2 29.6 27.3 26.3 27.7 28.0 28.4 29.3 29.6 27.7 28.4 28.2 29.6 27.9 30.8 30.1 27.8 27.5 30.9 31.0 26.2 29.2 30.3 27.2 29.4 28.5 29.6 30.7 26.0 28.2 27.8 31.1 27.6 27.3 26.3 28.0 29.8 29.5 28.6 31.2 29.6 28.0 27.5 29.2 30.2 30.3 28.2 29.6 27.8 26.5 28.4 28.6 29.3 29.8 28.8 28.3 28.4 27.4 29.8 27.9 28.5 27.5 27.2 29.7 28.3 30.3 29.7 25.2 30.4 29.0 33.8 26.3 28.3 29.2 27.7 30.7 28.0 34.9 28.2 26.3 29.2 30.6 26.2 31.2 33.7 28.7 33.1 31.8 29.8 27.4 25.9 28.7 28.4 21.0 26.9 26.6 29.5 30.3 32.5 29.0 24.6 28.3 26.4 28.9 29.3 31.8 30.4 32.4 29.2 27.3 31.2 30.1 29.9 27.1 29.8 27.3 27.8 30.0 28.8 28.4 26.6 28.9 29.2 30.7 23.1 29.5 31.6 27.5 26.2 28.8 31.0 27.9 30.0 26.7 29.1 26.3 25.9 30.4 25.7 29.9 32.0 27.0 26.8 31.1 22.0 29.3 30.0 30.1 29.7 27.3 29.1 29.6 26.1 28.7 26.3 28.5 29.6 28.9 30.5 24.8 30.1 30.7 29.8 29.3 27.3 32.6 25.7 28.6 27.2 29.4 30.0">
<param name="horiz11Axis" value="20 36 20 5">
<param name="x12VarName" value="Wrist">
<param name="x12Values" value="17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 18.5 19.0 17.7 18.8 18.2 16.9 17.3 19.3 18.5 18.2 18.4 19.9 16.7 17.1 17.6 17.7 16.5 17.0 17.2 17.6 18.4 17.9 18.8 18.7 19.7 17.0 19.0 19.4 21.4 18.3 21.4 17.4 18.4 18.8 16.1 18.3 17.3 17.9 16.3 16.8 17.3 17.2 16.9 18.5 18.5 18.9 18.5 19.2 18.2 18.5 20.2 18.3 19.1 18.8 18.4 18.7 17.4 18.7 18.1 17.3 18.6 18.3 18.2 16.9 16.8 18.3 18.1 18.8 18.3 19.0 19.0 17.7 19.0 19.2 18.0 18.2 18.8 18.1 18.8 18.7 17.7 18.8 18.4 19.1 17.8 20.4 18.5 18.2 18.2 18.3 18.6 17.0 18.4 19.7 17.7 18.8 18.1 19.1 19.2 17.3 18.1 17.4 19.8 17.4 17.5 17.3 18.1 19.5 18.5 18.0 19.5 18.4 17.6 17.6 18.0 17.6 17.2 17.4 18.1 17.7 17.6 17.1 17.9 17.3 18.1 17.6 17.1 17.7 17.6 18.7 16.6 17.8 17.9 18.2 18.3 17.3 18.7 18.4 16.9 18.4 17.8 19.6 17.4 17.9 19.4 17.7 19.1 18.6 16.9 18.2 16.5 19.1 19.7 16.5 18.5 19.4 17.7 19.8 18.8 17.4 17.7 16.9 17.7 17.8 20.1 16.9 16.7 18.4 18.1 19.9 19.0 16.5 17.2 17.4 17.7 18.2 20.0 19.1 18.8 18.5 17.9 19.9 18.7 18.5 17.1 18.8 17.4 16.9 18.5 18.8 18.6 17.4 18.7 18.4 17.4 19.4 17.3 18.4 17.7 17.6 17.4 18.9 18.6 19.0 18.0 18.4 17.8 18.6 19.2 17.1 18.9 19.6 17.8 17.0 19.2 15.8 18.8 18.4 18.8 19.0 16.9 19.0 18.0 17.6 18.3 18.3 19.0 18.5 18.3 19.1 16.5 19.4 19.5 19.5 18.5 18.5 18.8 18.5 20.1 18.0 19.8 20.9">
<param name="horiz12Axis" value="15 22 16 2">
<param name="labelAxes" value="true">
<param name="paramDecimals" value="2 3 2 2 2 2 2 2 2 2 2 2 2 2 2">
<param name="biggestParams" value="999.99 999.99">
<param name="extraXPixels" value="20">
<param name="allowLSDisplay" value="false">
</applet> 
</div>

		
    <p>For example, the least squares coefficient of <em>weight</em> in the full
 model, -0.089, is negative but it is positively correlated with <em>body 
      fat</em>. There is no contradiction here:</p>
		<ul>
			<li>Heavier men tend to have <strong>more</strong> body fat.</li>
			<li>Comparing two men with the <strong>same age, height, neck, chest, abdomen, 
				etc</strong>, the heavier man will tend to have <strong>less</strong> 
				body fat. Muscle and bone are heavier than fat, so if the exterior dimensions 
				of the two men are equal, it is reasonable that the heavier man would 
				be expected to have less body fat.</li>
		</ul>
		<p>The value of the coefficient is interpreted as follows:</p>
		<div class="centred"><table width="75%" border="1" cellspacing="0" cellpadding="10" style="background-color:#FFFFFF" class="centred">
			<tr> 
				<td align="center"><strong>Comparing men with the <span class="red">same
 other body measurements</span>, each extra pound in weight is predicted 
					to correspond to a decrease of 0.089 percent body fat.</strong></td>
			</tr>
		</table></div>
		<p>The other coefficients are interpreted in a similar way. For example,</p>
		<div class="centred"><table width="75%" border="1" cellspacing="0" cellpadding="10" style="background-color:#FFFFFF" class="centred">
			<tr> 
				<td align="center"><strong>Comparing men with the <span class="red">same 
					weight and other body measurements</span>, each extra 1cm in abdomen 
					circumference is predicted to correspond to an increase of 0.886 percent 
					body fat.</strong></td>
			</tr>
		</table></div>
		</div>




<h2 class="pageName">9.1.6 &nbsp; Standard errors</h2><!DOCTYPE HTML>


<p class="heading">Model</p>
	<p>Consider data that come from a general linear model,</p>
	<p class="eqn"><img src="../../../en/glm/images/generalMatrixModel.gif" width="91" height="17"></p>
	<p>in which the errors, ε<sub><em>i</em></sub>, 
		are independent and</p>
	<p class=eqn><img src="../../../en/glm/images/errorDistnGlm.gif" width="135" height="21"></p>
	
  <p class="heading">Estimate of error variance</p>
  <p>The general linear model involves a further parameter whose value is unknown 
    and must be estimated &mdash; the error standard deviation, <span class="green">σ</span>. 
    To simplify the formulae, we will estimate its square, the error variance, 
    <span class="green">σ<sup>2</sup></span>.</p>
  <p>The best estimate of <span class="green">σ<sup>2</sup></span>    is the <strong>residual sum of squares</strong>, divided by its <strong>degrees 
    of freedom</strong>, called the <strong>mean residual sum of squares</strong>. 
    Its degrees of freedom are the number of observations, <em>n</em>, minus the 
    number of columns of <strong>X</strong>.</p>
  <p class=eqn><img src="../../../en/glm/images/varianceEst.gif" width="84" height="42"></p>
  <p>Note that <em>p</em> is the number of explanatory variables <strong>plus 
    1</strong> because of the column of 1's in <strong>X</strong>. </p>
	
	<div class="diagram">
<p class="heading">Body fat</p>

		<p>Fitting a general linear model to the body fat data gives the following 
			table of least squares estimates.</p>

<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.EstSeTableApplet.class" archive="coreCAST.jar" width="450" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="yVarName" value="Body fat">
<param name="yValues" value="12.6 6.9 24.6 10.9 27.8 20.6 19.0 12.8 5.1 12.0 7.5 8.5 20.5 20.8 21.7 20.5 28.1 22.4 16.1 16.5 19.0 15.3 15.7 17.6 14.2 4.6 8.5 22.4 4.7 9.4 12.3 6.5 13.4 20.9 31.1 38.2 23.6 27.5 33.8 31.3 33.1 31.7 30.4 30.8 8.4 14.1 11.2 6.4 13.4 5.0 10.7 7.4 8.7 7.1 4.9 22.2 20.1 27.1 30.4 24.0 25.4 28.8 29.6 25.1 31.0 28.9 21.1 14.0 7.1 13.2 23.7 9.4 9.1 13.7 12.0 18.3 9.2 21.7 21.1 18.6 30.2 26.0 18.2 26.2 26.1 25.8 15.0 22.6 8.8 14.3 20.2 18.1 9.2 24.2 9.6 17.3 10.1 11.1 17.7 21.7 20.8 20.1 19.8 21.9 24.7 17.8 19.1 18.2 17.2 21.0 19.5 27.1 21.6 20.9 25.9 16.7 19.8 14.1 25.1 17.9 27.0 24.6 14.8 16.0 14.0 17.4 26.4 17.4 20.4 15.0 18.0 22.2 23.1 25.3 23.8 26.3 21.4 28.4 21.8 20.1 24.3 18.1 22.7 9.9 10.8 14.4 19.0 28.6 6.1 24.5 9.9 19.1 10.6 16.5 20.5 17.2 30.1 10.5 12.8 22.0 9.9 14.8 13.3 15.2 26.5 19.0 21.4 20.0 34.7 16.5 4.1 1.9 20.2 16.8 24.6 10.4 13.4 28.8 22.0 16.8 25.8 0.0 11.9 12.4 17.4 9.2 23.0 20.1 20.2 23.8 11.8 36.5 16.0 24.0 22.3 24.8 21.5 17.6 7.3 22.6 12.5 21.7 27.7 6.8 33.4 16.6 31.7 31.5 10.1 11.3 7.8 26.4 19.3 18.5 19.3 45.1 13.8 8.2 23.9 15.1 12.7 25.3 11.9 6.1 11.3 12.8 14.9 24.5 15.0 16.9 11.1 16.1 15.5 25.9 25.5 18.4 24.0 26.4 12.7 28.8 17.0 33.6 29.3 31.4 28.1 15.3 29.1 11.5 32.3 28.3 25.3 30.7">
<param name="x0VarName" value="weight">
<param name="x0Values" value="154.25 173.25 154.00 184.75 184.25 210.25 181.00 176.00 191.00 198.25 186.25 216.00 180.50 205.25 187.75 162.75 195.75 209.25 183.75 211.75 179.00 200.50 140.25 148.75 151.25 159.25 131.50 148.00 133.25 160.75 182.00 160.25 168.00 218.50 247.25 191.75 202.25 196.75 363.15 203.00 262.75 205.00 217.00 212.00 125.25 164.25 133.50 148.50 135.75 127.50 158.25 139.25 137.25 152.75 136.25 198.00 181.50 201.25 202.50 179.75 216.00 178.75 193.25 178.00 205.50 183.50 151.50 154.75 155.25 156.75 167.50 146.75 160.75 125.00 143.00 148.25 162.50 177.75 161.25 171.25 163.75 150.25 190.25 170.75 168.00 167.00 157.75 160.00 176.75 176.00 177.00 179.75 165.25 192.50 184.25 224.50 188.75 162.50 156.50 197.00 198.50 173.75 172.75 196.75 177.00 165.50 200.25 203.25 194.00 168.50 170.75 183.25 178.25 163.00 175.25 158.00 177.25 179.00 191.00 187.50 206.50 185.25 160.25 151.50 161.00 167.00 177.50 152.25 192.25 165.25 171.75 171.25 197.00 157.00 168.25 186.00 166.75 187.75 168.25 212.75 176.75 173.25 167.00 159.75 188.15 156.00 208.50 206.50 143.75 223.00 152.25 241.75 146.00 156.75 200.25 171.50 205.75 182.50 136.50 177.25 151.25 196.00 184.25 140.00 218.75 217.00 166.25 224.75 228.25 172.75 152.25 125.75 177.25 176.25 226.75 145.25 151.00 241.25 187.25 234.75 219.25 118.50 145.75 159.25 170.50 167.50 232.75 210.50 202.25 185.00 153.00 244.25 193.50 224.75 162.75 180.00 156.25 168.00 167.25 170.75 178.25 150.00 200.50 184.00 223.00 208.75 166.00 195.00 160.50 159.75 140.50 216.25 168.25 194.75 172.75 219.00 149.25 154.50 199.25 154.50 153.25 230.00 161.75 142.25 179.75 126.50 169.50 198.50 174.50 167.75 147.75 182.25 175.50 161.75 157.75 168.75 191.50 219.15 155.25 189.75 127.50 224.50 234.25 227.75 199.50 155.50 215.50 134.25 201.00 186.75 190.75 207.50">
<param name="x1VarName" value="age">
<param name="x1Values" value="23 22 22 26 24 24 26 25 25 23 26 27 32 30 35 35 34 32 28 33 28 28 31 32 28 27 34 31 27 29 32 29 27 41 41 49 40 50 46 50 45 44 48 41 39 43 40 39 45 47 47 40 51 49 42 54 58 62 54 61 62 56 54 61 57 55 54 55 54 55 62 55 56 55 61 61 57 69 81 66 67 64 64 70 72 67 72 64 46 48 46 44 47 46 47 53 38 50 46 47 49 48 41 49 43 43 43 52 43 40 43 43 47 42 48 40 48 51 40 44 52 44 40 47 50 46 42 43 40 42 49 40 47 50 41 44 39 43 40 49 40 40 52 23 23 24 24 25 25 26 26 26 27 27 27 28 28 28 30 31 31 33 33 34 34 35 35 35 35 35 35 35 35 36 36 37 37 37 38 39 39 40 40 40 40 40 41 41 41 41 41 42 42 42 42 42 42 42 42 43 43 43 43 44 44 44 44 47 47 47 49 49 49 50 50 51 51 51 52 53 54 54 54 55 55 55 55 55 56 56 57 57 58 58 60 62 62 63 64 65 65 65 66 67 67 68 69 70 72 72 72 74">
<param name="x2VarName" value="height">
<param name="x2Values" value="67.75 72.25 66.25 72.25 71.25 74.75 69.75 72.50 74.00 73.50 74.50 76.00 69.50 71.25 69.50 66.00 71.00 71.00 67.75 73.50 68.00 69.75 68.25 70.00 67.75 71.50 67.50 67.50 64.75 69.00 73.75 71.25 71.25 71.00 73.50 65.00 70.00 68.25 72.25 67.00 68.75 69.50 70.00 71.50 68.00 73.25 67.50 71.25 68.50 66.75 72.25 69.00 67.75 73.50 67.50 72.00 68.00 69.50 70.75 65.75 73.25 68.50 70.25 67.00 70.00 67.50 70.75 71.50 69.25 71.50 71.50 68.75 73.75 64.00 65.75 67.50 69.50 68.50 70.25 69.25 67.75 67.25 72.75 70.00 69.25 67.50 67.25 65.75 72.50 73.00 70.00 69.50 70.50 71.75 74.50 77.75 73.25 66.50 68.25 72.00 73.50 72.00 71.25 73.75 69.25 68.50 73.50 74.25 75.50 69.25 68.50 70.00 70.00 70.25 71.75 69.25 72.75 72.00 74.00 72.25 74.50 71.50 68.75 66.75 66.50 67.00 68.75 67.75 73.25 69.75 71.50 70.50 73.25 66.75 69.50 69.75 70.75 74.00 71.25 75.00 71.00 69.50 67.75 72.25 77.50 70.75 72.75 69.75 72.50 70.25 69.00 74.50 72.25 67.25 73.50 75.25 69.00 72.25 68.75 71.50 72.25 73.00 68.75 70.50 72.00 73.75 68.00 72.25 69.50 69.50 67.75 65.50 71.00 71.50 71.75 69.25 67.00 71.50 69.25 74.50 74.25 68.00 67.25 69.75 74.25 71.50 74.25 72.00 72.50 68.25 69.25 76.00 70.50 74.75 72.75 68.25 69.00 71.50 72.75 67.50 70.25 69.25 71.50 74.00 69.75 73.00 65.50 72.50 70.25 70.75 68.00 74.50 71.75 70.75 73.00 64.00 69.75 70.00 71.75 69.25 70.50 72.25 67.50 67.25 68.75 66.75 68.25 74.25 69.50 68.50 65.75 71.75 71.50 67.25 67.50 67.50 72.25 69.50 69.50 65.75 65.75 68.25 72.00 72.75 68.50 69.25 70.50 67.00 69.75 66.00 70.50 70.00">
<param name="x3VarName" value="neck">
<param name="x3Values" value="36.2 38.5 34.0 37.4 34.4 39.0 36.4 37.8 38.1 42.1 38.5 39.4 38.4 39.4 40.5 36.4 38.9 42.1 38.0 40.0 39.1 41.3 33.9 35.5 34.5 35.7 36.2 38.8 36.4 36.7 38.7 37.3 38.1 39.8 42.1 38.4 38.5 42.1 51.2 40.2 43.2 36.6 37.3 41.5 31.5 35.7 33.6 34.6 32.8 34.0 34.9 34.3 36.5 35.1 37.8 39.9 39.1 40.5 40.5 38.4 41.4 35.6 38.0 37.4 40.1 40.9 35.6 36.9 37.5 36.3 35.5 38.7 36.4 33.2 36.5 36.0 38.7 38.7 37.8 37.4 38.4 38.1 39.3 38.7 38.5 36.5 37.7 36.5 38.0 36.7 37.2 39.2 37.5 38.0 37.3 41.1 37.5 38.7 35.9 40.0 40.1 37.0 36.3 40.7 39.6 31.1 38.6 42.0 38.5 34.2 37.2 37.1 40.2 35.3 38.0 36.3 36.8 41.0 38.3 38.0 40.8 39.5 36.9 36.9 37.7 36.6 38.9 37.5 39.8 38.3 35.5 36.3 37.8 37.8 36.5 37.8 37.0 37.7 34.3 40.8 37.4 36.5 37.5 35.5 38.0 35.7 39.2 40.9 35.2 40.6 35.4 41.8 34.1 37.9 38.2 35.6 38.5 37.0 35.9 36.2 35.0 38.5 40.7 36.0 39.5 40.5 38.5 43.9 40.4 37.6 37.0 34.0 38.4 38.7 41.5 36.0 35.3 42.1 38.0 42.8 40.0 33.8 35.5 35.3 37.7 39.4 41.9 38.5 40.8 38.0 36.4 41.8 40.7 38.5 35.4 38.5 35.5 36.5 37.6 37.4 37.8 35.2 37.9 37.9 40.9 41.9 39.1 40.2 36.0 34.5 35.8 40.2 38.3 39.0 37.4 41.2 34.8 36.9 39.4 37.6 38.5 42.5 37.4 35.2 41.1 33.4 37.2 38.3 38.1 37.4 35.2 39.4 38.0 35.1 40.4 38.3 40.6 40.2 37.9 40.8 34.7 38.8 41.4 41.3 40.7 36.3 40.8 34.9 40.9 38.9 38.9 40.8">
<param name="x4VarName" value="chest">
<param name="x4Values" value="93.1 93.6 95.8 101.8 97.3 104.5 105.1 99.6 100.9 99.6 101.5 103.6 102.0 104.1 101.3 99.1 101.9 107.6 106.8 106.2 103.3 111.4 86.0 86.7 90.2 89.6 88.6 97.4 93.5 97.4 100.5 93.5 93.0 111.7 117.0 118.5 106.5 105.6 136.2 114.8 128.3 106.0 113.3 106.6 85.1 96.6 88.2 89.8 92.3 83.4 90.2 89.2 89.7 93.3 87.6 107.6 100.0 111.5 115.4 104.8 112.3 102.9 107.6 105.3 105.3 103.0 90.0 95.4 89.3 94.4 97.6 88.5 93.6 87.7 93.4 91.6 91.6 102.0 96.4 102.7 97.7 97.1 103.1 101.8 101.4 98.9 97.5 104.3 97.3 96.7 99.7 101.9 97.2 106.6 99.6 113.2 99.1 99.4 95.1 107.5 106.5 99.1 96.7 103.5 104.0 93.1 105.2 110.0 110.1 97.8 96.3 108.0 99.7 93.5 100.7 97.0 96.0 99.2 95.4 101.8 104.3 99.2 99.3 94.0 98.9 101.0 98.7 95.9 103.9 96.2 97.8 94.6 103.6 100.4 98.4 104.6 92.9 97.8 98.3 104.7 98.6 99.5 102.7 92.1 96.6 92.7 102.0 110.9 92.3 114.1 92.9 108.3 88.5 94.0 101.1 92.1 105.6 98.5 88.7 101.1 94.0 103.8 98.9 89.2 111.4 107.5 99.1 108.2 114.9 99.1 92.2 90.8 100.5 98.2 115.3 96.8 92.6 119.2 102.7 109.5 108.5 79.3 95.5 92.3 98.9 89.5 117.5 107.4 109.2 103.4 91.4 115.2 104.9 106.7 92.2 101.6 97.8 92.0 94.0 103.7 102.7 91.1 107.2 100.8 121.6 105.6 100.6 102.7 99.8 92.9 91.2 115.6 98.3 103.7 98.7 119.8 92.8 93.3 106.8 93.9 99.0 119.9 94.2 92.7 106.9 88.8 101.7 105.3 104.0 98.6 99.6 103.4 100.2 94.9 97.2 104.7 104.0 117.6 95.8 106.4 93.0 119.6 119.7 115.8 118.3 97.4 113.7 89.2 108.5 111.1 108.3 112.4">
<param name="x5VarName" value="abdomen">
<param name="x5Values" value="85.2 83.0 87.9 86.4 100.0 94.4 90.7 88.5 82.5 88.6 83.6 90.9 91.6 101.8 96.4 92.8 96.4 97.5 89.6 100.5 95.9 98.8 76.4 80.0 76.3 79.7 74.6 88.7 73.9 83.5 88.7 84.5 79.1 100.5 115.6 113.1 100.9 98.8 148.1 108.1 126.2 104.3 111.2 104.3 76.0 81.5 73.7 79.5 83.4 70.4 86.7 77.9 82.0 79.6 77.6 100.0 99.8 104.2 105.3 98.3 104.8 94.7 102.4 99.7 105.5 100.3 83.9 86.6 78.4 84.6 91.5 82.8 82.9 76.0 83.3 81.8 78.8 95.0 95.4 98.6 95.8 89.0 97.8 94.9 99.8 89.7 88.1 90.9 86.0 86.5 95.6 93.2 83.1 97.5 88.8 99.2 91.6 86.7 88.2 94.0 95.0 92.0 89.2 95.5 98.6 87.3 102.8 101.6 88.7 92.3 90.6 105.0 95.0 89.6 92.4 86.6 90.0 90.0 92.4 87.5 99.2 98.1 83.3 86.1 84.1 89.9 92.1 78.0 93.5 87.0 90.1 90.3 99.8 89.4 87.2 101.1 86.1 98.6 88.5 106.6 93.1 93.0 91.0 77.1 85.3 81.9 99.1 100.5 76.5 106.8 77.6 102.9 72.8 88.2 100.1 83.5 105.0 90.8 76.6 92.4 81.2 95.6 92.1 83.4 106.0 95.1 90.4 100.4 115.9 90.8 81.9 75.0 90.3 90.3 108.8 79.4 83.2 110.3 92.7 104.5 104.6 69.4 83.6 86.8 90.4 83.7 109.3 98.9 98.0 101.2 80.6 113.7 94.1 105.7 85.6 96.6 86.0 89.7 78.0 89.7 89.2 85.7 103.1 89.1 113.9 96.3 93.9 101.3 83.9 84.4 79.4 104.0 89.7 97.6 87.6 122.1 81.1 81.5 100.0 88.7 91.8 110.4 87.6 82.8 95.3 78.2 91.1 96.7 89.4 93.0 86.4 96.7 88.1 94.9 93.3 95.6 98.2 113.8 82.8 100.5 79.7 118.0 109.0 113.4 106.1 84.3 107.6 83.6 105.0 111.5 101.3 108.5">
<param name="x6VarName" value="hip">
<param name="x6Values" value="94.5 98.7 99.2 101.2 101.9 107.8 100.3 97.1 99.9 104.1 98.2 107.7 103.9 108.6 100.1 99.2 105.2 107.0 102.4 109.0 104.9 104.8 94.6 93.4 95.8 96.5 85.3 94.7 88.5 98.7 99.8 100.6 94.5 108.3 116.1 113.8 106.2 104.8 147.7 102.5 125.6 115.5 114.1 106.0 88.2 97.2 88.5 92.7 90.4 87.2 98.3 91.0 89.1 91.6 88.6 99.6 102.5 105.8 97.0 99.6 103.1 100.8 99.4 99.7 108.3 104.2 93.9 91.8 96.1 94.3 98.5 95.5 96.3 88.6 93.0 94.8 94.3 98.3 99.3 100.2 97.1 96.9 99.6 95.0 96.2 96.2 96.9 93.8 99.3 98.3 102.2 100.6 95.4 100.6 101.4 107.5 102.4 96.2 92.8 103.7 101.7 98.3 98.3 101.6 99.5 96.6 103.6 100.7 102.1 100.6 99.3 103.0 98.6 99.8 97.5 92.6 99.7 96.4 104.3 101.0 104.1 101.4 97.5 95.2 94.0 100.0 98.5 93.2 99.5 97.8 95.8 99.1 103.2 92.3 98.4 102.1 95.6 100.6 98.3 107.7 101.6 99.3 98.9 93.9 102.5 95.3 110.1 106.2 92.1 113.9 93.5 114.4 91.1 95.2 105.0 98.3 106.4 102.5 89.8 99.3 91.5 105.1 103.5 89.6 108.8 104.5 95.6 106.8 111.9 98.1 92.8 89.2 98.7 99.9 114.4 89.2 96.4 113.9 101.9 109.9 109.8 85.0 91.6 96.1 95.5 98.1 108.8 104.1 101.8 103.1 92.3 112.4 102.7 111.8 96.5 100.6 96.2 101.0 99.0 94.2 99.2 96.9 105.5 102.6 107.1 102.0 100.1 101.7 91.8 94.0 89.0 109.0 99.1 104.2 96.1 112.8 96.3 94.4 105.0 94.5 96.2 105.5 95.6 91.9 98.2 87.5 97.1 106.6 98.4 97.0 90.1 100.7 97.8 100.2 94.0 93.7 101.1 111.8 94.5 100.5 87.6 114.3 109.1 109.8 101.6 94.4 110.0 88.8 104.5 101.7 97.8 107.1">
<param name="x7VarName" value="thigh">
<param name="x7Values" value="59.0 58.7 59.6 60.1 63.2 66.0 58.4 60.0 62.9 63.1 59.7 66.2 63.4 66.0 69.0 63.1 64.8 66.9 64.2 65.8 63.5 63.4 57.4 54.9 58.4 55.0 51.7 57.5 50.1 58.9 57.5 58.5 57.3 67.1 71.2 61.9 63.5 66.0 87.3 61.3 72.5 70.6 67.7 65.0 50.0 58.4 53.3 52.7 52.0 50.6 52.6 51.4 49.3 52.6 51.9 57.2 62.1 61.8 59.1 60.6 61.6 60.9 61.0 60.8 65.0 64.8 55.0 54.3 56.0 51.2 56.6 58.9 52.9 50.9 55.5 54.5 56.7 55.0 53.5 56.5 54.8 54.8 58.9 56.0 56.3 54.7 57.2 57.8 61.0 60.4 58.3 58.9 56.9 58.9 57.4 61.7 60.6 62.1 54.7 62.7 59.0 59.3 60.0 59.1 59.5 54.7 61.2 55.8 57.5 57.5 61.9 63.7 62.3 61.5 59.3 55.9 58.8 56.8 64.6 58.5 58.5 57.1 60.5 58.1 58.5 60.7 60.7 53.5 61.7 57.4 57.0 60.3 61.2 56.1 56.0 58.9 58.8 63.6 58.1 66.5 59.1 60.4 57.1 56.1 59.1 56.4 71.2 68.4 51.9 67.6 56.9 72.9 53.6 56.8 62.1 57.3 68.6 60.8 50.1 59.4 52.5 61.4 64.0 52.4 63.8 64.8 55.5 63.3 74.4 60.1 54.7 50.0 57.8 59.2 69.2 50.3 60.0 69.8 64.7 69.5 68.1 47.2 54.1 58.0 55.4 57.3 67.7 63.5 62.8 61.5 54.3 68.5 60.6 65.3 60.2 61.1 57.7 62.3 57.5 58.5 60.2 55.5 68.8 60.6 63.5 63.3 58.9 60.7 53.0 56.0 51.1 63.7 56.3 60.0 57.1 62.5 53.8 54.7 63.9 53.7 57.7 64.2 59.7 54.4 57.4 50.8 56.6 64.0 58.4 55.4 53.0 59.3 57.1 56.8 54.3 54.4 59.3 63.4 61.2 59.2 50.7 61.3 63.7 65.6 58.2 54.3 63.3 49.6 59.6 60.3 56.0 59.3">
<param name="x8VarName" value="knee">
<param name="x8Values" value="37.3 37.3 38.9 37.3 42.2 42.0 38.3 39.4 38.3 41.7 39.7 39.2 38.3 41.5 39.0 38.7 40.8 40.0 38.7 40.6 38.0 40.6 35.3 36.2 35.5 36.7 34.7 36.0 34.5 35.3 38.7 38.8 36.2 44.2 43.3 38.3 39.9 41.5 49.1 41.1 39.6 42.5 40.9 40.2 34.7 38.2 34.5 37.5 35.8 34.4 37.2 34.9 33.7 37.6 34.9 38.0 39.6 39.8 38.0 37.7 40.9 38.0 39.4 40.1 41.2 40.2 36.1 35.4 37.4 37.4 38.6 37.6 37.5 35.4 35.2 37.0 39.7 38.3 37.5 39.3 38.2 38.0 39.0 36.5 36.6 37.8 37.7 39.5 38.4 39.9 38.2 39.7 38.3 40.5 39.6 42.3 39.4 39.3 37.3 39.0 39.4 38.4 38.4 39.8 36.1 39.0 39.3 38.7 40.0 36.8 38.0 40.0 38.1 37.8 38.1 36.3 38.4 38.8 41.1 39.2 39.3 40.5 38.7 36.5 36.6 36.0 36.8 35.8 39.0 36.9 38.7 38.5 38.1 35.6 36.9 37.9 36.1 39.2 38.4 42.5 39.6 38.2 36.7 36.1 37.6 36.5 43.5 40.8 35.7 42.7 35.9 43.5 36.8 37.4 40.0 37.8 40.0 38.5 34.8 39.0 36.6 40.6 37.3 35.6 42.0 41.3 34.2 41.7 40.6 39.1 36.2 34.8 37.3 37.7 42.4 34.8 38.1 42.6 39.5 43.1 42.8 33.5 36.2 39.4 38.9 39.7 41.3 39.8 41.3 40.4 36.3 45.0 38.6 43.3 38.9 38.4 38.6 38.0 40.0 39.0 39.2 35.7 38.3 39.0 40.3 39.8 37.6 39.4 36.2 38.2 35.0 40.3 38.8 40.9 38.1 36.9 36.5 39.0 39.2 36.2 38.1 42.7 40.2 35.2 37.1 33.0 38.5 42.6 37.4 38.8 35.0 38.6 38.9 35.9 35.7 37.1 40.3 41.1 39.1 38.1 33.4 42.1 42.4 46.0 38.8 37.5 44.0 34.8 40.8 37.3 41.6 42.2">
<param name="x9VarName" value="ankle">
<param name="x9Values" value="21.9 23.4 24.0 22.8 24.0 25.6 22.9 23.2 23.8 25.0 25.2 25.9 21.5 23.7 23.1 21.7 23.1 24.4 22.9 24.0 22.1 24.6 22.2 22.1 22.9 22.5 21.4 21.0 21.3 22.6 33.9 21.5 24.5 25.2 26.3 21.9 22.6 24.7 29.6 24.7 26.6 23.7 25.0 23.0 21.0 23.4 22.5 21.9 20.6 21.9 22.4 21.0 21.4 22.6 22.5 22.0 22.5 22.7 22.5 22.9 23.1 22.1 23.6 22.7 24.7 22.7 21.7 21.5 22.4 21.6 22.4 21.6 23.1 19.1 20.9 21.4 24.2 21.8 21.5 22.7 23.7 22.0 23.0 24.1 22.0 33.7 21.8 23.3 23.8 24.4 22.5 23.1 22.1 24.5 24.6 23.2 22.9 23.3 21.9 22.3 22.3 22.4 23.2 25.4 22.0 24.8 23.5 23.4 24.8 22.8 22.3 23.6 23.9 21.9 21.8 22.1 22.8 23.3 24.8 24.5 24.6 23.2 22.6 22.1 23.5 21.9 22.2 20.8 21.8 22.2 23.2 23.0 22.6 20.5 23.0 22.7 22.4 23.8 22.5 24.5 21.6 22.0 22.3 22.7 23.2 22.0 25.2 24.6 22.0 24.7 20.4 25.1 23.8 22.8 24.9 21.7 25.2 25.0 21.8 24.6 21.0 25.0 23.5 20.4 23.4 25.6 21.9 24.6 24.0 23.4 22.1 22.0 22.4 21.5 24.0 22.2 22.0 24.8 24.7 25.8 24.1 20.2 21.8 22.7 22.4 22.6 24.7 23.5 24.8 22.9 21.8 25.5 24.7 26.0 22.4 24.1 24.0 22.3 22.5 24.1 23.8 22.0 23.7 24.0 21.8 24.1 21.4 23.3 22.5 22.6 21.7 23.2 23.0 25.5 21.8 23.6 21.5 22.6 22.9 22.0 23.9 27.0 23.4 22.5 21.8 19.7 22.6 23.4 22.5 23.2 21.3 22.8 23.6 21.0 21.0 22.7 23.0 22.3 22.3 24.0 20.1 23.4 24.6 25.4 24.1 22.6 22.6 21.5 23.2 21.5 22.7 24.6">
<param name="x10VarName" value="biceps">
<param name="x10Values" value="32.0 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 32.8 37.2 32.5 36.9 36.1 31.1 36.2 38.2 37.2 37.1 32.5 33.0 27.9 29.8 31.1 29.9 28.7 29.2 30.5 30.1 32.5 30.1 29.0 37.5 37.3 32.0 35.1 33.2 45.0 34.1 36.4 33.6 36.7 35.8 26.1 29.7 27.9 28.8 28.8 26.8 26.0 26.7 29.6 38.5 27.7 35.9 33.1 37.7 31.6 34.5 36.2 32.5 32.7 33.6 35.3 34.8 29.6 32.8 32.6 27.3 31.5 30.3 29.7 29.3 29.4 29.3 30.2 30.8 31.4 30.3 29.4 29.9 34.3 31.2 29.7 32.4 32.6 29.2 30.2 28.8 29.1 31.4 30.1 33.3 30.3 32.9 31.6 30.6 31.6 35.3 32.2 27.9 31.0 31.0 30.1 31.0 30.5 35.1 35.1 32.1 33.3 33.5 35.3 30.7 31.8 29.8 29.9 33.4 33.6 32.1 33.9 33.0 34.4 30.6 34.4 35.6 33.8 33.9 33.3 31.6 27.5 31.2 33.5 33.6 34.0 30.9 32.7 34.3 31.7 35.5 30.8 32.0 31.6 30.5 31.8 33.5 36.1 33.3 25.8 36.0 31.6 38.5 27.8 30.6 33.7 32.2 35.2 31.6 27.0 30.1 27.0 31.3 33.5 28.3 34.0 36.4 30.2 37.2 36.1 32.5 30.4 24.8 31.0 32.4 35.4 31.0 31.5 34.4 34.8 39.1 35.6 27.7 31.4 30.0 30.5 32.9 37.2 36.4 36.6 33.4 29.6 37.1 34.0 33.7 31.7 32.9 31.2 30.8 30.6 33.8 31.7 29.4 32.1 32.9 34.8 37.3 33.1 36.7 31.4 29.0 30.9 36.8 29.5 32.7 28.6 34.7 31.3 27.5 35.7 28.5 31.4 38.4 27.9 29.4 34.1 25.3 33.4 33.2 34.6 32.4 31.7 31.8 30.9 27.8 31.3 30.3 32.6 35.1 29.8 35.9 28.5 34.9 35.6 35.3 32.1 29.2 37.5 25.6 35.2 31.3 30.5 33.7">
<param name="x11VarName" value="forearm">
<param name="x11Values" value="27.4 28.9 25.2 29.4 27.7 30.6 27.8 29.0 31.1 30.0 29.4 30.2 28.6 31.6 30.5 26.4 30.8 31.6 30.5 30.1 30.3 32.8 25.9 26.7 28.0 28.2 27.0 26.6 27.9 26.7 27.7 26.4 30.0 31.5 31.7 29.8 30.6 30.5 29.0 31.0 32.7 28.7 29.8 31.5 23.1 27.4 26.2 26.8 25.5 25.8 25.8 26.1 26.0 27.4 27.5 30.2 28.3 30.9 28.8 29.6 31.8 29.8 29.9 29.0 31.1 30.1 27.4 27.4 28.1 27.1 27.3 27.3 27.3 25.7 27.0 27.0 29.2 25.7 26.8 28.7 27.2 25.2 29.6 27.3 26.3 27.7 28.0 28.4 29.3 29.6 27.7 28.4 28.2 29.6 27.9 30.8 30.1 27.8 27.5 30.9 31.0 26.2 29.2 30.3 27.2 29.4 28.5 29.6 30.7 26.0 28.2 27.8 31.1 27.6 27.3 26.3 28.0 29.8 29.5 28.6 31.2 29.6 28.0 27.5 29.2 30.2 30.3 28.2 29.6 27.8 26.5 28.4 28.6 29.3 29.8 28.8 28.3 28.4 27.4 29.8 27.9 28.5 27.5 27.2 29.7 28.3 30.3 29.7 25.2 30.4 29.0 33.8 26.3 28.3 29.2 27.7 30.7 28.0 34.9 28.2 26.3 29.2 30.6 26.2 31.2 33.7 28.7 33.1 31.8 29.8 27.4 25.9 28.7 28.4 21.0 26.9 26.6 29.5 30.3 32.5 29.0 24.6 28.3 26.4 28.9 29.3 31.8 30.4 32.4 29.2 27.3 31.2 30.1 29.9 27.1 29.8 27.3 27.8 30.0 28.8 28.4 26.6 28.9 29.2 30.7 23.1 29.5 31.6 27.5 26.2 28.8 31.0 27.9 30.0 26.7 29.1 26.3 25.9 30.4 25.7 29.9 32.0 27.0 26.8 31.1 22.0 29.3 30.0 30.1 29.7 27.3 29.1 29.6 26.1 28.7 26.3 28.5 29.6 28.9 30.5 24.8 30.1 30.7 29.8 29.3 27.3 32.6 25.7 28.6 27.2 29.4 30.0">
<param name="x12VarName" value="wrist">
<param name="x12Values" value="17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 18.5 19.0 17.7 18.8 18.2 16.9 17.3 19.3 18.5 18.2 18.4 19.9 16.7 17.1 17.6 17.7 16.5 17.0 17.2 17.6 18.4 17.9 18.8 18.7 19.7 17.0 19.0 19.4 21.4 18.3 21.4 17.4 18.4 18.8 16.1 18.3 17.3 17.9 16.3 16.8 17.3 17.2 16.9 18.5 18.5 18.9 18.5 19.2 18.2 18.5 20.2 18.3 19.1 18.8 18.4 18.7 17.4 18.7 18.1 17.3 18.6 18.3 18.2 16.9 16.8 18.3 18.1 18.8 18.3 19.0 19.0 17.7 19.0 19.2 18.0 18.2 18.8 18.1 18.8 18.7 17.7 18.8 18.4 19.1 17.8 20.4 18.5 18.2 18.2 18.3 18.6 17.0 18.4 19.7 17.7 18.8 18.1 19.1 19.2 17.3 18.1 17.4 19.8 17.4 17.5 17.3 18.1 19.5 18.5 18.0 19.5 18.4 17.6 17.6 18.0 17.6 17.2 17.4 18.1 17.7 17.6 17.1 17.9 17.3 18.1 17.6 17.1 17.7 17.6 18.7 16.6 17.8 17.9 18.2 18.3 17.3 18.7 18.4 16.9 18.4 17.8 19.6 17.4 17.9 19.4 17.7 19.1 18.6 16.9 18.2 16.5 19.1 19.7 16.5 18.5 19.4 17.7 19.8 18.8 17.4 17.7 16.9 17.7 17.8 20.1 16.9 16.7 18.4 18.1 19.9 19.0 16.5 17.2 17.4 17.7 18.2 20.0 19.1 18.8 18.5 17.9 19.9 18.7 18.5 17.1 18.8 17.4 16.9 18.5 18.8 18.6 17.4 18.7 18.4 17.4 19.4 17.3 18.4 17.7 17.6 17.4 18.9 18.6 19.0 18.0 18.4 17.8 18.6 19.2 17.1 18.9 19.6 17.8 17.0 19.2 15.8 18.8 18.4 18.8 19.0 16.9 19.0 18.0 17.6 18.3 18.3 19.0 18.5 18.3 19.1 16.5 19.4 19.5 19.5 18.5 18.5 18.8 18.5 20.1 18.0 19.8 20.9">
<param name="maxParam" value="-99.99 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999">
<param name="maxTableEntries" value="-99.999 9.999 99.99 999.9">
<param name="maxSsq" value="99999.9 999 99.99 9.9999">
<param name="customText" value="Show std errors=Show std errors#param=param#se=se">
</applet> 
</div>

		<p>The diagram shows the sum of squared residuals from the model and its degrees 
			of freedom (<em>n</em>&nbsp;=&nbsp;252 observations minus <em>p</em>&nbsp;=&nbsp;14 
			estimated parameters in <em><span class="bold red">b</span> </em>). 
			The estimate of the error standard deviation is also given &mdash; it is about 
			4.0 percent body fat.</p>
		
<div class="centred"><div class="boxed">
<p style="text-align:left">When estimating a man's percentage body fat from the 13 
	recorded variables, there is an <strong>unavoidable 
	and unpredictable normal error</strong> with standard deviation about 
	4.0 percent body fat.</p>
<p style="text-align:left">There is about 95% probability that the error will be within 
	8 percent body fat.</p>
</div></div>

		
    <br>
  </div>
	
  <p class="heading">Standard errors of least squares estimates</p>
  <p>As in other situations where a parameter is estimated, it is important to 
    give standard errors for the least squares estimates, <em>b</em><sub>0</sub>, 
    <em>b</em><sub>1</sub>, 
    ..., of the model parameters. These are needed in order to find confidence 
    intervals for the individual slope parameters and for hypothesis tests about 
    their values.</p>
  <p>We will give formulae for these standard errors below, but in practice a 
    computer can be relied on to evaluate them.</p>
	
	<div class="diagram">
<p class="heading">Body fat</p>

		
    <p>The computer can obtain standard errors for the parameters of the body 
      fat model. Click the checkbox <strong>Show std errors</strong> in the table 
      above to see the standard errors of the least squares estimates. </p>
		
<div class="centred"><div class="boxed">
<p>These standard errors describe the accuracy 
          of the least squares estimates.</p>
</div></div>

		<br>
	</div>
	
  <p class="heading">Formula for variances of least squares estimates (optional)</p>
	<p>The matrix below gives the <strong>variance-covariance matrix</strong> of 
		the least squares estimates.</p>
	<p class=eqn><img src="../../../en/glm/images/lseVar.gif" width="157" height="23"></p>
  <p>The diagonal elements of this matrix are the variances of the individual 
    parameter estimates. </p>
  <p class=eqn><img src="../../../en/glm/images/lseVar2.gif" width="268" height="115"></p>
  <p>(The off-diagonal elements of this matrix are related to the correlations 
		between pairs of parameter estimates &mdash; they are often correlated &mdash; but we 
		will not use them here.)</p>
  <p class="heading">Standard errors of least squares estimates (optional)</p>
  <p>This formula involves the unknown error variance, <span class="green">σ<sup>2</sup></span>. 
    Replacing it with the mean residual sum of squares, we can obtain a numerical 
    estimate of the variance-covariance matrix,</p>
  <p class=eqn><img src="../../../en/glm/images/varianceEst2.gif" width="159" height="23"></p>
  <p>The standard deviations of the least squares coefficients (i.e. their standard 
    errors when we think of them as estimates of the elements of <img src="../../../en/glm/images/redBoldBeta.gif" width="8" height="14" align="absmiddle">) 
    are the square roots of the diagonal elements of this matrix.</p>
	
<div class="centred"><div class="boxed">
<p>You will not need to use these matrix formulae 
				yourself &mdash; computer software will find the values for you.</p>
</div></div>

	<p>It is however important to recognise that:</p>
	
<div class="centred"><div class="boxed">
<p>Parameter estimates and their standard errors 
				can be expressed with the same simple matrix formulae <strong>for 
				all general linear models</strong>.</p>
</div></div>

	<br>




<h2 class="pageName">9.1.7 &nbsp; Inference for general linear models</h2><!DOCTYPE HTML>


<p class="heading">Confidence intervals</p>
  <p>We showed on the previous page how the standard error for each least squares 
		coefficient can be found. It is easy to translate these estimates and standard 
		errors into 95% confidence intervals.</p>
	<p class=eqn><img src="../../../en/glm/images/paramCI.gif" width="146" height="23"></p>
	<p>The t-value is looked up with the same number of degrees of freedom as the 
		residual sum of squares &mdash; the number of observations, <em>n</em>, minus the 
		number of parameter in <img src="../../../en/glm/images/redBoldBeta.gif" width="8" height="14" align="absmiddle">, 
		<em>p</em>. </p>
	
<div class="centred"><div class="boxed">
<p>If the degrees of freedom are high, the 95% CI 
				is approx<br>
				<em>b<sub>i</sub></em> &nbsp; ± &nbsp; 2 se(<em>b<sub>i</sub></em>)</p>
</div></div>

	<p class="heading">Hypothesis tests for single parameters</p>
	<p>In a similar way, we can perform a hypothesis test for whether individual 
		parameters in the model are zero.</p>
	<p class=eqn><img src="../../../en/glm/images/paramHypoth.gif" width="83" height="46"></p>
	
<div class="centred"><div class="boxed">
<p>The test asks whether the corresponding explanatory 
				variable can be dropped from the full model.</p>
</div></div>

	<p>The test statistic is found by standardising the estimate,</p>
	<p class=eqn><img src="../../../en/glm/images/paramTest.gif" width="78" height="41"></p>
	<p>The p-value is the probability of getting a test statistic this far from 
		zero. It is found from the tail area of the t distribution with (<em>n</em>&nbsp;-&nbsp;<em>p</em>) 
		degrees of freedom.</p>
	<p>The p-values are interpreted in the usual way as the strength of evidence 
		against the null hypothesis.</p>
	<p class="heading"><span class="red">Warning</span></p>
	<p>Each of these tests only assesses whether you can drop a single explanatory 
		variable from the <strong>full</strong> model. After dropping one variable 
		from the full model, the p-values for the other variables will change and 
		they may no longer be unimportant.</p>
	
<div class="centred"><div class="boxed">
<p>If several explanatory variables have high p-values, 
				this does <strong>not</strong> give evidence that you can 
				<strong>simultaneously</strong> drop all variables from the 
				model.</p>
</div></div>

	<p>When the explanatory variables are correlated with each other (multicollinearity), 
		they may be in some way hold the same information about variability in the 
		response &mdash; dropping any one variable may not matter since the others hold 
		the same information, but you should not drop all of them.</p>
	<p>This effect was <a href="javascript:showNamedPage('multicollin5')">described 
		more fully for linear models with two explanatory variables</a>. </p>

<div class="diagram">
		<p class="heading">Body fat</p>
		<p>The table below shows the least squares estimates and their standard deviations 
			for the body fat data. Since the residual sum of squares has over 200 degrees 
			of freedom, 95% confidence intervals for the individual parameters are approximately 
			(estimate&nbsp;±&nbsp;2&nbsp;s.e.) and are not displayed in the table.</p>
		<p>The table does show the t-statistics for testing whether the individual 
			parameters are zero, and the corresponding p-values.</p>
		<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.TestRemoveTableApplet.class" archive="coreCAST.jar" width="550" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="yVarName" value="Body fat">
<param name="yValues" value="12.6 6.9 24.6 10.9 27.8 20.6 19.0 12.8 5.1 12.0 7.5 8.5 20.5 20.8 21.7 20.5 28.1 22.4 16.1 16.5 19.0 15.3 15.7 17.6 14.2 4.6 8.5 22.4 4.7 9.4 12.3 6.5 13.4 20.9 31.1 38.2 23.6 27.5 33.8 31.3 33.1 31.7 30.4 30.8 8.4 14.1 11.2 6.4 13.4 5.0 10.7 7.4 8.7 7.1 4.9 22.2 20.1 27.1 30.4 24.0 25.4 28.8 29.6 25.1 31.0 28.9 21.1 14.0 7.1 13.2 23.7 9.4 9.1 13.7 12.0 18.3 9.2 21.7 21.1 18.6 30.2 26.0 18.2 26.2 26.1 25.8 15.0 22.6 8.8 14.3 20.2 18.1 9.2 24.2 9.6 17.3 10.1 11.1 17.7 21.7 20.8 20.1 19.8 21.9 24.7 17.8 19.1 18.2 17.2 21.0 19.5 27.1 21.6 20.9 25.9 16.7 19.8 14.1 25.1 17.9 27.0 24.6 14.8 16.0 14.0 17.4 26.4 17.4 20.4 15.0 18.0 22.2 23.1 25.3 23.8 26.3 21.4 28.4 21.8 20.1 24.3 18.1 22.7 9.9 10.8 14.4 19.0 28.6 6.1 24.5 9.9 19.1 10.6 16.5 20.5 17.2 30.1 10.5 12.8 22.0 9.9 14.8 13.3 15.2 26.5 19.0 21.4 20.0 34.7 16.5 4.1 1.9 20.2 16.8 24.6 10.4 13.4 28.8 22.0 16.8 25.8 0.0 11.9 12.4 17.4 9.2 23.0 20.1 20.2 23.8 11.8 36.5 16.0 24.0 22.3 24.8 21.5 17.6 7.3 22.6 12.5 21.7 27.7 6.8 33.4 16.6 31.7 31.5 10.1 11.3 7.8 26.4 19.3 18.5 19.3 45.1 13.8 8.2 23.9 15.1 12.7 25.3 11.9 6.1 11.3 12.8 14.9 24.5 15.0 16.9 11.1 16.1 15.5 25.9 25.5 18.4 24.0 26.4 12.7 28.8 17.0 33.6 29.3 31.4 28.1 15.3 29.1 11.5 32.3 28.3 25.3 30.7">
<param name="x0VarName" value="weight">
<param name="x0Values" value="154.25 173.25 154.00 184.75 184.25 210.25 181.00 176.00 191.00 198.25 186.25 216.00 180.50 205.25 187.75 162.75 195.75 209.25 183.75 211.75 179.00 200.50 140.25 148.75 151.25 159.25 131.50 148.00 133.25 160.75 182.00 160.25 168.00 218.50 247.25 191.75 202.25 196.75 363.15 203.00 262.75 205.00 217.00 212.00 125.25 164.25 133.50 148.50 135.75 127.50 158.25 139.25 137.25 152.75 136.25 198.00 181.50 201.25 202.50 179.75 216.00 178.75 193.25 178.00 205.50 183.50 151.50 154.75 155.25 156.75 167.50 146.75 160.75 125.00 143.00 148.25 162.50 177.75 161.25 171.25 163.75 150.25 190.25 170.75 168.00 167.00 157.75 160.00 176.75 176.00 177.00 179.75 165.25 192.50 184.25 224.50 188.75 162.50 156.50 197.00 198.50 173.75 172.75 196.75 177.00 165.50 200.25 203.25 194.00 168.50 170.75 183.25 178.25 163.00 175.25 158.00 177.25 179.00 191.00 187.50 206.50 185.25 160.25 151.50 161.00 167.00 177.50 152.25 192.25 165.25 171.75 171.25 197.00 157.00 168.25 186.00 166.75 187.75 168.25 212.75 176.75 173.25 167.00 159.75 188.15 156.00 208.50 206.50 143.75 223.00 152.25 241.75 146.00 156.75 200.25 171.50 205.75 182.50 136.50 177.25 151.25 196.00 184.25 140.00 218.75 217.00 166.25 224.75 228.25 172.75 152.25 125.75 177.25 176.25 226.75 145.25 151.00 241.25 187.25 234.75 219.25 118.50 145.75 159.25 170.50 167.50 232.75 210.50 202.25 185.00 153.00 244.25 193.50 224.75 162.75 180.00 156.25 168.00 167.25 170.75 178.25 150.00 200.50 184.00 223.00 208.75 166.00 195.00 160.50 159.75 140.50 216.25 168.25 194.75 172.75 219.00 149.25 154.50 199.25 154.50 153.25 230.00 161.75 142.25 179.75 126.50 169.50 198.50 174.50 167.75 147.75 182.25 175.50 161.75 157.75 168.75 191.50 219.15 155.25 189.75 127.50 224.50 234.25 227.75 199.50 155.50 215.50 134.25 201.00 186.75 190.75 207.50">
<param name="x1VarName" value="age">
<param name="x1Values" value="23 22 22 26 24 24 26 25 25 23 26 27 32 30 35 35 34 32 28 33 28 28 31 32 28 27 34 31 27 29 32 29 27 41 41 49 40 50 46 50 45 44 48 41 39 43 40 39 45 47 47 40 51 49 42 54 58 62 54 61 62 56 54 61 57 55 54 55 54 55 62 55 56 55 61 61 57 69 81 66 67 64 64 70 72 67 72 64 46 48 46 44 47 46 47 53 38 50 46 47 49 48 41 49 43 43 43 52 43 40 43 43 47 42 48 40 48 51 40 44 52 44 40 47 50 46 42 43 40 42 49 40 47 50 41 44 39 43 40 49 40 40 52 23 23 24 24 25 25 26 26 26 27 27 27 28 28 28 30 31 31 33 33 34 34 35 35 35 35 35 35 35 35 36 36 37 37 37 38 39 39 40 40 40 40 40 41 41 41 41 41 42 42 42 42 42 42 42 42 43 43 43 43 44 44 44 44 47 47 47 49 49 49 50 50 51 51 51 52 53 54 54 54 55 55 55 55 55 56 56 57 57 58 58 60 62 62 63 64 65 65 65 66 67 67 68 69 70 72 72 72 74">
<param name="x2VarName" value="height">
<param name="x2Values" value="67.75 72.25 66.25 72.25 71.25 74.75 69.75 72.50 74.00 73.50 74.50 76.00 69.50 71.25 69.50 66.00 71.00 71.00 67.75 73.50 68.00 69.75 68.25 70.00 67.75 71.50 67.50 67.50 64.75 69.00 73.75 71.25 71.25 71.00 73.50 65.00 70.00 68.25 72.25 67.00 68.75 69.50 70.00 71.50 68.00 73.25 67.50 71.25 68.50 66.75 72.25 69.00 67.75 73.50 67.50 72.00 68.00 69.50 70.75 65.75 73.25 68.50 70.25 67.00 70.00 67.50 70.75 71.50 69.25 71.50 71.50 68.75 73.75 64.00 65.75 67.50 69.50 68.50 70.25 69.25 67.75 67.25 72.75 70.00 69.25 67.50 67.25 65.75 72.50 73.00 70.00 69.50 70.50 71.75 74.50 77.75 73.25 66.50 68.25 72.00 73.50 72.00 71.25 73.75 69.25 68.50 73.50 74.25 75.50 69.25 68.50 70.00 70.00 70.25 71.75 69.25 72.75 72.00 74.00 72.25 74.50 71.50 68.75 66.75 66.50 67.00 68.75 67.75 73.25 69.75 71.50 70.50 73.25 66.75 69.50 69.75 70.75 74.00 71.25 75.00 71.00 69.50 67.75 72.25 77.50 70.75 72.75 69.75 72.50 70.25 69.00 74.50 72.25 67.25 73.50 75.25 69.00 72.25 68.75 71.50 72.25 73.00 68.75 70.50 72.00 73.75 68.00 72.25 69.50 69.50 67.75 65.50 71.00 71.50 71.75 69.25 67.00 71.50 69.25 74.50 74.25 68.00 67.25 69.75 74.25 71.50 74.25 72.00 72.50 68.25 69.25 76.00 70.50 74.75 72.75 68.25 69.00 71.50 72.75 67.50 70.25 69.25 71.50 74.00 69.75 73.00 65.50 72.50 70.25 70.75 68.00 74.50 71.75 70.75 73.00 64.00 69.75 70.00 71.75 69.25 70.50 72.25 67.50 67.25 68.75 66.75 68.25 74.25 69.50 68.50 65.75 71.75 71.50 67.25 67.50 67.50 72.25 69.50 69.50 65.75 65.75 68.25 72.00 72.75 68.50 69.25 70.50 67.00 69.75 66.00 70.50 70.00">
<param name="x3VarName" value="neck">
<param name="x3Values" value="36.2 38.5 34.0 37.4 34.4 39.0 36.4 37.8 38.1 42.1 38.5 39.4 38.4 39.4 40.5 36.4 38.9 42.1 38.0 40.0 39.1 41.3 33.9 35.5 34.5 35.7 36.2 38.8 36.4 36.7 38.7 37.3 38.1 39.8 42.1 38.4 38.5 42.1 51.2 40.2 43.2 36.6 37.3 41.5 31.5 35.7 33.6 34.6 32.8 34.0 34.9 34.3 36.5 35.1 37.8 39.9 39.1 40.5 40.5 38.4 41.4 35.6 38.0 37.4 40.1 40.9 35.6 36.9 37.5 36.3 35.5 38.7 36.4 33.2 36.5 36.0 38.7 38.7 37.8 37.4 38.4 38.1 39.3 38.7 38.5 36.5 37.7 36.5 38.0 36.7 37.2 39.2 37.5 38.0 37.3 41.1 37.5 38.7 35.9 40.0 40.1 37.0 36.3 40.7 39.6 31.1 38.6 42.0 38.5 34.2 37.2 37.1 40.2 35.3 38.0 36.3 36.8 41.0 38.3 38.0 40.8 39.5 36.9 36.9 37.7 36.6 38.9 37.5 39.8 38.3 35.5 36.3 37.8 37.8 36.5 37.8 37.0 37.7 34.3 40.8 37.4 36.5 37.5 35.5 38.0 35.7 39.2 40.9 35.2 40.6 35.4 41.8 34.1 37.9 38.2 35.6 38.5 37.0 35.9 36.2 35.0 38.5 40.7 36.0 39.5 40.5 38.5 43.9 40.4 37.6 37.0 34.0 38.4 38.7 41.5 36.0 35.3 42.1 38.0 42.8 40.0 33.8 35.5 35.3 37.7 39.4 41.9 38.5 40.8 38.0 36.4 41.8 40.7 38.5 35.4 38.5 35.5 36.5 37.6 37.4 37.8 35.2 37.9 37.9 40.9 41.9 39.1 40.2 36.0 34.5 35.8 40.2 38.3 39.0 37.4 41.2 34.8 36.9 39.4 37.6 38.5 42.5 37.4 35.2 41.1 33.4 37.2 38.3 38.1 37.4 35.2 39.4 38.0 35.1 40.4 38.3 40.6 40.2 37.9 40.8 34.7 38.8 41.4 41.3 40.7 36.3 40.8 34.9 40.9 38.9 38.9 40.8">
<param name="x4VarName" value="chest">
<param name="x4Values" value="93.1 93.6 95.8 101.8 97.3 104.5 105.1 99.6 100.9 99.6 101.5 103.6 102.0 104.1 101.3 99.1 101.9 107.6 106.8 106.2 103.3 111.4 86.0 86.7 90.2 89.6 88.6 97.4 93.5 97.4 100.5 93.5 93.0 111.7 117.0 118.5 106.5 105.6 136.2 114.8 128.3 106.0 113.3 106.6 85.1 96.6 88.2 89.8 92.3 83.4 90.2 89.2 89.7 93.3 87.6 107.6 100.0 111.5 115.4 104.8 112.3 102.9 107.6 105.3 105.3 103.0 90.0 95.4 89.3 94.4 97.6 88.5 93.6 87.7 93.4 91.6 91.6 102.0 96.4 102.7 97.7 97.1 103.1 101.8 101.4 98.9 97.5 104.3 97.3 96.7 99.7 101.9 97.2 106.6 99.6 113.2 99.1 99.4 95.1 107.5 106.5 99.1 96.7 103.5 104.0 93.1 105.2 110.0 110.1 97.8 96.3 108.0 99.7 93.5 100.7 97.0 96.0 99.2 95.4 101.8 104.3 99.2 99.3 94.0 98.9 101.0 98.7 95.9 103.9 96.2 97.8 94.6 103.6 100.4 98.4 104.6 92.9 97.8 98.3 104.7 98.6 99.5 102.7 92.1 96.6 92.7 102.0 110.9 92.3 114.1 92.9 108.3 88.5 94.0 101.1 92.1 105.6 98.5 88.7 101.1 94.0 103.8 98.9 89.2 111.4 107.5 99.1 108.2 114.9 99.1 92.2 90.8 100.5 98.2 115.3 96.8 92.6 119.2 102.7 109.5 108.5 79.3 95.5 92.3 98.9 89.5 117.5 107.4 109.2 103.4 91.4 115.2 104.9 106.7 92.2 101.6 97.8 92.0 94.0 103.7 102.7 91.1 107.2 100.8 121.6 105.6 100.6 102.7 99.8 92.9 91.2 115.6 98.3 103.7 98.7 119.8 92.8 93.3 106.8 93.9 99.0 119.9 94.2 92.7 106.9 88.8 101.7 105.3 104.0 98.6 99.6 103.4 100.2 94.9 97.2 104.7 104.0 117.6 95.8 106.4 93.0 119.6 119.7 115.8 118.3 97.4 113.7 89.2 108.5 111.1 108.3 112.4">
<param name="x5VarName" value="abdomen">
<param name="x5Values" value="85.2 83.0 87.9 86.4 100.0 94.4 90.7 88.5 82.5 88.6 83.6 90.9 91.6 101.8 96.4 92.8 96.4 97.5 89.6 100.5 95.9 98.8 76.4 80.0 76.3 79.7 74.6 88.7 73.9 83.5 88.7 84.5 79.1 100.5 115.6 113.1 100.9 98.8 148.1 108.1 126.2 104.3 111.2 104.3 76.0 81.5 73.7 79.5 83.4 70.4 86.7 77.9 82.0 79.6 77.6 100.0 99.8 104.2 105.3 98.3 104.8 94.7 102.4 99.7 105.5 100.3 83.9 86.6 78.4 84.6 91.5 82.8 82.9 76.0 83.3 81.8 78.8 95.0 95.4 98.6 95.8 89.0 97.8 94.9 99.8 89.7 88.1 90.9 86.0 86.5 95.6 93.2 83.1 97.5 88.8 99.2 91.6 86.7 88.2 94.0 95.0 92.0 89.2 95.5 98.6 87.3 102.8 101.6 88.7 92.3 90.6 105.0 95.0 89.6 92.4 86.6 90.0 90.0 92.4 87.5 99.2 98.1 83.3 86.1 84.1 89.9 92.1 78.0 93.5 87.0 90.1 90.3 99.8 89.4 87.2 101.1 86.1 98.6 88.5 106.6 93.1 93.0 91.0 77.1 85.3 81.9 99.1 100.5 76.5 106.8 77.6 102.9 72.8 88.2 100.1 83.5 105.0 90.8 76.6 92.4 81.2 95.6 92.1 83.4 106.0 95.1 90.4 100.4 115.9 90.8 81.9 75.0 90.3 90.3 108.8 79.4 83.2 110.3 92.7 104.5 104.6 69.4 83.6 86.8 90.4 83.7 109.3 98.9 98.0 101.2 80.6 113.7 94.1 105.7 85.6 96.6 86.0 89.7 78.0 89.7 89.2 85.7 103.1 89.1 113.9 96.3 93.9 101.3 83.9 84.4 79.4 104.0 89.7 97.6 87.6 122.1 81.1 81.5 100.0 88.7 91.8 110.4 87.6 82.8 95.3 78.2 91.1 96.7 89.4 93.0 86.4 96.7 88.1 94.9 93.3 95.6 98.2 113.8 82.8 100.5 79.7 118.0 109.0 113.4 106.1 84.3 107.6 83.6 105.0 111.5 101.3 108.5">
<param name="x6VarName" value="hip">
<param name="x6Values" value="94.5 98.7 99.2 101.2 101.9 107.8 100.3 97.1 99.9 104.1 98.2 107.7 103.9 108.6 100.1 99.2 105.2 107.0 102.4 109.0 104.9 104.8 94.6 93.4 95.8 96.5 85.3 94.7 88.5 98.7 99.8 100.6 94.5 108.3 116.1 113.8 106.2 104.8 147.7 102.5 125.6 115.5 114.1 106.0 88.2 97.2 88.5 92.7 90.4 87.2 98.3 91.0 89.1 91.6 88.6 99.6 102.5 105.8 97.0 99.6 103.1 100.8 99.4 99.7 108.3 104.2 93.9 91.8 96.1 94.3 98.5 95.5 96.3 88.6 93.0 94.8 94.3 98.3 99.3 100.2 97.1 96.9 99.6 95.0 96.2 96.2 96.9 93.8 99.3 98.3 102.2 100.6 95.4 100.6 101.4 107.5 102.4 96.2 92.8 103.7 101.7 98.3 98.3 101.6 99.5 96.6 103.6 100.7 102.1 100.6 99.3 103.0 98.6 99.8 97.5 92.6 99.7 96.4 104.3 101.0 104.1 101.4 97.5 95.2 94.0 100.0 98.5 93.2 99.5 97.8 95.8 99.1 103.2 92.3 98.4 102.1 95.6 100.6 98.3 107.7 101.6 99.3 98.9 93.9 102.5 95.3 110.1 106.2 92.1 113.9 93.5 114.4 91.1 95.2 105.0 98.3 106.4 102.5 89.8 99.3 91.5 105.1 103.5 89.6 108.8 104.5 95.6 106.8 111.9 98.1 92.8 89.2 98.7 99.9 114.4 89.2 96.4 113.9 101.9 109.9 109.8 85.0 91.6 96.1 95.5 98.1 108.8 104.1 101.8 103.1 92.3 112.4 102.7 111.8 96.5 100.6 96.2 101.0 99.0 94.2 99.2 96.9 105.5 102.6 107.1 102.0 100.1 101.7 91.8 94.0 89.0 109.0 99.1 104.2 96.1 112.8 96.3 94.4 105.0 94.5 96.2 105.5 95.6 91.9 98.2 87.5 97.1 106.6 98.4 97.0 90.1 100.7 97.8 100.2 94.0 93.7 101.1 111.8 94.5 100.5 87.6 114.3 109.1 109.8 101.6 94.4 110.0 88.8 104.5 101.7 97.8 107.1">
<param name="x7VarName" value="thigh">
<param name="x7Values" value="59.0 58.7 59.6 60.1 63.2 66.0 58.4 60.0 62.9 63.1 59.7 66.2 63.4 66.0 69.0 63.1 64.8 66.9 64.2 65.8 63.5 63.4 57.4 54.9 58.4 55.0 51.7 57.5 50.1 58.9 57.5 58.5 57.3 67.1 71.2 61.9 63.5 66.0 87.3 61.3 72.5 70.6 67.7 65.0 50.0 58.4 53.3 52.7 52.0 50.6 52.6 51.4 49.3 52.6 51.9 57.2 62.1 61.8 59.1 60.6 61.6 60.9 61.0 60.8 65.0 64.8 55.0 54.3 56.0 51.2 56.6 58.9 52.9 50.9 55.5 54.5 56.7 55.0 53.5 56.5 54.8 54.8 58.9 56.0 56.3 54.7 57.2 57.8 61.0 60.4 58.3 58.9 56.9 58.9 57.4 61.7 60.6 62.1 54.7 62.7 59.0 59.3 60.0 59.1 59.5 54.7 61.2 55.8 57.5 57.5 61.9 63.7 62.3 61.5 59.3 55.9 58.8 56.8 64.6 58.5 58.5 57.1 60.5 58.1 58.5 60.7 60.7 53.5 61.7 57.4 57.0 60.3 61.2 56.1 56.0 58.9 58.8 63.6 58.1 66.5 59.1 60.4 57.1 56.1 59.1 56.4 71.2 68.4 51.9 67.6 56.9 72.9 53.6 56.8 62.1 57.3 68.6 60.8 50.1 59.4 52.5 61.4 64.0 52.4 63.8 64.8 55.5 63.3 74.4 60.1 54.7 50.0 57.8 59.2 69.2 50.3 60.0 69.8 64.7 69.5 68.1 47.2 54.1 58.0 55.4 57.3 67.7 63.5 62.8 61.5 54.3 68.5 60.6 65.3 60.2 61.1 57.7 62.3 57.5 58.5 60.2 55.5 68.8 60.6 63.5 63.3 58.9 60.7 53.0 56.0 51.1 63.7 56.3 60.0 57.1 62.5 53.8 54.7 63.9 53.7 57.7 64.2 59.7 54.4 57.4 50.8 56.6 64.0 58.4 55.4 53.0 59.3 57.1 56.8 54.3 54.4 59.3 63.4 61.2 59.2 50.7 61.3 63.7 65.6 58.2 54.3 63.3 49.6 59.6 60.3 56.0 59.3">
<param name="x8VarName" value="knee">
<param name="x8Values" value="37.3 37.3 38.9 37.3 42.2 42.0 38.3 39.4 38.3 41.7 39.7 39.2 38.3 41.5 39.0 38.7 40.8 40.0 38.7 40.6 38.0 40.6 35.3 36.2 35.5 36.7 34.7 36.0 34.5 35.3 38.7 38.8 36.2 44.2 43.3 38.3 39.9 41.5 49.1 41.1 39.6 42.5 40.9 40.2 34.7 38.2 34.5 37.5 35.8 34.4 37.2 34.9 33.7 37.6 34.9 38.0 39.6 39.8 38.0 37.7 40.9 38.0 39.4 40.1 41.2 40.2 36.1 35.4 37.4 37.4 38.6 37.6 37.5 35.4 35.2 37.0 39.7 38.3 37.5 39.3 38.2 38.0 39.0 36.5 36.6 37.8 37.7 39.5 38.4 39.9 38.2 39.7 38.3 40.5 39.6 42.3 39.4 39.3 37.3 39.0 39.4 38.4 38.4 39.8 36.1 39.0 39.3 38.7 40.0 36.8 38.0 40.0 38.1 37.8 38.1 36.3 38.4 38.8 41.1 39.2 39.3 40.5 38.7 36.5 36.6 36.0 36.8 35.8 39.0 36.9 38.7 38.5 38.1 35.6 36.9 37.9 36.1 39.2 38.4 42.5 39.6 38.2 36.7 36.1 37.6 36.5 43.5 40.8 35.7 42.7 35.9 43.5 36.8 37.4 40.0 37.8 40.0 38.5 34.8 39.0 36.6 40.6 37.3 35.6 42.0 41.3 34.2 41.7 40.6 39.1 36.2 34.8 37.3 37.7 42.4 34.8 38.1 42.6 39.5 43.1 42.8 33.5 36.2 39.4 38.9 39.7 41.3 39.8 41.3 40.4 36.3 45.0 38.6 43.3 38.9 38.4 38.6 38.0 40.0 39.0 39.2 35.7 38.3 39.0 40.3 39.8 37.6 39.4 36.2 38.2 35.0 40.3 38.8 40.9 38.1 36.9 36.5 39.0 39.2 36.2 38.1 42.7 40.2 35.2 37.1 33.0 38.5 42.6 37.4 38.8 35.0 38.6 38.9 35.9 35.7 37.1 40.3 41.1 39.1 38.1 33.4 42.1 42.4 46.0 38.8 37.5 44.0 34.8 40.8 37.3 41.6 42.2">
<param name="x9VarName" value="ankle">
<param name="x9Values" value="21.9 23.4 24.0 22.8 24.0 25.6 22.9 23.2 23.8 25.0 25.2 25.9 21.5 23.7 23.1 21.7 23.1 24.4 22.9 24.0 22.1 24.6 22.2 22.1 22.9 22.5 21.4 21.0 21.3 22.6 33.9 21.5 24.5 25.2 26.3 21.9 22.6 24.7 29.6 24.7 26.6 23.7 25.0 23.0 21.0 23.4 22.5 21.9 20.6 21.9 22.4 21.0 21.4 22.6 22.5 22.0 22.5 22.7 22.5 22.9 23.1 22.1 23.6 22.7 24.7 22.7 21.7 21.5 22.4 21.6 22.4 21.6 23.1 19.1 20.9 21.4 24.2 21.8 21.5 22.7 23.7 22.0 23.0 24.1 22.0 33.7 21.8 23.3 23.8 24.4 22.5 23.1 22.1 24.5 24.6 23.2 22.9 23.3 21.9 22.3 22.3 22.4 23.2 25.4 22.0 24.8 23.5 23.4 24.8 22.8 22.3 23.6 23.9 21.9 21.8 22.1 22.8 23.3 24.8 24.5 24.6 23.2 22.6 22.1 23.5 21.9 22.2 20.8 21.8 22.2 23.2 23.0 22.6 20.5 23.0 22.7 22.4 23.8 22.5 24.5 21.6 22.0 22.3 22.7 23.2 22.0 25.2 24.6 22.0 24.7 20.4 25.1 23.8 22.8 24.9 21.7 25.2 25.0 21.8 24.6 21.0 25.0 23.5 20.4 23.4 25.6 21.9 24.6 24.0 23.4 22.1 22.0 22.4 21.5 24.0 22.2 22.0 24.8 24.7 25.8 24.1 20.2 21.8 22.7 22.4 22.6 24.7 23.5 24.8 22.9 21.8 25.5 24.7 26.0 22.4 24.1 24.0 22.3 22.5 24.1 23.8 22.0 23.7 24.0 21.8 24.1 21.4 23.3 22.5 22.6 21.7 23.2 23.0 25.5 21.8 23.6 21.5 22.6 22.9 22.0 23.9 27.0 23.4 22.5 21.8 19.7 22.6 23.4 22.5 23.2 21.3 22.8 23.6 21.0 21.0 22.7 23.0 22.3 22.3 24.0 20.1 23.4 24.6 25.4 24.1 22.6 22.6 21.5 23.2 21.5 22.7 24.6">
<param name="x10VarName" value="biceps">
<param name="x10Values" value="32.0 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 32.8 37.2 32.5 36.9 36.1 31.1 36.2 38.2 37.2 37.1 32.5 33.0 27.9 29.8 31.1 29.9 28.7 29.2 30.5 30.1 32.5 30.1 29.0 37.5 37.3 32.0 35.1 33.2 45.0 34.1 36.4 33.6 36.7 35.8 26.1 29.7 27.9 28.8 28.8 26.8 26.0 26.7 29.6 38.5 27.7 35.9 33.1 37.7 31.6 34.5 36.2 32.5 32.7 33.6 35.3 34.8 29.6 32.8 32.6 27.3 31.5 30.3 29.7 29.3 29.4 29.3 30.2 30.8 31.4 30.3 29.4 29.9 34.3 31.2 29.7 32.4 32.6 29.2 30.2 28.8 29.1 31.4 30.1 33.3 30.3 32.9 31.6 30.6 31.6 35.3 32.2 27.9 31.0 31.0 30.1 31.0 30.5 35.1 35.1 32.1 33.3 33.5 35.3 30.7 31.8 29.8 29.9 33.4 33.6 32.1 33.9 33.0 34.4 30.6 34.4 35.6 33.8 33.9 33.3 31.6 27.5 31.2 33.5 33.6 34.0 30.9 32.7 34.3 31.7 35.5 30.8 32.0 31.6 30.5 31.8 33.5 36.1 33.3 25.8 36.0 31.6 38.5 27.8 30.6 33.7 32.2 35.2 31.6 27.0 30.1 27.0 31.3 33.5 28.3 34.0 36.4 30.2 37.2 36.1 32.5 30.4 24.8 31.0 32.4 35.4 31.0 31.5 34.4 34.8 39.1 35.6 27.7 31.4 30.0 30.5 32.9 37.2 36.4 36.6 33.4 29.6 37.1 34.0 33.7 31.7 32.9 31.2 30.8 30.6 33.8 31.7 29.4 32.1 32.9 34.8 37.3 33.1 36.7 31.4 29.0 30.9 36.8 29.5 32.7 28.6 34.7 31.3 27.5 35.7 28.5 31.4 38.4 27.9 29.4 34.1 25.3 33.4 33.2 34.6 32.4 31.7 31.8 30.9 27.8 31.3 30.3 32.6 35.1 29.8 35.9 28.5 34.9 35.6 35.3 32.1 29.2 37.5 25.6 35.2 31.3 30.5 33.7">
<param name="x11VarName" value="forearm">
<param name="x11Values" value="27.4 28.9 25.2 29.4 27.7 30.6 27.8 29.0 31.1 30.0 29.4 30.2 28.6 31.6 30.5 26.4 30.8 31.6 30.5 30.1 30.3 32.8 25.9 26.7 28.0 28.2 27.0 26.6 27.9 26.7 27.7 26.4 30.0 31.5 31.7 29.8 30.6 30.5 29.0 31.0 32.7 28.7 29.8 31.5 23.1 27.4 26.2 26.8 25.5 25.8 25.8 26.1 26.0 27.4 27.5 30.2 28.3 30.9 28.8 29.6 31.8 29.8 29.9 29.0 31.1 30.1 27.4 27.4 28.1 27.1 27.3 27.3 27.3 25.7 27.0 27.0 29.2 25.7 26.8 28.7 27.2 25.2 29.6 27.3 26.3 27.7 28.0 28.4 29.3 29.6 27.7 28.4 28.2 29.6 27.9 30.8 30.1 27.8 27.5 30.9 31.0 26.2 29.2 30.3 27.2 29.4 28.5 29.6 30.7 26.0 28.2 27.8 31.1 27.6 27.3 26.3 28.0 29.8 29.5 28.6 31.2 29.6 28.0 27.5 29.2 30.2 30.3 28.2 29.6 27.8 26.5 28.4 28.6 29.3 29.8 28.8 28.3 28.4 27.4 29.8 27.9 28.5 27.5 27.2 29.7 28.3 30.3 29.7 25.2 30.4 29.0 33.8 26.3 28.3 29.2 27.7 30.7 28.0 34.9 28.2 26.3 29.2 30.6 26.2 31.2 33.7 28.7 33.1 31.8 29.8 27.4 25.9 28.7 28.4 21.0 26.9 26.6 29.5 30.3 32.5 29.0 24.6 28.3 26.4 28.9 29.3 31.8 30.4 32.4 29.2 27.3 31.2 30.1 29.9 27.1 29.8 27.3 27.8 30.0 28.8 28.4 26.6 28.9 29.2 30.7 23.1 29.5 31.6 27.5 26.2 28.8 31.0 27.9 30.0 26.7 29.1 26.3 25.9 30.4 25.7 29.9 32.0 27.0 26.8 31.1 22.0 29.3 30.0 30.1 29.7 27.3 29.1 29.6 26.1 28.7 26.3 28.5 29.6 28.9 30.5 24.8 30.1 30.7 29.8 29.3 27.3 32.6 25.7 28.6 27.2 29.4 30.0">
<param name="x12VarName" value="wrist">
<param name="x12Values" value="17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 18.5 19.0 17.7 18.8 18.2 16.9 17.3 19.3 18.5 18.2 18.4 19.9 16.7 17.1 17.6 17.7 16.5 17.0 17.2 17.6 18.4 17.9 18.8 18.7 19.7 17.0 19.0 19.4 21.4 18.3 21.4 17.4 18.4 18.8 16.1 18.3 17.3 17.9 16.3 16.8 17.3 17.2 16.9 18.5 18.5 18.9 18.5 19.2 18.2 18.5 20.2 18.3 19.1 18.8 18.4 18.7 17.4 18.7 18.1 17.3 18.6 18.3 18.2 16.9 16.8 18.3 18.1 18.8 18.3 19.0 19.0 17.7 19.0 19.2 18.0 18.2 18.8 18.1 18.8 18.7 17.7 18.8 18.4 19.1 17.8 20.4 18.5 18.2 18.2 18.3 18.6 17.0 18.4 19.7 17.7 18.8 18.1 19.1 19.2 17.3 18.1 17.4 19.8 17.4 17.5 17.3 18.1 19.5 18.5 18.0 19.5 18.4 17.6 17.6 18.0 17.6 17.2 17.4 18.1 17.7 17.6 17.1 17.9 17.3 18.1 17.6 17.1 17.7 17.6 18.7 16.6 17.8 17.9 18.2 18.3 17.3 18.7 18.4 16.9 18.4 17.8 19.6 17.4 17.9 19.4 17.7 19.1 18.6 16.9 18.2 16.5 19.1 19.7 16.5 18.5 19.4 17.7 19.8 18.8 17.4 17.7 16.9 17.7 17.8 20.1 16.9 16.7 18.4 18.1 19.9 19.0 16.5 17.2 17.4 17.7 18.2 20.0 19.1 18.8 18.5 17.9 19.9 18.7 18.5 17.1 18.8 17.4 16.9 18.5 18.8 18.6 17.4 18.7 18.4 17.4 19.4 17.3 18.4 17.7 17.6 17.4 18.9 18.6 19.0 18.0 18.4 17.8 18.6 19.2 17.1 18.9 19.6 17.8 17.0 19.2 15.8 18.8 18.4 18.8 19.0 16.9 19.0 18.0 17.6 18.3 18.3 19.0 18.5 18.3 19.1 16.5 19.4 19.5 19.5 18.5 18.5 18.8 18.5 20.1 18.0 19.8 20.9">
<param name="maxParam" value="-99.99 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999 -99.999">
<param name="maxTableEntries" value="-99.999 9.999 99.99 999.9">
<param name="maxSsq" value="99999.9 999 99.99 9.9999">
<param name="showVIF" value="false">
<param name="customText" value="Remove all variables=Remove all variables#Add all variables=Add all variables#param=param#se=se">
</applet> 
</div>

		<p>Several p-values are higher than 0.1, giving evidence that these variables 
			could be dropped from the full model. However this does <strong>not</strong> 
			mean that we could drop all such variables simultaneously.</p>
		
<div class="centred"><div class="boxed">
<p>Only <em>abdomen</em> is highly significant 
					in the full model &mdash; all other variables have p-values of 0.01 or higher.</p>
</div></div>

		<p>The diagram has a checkbox for each explanatory variable, allowing it to 
			be dropped from the model. The p-value for <em>knee</em> is highest, so 
			click its checkbox to remove it from the model. Observe that the other p-values 
			change.</p>
		<p>Continue deleting variables with the highest p-values until all remaining 
			variables have p-values below 0.05. Observe that</p>
		
<div class="centred"><div class="boxed">
<p>In the model with only <em>weight</em>, <em>abdomen</em>, 
					<em>forearm</em> and <em>wrist</em>, all variables have p-values under 
					0.01 &mdash; there is very strong evidence that these variables are important 
					in this model.</p>
</div></div>

		<br>
		</div>





<h1 class="sectionName breakBefore">9.2 &nbsp; Nonlinear relationships</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Linear models for curvature</li>
<li>Linearity of quadratic models</li>
<li>Polynomial models</li>
<li>Residual plots to detect nonlinearity</li>
<li>Partial residual plots</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='6'>
<li>Model with quadratic in X, linear in Z</li>
<li>Model with quadratic terms in X and Z</li>
<li>Visualising least squares</li>
<li>Tests for curvature in X and Z</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">9.2.1 &nbsp; Linear models for curvature</h2><!DOCTYPE HTML>


<p class="heading">Linear and nonlinear models</p>
  <p>If there is nonlinearity in the relationship between <em>Y</em> and <em>x</em>, 
		so that the normal linear model with a single explanatory variable,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/simpleLinModel.gif" width="361" height="21"></p>
	<p>does not fit, we might try a model with a transformed explanatory variable 
		or response, such as</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/logModel.gif" width="399" height="21"></p>
	<p>In terms of the response variable <span class="black"><em>y</em>*&nbsp;=&nbsp;log(<em>y</em>)</span>, 
		this is still a 'linear model' &mdash; it describes a linear relationship between 
		<span class="black"><em>y</em>*</span> and <span class="em black">x</span> . 
		The parameters can be estimated and tested in the same way.</p>
	<p>The important characteristic of a simple linear model is <strong>not</strong> 
		that it is linear in the original explanatory variables, but that:</p>
	
<div class="centred"><div class="boxed">
<p>A simple linear model is <strong>linear 
				in the parameters</strong>.</p>
</div></div>

	  
	<p class="heading">Quadratic models</p>
  <p>An alternative way to model curvature in the relationship between <em>Y</em> 
		and <em>x</em> is to add a quadratic term to the model,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/quadModel.gif" width="419" height="23"></p>
	<p>Although this initially seems to be a different type of model from ordinary 
		linear regression models, it can also be written as a linear model with <strong>two</strong> 
		explanatory variables,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/quadModel2.gif" width="285" height="37"></p>
	<p>The model is therefore linear if we treat <em>x</em><sup>2</sup> as a second 
		'explanatory variable'.</p>
	
<div class="centred"><div class="boxed">
<p>The quadratic model is a general linear model because it is 
				<strong>linear in the parameters</strong>.</p>
</div></div>

	<p>The only difference from ordinary linear models with two explanatory variables 
		is that the two explanatory variables are related quadratically. However since 
		we treat the explanatory variables as constants, this does not affect how 
		the model is fitted or used.</p>




<h2 class="pageName">9.2.2 &nbsp; Linearity of quadratic models</h2><!DOCTYPE HTML>


<p class="heading">Quadratic models</p>
  <p>A nonlinear relationship between <em>Y</em> and <em>x</em> can sometimes 
		be modelled by adding a quadratic term to the simple linear model,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/quadModel.gif" width="419" height="23"></p>
	<p>Although the relationship between <em>Y</em> and <em>x</em> is nonlinear,</p>
	
<div class="centred"><div class="boxed">
<p>The quadratic model is also a general linear model because it 
				is <strong>linear in the parameters</strong>.</p>
</div></div>

	<p>We treat the model as a general linear model with <strong>two</strong> explanatory 
		variables,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/quadModel2.gif" width="285" height="37"></p>
	<p>The only difference from ordinary linear models with two explanatory variables 
		is that the two explanatory variables are related quadratically. However since 
		we treat them as constants, this does not affect how the model is fitted or 
		used.</p>
	<div class="diagram">
    <p class="heading">Linear representation of the quadratic model</p>

    <p>The two variables on the left of the diagram below are related nonlinearly. 
			A quadratic curve is drawn on the diagram and its parameters can be adjusted 
			by dragging the three red arrows.</p>
    <div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.DragQuadratic3DApplet.class" archive="coreCAST.jar" width="600" height="420">
<script type="text/javascript">writeAppletParams();</script>
<param name="xVarName" value="x">
<param name="yVarName" value="y">
<param name="xValues" value="1.5 22.5 6.4 8.5 18.9 14.5 37.4 20.6 22.9 7.7 29.9 31.5 35.9 38 7 20 19.5 18.3 37.4 5.4 36.8 27.4 25.7 1.1 9.8 17.1 39.1 32.3 28.7 29.6">
<param name="yValues" value="0.4 3.9 1.8 2.1 5.1 4.2 12.9 4.9 4.1 1.3 10.9 10.4 9.8 10.4 0.5 6.5 2.9 5.8 16.7 1.3 14.8 7.2 8 0.4 3 4.5 17 12.7 6.2 8.2">
<param name="horizAxis" value="0 40 0 10">
<param name="vertAxis" value="0 20 0 5">
<param name="xSqrAxis" value="0 1600 0 500">
<param name="interceptLimits" value="0.0 20.0 5.0">
<param name="slopeLimits" value="-0.50 0.50 0.20">
<param name="curvatureLimits" value="-0.050 0.050 0.000">
<param name="labelAxes" value="true">
<param name="customText" value="squared=squared">
</applet> 
</div>

    <p>The 3-dimensional diagram on the right plots <em>y</em> against <em>x</em> 
			and <em>x</em><sup>2</sup>. Click the <em>x</em><sup>2</sup>-<em>x</em> 
			button to rotate the diagram to see the quadratic relationship between the 
			two 'explanatory variables'.</p>
		<p>Click the <em>y</em>-<em>x</em><sup>2</sup>-<em>x</em> button. The quadratic 
			model corresponds to a plane on the right. Drag the red arrows on the left 
			again and observe that changes to the model alter the position of this plane.</p>
		<p>Now click the <em>y</em>-<em>x</em> button to rotate the 3-dimensional 
			model to show the same scatterplot that is displayed on the left of the 
			diagram and again adjust the quadratic curve.</p>
		
<div class="centred"><div class="boxed">
<p>The linear plane in 3 dimensions corresponds to fitted values 
					that lie on a quadratic curve (the grey line) on the plot of <em>y</em> 
					against <em>x</em>.</p>
</div></div>

		<p>Finally, click the checkbox <strong>Show residuals</strong> and observe 
			that the residuals are the same on both the left and right, then click <strong>Least 
			Squares</strong> to find the least squares parameter estimates.<strong> 
			</strong></p>
		</div>





<h2 class="pageName">9.2.3 &nbsp; Polynomial models</h2><!DOCTYPE HTML>


<p class="heading">Nonlinear regression with polynomials</p>
	<p>We now extend quadratic models with extra terms involving higher powers of 
		<em>x</em>.</p>
	<p class="eqn"><img src="../../../en/nonlinTwo/images/polyModel.gif" width="522" height="22"></p>
	<p>The extra polynomial terms give considerable flexibility in modelling curvature 
		in the relationship between <em>Y</em> and <em>x</em>. Since the parameters 
		again appear linearly, this model is also a general linear model and all general 
		results about GLMs apply to it. </p>
	

<div class="diagram">
		<p class="heading">Cubic model</p>
		<p>The diagram below shows the <strong>X</strong> matrix that corresponds 
			to a cubic model for a single explanatory variable, <em>x</em>.</p>

<div class="centred"> 
<applet codebase="../../../java" code="matrixProg.GenericModelEqnApplet.class" archive="coreCAST.jar" width="450" height="370">
<script type="text/javascript">writeAppletParams();</script>
<param name="xRows" value="12">
<param name="nXColumns" value="3">
<param name="fullNameX1" value="x">
<param name="shortNameX1" value="x">
<param name="fullNameX2" value="x">
<param name="shortNameX2" value="x">
<param name="powerX2" value="x1 2">
<param name="fullNameX3" value="x">
<param name="shortNameX3" value="x">
<param name="powerX3" value="x1 3">
<param name="yName" value="Y">
<param name="errorName" value="error">
</applet> 
</div>

		<p>Click any row to see how the 'linear part' of the model is a cubic in <em>x</em>.</p>
</div>
	<p class="heading">Finding the best degree of polynomials</p>
	<p>When using polynomial models, we are interested in using the lowest possible 
		degree of polynomial &mdash; the lower the degree of polynomial, the smoother the 
		fitted curve tends to become.</p>
	<p>The test for whether the highest-order coefficients of a polynomial model 
		is significantly different from zero can be used to decide whether to use 
		a polynomial with lower degree.</p>
	<p>For models of this type, we are interested in using the lowest possible degree 
		of polynomial, but it makes no sense to have any power of <em>x</em> without 
		all lower powers.</p>
	
<div class="centred"><div class="boxed">
<p>Note that it makes no sense to use a polynomial 
				whose highest-order term is <em>x<sup>p</sup></em> without including all 
				lower powers in the model.</p>
</div></div>

  <p>Do not therefore consider deletion of terms from the polynomial model if 
		a higher-order term is still in the model.</p>
	<p class="heading">Warning</p>
	<p>A polynomial of degree 4 or higher might be found to fit the data best, but 
		you will often find that it behaves in unreasonable ways outside the range 
		of data that were collected. High-degree polynomials should <strong>never</strong> 
		be used for extrapolation.</p>
	
<div class="centred"><div class="boxed">
<p>Some other form of nonlinear function should 
				always be considered before using high-order polynomials.</p>
</div></div>

	<p>For example, consider a nonlinear transformation of either <em>X</em> or 
		<em>Y</em>. </p>
  <div class="diagram">
		<p class="heading">Onion yield</p>
    <p>The data below arose from an experiment in Purnong Landing, South Australia 
			involving production of white Spanish onions. The explanatory variable is 
			the density of planting (plants per square metre) and the response is onion 
			yield (grams per plant).</p>
		
		<div class="centred"> 
<applet codebase="../../../java" code="glmAnovaProg.PolynomialApplet.class" archive="coreCAST.jar" width="550" height="400">
<script type="text/javascript">writeAppletParams();</script>
<param name="yVarName" value="Yield">
<param name="yValues" value="223 234 221 221 197 189 211 191 156 168 197 154 153 142 126 167 144 151 130 125 114 116 120 134 114 91 101 97 101 97 87 81 76 87 84 69 64 66 63 55 62 54">
<param name="xVarName" value="Density">
<param name="xValues" value="23 26 27 32 33 36 37 37 41 42 44 44 51 55 55 57 58 59 60 62 67 70 70 73 73 78 95 96 96 101 103 104 105 108 117 127 134 137 151 163 166 184">
<param name="xCenter" value="100">
<param name="maxSsq" value="99999.99 99 99999.99 999.99">
<param name="polyDegree" value="6">
<param name="xCenteredAxis" value="-100 100 -100 20">
<param name="xAxis" value="0 200 0 20">
<param name="yAxis" value="0 300 0 50">
<param name="customText" value="Polynomial degree=Polynomial degree#Constant=Constant#Linear=Linear#Quadratic=Quadratic#Cubic=Cubic#Power=Power">
</applet> 
</div>

		<p>The diagram initially shows a polynomial of degree 0 fitted by least squares 
			to the data &mdash; simply the sample mean.</p>
		<p>Use the pop-up menu to increase the polynomial degree. As extra polynomial 
			terms are added to the model, the criterion of least squares ensures that 
			the curve becomes closer to the data &mdash; the residual sum of squares reduces.</p>
		
<div class="centred"><div class="boxed">
<p>The polynomial is fairly smooth for all degrees 
					up to 5. However observe that the polynomial of degree 5 has a sharp 
					increase for densities over 180 and would be a poor predictor of yield 
					outside the range of the data (densities of 20 to 180).</p>
</div></div>

	<p class="heading">Traffic fatal crashes in New Zealand</p>
    <p>The next data set gives the number of fatal vehicle crashes in New Zealand 
			per 100,000 population between 1970 and 2005.</p>
		
		<div class="centred"> 
<applet codebase="../../../java" code="glmAnovaProg.PolynomialApplet.class" archive="coreCAST.jar" width="550" height="400">
<script type="text/javascript">writeAppletParams();</script>
<param name="yVarName" value="Fatal crashes per 100,000 popn">
<param name="yValues" value="20.3 20.7 21.0 24.5 19.8 18.3 17.0 19.7 18.6 15.9 16.8 18.3 18.7 17.4 18.6 20.0 19.8 20.6 18.7 19.2 18.7 16.1 15.6 14.7 13.9 13.8 12.3 12.4 11.5 11.4 10.0 10.3 9.3 10.1 9.2 8.3">
<param name="xVarName" value="Year">
<param name="xValues" value="1970 1971 1972 1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003 2004 2005">
<param name="xCenter" value="1990">
<param name="maxSsq" value="999.99 99 999.99 99.99">
<param name="polyDegree" value="7">
<param name="xCenteredAxis" value="-21 20 -20 5">
<param name="xAxis" value="1969 2010 1970 5">
<param name="yAxis" value="5 30 5 5">
<param name="customText" value="Polynomial degree=Polynomial degree#Constant=Constant#Linear=Linear#Quadratic=Quadratic#Cubic=Cubic#Power=Power">
</applet> 
</div>

		<p>Again examine how the shape of the least squares curve changes as the polynomial 
			degree increases.</p>
		
<div class="centred"><div class="boxed">
<p>Several of the polynomials seem reasonable 
					descriptions of the changes in fatal vehicle crashes between 1970 and 
					2005. However none of the polynomials would provide reasonable predictions 
					after 2005.</p>
</div></div>

		<br>

</div>




<h2 class="pageName">9.2.4 &nbsp; Residual plots to detect nonlinearity</h2><!DOCTYPE HTML>


<p class="heading">Examining residuals</p>
	<p>As in regression models with a single explanatory variable, we look for problems 
		in multiple regression models with diagnostics that are based on the residuals 
		and leverages of the observations.</p>
	<p>When there is only one explanatory variable, <em>X</em>, a scatterplot of 
		<em>Y</em> against <em>X</em> usually shows up any problems with the regression 
		model as effectively as a scatterplot of the residuals against <em>X</em>. 
		However with more explanatory variables,</p>
	<ul>
		<li>It is harder to display the raw data &mdash; impossible with more than two 
			explanatory variables.</li>
		<li>A scatterplot of <em>Y</em> against any single explanatory variable can 
			contain a lot of 'noise' due to the effect of other explanatory variables 
			on <em>Y</em>.</li>
	</ul>
	
	<p>The residuals remove the effects of <strong>all</strong> explanatory variable, 
		so plots of residuals against explanatory variables can show information about 
		problems with the model that cannot be seen in plots of the raw data.</p>
	<div class="diagram">
    <p class="heading">Artificial illustration</p>

    <p>The diagram below shows an artificial data set that shows clearly how residual 
			plots can highlight problems that are not easy to see in the raw data.</p>
    <div class="centred"> 
<applet codebase="../../../java" code="residTwoProg.ResidPlotXZApplet.class" archive="coreCAST.jar" width="580" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="yVarName" value="Response, Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="yValues" value="21.095 28.179 19.819 20.970 16.309 26.416 26.106 17.782 17.433 27.369 14.255 18.507 17.566 21.764 23.600 28.329 19.638 12.526 19.386 10.890 16.886 27.742 26.023 18.347 17.390 15.421 7.403 12.318 17.596 8.003 16.699 16.363 21.269 13.662 15.546 18.389 13.054 22.151 18.024 30.142 5.016 17.929 16.461 5.450 29.170 13.279 12.547 31.718 13.795 22.499">
<param name="xValues" value="3.524 4.175 2.861 1.943 2.905 4.691 4.440 3.555 3.118 3.205 2.422 3.243 2.689 3.569 4.601 4.249 3.454 2.242 4.121 2.118 3.724 3.925 3.676 3.471 3.653 2.879 1.940 3.083 2.502 2.143 2.976 2.409 4.587 2.243 2.022 3.274 2.182 2.721 1.506 4.141 1.370 2.358 2.900 1.131 4.891 2.182 2.340 4.337 3.366 4.429">
<param name="zValues" value="6.421 8.465 7.460 9.570 5.451 6.374 6.857 5.406 5.737 9.416 6.082 6.234 7.034 7.030 5.217 8.194 5.975 5.356 4.229 5.672 3.645 8.157 8.549 5.440 4.320 4.946 2.320 1.210 7.099 2.172 5.704 6.979 2.859 6.145 7.305 6.440 5.891 8.399 9.129 8.985 3.525 7.602 5.740 5.680 7.334 6.172 5.394 9.212 2.312 4.787">
<param name="yAxis" value="0 35 0 5">
<param name="xAxis" value="1 5 1 1">
<param name="zAxis" value="1 10 2 2">
<param name="residAxis" value="-3 3 -3 1">
<param name="customText" value="Color crosses=Color crosses">
</applet> 
</div>

    <p>Use the lower pop-up menu to display scatterplots of <em>Y</em> against 
			<em>X</em> and <em>Z</em>. Neither plot gives any clear indication of problems 
			with the fit of the model &mdash; both variables seem to be linearly related 
			to <em>Y</em>.</p>
		<p>Now use the top pop-up menu to display scatterplots of the <strong>residuals</strong> 
			against <em>X</em> and <em>Z</em>.</p>
		
<div class="centred"><div class="boxed">
<p>The scatterplot of residuals against <em>Z</em> clearly shows 
					curvature &mdash; the model should use a nonlinear function of <em>Z</em>.</p>
</div></div>

	  <p>To help understand the difference between the plots of <em>Y</em> and the 
			residuals against <em>Z</em>, display a scatterplot of <em>Y</em> against 
			<em>Z</em> and click the checkbox <strong>Color crosses</strong>.</p>
		<p>The colours of the crosses represent <em>X</em> &mdash; from red for low <em>X</em> 
			to blue for high <em>X</em>.<em> Y</em> is related to <em>X</em> as well 
			as <em>Z</em>, so there the vertical spread of crosses in the plot of <em>Y</em> 
			against <em>Z</em> is mostly determined by <em>X</em>. When changing to 
			a scatterplot of residuals against <em>Z</em>, the effect of <em>X</em> 
			is removed.</p>
		<p>The following example shows the use of residuals for a real data set.</p>
		<p class="heading">Energy expenditure of bees</p>
		<p>In an experiment, an entomologist recorded energy expenditure (joules/sec) 
			for bees drinking water with different sucrose concentrations (%) and at 
			different temperatures. Energy expenditure is the response measurement.</p>
		
<div class="centred"> 
<applet codebase="../../../java" code="residTwoProg.ResidPlotXZApplet.class" archive="coreCAST.jar" width="580" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="yVarName" value="Energy">
<param name="xVarName" value="Temperature (X)">
<param name="zVarName" value="Sucrose (Z)">
<param name="yValues" value="3.1 3.7 4.7 5.5 6.7 7.3 7.9 9.2 9.3 6.0 6.9 7.5 11.5 12.9 13.4 17.5 15.8 14.7 7.7 8.3 9.5 15.7 14.3 15.9 19.1 18.0 19.9">
<param name="xValues" value="9@20 9@30 9@40">
<param name="zValues" value="3@20 3@40 3@60 3@20 3@40 3@60 3@20 3@40 3@60">
<param name="yAxis" value="0 20 0 5">
<param name="xAxis" value="17 43 20 10">
<param name="zAxis" value="15 65 20 20">
<param name="residAxis" value="-3 3 -3 1">
<param name="customText" value="Color crosses=Color crosses">
</applet> 
</div>
		
		<p>Scatterplots of Energy expenditure against Temperature and Sucrose do not 
			show particular curvature, but the residual plots both give some evidence 
			of nonlinearity in the relationship with both explanatory variables.</p>
		</div>





<h2 class="pageName">9.2.5 &nbsp; Partial residual plots</h2><!DOCTYPE HTML>


<p class="heading">'Importance' of the curvature</p>
  <p>Scatterplots of residuals against <em>X</em> and <em>Z</em> are useful ways 
		to detect whether a nonlinear function of <em>X</em> or <em>Z</em> should 
		be used in the regression model. But what transformation of <em>X</em> or 
		<em>Z</em> should be used in the model?</p>
	
<div class="centred"><div class="boxed">
<p>The residual plots do not suggest the nature of the curvature 
				or show its importance, relative to the linear relationship.</p>
</div></div>

	<p>To help show the nature of the curvature for each variable, <strong>partial 
		residual plots</strong> (also called a <strong>component plus residual plot</strong>s) 
		are often used. The partial residual plot for <em>X</em> simply adds the linear 
		function of <em>X</em> back onto the residual before plotting against <em>X</em>.</p>
	<p class=eqn>plot &nbsp; (<em>b<sub>1</sub>x<sub>i</sub></em> + <em>e<sub>i</sub></em>) 
		&nbsp; against <em>&nbsp; x<sub>i</sub></em></p>
	<p>A partial residual plot for <em>Z</em> is similar:</p>
	<p class=eqn>plot &nbsp; (<em>b<sub>2</sub>z<sub>i</sub></em> + <em>e<sub>i</sub></em>) 
		&nbsp; against <em>&nbsp; z<sub>i</sub></em></p>
	
<div class="centred"><div class="boxed">
<p>Note that ordinary residual plots should be used to detect whether 
				there is <strong>any</strong> curvature. Only use partial 
				residual plots <strong>after</strong> you have discovered 
				that there is some curvature.</p>
</div></div>

	<p class="gray">(Using a similar definition for simple linear regression 
		with only a single explanatory variable, <em>X</em>, the partial residual 
		plot would be simply a plot of <em>Y</em> against <em>X</em>.)</p>
	<div class="diagram">
    <p class="heading">Artificial illustration</p>

    <p>The diagram below again shows the artificial data set from the previous 
			page in which the residual plots indicated nonlinearity in the relationship 
			of <em>Y</em> with <em>Z</em>.</p>
    <div class="centred"> 
<applet codebase="../../../java" code="residTwoProg.PartialResidApplet.class" archive="coreCAST.jar" width="550" height="380">
<script type="text/javascript">writeAppletParams();</script>
<param name="yVarName" value="Response, Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="yValues" value="21.095 28.179 19.819 20.970 16.309 26.416 26.106 17.782 17.433 27.369 14.255 18.507 17.566 21.764 23.600 28.329 19.638 12.526 19.386 10.890 16.886 27.742 26.023 18.347 17.390 15.421 7.403 12.318 17.596 8.003 16.699 16.363 21.269 13.662 15.546 18.389 13.054 22.151 18.024 30.142 5.016 17.929 16.461 5.450 29.170 13.279 12.547 31.718 13.795 22.499">
<param name="xValues" value="3.524 4.175 2.861 1.943 2.905 4.691 4.440 3.555 3.118 3.205 2.422 3.243 2.689 3.569 4.601 4.249 3.454 2.242 4.121 2.118 3.724 3.925 3.676 3.471 3.653 2.879 1.940 3.083 2.502 2.143 2.976 2.409 4.587 2.243 2.022 3.274 2.182 2.721 1.506 4.141 1.370 2.358 2.900 1.131 4.891 2.182 2.340 4.337 3.366 4.429">
<param name="zValues" value="6.421 8.465 7.460 9.570 5.451 6.374 6.857 5.406 5.737 9.416 6.082 6.234 7.034 7.030 5.217 8.194 5.975 5.356 4.229 5.672 3.645 8.157 8.549 5.440 4.320 4.946 2.320 1.210 7.099 2.172 5.704 6.979 2.859 6.145 7.305 6.440 5.891 8.399 9.129 8.985 3.525 7.602 5.740 5.680 7.334 6.172 5.394 9.212 2.312 4.787">
<param name="yAxis" value="0 35 0 5">
<param name="xAxis" value="1 5 1 1">
<param name="zAxis" value="1 10.2 2 2">
<param name="residAxis" value="-3 3 -3 1">
<param name="partialResidAxis" value="0 25 0 5">
<param name="customText" value="Color crosses=Color crosses#Rotate to Comp+Resid=Rotate to Comp+Resid#Component plus residual=Component plus residual">
</applet> 
</div>

    <p>Select <strong>Component plus residual</strong> from the pop-up menu on 
			the top to display the partial residual plot for <em>X</em>. This simply 
			adds back the linear trend in <em>X</em>.</p>
		<p>Repeat for the variable <em>Z</em>.</p>
		
<div class="centred"><div class="boxed">
<p>The partial residual plot suggests that the relationship of 
					<em>Y</em> with <em>Z</em> is flatter at low z-values.</p>
</div></div>

	  <p>Display a partial residual plot for <em>Z</em> on the right, then click 
			the y-z rotation button to rotate the 3-dimensional scatterplot to plot 
			<em>Y</em> against <em>Z</em>. Now click <strong>Rotate to Comp+Resid</strong>. 
			The resulting rotation of the 3-dimensional scatterplot removes the linear 
			trend in <em>X</em> and is identical to the partial residual plot on the 
			right.</p>
		</div>





<h2 class="pageName">9.2.6 &nbsp; Model with quadratic in X, linear in Z</h2><!DOCTYPE HTML>


<p class="heading">Explaining curvature with a quadratic term in X</p>
  <p>A quadratic term can be added to a simple linear model to explain curvature. 
		In a similar way, if curvature is apparent in a plot of residuals against 
		<em>X</em> in the multiple regression model,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/xzModel.gif" width="214" height="17"></p>
	<p>then a quadratic term in <em>X</em> can be added to model the curvature,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/xzQuadModel.gif" width="276" height="22"></p>
	<p>This model is also a <a href="javascript:showNamedPage('regnInfTwo1')">general 
		linear model</a> since it is linear in the parameters.</p>
	<p>Note the following properties of this model:</p>
	<ul>
		<li>The slope of the linear relationship of <em>Y</em> with <em>z</em> is 
			the same for any fixed <em>x</em>.</li>
		<li>The slope and curvature of the relationship of <em>Y</em> with <em>x</em> 
			are the same for any fixed <em>z</em>.</li>
	</ul>
	<br>
	<div class="diagram">
<p class="heading">Flexibility of the model</p>

		<p>The diagram below shows an ordinary linear model involving <em>X</em> and 
			<em>Z</em>. It corresponds to a regression plane whose corners can be dragged 
			to position it.</p>
<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.DragQuadXZApplet.class" archive="coreCAST.jar" width="550" height="480">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="20 60 20 10">
<param name="xAxis" value="1 2 1 0.2">
<param name="zAxis" value="1 2 1 0.2">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="initialParams" value="10.0 10.0 10.0 0.0 0.0 0.0 0">
<param name="paramMinMax" value="-100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0">
<param name="shadeCutoff" value="20 40 60">
<param name="quadX" value="check">
<param name="quadZ" value="off">
<param name="customText" value="Quadratic in X=Quadratic in X">
</applet> 
</div>

		<p>Click the checkbox <strong>Quadratic in X</strong> to add a quadratic term 
			in <em>X</em> to the model. An extra red arrow is added to the diagram. 
			Dragging these four arrows adjusts all four parameters of the model, showing 
			its ability to model curvature in <em>X</em>.</p>
		<p class="heading">Interpreting parameters (optional)</p>

		<p>The diagram below initially shows a model without curvature &mdash; the coefficient 
			of <em>x</em><sup>2</sup> is zero.</p>
<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.DragParamsQuadXApplet.class" archive="coreCAST.jar" width="450" height="500">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="0 50 0 10">
<param name="xAxis" value="0 1.0 0 0.2">
<param name="zAxis" value="0 1.0 0 0.2">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="initialParams" value="10.0 10.0 10.0 0.0 0">
<param name="paramMinMax" value="-100.0 100.0 -100.00 100.00 -100.00 100.00 -100.00 100.00">
<param name="customText" value="Zero slopes=Zero slopes">
</applet> 
</div>

		<p>Drag the three red arrows on the left (but <strong>not</strong> the red 
			arrow on the left at this stage). These alter the intercept and two slope 
			parameters of the linear model. As before, the slope parameters describe 
			the increase in <em>Y</em> for a unit increase in <em>x</em> or <em>z</em>. 
		</p>
		<p>Now drag the red arrow on the far right to change the coefficient of <em>x</em><sup>2</sup> 
			&mdash; the curvature in the model. The grey plane describes the model with the 
			same parameters but zero curvature and the wire-frame plane shows the model 
			with curvature. The coefficient of <em>x</em><sup>2</sup> is the difference 
			between the two planes when <em>x</em>&nbsp;=&nbsp;1. </p>
</div>





<h2 class="pageName">9.2.7 &nbsp; Model with quadratic terms in X and Z</h2><!DOCTYPE HTML>


<p class="heading">Curvature in <em>X</em> and <em>Z</em></p>
  <p>The model can be extended further to explain curvature in both <em>X</em> 
		and <em>Z</em> by adding a further quadratic term in <em>z</em>.</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/xzQuadQuadModel.gif" width="335" height="22"></p>
	<p>This model is again a general linear model since its <strong>parameters</strong> 
		appear linearly in the equation.</p>
	<div class="diagram">
<p class="heading">Flexibility of the model</p>

		<p>The diagram below shows the kinds of regression surface that correspond 
			to this class of linear models.</p>
<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.DragQuadXZApplet.class" archive="coreCAST.jar" width="550" height="480">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="20 60 20 10">
<param name="xAxis" value="1 2 1 0.2">
<param name="zAxis" value="1 2 1 0.2">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="initialParams" value="10.0 10.0 10.0 0.0 0.0 0.0 0">
<param name="paramMinMax" value="-100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0">
<param name="shadeCutoff" value="20 40 60">
<param name="quadX" value="check">
<param name="quadZ" value="check">
<param name="customText" value="Quadratic in X=Quadratic in X#Quadratic in Z=Quadratic in Z">
</applet>
</div>

		<p>Drag the red arrows to adjust the parameters.</p>
		<p>Click the checkboxes <strong>Quadratic in X</strong> and <strong>Quadratic 
			in Z</strong> to add quadratic terms in the two explanatory variables to 
			the model, and drag the extra two arrows to investigate the kinds of surface 
			that correspond to this quadratic model.</p>
		</div>





<h2 class="pageName">9.2.8 &nbsp; Visualising least squares</h2><!DOCTYPE HTML>


<p class="heading">Residuals</p>
  <p>For all general linear models, we can find fitted values. For a model with 
		quadratic terms in <em>x</em> and <em>z</em>, the <strong>fitted values</strong> 
		are:</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/fittedValue.gif" width="299" height="23"></p>
	<p>The <strong>residuals</strong> are differences between the observed and fitted 
		values, </p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/residualNonlin.gif" width="87" height="21"></p>
	<p class="heading">Visualising the residuals</p>
	<p>In simpler models with one or two linear terms (but no quadratic terms), 
		we showed that the residuals could be represented as vertical lines from the 
		data points to the least squares line or plane.</p>
	<p>There is a similar representation of the residuals in the quadratic model 
		&mdash; the residuals are vertical lines from the data points to the <strong>quadratic 
		surface</strong> that represents the model.</p>
	<p class="heading">Squared residuals and least squares</p>
	<p>Least squares minimises the sum of squared residuals,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/residSsqNonlin.gif" width="249" height="26"></p>
	<p>If these squared residuals are represented as squares in the 3-dimensional 
		scatterplot, the least squares line results in the smallest possible total 
		area for these squares.</p>

<div class="diagram">
		<p class="heading">Illustration</p>

		<p>The scatterplot below shows a data set of 7 response values and the corresponding 
			values of two explanatory variables.</p>
<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.DragQuadCrossApplet.class" archive="coreCAST.jar" width="550" height="480">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="0 45 0 10">
<param name="xAxis" value="1 2 1 0.2">
<param name="zAxis" value="1 2 1 0.2">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="longYVarName" value="response (Y)">
<param name="longXVarName" value="X">
<param name="longZVarName" value="Z">
<param name="yValues" value="15.31 30.91 22.42  7.23 25.88 20.01 17.77 ">
<param name="xValues" value="1.128 1.940 1.193 1.069 1.825 1.405 1.497">
<param name="zValues" value="1.974 1.110 1.653 1.141 1.920 1.560 1.230">
<param name="initialParams" value="20.0 0.0 0.0 0.0 0.0 0.0 0">
<param name="paramMinMax" value="-100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0">
<param name="shadeCutoff" value="0 25 50">
<param name="quadX" value="on">
<param name="quadZ" value="on">
<param name="maxRSS" value="9999.9">
<param name="customText" value="resid=resid#Don't show=Don't show#Show as lines=Show as lines#Show as squares=Show as squares">
</applet> 
</div>

		<p>Choose <strong>Show as lines</strong> from the pop-up menu to display the 
			residuals &mdash; they are vertical lines from the data points to the regression 
			surface. Rotate the scatterplot a little with the mouse to get a better 
			idea of where the points lie in 3-dimensions, then drag the five red arrows 
			to adjust the parameters of the model, trying to make the residuals small.</p>
		<p>Choose <strong>Show as squares</strong> from the pop-up menu to display 
			each residual as a square. The total area is the residual sum of squares. 
			Try adjusting the parameters again to make the residual sum of squares (the 
			red area) as small as possible.</p>
		
<div class="centred"><div class="boxed">
<p>It is difficult to minimise the residual sum 
					of squares by hand. However a computer can easily perform the matrix 
					calculations to obtain the least squares estimates.</p>
</div></div>

	  <p>Click <strong>Least squares</strong> to show the least squares fit of the 
			model.</p>
		<p class="heading">Leafing-out time of maples</p>

		<p>Are there genetic differences between maple trees that grow in different 
			parts of the USA and Canada? The data set below arose from a study in which 
			batches of seeds were collected from maple trees in different parts of the 
			Eastern USA and Canada. All seeds were germinated in Wooster, Ohio and an 
			index of the <em>leafing-out time</em> of the batches was recorded.</p>
		<p>Regression is used to examine whether the mean <em>leafing-out time</em> 
			depends on the <em>latitude (X</em>° North - 30<em>)</em> and <em>mean 
			July temperature (Z</em>° F - 60<em>)</em> of the place of origin of 
			the batches of seeds. A relationship would prove that there is a genetic 
			difference between seeds from the different locations. <span class="gray">(Note 
			that we have subtracted 30 from each latitude and 60 from each temperature 
			to make the coefficients smaller. The fit of the models is unchanged.)</span></p>

<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.ChooseTermsQuadApplet.class" archive="coreCAST.jar" width="550" height="480">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="10 22 10 2">
<param name="xAxis" value="0 18 0 5">
<param name="zAxis" value="0 23 0 5">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="longYVarName" value="leafing-out time (Y)">
<param name="longXVarName" value="latitude (X)">
<param name="longZVarName" value="temperature (Z)">
<param name="yValues" value="20.5 21.0 18.3 18.6 18.6 19.8 20.6 19.2 19.8 15.8 14.5 18.5 16.7 13.9 14.3 15.2 16.6 18.2 18.3 13.3 20.0 18.1 17.0 15.6 15.7 15.4 15.4 15.8 15.0 15.9 14.0 10.8">
<param name="xValues" value="16.95 15.55 15.00 15.42 14.50 16.37 15.03 13.00 12.80 12.70 12.42 10.75 11.38 10.35 10.80 10.92 10.33 11.58 11.92 10.12 12.75 12.00 12.55 11.50 9.25 7.45 8.33 6.25 5.80 1.38 2.83 0.75">
<param name="zValues" value="6.7 4.3 1.8 5.0 3.5 5.5 7.7 7.9 10.2 11.1 14.4 16.4 15.9 16.4 11.9 14.2 13.0 11.4 9.7 12.6 9.2 8.0 10.0 12.5 16.7 19.5 9.5 14.3 8.9 20.8 21.2 21.0">
<param name="initialParams" value="6.000 0.000 0.000 0.0000 0.0000 0.0000 0">
<param name="paramMinMax" value="5.000 10.000 -9.000 9.000 -9.000 9.000 0.0000 9.0000 -9.0000 9.0000 -9.0000 9.0000">
<param name="shadeCutoff" value="12 17 21">
<param name="quadX" value="on">
<param name="quadZ" value="on">
<param name="initialRotation" value="45 60">
<param name="maxRSS" value="99999.9">
<param name="customText" value="Terms in model=Terms in model#Linear=Linear#Quadratic=Quadratic#resid=resid">
</applet> 
</div>

		<p>Use the checkboxes at the right of the diagram to investigate the fit of 
			different linear and nonlinear models to these data. For each model, the 
			least squares fitted model and corresponding residual sum of squares are 
			displayed.</p>
		<p>Note that adding an extra term always reduces the residual sum of squares 
			&mdash; each extra term gives additional flexibility allowing the surface to 
			get closer to the crosses.</p>
		
<div class="centred"><div class="boxed">
<p>It rarely makes sense to have a quadratic term 
					in <em>x</em> in the model if there is not already a linear term in 
					<em>x</em>, so the diagram does not allow you to remove a linear term 
					without also removing the corresponding quadratic term.</p>
</div></div>

	<br>
</div>





<h2 class="pageName">9.2.9 &nbsp; Tests for curvature in X and Z</h2><!DOCTYPE HTML>


<p class="heading">Hypotheses</p>
  <p>We have described a model that can explain some forms of curvature in the 
		relationship between <em>Y</em> and the two explanatory variables, <em>X</em> 
		and <em>Z</em>,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/xzQuadQuadModel.gif" width="335" height="22"></p>
	<p>This suggests hypothesis tests for curvature, based on whether the coefficients 
		of the two quadratic terms are zero. For example, testing whether there is 
		curvature in <em>X</em> corresponds to the hypotheses,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/quadXHypoth.gif" width="87" height="41"></p>
	<p class="heading">Test for curvature</p>
	<p>As in other general linear models, this can be tested with a t-test based 
		on the ratio of the least squares estimate of the parameter and its standard 
		error,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/quadXt.gif" width="75" height="41"></p>
	<p>(A general formula for the standard error of least squares estimates for 
		the general linear model was given earlier.)</p>
	<p>If there is no curvature, this t-statistic has a t distribution with (<em>n</em>&nbsp;-&nbsp;5) 
		degrees of freedom, so the p-value for the test is the tail area of this distribution.</p>
	
<div class="centred"><div class="boxed">
<p>Most statistical software for fitting linear models gives a 
				table of all parameter estimates, their standard errors, t-ratios and 
				p-values. This table avoids the need to do any calculations by hand.</p>
</div></div>

	<br>
	  <div class="diagram">
		<p class="heading">Energy expenditure of bees</p>

<p>In an experiment, an entomologist recorded energy expenditure (joules/sec) 
for bees drinking water with different sucrose concentrations (%) and at different 
temperatures. Energy expenditure is the response measurement.</p>

<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.QuadParamTestApplet.class" archive="coreCAST.jar" width="550" height="520">
<script type="text/javascript">writeAppletParams();</script>
<param name="dataName" value="Energy expenditure of bees">
<param name="yAxis" value="0 20 0 5">
<param name="xAxis" value="17 43 20 10">
<param name="zAxis" value="15 65 20 20">
<param name="longYVarName" value="energy (y)">
<param name="longXVarName" value="temperature (x)">
<param name="longZVarName" value="sucrose (z)">
<param name="yVarName" value="y">
<param name="xVarName" value="x">
<param name="zVarName" value="z">
<param name="yValues" value="3.1 3.7 4.7 5.5 6.7 7.3 7.9 9.2 9.3 6.0 6.9 7.5 11.5 12.9 13.4 17.5 15.8 14.7 7.7 8.3 9.5 15.7 14.3 15.9 19.1 18.0 19.9">
<param name="xValues" value="9@20 9@30 9@40">
<param name="zValues" value="3@20 3@40 3@60 3@20 3@40 3@60 3@20 3@40 3@60">
<param name="initialParams" value="6.00 0.000 0.000 0.0000 0.0000 0.0000 0">
<param name="paramMinMax" value="-99.99 99.99 0.999 9.999 -9.999 9.999 -9.9999 9.9999 -9.9999 9.9999 0.0000 9.9999">
<param name="shadeCutoff" value="0 10 20">
<param name="paramNames" value="Intercept Temperature Sucrose Temp-squared Sucrose-squared ?">
<param name="maxTableEntries" value="-99.999 9.999 99.99">
<param name="initialRotation" value="45 40">
<param name="customText" value="param=param#se=se">
</applet> 
</div>

		<p>The table under the data shows all parameter estimates and the associated 
			standard errors, t-ratios, and p-values for the model with quadratic terms 
			in both variables. The only two p-values of interest in this table are those 
			associated with the two quadratic terms. From them, we can conclude that:</p>
		<ul>
			<li>There is moderately strong evidence that temperature is <strong>nonlinearly</strong> 
				related to energy expenditure since the p-value is 0.0172. There seems 
				to be a bigger increase in energy expenditure when temperature increases 
				from 20 to 30 degrees than when it increases from 30 to 40 degrees.</li>
			<li>Since the p-value for the quadratic term in sucrose is 0.1023, there 
				is no evidence that the relationship between energy expenditure and sucrose 
				is nonlinear.</li>
		</ul>
		<p> Do <strong>not</strong> try to interpret the p-values associated with 
			the linear terms and the intercept in this table. For example, it makes 
			no sense to test whether the linear coefficient of temperature is zero when 
			there is already a quadratic term in the model. (Remember that the p-values 
			each test whether one coefficient is zero <strong>in the full model with 
			all other terms present</strong>.)</p>
</div>





<h1 class="sectionName breakBefore">9.3 &nbsp; Interaction</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Additivity of effects of X and Z</li>
<li>Interaction between X and Z</li>
<li>Inference for models with interaction</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='4'>
<li>Tranformations and interaction</li>
<li>Example (nonlinearity and interaction)</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">9.3.1 &nbsp; Additivity of effects of X and Z</h2><!DOCTYPE HTML>


<p class="heading">Assumption of additivity</p>
  <p>Both the linear model,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/xzModel.gif" width="214" height="17"></p>
	<p>and the quadratic model</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/xzQuadQuadModel.gif" width="335" height="22"></p>
	<p>are of the general form</p>
	<p class=eqn><img src="../../../en/interact/images/additivity.gif" width="432" height="21"></p>
	<p>In this type of model, the effects of <em>X</em> and <em>Z</em> are <strong>additive</strong> 
		on <em>Y</em>.</p>
	
<div class="centred"><div class="boxed">
<p>In additive models, the expected response is 
				affected in the same way by changes to <em>x</em> whatever the value of 
				<em>z</em>.</p>
</div></div>

	<p>In a similar way, the expected response is affected in the same way by changes 
		to <em>z</em> whatever the value of <em>x</em>. In additive models, we say 
		that there is <strong>no interaction</strong> between the effects of <em>X</em> 
		and <em>Z</em>. (We will describe models <strong>with</strong> interaction 
		in the following page.)</p>
	<p>When additive models are displayed as a surface in 3 dimensions,</p>
	<ul>
		<li>The slope and curvature of the relationship of <em>Y</em> with <em>x</em> 
			are the same for any fixed <em>z</em>.</li>
		<li>The slope and curvature of the relationship of <em>Y</em> with <em>z</em> 
			are the same for any fixed <em>x</em>.</li>
	</ul>
	<br>
	<div class="diagram">
<p class="heading">Model that is linear in <em>X</em> and <em>Z</em></p>
		<p>The following model only has linear terms in <em>X</em> and <em>Z</em>.</p>

<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.DragQuadGridApplet.class" archive="coreCAST.jar" width="550" height="500">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="20 60 20 10">
<param name="xAxis" value="1 2 1 0.2">
<param name="zAxis" value="1 2 1 0.2">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="initialParams" value="3.0 16.0 10.0 0.0 0.0 0.0 0">
<param name="paramMinMax" value="-100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0">
<param name="quadX" value="off">
<param name="quadZ" value="off">
</applet> 
</div>

		<p>Click the <strong>y-z</strong> rotation button and observe that all lines 
			are parallel. At every <em>x</em>-value, the relationship is linear between 
			<em>Y</em> and <em>z</em> with the same slope. The coefficient of <em>x</em> 
			in the model gives the effect of increasing <em>z</em> by 1, whatever the 
			value of <em>x</em>.</p>
		<p>Now click the <strong>y-x</strong> rotation button and note that the lines 
			are again parallel. Increasing <em>x</em> by 1 has the same effect on <em>Y</em>, 
			whatever the value of <em>z</em>.</p>
		<hr width="75%">
		<p class="heading">Quadratic model</p>
		<p>The following diagram adds quadratic terms in <em>x</em> and <em>z</em>.</p>
<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.DragQuadGridApplet.class" archive="coreCAST.jar" width="550" height="500">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="20 60 20 10">
<param name="xAxis" value="1 2 1 0.2">
<param name="zAxis" value="1 2 1 0.2">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="initialParams" value="40.0 102.1 -127.0 -30.7 45.7 0.0 0">
<param name="paramMinMax" value="-100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0">
<param name="quadX" value="on">
<param name="quadZ" value="on">
</applet> 
</div>

		<p>Again click the <strong>y-z</strong> and <strong>y-x</strong> buttons and 
			observe that:</p>
		
<div class="centred"><div class="boxed">
<p>The quadratic curves are 'parallel' &mdash; they 
					have the same curvatures and slopes.</p>
</div></div>

		<p>The parallel curves are a consequence of the additivity of the effects 
			of <em>X</em> and <em>Z</em> in the two models.</p>
	</div>




<h2 class="pageName">9.3.2 &nbsp; Interaction between X and Z</h2><!DOCTYPE HTML>


<p class="heading">Interaction</p>
  <p>The effects of two explanatory variables are <strong>not</strong> always 
		additive. For example, increasing the amount of nitrogen fertiliser (<em>X</em>) 
		may improve the yield of wheat (<em>Y</em>), but only at high temperatures 
		(<em>Z</em>).</p>
	<p class=eqn><img src="../../../en/interact/images/interactExample.gif" width="280" height="255"></p>
	<p>In the illustrative diagram above, we have only shown data at two values 
		of <em>Z</em> to show clearly that the increase in yield per unit increase 
		in fertiliser (i.e. the slope for <em>X</em>) is greater at high temperatures 
		(high <em>Z</em>) than at low temperatures (low <em>Z</em>).</p>
	<p class="heading">Modelling interaction</p>
	<p>Interaction between the effects of <em>X</em> and <em>Z</em> can take many 
		forms, but a simple model that is often adequate adds a term involving the 
		product of <em>X</em> and <em>Z</em> to the linear model,</p>
	<p class=eqn><img src="../../../en/interact/images/interactModel.gif" width="496" height="21"></p>
	<p>This is again a general linear model since the unknown parameters appear 
		linearly. To help understand the interaction, observe that the model can be 
		rewritten in the form,</p>
	<p class=eqn><img src="../../../en/interact/images/interactModel2.gif" width="310" height="21"></p>
	<p>When considering how the expected response is affected by changes to <em>X</em>, 
		note that its 'slope' is the red term. Since the red term involves <em>Z</em>, 
		the effect of increasing <em>X</em> by 1 depends on <em>Z</em>.</p>
	<div class="diagram">
		<p class="heading">Flexibility of the model</p>

		<p>In the diagram below, the grey plane shows a linear model with no interaction 
			term. The wire-frame surface shows a model with the same coefficients for 
			<em>x</em> and <em>z</em> but also an interaction term.</p>
<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.DragParamsInteractApplet.class" archive="coreCAST.jar" width="450" height="450">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="0 50 0 10">
<param name="xAxis" value="0 1.0 0 0.2">
<param name="zAxis" value="0 1.0 0 0.2">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="initialParams" value="10.0 10.0 10.0 10.0 0">
<param name="paramMinMax" value="-100.0 100.0 -100.00 100.00 -100.00 100.00 -100.00 100.00">
<param name="customText" value="Zero slopes=Zero slopes">
</applet> 
</div>

		<p>Drag the red arrow on the right (at <em>x</em>&nbsp;=&nbsp;<em>z</em>&nbsp;=&nbsp;1) 
			to adjust the coefficient of the interaction term.</p>
		<p>When the coefficient of the interaction term is non-zero, click the <strong>y-x</strong> 
			button and observe that the grid lines are still straight lines, but are 
			no longer parallel. The slope for <em>x</em> is different for different 
			values of <em>z</em>.</p>
		<p>Click the <strong>y-z</strong> button and observe that the grid lines here 
			are also straight but that their slopes depend of <em>x</em>.</p>
</div>





<h2 class="pageName">9.3.3 &nbsp; Inference for models with interaction</h2><!DOCTYPE HTML>


<p class="heading">Least squares estimation</p>
  <p>The model with interaction,</p>
	<p class=eqn><img src="../../../en/interact/images/interactModel.gif" width="496" height="21"></p>
	<p>is a general linear model, so it can be fitted by least squares &mdash; the parameters 
		of the model are chosen to give the smallest possible value for the sum of 
		squared residuals.</p>
	<div class="diagram">
<p class="heading">Energy expenditure of bees</p>
		<p>In an experiment, an entomologist recorded energy expenditure (joules/sec) 
			for bees drinking water with different sucrose concentrations (%) and at 
			different temperatures.</p>

<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.DragQuadCrossApplet.class" archive="coreCAST.jar" width="550" height="450">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="0 20 0 5">
<param name="xAxis" value="17 43 20 10">
<param name="zAxis" value="15 65 20 20">
<param name="yVarName" value="y">
<param name="xVarName" value="x">
<param name="zVarName" value="z">
<param name="longYVarName" value="energy (y)">
<param name="longXVarName" value="temperature (x)">
<param name="longZVarName" value="sucrose (z)">
<param name="yValues" value="3.1 3.7 4.7 5.5 6.7 7.3 7.9 9.2 9.3 6.0 6.9 7.5 11.5 12.9 13.4 17.5 15.8 14.7 7.7 8.3 9.5 15.7 14.3 15.9 19.1 18.0 19.9">
<param name="xValues" value="9@20 9@30 9@40">
<param name="zValues" value="3@20 3@40 3@60 3@20 3@40 3@60 3@20 3@40 3@60">
<param name="initialParams" value="10.0 0.0 0.0 0.0 0.0 0.0 0">
<param name="paramMinMax" value="-100.0 100.0 -100.00 100.00 -100.00 100.00 -100.00 100.00 -100.00 100.00 -100.00 100.00">
<param name="shadeCutoff" value="0 10 20">
<param name="interact" value="check">
<param name="maxRSS" value="99999.9">
<param name="customText" value="resid=resid#Don't show=Don't show#Show as lines=Show as lines#Show as squares=Show as squares#Interaction=Interaction">
</applet> 
</div>

		<p>The diagram initially shows the least squares estimates for the model without 
			interaction. Rotate the diagram to get a feel for the positions of the points 
			in relation to the plane.</p>
		<p>Now click the checkbox <strong>Interaction</strong> and choose <strong>Show 
			as squares</strong> from the pop-up menu. <strong>Drag</strong> the four 
			red arrows to make the sum of squared residuals (red area) as small as possible. 
			Finally, click <strong>Least squares</strong> to see the least squares estimates.</p>
		<p>After clicking <strong>Least squares</strong>, click the <strong>y-x</strong> 
			rotation button. Observe that the fitted model shows that energy expenditure 
			rises more slowly with temperature at low sucrose levels than at high sucrose 
			levels.</p>
		<p>Click the <strong>y-z</strong> rotation button and observe that energy 
			expenditure rises more slowly as sucrose increases at low temperatures than 
			at high temperatures.</p>
		
<div class="centred"><div class="boxed">
<p>Increasing sucrose and temperature together 
					has a particularly high effect on energy expenditure.</p>
</div></div>

		<br>
</div>


  <p class="heading">Testing for interaction</p>
  <p>In the following model, the interaction is modelled by the term involving 
		the product of <em>x</em> and <em>z</em>.</p>
	<p class=eqn><img src="../../../en/interact/images/interactModel.gif" width="496" height="21"></p>
	<p>The test for interaction therefore asks whether the coefficient of this term 
		is zero.</p>
	<p>Since the model is a general linear model, the method that was described 
		earlier for testing the parameters of any GLM can be applied to test whether 
		the parameters of this model are zero. Interaction can therefore be tested 
		with a t-test for the interaction term. As in other t-tests, this is based 
		on a t statistic that divides the parameter estimate by its standard error.</p>
	<div class="diagram">
<p class="heading">Energy expenditure of bees</p>
		<p>We will now test whether the interaction between sucrose and temperature 
			that is apparent in the least squares estimates could have arisen by chance.</p>

<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.QuadParamTestApplet.class" archive="coreCAST.jar" width="550" height="520">
<script type="text/javascript">writeAppletParams();</script>
<param name="dataName" value="Energy expenditure of bees">
<param name="yAxis" value="0 20 0 5">
<param name="xAxis" value="17 43 20 10">
<param name="zAxis" value="15 65 20 20">
<param name="longYVarName" value="energy (y)">
<param name="longXVarName" value="temperature (x)">
<param name="longZVarName" value="sucrose (z)">
<param name="yVarName" value="y">
<param name="xVarName" value="x">
<param name="zVarName" value="z">
<param name="yValues" value="3.1 3.7 4.7 5.5 6.7 7.3 7.9 9.2 9.3 6.0 6.9 7.5 11.5 12.9 13.4 17.5 15.8 14.7 7.7 8.3 9.5 15.7 14.3 15.9 19.1 18.0 19.9">
<param name="xValues" value="9@20 9@30 9@40">
<param name="zValues" value="3@20 3@40 3@60 3@20 3@40 3@60 3@20 3@40 3@60">
<param name="initialParams" value="6.00 0.000 0.000 0.0000 0.0000 0.0000 0">
<param name="paramMinMax" value="-99.99 99.99 0.999 9.999 -9.999 9.999 -9.9999 9.9999 -9.9999 9.9999 0.0000 9.9999">
<param name="shadeCutoff" value="0 10 20">
<param name="paramNames" value="Intercept Temperature Sucrose ? ? Interaction">
<param name="maxTableEntries" value="-99.999 9.999 99.99">
<param name="initialRotation" value="45 40">
<param name="customText" value="param=param#se=se">
</applet> 
</div>

		
    <p>The table shows the parameter estimates, their standard errors, t-statistics 
      and p-values. The p-values show the strength of evidence for whether the 
      corresponding parameters are non-zero.</p>
		
    <p>The p-value for the interaction term is 0.0013, giving very strong evidence 
      that there is interaction between the effects of sucrose and temperature.</p>
		<p>The other p-values should not be interpreted since it does not make sense 
			to drop the linear terms in sucrose or temperature when there is an interaction 
			in the model.</p>

	</div>





<h2 class="pageName">9.3.4 &nbsp; Tranformations and interaction</h2><!DOCTYPE HTML>


<p class="heading">Effect of transformation on the interaction</p>  
  <p>Consider a response variable, Y, that satisfies a normal model with two explanatory 
		variables X and Z that do not interact in their effect on the mean response.</p>
	<p>If a nonlinear function of this response, such as log(Y) or exp(Y), is modelled 
		instead, there is likely to appear to be an interaction.</p>
		
<div class="centred"><div class="boxed">
<p>The appearance of interaction depends on the 
				function of the response that is modelled.</p>
</div></div>

	<p>It is therefore important to consider nonlinear transformations of the response 
		as part of the modelling process.</p>
	
<div class="centred"><div class="boxed">
<p>Response variables that are 'quantities' of something 
				are often routinely replaced by their logs before analysis.</p>
</div></div>

	<p class="heading">Other effects of transforming the response</p>
	<p>Note that nonlinear transformations of the response have several different 
		effects on the model:</p>
	<ul>
		<li>Change the linearity of the relationship with numerical explanatory variables</li>
		<li>Change the interaction between the explanatory variables</li>
		<li>Change whether the error variance is the same for all treatment combinations</li>
	</ul>
	<p>It is therefore important to look simultaneously for all three problems when 
		deciding on whether a transformation of the response is advisable.</p>
	<div class="diagram"> 
    <p class="heading">Example with interaction</p>
    <p>The diagram below shows a data set for which there is clear evidence of 
			interaction between the effects of the two explanatory variables. The coloured 
			surface represents the least squares fit of the model with interaction.</p>

<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.QuadParamTestApplet.class" archive="coreCAST.jar" width="500" height="500">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="0 2000 0 500">
<param name="xAxis" value="0.7 5.3 1 1">
<param name="zAxis" value="0.8 4.2 1 1">
<param name="longYVarName" value="Response, Y">
<param name="longXVarName" value="Variable X">
<param name="longZVarName" value="Variable Z">
<param name="yVarName" value="y">
<param name="xVarName" value="x">
<param name="zVarName" value="z">
<param name="yValues" value="13.7 23.6 25.5 169.9 35.3 77.3 187.1 479.1 17.8 426.7 236.3 359.3 85.5 170.0 968.7 1460.3 217.9 378.2 1689.5 1987.0">
<param name="xValues" value="4@1 4@2 4@3 4@4 4@5">
<param name="zValues" value="1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4">
<param name="initialParams" value="6.00 0.0 0.0 0 0 0.0 0">
<param name="paramMinMax" value="0.99 999.99 -999.9 999.9 -999.9 999.9 0 0 0 0 0.9 999.9">
<param name="shadeCutoff" value="-200 700 2100">
<param name="paramNames" value="Intercept X Z ? ? Interaction">
<param name="maxTableEntries" value="-99.999 9.999 99.99">
<param name="customText" value="param=param#se=se">
</applet>
</div>

    <p>Observe that the interaction is highly significant.</p>
    <p class="heading">Transformed response</p>
    <p>In this example, the interaction can be completely removed by analysing 
			the logarithms of the response. This nonlinear transformation compresses 
			the top of the response scale and expands the lower end of the scale.</p>

<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.QuadParamTestApplet.class" archive="coreCAST.jar" width="500" height="500">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="2.5 8 3 1">
<param name="xAxis" value="0.7 5.3 1 1">
<param name="zAxis" value="0.8 4.2 1 1">
<param name="longYVarName" value="Response, log(Y)">
<param name="longXVarName" value="Variable X">
<param name="longZVarName" value="Variable Z">
<param name="yVarName" value="log(y)">
<param name="xVarName" value="x">
<param name="zVarName" value="z">
<param name="yValues" value="2.617 3.161 3.239 5.135 3.564 4.348 5.232 6.172 2.879 6.056 5.465 5.884 4.449 5.136 6.876 7.286 5.384 5.935 7.432 7.594">
<param name="xValues" value="4@1 4@2 4@3 4@4 4@5">
<param name="zValues" value="1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4">
<param name="initialParams" value="6.000 0.000 0.000 0 0 0.000 0">
<param name="paramMinMax" value="0.999 9.999 0.999 9.999 0.999 9.999 0 0 0 0 0.999 9.999">
<param name="shadeCutoff" value="2 5 8">
<param name="paramNames" value="Intercept X Z ? ? Interaction">
<param name="maxTableEntries" value="-99.999 9.999 99.99">
<param name="customText" value="param=param#se=se">
</applet>
</div>

    <p>When analysing the log transformation of the response, there is no significant 
			interaction between the effects of X and Z.</p>
    </div>




<h2 class="pageName">9.3.5 &nbsp; Example (nonlinearity and interaction)</h2><!DOCTYPE HTML>


<p class="heading">Model with curvature and interaction</p>
  <p>We have now expanded the linear model,</p>
	<p class=eqn><img src="../../../en/nonlinTwo/images/xzModel.gif" width="214" height="17"></p>
	<p>with quadratic terms to explain curvature and with an interaction term. These 
		can be combined in a model that has both nonlinearity and interaction,</p>
	<p class=eqn><img src="../../../en/interact/images/quadInteractModel.gif" width="412" height="22"></p>
	<p>An example illustrates this model.</p>

  <div class="diagram"> 
		<p class="heading">Energy expenditure of bees</p>

		<p>On the previous page, we found that there was strong evidence of interaction 
			between temperature and sucrose on energy expenditure of bees. <a href="javascript:showNamedPage('nonlinTwo9')">Much 
			earlier</a>, we also found that there was moderately strong evidence of 
			curvature in the relationship of temperature to energy expenditure, but 
			not of sucrose. The diagram below shows the fit of a model with both interaction 
			and quadratic terms in temperature and sucrose.</p>
<div class="centred"> 
<applet codebase="../../../java" code="curveInteractProg.QuadParamTestApplet.class" archive="coreCAST.jar" width="550" height="570">
<script type="text/javascript">writeAppletParams();</script>
<param name="dataName" value="Energy expenditure of bees">
<param name="yAxis" value="0 20 0 5">
<param name="xAxis" value="17 43 20 10">
<param name="zAxis" value="15 65 20 20">
<param name="longYVarName" value="energy (y)">
<param name="longXVarName" value="temperature (x)">
<param name="longZVarName" value="sucrose (z)">
<param name="yVarName" value="y">
<param name="xVarName" value="x">
<param name="zVarName" value="z">
<param name="yValues" value="3.1 3.7 4.7 5.5 6.7 7.3 7.9 9.2 9.3 6.0 6.9 7.5 11.5 12.9 13.4 17.5 15.8 14.7 7.7 8.3 9.5 15.7 14.3 15.9 19.1 18.0 19.9">
<param name="xValues" value="9@20 9@30 9@40">
<param name="zValues" value="3@20 3@40 3@60 3@20 3@40 3@60 3@20 3@40 3@60">
<param name="initialParams" value="6.00 0.000 0.000 0.0000 0.0000 0.0000 0">
<param name="paramMinMax" value="-99.99 99.99 0.999 9.999 -9.999 9.999 -9.9999 9.9999 -9.9999 9.9999 0.0000 9.9999">
<param name="shadeCutoff" value="0 10 20">
<param name="paramNames" value="Intercept Temperature Sucrose Temp-sqr Sucrose-sqr Interaction">
<param name="maxTableEntries" value="-99.999 9.999 99.99">
<param name="initialRotation" value="45 40">
<param name="customText" value="param=param#se=se">
</applet> 
</div>

		<p>In this model, there is still strong evidence of interaction between the 
			effects of temperature and sucrose, and of curvature in the effect of temperature.</p>
		<p>Note however that there is now <strong>also</strong> evidence of nonlinearity 
			in the effect of sucrose &mdash; its p-value has reduced from 0.1023 in the earlier 
			model without an interaction term to 0.0243 in this model. There is therefore 
			also moderately strong evidence that the relationship of energy expenditure 
			to sucrose is also nonlinear.</p>
		<p>The reason is that the interaction term has explained a considerable amount 
			of the variation in energy expenditure, so the residuals and the estimate 
			of the error standard deviation are much smaller with an interaction term. 
			Since the latter is part of the denominator of all t-ratios, the t-ratios 
			have become bigger and more significant.</p>
		
<div class="centred"><div class="boxed">
<p>The lower the unexplained variation in the response, the greater 
					the chance of detecting explanatory variables (and terms) that have 
					a small effect on the response.</p>
</div></div>

		<p>Click the <strong>y-x</strong> and <strong>y-z</strong> rotation buttons 
			to help understand the nature of the curvature and interaction in this model. 
		</p>
</div>





<h1 class="sectionName breakBefore">9.4 &nbsp; Diagnostics for models with 2 explanatory variables</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Problem points</li>
<li>Leverage</li>
<li>Problems with high leverage</li>
<li>Standardised residuals</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='5'>
<li>Externally studentised residuals</li>
<li>Influence</li>
<li>Examples</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">9.4.1 &nbsp; Problem points</h2><!DOCTYPE HTML>


<p class="heading">Problems with <span class="darkred">all</span> data points</p>
  <p>The relationship between a reponse and two explanatory variables is not always 
		described well by the multiple linear regression model,</p>
	<p class=eqn><img src="../../../en/regnInfTwo/images/normModelTwo2.gif" width="418" height="21"> 
	</p>
	<p>Some problems relate to the fit of the model to <strong>all</strong> data 
		points. </p>
	<dl>
		<dt>Nonlinearity</dt>
		<dd>Perhaps the response or one of the explanatory variables should be transformed.</dd>
		<dt>Interaction between <em>X</em> and <em>Z</em></dt>
		<dd>The effect of <em>X</em> may vary, depending on the value of <em>Z</em>.</dd>
		<dt>Non-constant variance</dt>
		<dd>The error standard deviation is often higher when the response mean is 
			higher. This is often associated with nonlinearity and a transformation 
			of the response often fixes both problems.</dd>
		<dt>Non-normal errors</dt>
		<dd>The errors are assumed to be normally distributed. This is not usually 
			a major problem and we will not discuss it further here.</dd>
	</dl>
	<p>Nonlinearity and interaction were investigated in the previous two sections.</p>
	<p class="heading">Problems with a <span class="darkred">single</span> data 
		point</p>
	<p>Other problems that are specific to a few data points will be investigated 
		in this section.</p>
	<dl>
		<dt>Outliers</dt>
		<dd>Response measurements that do not fit with the rest of the data &mdash; possibly 
			measurement errors or individuals that should be analysed separately from 
			the others.</dd>
		<dt>Influential points</dt>
		<dd>Do the conclusions depend unduely on one or two observations?</dd>
	</dl>
	<p class="heading">Diagnostics for outliers, leverage and influence</p>
	<p>These problems were investigated earlier for models with a single explanatory 
		variable. The regression diagnostics that are described in this section are 
		extensions of these. They will be further extended later to models with three 
		or more explanatory variables where they are specially important since the 
		raw data cannot be fully examined with scatterplots.</p>
	<p>We write the general linear model in the form,</p>
	<p class=eqn><img src="../../../en/diagnosticsTwo/images/multipleRegnModel.gif" width="535" height="55"></p>
	
<div class="centred"><div class="boxed">
<p>To foreshadow the general linear model with <em>p</em> explanatory 
				variables, we phrase some guidelines for the regression diagnostics in 
				terms of <em>p</em>.</p>
</div></div>

  <p>Note that <em>p</em>&nbsp;=&nbsp;2 for the simple linear model and <em>p</em>&nbsp;=&nbsp;3 
		for the regression model with two explanatory variables.</p>




<h2 class="pageName">9.4.2 &nbsp; Leverage</h2><!DOCTYPE HTML>


<p class="heading">Variability of least squares plane</p>
  <p>We <a href="javascript:showNamedPage('regnInfTwo2')">showed 
		earlier</a> that the least squares plane is a random quantity &mdash; it varies 
		from sample to sample. The position of the least squares plane has greatest 
		variability for <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> 
		combinations far from the data and this is particularly pronounced when <em>X</em> 
		and <em>Z</em> are multicollinear.</p>
	<p>The variability of predictions from the least squares plane therefore also 
		depends on the <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> 
		combination at which the prediction of <em>Y</em> is made:</p>
	<p class=eqn><img src="../../../en/diagnosticsTwo/images/predictVar.gif" width="599" height="53"></p>
	<p>where <em>r<sub>xz</sub></em> is the correlation coefficient between <em>X</em> 
		and <em>Z</em>. </p>
	<p>Do <strong>not</strong> try to remember this formula, but observe that it 
		defines a quadratic surface in <span class="em red">x</span>  and 
		<span class="em red">z</span>  and is smallest at the means of <em>X</em> 
		and <em>Z</em>.</p>
		
	<div class="diagram">
    <p class="heading">Illustration</p>

    <p>The left of the diagram below represents a normal linear model with two 
			planes, 2σ 
			above and below the regression plane (which is not shown). The (<em>x</em>,&nbsp;<em>z</em>) 
			values at which data are to be collected are represented by crosses on the 
			<em>x</em>-<em>z</em> plane and as red lines between the two planes.</p>
		<p>If response measurements were taken from this model, 95% of them would 
			lie on the red lines (i.e. between the two planes) and 5% would be either 
			above or below.</p>
    <div class="centred"> 
<applet codebase="../../../java" code="residTwoProg.LeverageGraphApplet.class" archive="coreCAST.jar" width="550" height="420">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="0 50 0 10">
<param name="xAxis" value="35 140 40 20">
<param name="zAxis" value="55 85 60 10">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="randomSeed" value="6456893">
<param name="multiRegnModel" value="-15.0 0.5 0.0 5">
<param name="xValues" value="90.7 83.6 84.1 82.2 93.3 90.5 77.0 84.9 88.9 73.1 86.3 84.4 102.7 86.1 96.8 98.4 97.6 82.3 84.5 98.7 79.7 83.8 70.4 73.1 85.0 79.4 ?">
<param name="zValues" value="66.0 72.9 68.0 66.1 66.3 70.6 69.4 68.1 70.0 68.3 68.0 70.5 73.6 66.0 71.1 67.8 68.2 68.4 71.7 71.2 68.3 71.7 68.7 71.2 67.4 66.6 ?">
<param name="maxFitVar" value="999.99">
<param name="leverageAxis" value="0 130 0 20">
<param name="customText" value="Var(prediction)=Var(prediction)">
</applet> 
</div>

    <p>The right of the diagram shows the variance of predictions as a quadratic 
			surface. Click anywhere on the x-z planes to read off the variance of predictions 
			for that <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> combination.</p>
		
<div class="centred"><div class="boxed">
<p>The predictions would be much more variable away from the 
					values of <strong>(<em>x</em>,&nbsp;<em>z</em>)</strong> 
					at which data are obtained.</p>
</div></div>

	  <p class="heading">Multicollinear data</p>
		<p>The following diagram is the same, but <em>X</em> and <em>Z</em> have higher 
			correlation.</p>
    <div class="centred"> 
<applet codebase="../../../java" code="residTwoProg.LeverageGraphApplet.class" archive="coreCAST.jar" width="550" height="420">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="0 50 0 10">
<param name="xAxis" value="40 135 40 20">
<param name="zAxis" value="55 85 60 10">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="randomSeed" value="6456893">
<param name="multiRegnModel" value="-15.0 0.5 0.0 5">
<param name="xValues" value="84.1 82.2 90.5 77.0 84.9 88.9 86.3 84.4 102.7 86.1 96.8 82.3 84.5 98.7 79.7 83.8 85.0 79.4 ?">
<param name="zValues" value="68.0 66.1 70.6 69.4 68.1 70.0 68.0 70.5 73.6 66.0 71.1 68.4 71.7 71.2 68.3 71.7 67.4 66.6 ?">
<param name="maxFitVar" value="999.99">
<param name="leverageAxis" value="0 400 0 100">
<param name="customText" value="Var(prediction)=Var(prediction)">
</applet> 
</div>

		<p>Observe that the variance of the predictions are highest at <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> 
			combinations in the corners away from the data.</p>
	</div>
		
	<p class="heading">'Best' place for new data</p>
	<p>The most effective place to make a new observation is at an <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> 
		combination where the position of the least squares plane is least accurately 
		determined &mdash; i.e. where the variance of the predictions from the model are 
		highest.</p>
	<div class="diagram">
    <p class="heading">Effect of an extra observation at (<em>x</em>, <em>z</em>)</p>

    <p>The diagram below again shows a model on the left. The normal distributions 
			on the right show the resulting distributions of the three least squares 
			parameter estimates.</p>
    <div class="centred"> 
<applet codebase="../../../java" code="residTwoProg.LeverageApplet.class" archive="coreCAST.jar" width="550" height="420">
<script type="text/javascript">writeAppletParams();</script>
<param name="yAxis" value="0 50 0 10">
<param name="xAxis" value="40 135 40 20">
<param name="zAxis" value="50 90 50 10">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="randomSeed" value="6456893">
<param name="multiRegnModel" value="-15.0 0.5 0.0 5">
<param name="xValues" value="84.1 82.2 90.5 77.0 84.9 88.9 86.3 84.4 102.7 86.1 96.8 82.3 84.5 98.7 79.7 83.8 85.0 79.4 ?">
<param name="zValues" value="68.0 66.1 70.6 69.4 68.1 70.0 68.0 70.5 73.6 66.0 71.1 68.4 71.7 71.2 68.3 71.7 67.4 66.6 ?">
<param name="b0AxisInfo" value="-150 150 -150 50">
<param name="bxAxisInfo" value="-0.3 1.3 -0.2 0.2">
<param name="bzAxisInfo" value="-2.5 2.5 -2 1">
<param name="maxFitVar" value="999.99">
<param name="customText" value="Var(prediction)=Var(prediction)#LS intercept=LS intercept#LS slope for=LS slope for">
</applet> 
</div>

    <p>Click on the x-z plane on the left to see the effect of adding an extra 
			observation there. By dragging this new point, you can see how much this 
			extra observation will increase the accuracy of the parameter estimates.</p>
		
<div class="centred"><div class="boxed">
<p>Accuracy is improved most when the new observation is collected 
					at an <strong>(<em>x</em>,&nbsp;<em>z</em>)</strong> combination 
					at which the variance of the predictions is highest.</p>
</div></div>

		<br>
		</div>
		
	<p class="heading">Leverage</p>
	<p>Since σ 
		is unknown in practice, we cannot use the variance of the prediction at <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> 
		to describe the effectiveness of collecting extra data there. Instead, we 
		use the <strong>leverage</strong> of <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span>.</p>
	<p class=eqn><img src="../../../en/diagnosticsTwo/images/leverageFormula.gif" width="593" height="90"></p>
	<p>In a similar way, we can use leverage to describe the potential influence 
		of each data point in the actual data set. As in simple linear regression, 
		the leverage of the <em>i</em>'th data point is denoted by <em>h<sub>ii</sub></em></p>
	<p class=eqn><img src="../../../en/diagnosticsTwo/images/leverage2.gif" width="236" height="39"></p>





<h2 class="pageName">9.4.3 &nbsp; Problems with high leverage</h2><!DOCTYPE HTML>


<p class="heading">Advantages of high leverage</p>
  <p>Selecting a new observation at a point, <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span>, 
		with high leverage should give good improvement in the accuracy of the least 
		squares parameter estimates, but <strong>only if the new observation conforms 
		to the same linear model as the rest of the data</strong>.</p>
	<p class="heading">Problems with high leverage</p>
	<p>We are rarely sure that the relationship is linear for all <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span>. 
		Even though linearity is often reasonable in a restricted range of <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span>, 
		this may not be true at high leverage points on the 'outskirts' of the data.</p>
	<p>Even more seriously, it is always possible that an observation may have been 
		incorrectly recorded or the individual may have different characteristics 
		from the bulk of the data &mdash; it could be an <strong>outlier</strong>. An observation 
		at a high leverage point has the potential to strongly influence the results 
		if it is also an outlier.</p>
	<p>Unfortunately, outliers often do not show up as residuals that are unusually 
		far from zero. Because a high leverage point pulls the least squares plane 
		so much, the outlier may have a residual that has similar size to the other 
		residuals.</p>
	
<div class="centred"><div class="boxed">
<p>Do not rely on the residuals to show up an outlier if it is 
				also a high leverage point.</p>
</div></div>

	<br>
	
	
	<div class="diagram">
    <p class="heading">Illustration</p>

    <div class="centred"> 
<applet codebase="../../../java" code="residTwoProg.DragXZOutlierApplet.class" archive="coreCAST.jar" width="450" height="380">
<script type="text/javascript">writeAppletParams();</script>
<param name="yVarName" value="Response, Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="yValues" value="16.33 16.42 18.23 18.50 20.11 13.77 17.24 17.34 20.54 12.13 14.32 10.13 22.75 24.60 23.10 24.93 23.64 23.26 13.27 25.66 44.45">
<param name="xValues" value="0.72 1.02 1.90 2.16 3.16 0.28 2.92 2.62 1.40 0.79 0.43 1.13 3.71 3.77 2.30 2.26 2.53 2.62 0.64 3.00 4.8">
<param name="zValues" value="6.00 5.21 3.89 3.70 2.07 5.45 1.13 1.93 6.32 4.05 5.56 2.05 1.84 2.44 5.78 6.31 5.18 4.83 4.43 4.87 9.6">
<param name="yAxis" value="0 60 0 10">
<param name="xAxis" value="0 5 0 1">
<param name="zAxis" value="0 10 0 2">
<param name="residAxis" value="-24 37 -20 10">
<param name="dragPoints" value="2#17#Low leverage#20#High leverage">
<param name="customText" value="Drag point with=Drag point with">
</applet> 
</div>

    <p>Rotate the 3-dimensional scatterplot by dragging the centre with the mouse 
			(but avoiding the red arrow.) All points lie near to a plane, so a normal 
			linear model is appropriate.</p>
		<p>Click the y-x-z button, then drag the cross in the centre of the diagram 
			to make it an outlier. Observe that the residual plot will show this point 
			as an extreme residual.</p>
		<p>Select <strong>High leverage</strong> from the pop-up menu then drag the 
			cross on the right. Because it is a high leverage point, it strongly pulls 
			the least squares plane towards itself, so its residual does not stand out 
			much from the other residuals, even though it is an outlier.</p>
		
	</div>
		
	<p class="heading">Rule-of-thumb for high leverage points</p>
	<p>It can be shown that the leverages of all data points sum to <em>p</em>, 
		where <em>p</em> is the number of linear parameters in the model (with <em>p</em>&nbsp;=&nbsp;3 
		for the linear model with two explanatory variables), so their average value 
		is <em><sup>p</sup></em>/<em><sub>n</sub></em>. A rule-of-thumb is therefore 
		to call a point 'high leverage' if its leverage is more than double this value.</p>
	
<div class="centred"><div class="boxed">
<p>Examine carefully points with <em>h<sub>ii</sub></em>&nbsp;&gt;&nbsp;&nbsp;<sup>2<em>p</em></sup>/<em><sub>n</sub></em>.</p>
</div></div>

		
	<p>Note that high leverage does <strong>not</strong> mean that there is anything 
		wrong with an observation &mdash; only that its explanatory variables are 'unusual' 
		in some way that <strong>could</strong> unduely influence the results.</p>
		
	


<h2 class="pageName">9.4.4 &nbsp; Standardised residuals</h2><!DOCTYPE HTML>


<p class="heading">Variance of fitted values and residuals</p>
  <p>As in simple linear regression with a single explanatory variable, although 
		the errors (and hence all <em>y<sub>i</sub></em>) have variance σ<sup>2</sup>, 
		the residuals have variance that is lower than σ<sup>2</sup> 
		and that depends on the leverages of the values.</p>
	<p class=eqn> <img src="../../../en/diagnosticsTwo/images/yComponents.gif" width="388" height="55" alt="log(wt) = log(a) + p log(len)"> 
	</p>
	<p>It can be proved that</p>
	<p class=eqn> <img src="../../../en/diagnostics/images/yAndFitVar.gif" width="114" height="48" alt="log(wt) = log(a) + p log(len)"> 
	</p>
	<p class=eqn> <img src="../../../en/diagnostics/images/residVar.gif" width="159" height="20" alt="log(wt) = log(a) + p log(len)"> 
	</p>
	<p class="heading">Standardised residuals</p>
	<p>Since different residuals have different variances, the solution is to standardise 
		them using an estimate of their standard deviations,</p>
	<p class=eqn> <img src="../../../en/diagnostics/images/standardResid.gif" width="303" height="42" alt="log(wt) = log(a) + p log(len)"> 
	</p>
	
<div class="centred"><div class="boxed">
<p>If the normal linear model holds, the 
						standardised residuals will have approximately normal(0,&nbsp;1) distributions.</p>
</div></div>

	<p>If the linear model holds, approximately 95% of these standardised residuals 
		should therefore be between -2 and +2, and almost all should be between -3 
		and +3.</p>
	<p class="heading">Non-constant variance</p>
	<p>An important use of standardised residuals is to look for non-constant variance. 
		When there is non-constant variance, it is usually a function of the mean 
		response, often increasing as the response mean increases. Rather than plotting 
		the standardised residuals against the separate explanatory variables, a single 
		plot of the standardised residuals against the fitted values is usually sufficient.</p>
	
<div class="centred"><div class="boxed">
<p>A scatterplot of standardised residuals 
						against fitted values usually has a 'funnel' shape if there is non-constant 
						variance.</p>
</div></div>

	<p>Non-constant variance is usually associated with nonlinearity and a transformation 
		of the response often fixes both problems.</p>
	<p class="heading">Plotting variables against the fitted values (advanced)</p>
		
	<p>The fitted values are a linear combination of the two explanatory variables. 
	</p>
		<p class=eqn> <span class="black"><span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span>&nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x<sub>i</sub></em></span> 
		</p>
		
	<p>Therefore a plot of any variable against the fitted values can be obtained 
		by rotating a 3-dimensional scatterplot of this variable against <em>X</em> 
		and <em>Z</em>. </p>
		
	<div class="diagram"> 
		<p class="heading">Illustration</p>
		<div class="centred"> 
<applet codebase="../../../java" code="residTwoProg.RotateToFitApplet.class" archive="coreCAST.jar" width="550" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="yVarName" value="Response, Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="yValues" value="16.33 16.42 18.23 18.50 20.11 13.77 17.24 17.34 20.54 12.13 14.32 10.13 22.75 24.60 23.10 24.93 23.64 23.26 13.27 25.66 44.45">
<param name="xValues" value="0.72 1.02 1.90 2.16 3.16 0.28 2.92 2.62 1.40 0.79 0.43 1.13 3.71 3.77 2.30 2.26 2.53 2.62 0.64 3.00 4.8">
<param name="zValues" value="6.00 5.21 3.89 3.70 2.07 5.45 1.13 1.93 6.32 4.05 5.56 2.05 1.84 2.44 5.78 6.31 5.18 4.83 4.43 4.87 9.6">
<param name="yAxis" value="0 50 0 10">
<param name="xAxis" value="0 5 0 1">
<param name="zAxis" value="0 10 0 2">
<param name="fitAxis" value="0 60 0 10">
<param name="residAxis" value="-4 4 -4 2">
<param name="customText" value="Fitted value=Fitted value">
</applet> 
</div>

    <p>The scatterplot of the left initially displays <em>Y</em> against <em>X</em>. 
			Click the y-x rotation button on the right to rotate the 3-dimensional scatterplot 
			to show the same plot.</p>
		<p>Now select <em><strong>Z</strong></em> from the lower pop-up menu and observe 
			that this is equivalent to a different rotation of the 3-dimensional scatterplot.</p>
		<p>Select <strong>Fitted values</strong> from the pop-up menu and observe 
			that this is equivalent to an intermediate rotation of the 3-dimensional 
			scatterplot that 'looks along' the regression plane.</p>
		<p>Finally, repeat with plots of the standardised residuals.</p>
		</div>
		
	


<h2 class="pageName">9.4.5 &nbsp; Externally studentised residuals</h2><!DOCTYPE HTML>


<p class="heading">Detecting outlliers</p>
  <p>As in simple linear regression, although studentised residuals are better 
		than ordinary residuals, they are still poor for detecting outliers. A more 
		sensitive way to detect outliers is with <strong>externally studentised residuals</strong>. 
		Whereas the ordinary standardised residuals use the mean residual sum of squares 
		(MS<sub>Resid</sub>) from the full data set as an estimate of σ<sup>2</sup>,</p>
	<p class="eqn"><img src="../../../en/diagnosticsTwo/images/stdResidDefn.gif" width="123" height="42" align="absmiddle"></p>
	<p>the externally studentised residuals separately estimate σ 
		for each observation using the data set without that observation,</p>
	<p class="eqn"><img src="../../../en/diagnosticsTwo/images/studentResidDefn.gif" width="129" height="42" align="absmiddle"></p>
	<div class="diagram"> 
		<p class="heading">Illustration</p>

<div class="centred"> 
<applet codebase="../../../java" code="residTwoProg.DragXZOutlier2Applet.class" archive="coreCAST.jar" width="550" height="380">
<script type="text/javascript">writeAppletParams();</script>
<param name="yVarName" value="Response, Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="yValues" value="16.33 16.42 18.23 18.50 20.11 13.77 17.24 17.34 20.54 12.13 14.32 10.13 22.75 24.60 23.10 24.93 23.64 23.26 13.27 25.66 44.45">
<param name="xValues" value="0.72 1.02 1.90 2.16 3.16 0.28 2.92 2.62 1.40 0.79 0.43 1.13 3.71 3.77 2.30 2.26 2.53 2.62 0.64 3.00 4.8">
<param name="zValues" value="6.00 5.21 3.89 3.70 2.07 5.45 1.13 1.93 6.32 4.05 5.56 2.05 1.84 2.44 5.78 6.31 5.18 4.83 4.43 4.87 9.6">
<param name="yAxis" value="0 60 0 10">
<param name="xAxis" value="0 5 0 1">
<param name="zAxis" value="0 10 0 2">
<param name="residAxis" value="-10 10 -10 5">
<param name="dragPoints" value="2#17#Low leverage#20#High leverage">
<param name="fitAxis" value="0 60 0 10">
<param name="customText" value="Drag point with=Drag point with#Ordinary standardised residual=Ordinary standardised residual#Externally studentised residual=Externally studentised residual#Fitted values=Fitted values#Std resid=Std resid#Deleted resid=Deleted resid">
</applet> 
</div>

    <p>In the diagram above, drag the red arrows to make the low-leverage point 
			in the middle of the diagram into an outlier. Observe how the standardised 
			residual is affected.</p>
		<p>Select <strong>Externally studentised residual</strong> from the pop-up 
			menu at the top and observe that the plot of externally studentised residuals 
			is better at showing up the point when it is an outlier.</p>
		<p>Repeat with the <strong>High leverage</strong> point.</p>
		</div>
		
	


<h2 class="pageName">9.4.6 &nbsp; Influence</h2><!DOCTYPE HTML>


<p class="heading">Influence on fitted values</p>
  <p>As in simple linear regression, high-leverage points have the <strong>potential</strong> 
		to strongly influence the conclusions from a data set.</p>
	<p>Leverage is only a function of the explanatory variables, and we also need 
		to take into account the response values for any high-leverage points to see 
		whether they are <strong>actually</strong> influential.</p>

  <p>One measure of influence relates to how deletion of each point affects that 
		point's fitted value,</p>
	<p class=eqn> <img src="../../../en/diagnostics/images/dfits.gif" width="149" height="51"> 
	</p>
	<p>Observations are often classified as 'influential' if</p>
	<p class=eqn> <img src="../../../en/diagnosticsTwo/images/dfitsGuideline.gif" width="148" height="37"> 
	</p>
	<p>It can be proved that <em>DFITS</em> is a simple function of the externally 
		studentised residual and the leverage,</p>
	<p class=eqn> <img src="../../../en/diagnostics/images/dfits2.gif" width="154" height="41" alt="log(wt) = log(a) + p log(len)"></p>
	<p class="heading">Influence on parameter estimates</p>
	<p>An alternative is to look at how deletion of each point affects the regression 
		coefficients,</p>
	<p class=eqn><img src="../../../en/diagnosticsTwo/images/bChanges.gif" width="83" height="73"></p>
	<p>Instead of separately examining the influence on each parameter estimate, 
		they are usually combined into a single statistics, called <strong>Cook's 
		D</strong>. Although it can be defined in terms of the above differences, 
		it can also be expressed in terms of the standardised residuals and leverages,</p>
	<p class=eqn> <img src="../../../en/diagnosticsTwo/images/cookDDefn.gif" width="134" height="43" alt="log(wt) = log(a) + p log(len)"> 
	</p>
	<p>Therefore the two influence measures are related,</p>
	<p class=eqn> <img src="../../../en/diagnosticsTwo/images/influenceReln.gif" width="311" height="38" alt="log(wt) = log(a) + p log(len)"> 
	</p>
		
	


<h2 class="pageName">9.4.7 &nbsp; Examples</h2><!DOCTYPE HTML>


<p class="heading">Looking for outliers and influence</p>
  <p>Detection of outliers is clearly important when fitting multiple regression 
		models. They may correspond to incorrectly recorded values or individuals 
		that are different enough from the rest to warrant separate analysis.</p>
	<p>High leverage is also important, even though it does not necessarily mean 
		that anything is wrong with the multiple regression model. A high-leverage 
		point could potentially have undue influence on the conclusions and we should 
		be aware if our conclusions hang on a single observation.</p>
	<p>In simple linear models, outliers, high leverage and influential points can 
		usually be seen in a scatterplot of the raw data, so the complication of evaluating 
		and plotting externally studentised residuals, leverages and measures of influence 
		is less important. However when there are two explanatory variables, it is 
		much harder to simply 'look at the raw data' and this is impossible if there 
		are three or more explanatory variables.</p>
	<p>Examination of externally studentised residuals, leverages and a measure 
		of influence is therefore important. These may be shown on a dot plot or in 
		a scatterplot against fitted values.</p>

	<div class="diagram"> 
		<p class="heading">Examples</p>
		<p>For each of the following data sets, externally studentised residuals, 
			leverages and DFITS are shown in stacked dot plots. Carefully examine the 
			plots, clicking on crosses to see corresponding values of the other measures, 
			then read the conclusions.</p>

<div class="centred"> 
<applet codebase="../../../java" code="residTwoProg.DiagnosticsXZApplet.class" archive="coreCAST.jar" width="550" height="500">
<script type="text/javascript">writeAppletParams();</script>
<param name="noOfDataSets" value="3">
<param name="customText" value="Data=Data#Externally studentised residuals=Externally studentised residuals#Leverage=Leverage#DFITS=DFITS#Conclusion=Conclusion#Peek at data=Peek at data">

<param name="dataName" value="Leafing-out times of Maple seedlings">
<param name="description" value="Batches of maple seedlings from various locations in the US and Canada were grown in Wooster, Ohio. An index of the time to leafing-out of each batch (Y) may be related to the latitude (X degrees North) and mean July temperature (Z degrees F) of the source of the seeds.">
<param name="question" value="No seedlings have a residual far enough from zero to be called an outlier. Of the three seedlings with high leverage, only one is associated with a fairly high residual and therefore a high DFITS. You should check that your conclusions are not strongly affected by this observation.">
<param name="yVarName" value="Leafing-out time">
<param name="xVarName" value="Latitude(X)">
<param name="zVarName" value="Temperature(Z)">
<param name="yValues" value="20.5 21.0 18.3 18.6 18.6 19.8 20.6 19.2 19.8 15.8 14.5 18.5 16.7 13.9 14.3 15.2 16.6 18.2 18.3 13.3 20.0 18.1 17.0 15.6 15.7 15.4 15.4 15.8 15.0 15.9 14.0 10.8">
<param name="xValues" value="46.95 45.55 45.00 45.42 44.50 46.37 45.03 43.00 42.80 42.70 42.42 40.75 41.38 40.35 40.80 40.92 40.33 41.58 41.92 40.12 42.75 42.00 42.55 41.50 39.25 37.45 38.33 36.25 35.80 31.38 32.83 30.75">
<param name="zValues" value="66.7 64.3 61.8 65.0 63.5 65.5 67.7 67.9 70.2 71.1 74.4 76.4 75.9 76.4 71.9 74.2 73.0 71.4 69.7 72.6 69.2 68.0 70.0 72.5 76.7 79.5 69.5 74.3 68.9 80.8 81.2 81.0">
<param name="yAxis" value="10 22 10 2">
<param name="xAxis" value="30 47 30 2">
<param name="zAxis" value="60 82 60 5">
<param name="leverageAxis" value="0 0.5 0 0.1">
<param name="dfitsAxis" value="-2 2 -2 1">

<param name="dataName2" value="Body fat for sample of 25 men">
<param name="description2" value="Body fat was measured using an underwater weighing technique from 251 men. This data set shows percentage body fat (Y), abdomen circumference (X cm) and height (Z cm) from 25 of the men.">
<param name="question2" value="There are no outliers. Three men have an (abdomen, height) combination with fairly high leverage, but only one (with very small abdomen) has DFITS outside the guidelines and only by a little.">
<param name="yVarName2" value="Body fat">
<param name="xVarName2" value="Abdomen(X)">
<param name="zVarName2" value="Height(Z)">
<param name="yAxis2" value="0 40 0 10">
<param name="xAxis2" value="65 130 70 10">
<param name="zAxis2" value="63 76 65 5">
<param name="yValues2" value="12 16.5 9.4 31.3 5 24 13.2 18.6 14.3 21.7 21 17.9 15 20.1 24.5 22 16.5 16.8 23.8 22.6 11.3 15.1 16.9 28.8 28.3">
<param name="xValues2" value="88.6 100.5 83.5 108.1 70.4 98.3 84.6 98.6 86.5 94 92.3 87.5 87 106.6 106.8 92.4 90.8 104.5 101.2 89.7 84.4 88.7 93 100.5 111.5">
<param name="zValues2" value="73.5 73.5 69 67 66.75 65.75 71.5 69.25 73 72 69.25 72.25 69.75 75 70.25 71.5 69.5 74.5 68.25 67.5 70.75 69.25 68.5 65.75 66">
<param name="leverageAxis2" value="0 0.5 0 0.1">
<param name="dfitsAxis2" value="-2 2 -2 1">

<param name="dataName3" value="Heart catheter length">
<param name="description3" value="In heart catheterisation, a catheter is passed through a major vein or artery from the leg into the heart. X-rays are used to position the tip of the catheter. The catheter length (Y cm), height (X in) and weight (Z lb) were recorded from 12 children.">
<param name="question3" value="One child has deleted residual less than -3. This was a very small, light child (moderately high leverage). The relationship could be nonlinear for small children or the child may be an outlier. Another child has high leverage (unusually light for the height) and is highly influential. Both children's observations strongly influence the fitted line.">
<param name="yVarName3" value="Catheter">
<param name="xVarName3" value="Height">
<param name="zVarName3" value="Weight">
<param name="yValues3" value="37 50 34 36 43 28 37 20 34 30 38 47">
<param name="xValues3" value="42.8 63.5 37.5 39.5 45.5 38.5 43.0 22.5 37.0 23.5 33.0 58.0">
<param name="zValues3" value="40.0 93.5 35.5 30.0 52.0 17.0 38.5 8.5 33.0 9.5 21.0 79.0">
<param name="yAxis3" value="15 55 20 10">
<param name="xAxis3" value="20 65 20 10">
<param name="zAxis3" value="0 100 0 20">
<param name="leverageAxis3" value="0 0.8 0 0.2">
<param name="dfitsAxis3" value="-3 3 -3 1">
</applet> 
</div>

    <p>Since there are only two explanatory variables, you can click <strong>Peek 
			at data</strong> to see the raw data in a 3-dimensional scatterplot. For 
			models with more than two explanatory variables that you will meet in later 
			chapters, this will not be possible.</p>
		</div>

	


</html>
