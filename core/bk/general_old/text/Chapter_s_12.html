<html>
<head>
  <title>12. Regression Inference</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="../../../structure/printStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/summaryStyles.css" type="text/css">
  <script src="../../../structure/videoControls/jquery.js"></script>
  <script src="../../../structure/printFixes.js"></script>
</head>

<body id="body" onLoad="showPrintDialog(true)">
<div id='overlay'>
	<div id='dialogWindow'>
		<div class='printDialog'>
			<script type='text/javascript'>
				document.write("<div class='heading'>" + top.document.title + "</div>");
				if (top.url != null) {
					document.write("<p class='text'>A version of this chapter has already been generated in PDF format and we recommend that it is used for printing. The button below will download and display it.</p>");
					document.write("<p><button onClick='top.showPdf()'>Show PDF version of chapter</button></p>");
					document.write("<p class='text'>However downloading could be slow depending on your internet connection. If this is a problem, click the button below to print the chapter without downloading (but perhaps not formatted as well as the PDF version).</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>If you are <strong>not</strong> using the PDF version, the best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
				else {
					document.write("<p class='text'>Click the button below to print this chapter.</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>The best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
			</script>
			
			<p class='text'>If you don't want to print now,</p>
			<p><button onClick='top.showPrintDialog(false)'>Browse formatted chapter</button></p>
		</div>
	</div>
</div>
<h1 class="chapterName">Chapter 12 &nbsp; Regression Inference</h1>
<h1 class="sectionName">12.1 &nbsp; Linear regression models</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Interest in generalising from data</li>
<li>Distribution of Y for each X</li>
<li>Normal linear model</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='4'>
<li>Another way to describe the model</li>
<li>Model parameters</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">12.1.1 &nbsp; Interest in generalising from data</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Bivariate data: population or sample?</p>
<p>In most bivariate data sets, we have no interest in the specific individuals from
which the data are collected. The individuals are 'representative' of a larger population
or process, and our main interest is in this underlying population. </p>
<p class="heading">Example</p>
<p>Data  were collected by biologists from 15 lakes
in central Ontario to assess how zinc concentrations in an aquatic plant were related
to zinc concentrations in the lake sediment.</p>
<p class="eqn"><img src="../../../en/regnModel/images/s_sampleScatter.gif" width="403" height="316"> </p>
<p class="heading">Band containing about 95% of values</p>
<p>Applying the 70-95-100 rule of thumb to the errors, about 95% of them
will be within 2 standard deviations of zero &mdash; i.e. between ±2σ.</p>
<p>Since the errors are vertical distances of data points to the regression line,
a  band
2σ on each side of it should contain about 95% of the crosses
on a scatterplot of the data.</p>
<p class=eqn><img class="gif" src="../../../en/regnModel/images/band95.gif" width="297" height="274"></p>




<h2 class="pageName">12.1.5 &nbsp; Model parameters</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Slope and intercept</p>
<p>A normal linear model, </p>
<p class=eqn><span class="black">&mu;<sub><em>y</em></sub> &nbsp;=&nbsp; &beta;<sub>0</sub> &nbsp;+&nbsp; &beta;<sub>1</sub><em>x</em></span> </p>
<p class=eqn><span class="black">&sigma;<sub><em>y</em></sub> &nbsp;=&nbsp; &sigma;</span> </p>
<p>involves 3 parameters, β<sub>0</sub>, β<sub>1</sub> and σ. The model's slope,
β<sub>1</sub>,
and intercept, β<sub>0</sub>, can be interpreted in a similar way to the slope
and intercept of a least squares line.</p> 
<dl>
<dt>Slope</dt>
<dd>Increase in the mean response per unit increase in <i>X</i>.</dd>
<dt>Intercept</dt>
<dd>Mean response when <em>X</em> = 0.</dd>
</dl>

<p class="heading" style="margin-bottom:5px; margin-top:35px">Examples of interpretation</p>

<div class="centred"><table class="centred" border="0" cellpadding="8" cellspacing="0" style="margin-top:0px">
<tr>
<th align="CENTER" width="300">Context</th>
<th width="33%" align="CENTER">Interpretation of β<sub>1</sub></th>
<th width="33%" align="CENTER">Interpretation of β<sub>0</sub></th>
</tr>
<tr bgcolor="#FFFFFF">
<td width="300" class="top bottom left right"><i>Y</i> = Yield of wheat per acre <br>
<i>X</i> = Fertiliser (kg per m<sup>2</sup>)</td>
<td width="33%" class="top bottom right">Increase in mean yield per acre for
each additional kg/m<sup>2</sup> of fertiliser</td>
<td width="33%" class="top bottom right">Mean yield per acre if no fertiliser
is used</td>
</tr>
<tr bgcolor="#FFFFFF">
<td width="300" class="bottom left right"><i>Y</i> = Exam mark <br>
<i>X</i> = Hours of study by student before exam</td>
<td width="33%" class="bottom right">Increase in expected mark for each additional
hour of study</td>
<td width="33%" class="bottom right">Expected mark if there is no study</td>
</tr>
<tr bgcolor="#FFFFFF">
<td width="300" class="bottom left right"><i>Y</i> = Hospital stay (days) <br>
<i>X</i> = Age of patient</td>
<td width="33%" class="bottom right">Average extra days in hospital per extra
year of age</td>
<td width="33%" class="bottom right">Average days in hospital at age 0. Not particularly
meaningful here. </td>
</tr>
</table></div>


<h1 class="sectionName breakBefore">12.2 &nbsp; Estimating parameters</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Estimating the slope and intercept</li>
<li>Estimating the error standard devn</li>
<li>Distn of least squares estimates</li>
<li>Standard error of least squares slope</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='5'>
<li>95% confidence interval for slope</li>
<li>Properties of confidence interval</li>
<li>Influences on accuracy</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">12.2.1 &nbsp; Estimating the slope and intercept</h2><!DOCTYPE HTML>


<p class="heading">Least squares</p>
<p>In practical situations, we must estimate β<sub>0</sub>,
β<sub>1</sub> and σ from a data set that we believe satisfies the normal linear model.</p>

<div class="centred"><div class="boxed">
<p>The best estimates of β<sub>0</sub> and β<sub>1</sub> are the slope and
intercept of the least squares line, <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub></p>
</div></div>

<p>Since<em> b</em><sub>0 </sub>and <em>b</em><sub>1</sub> are functions of a
data set that we assume to be a random sample from the normal linear model, <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub> are
themselves random quantities and have distributions.</p>
<p class="heading">Simulated example</p>
<p>The diagram below represents a regression model with a grey band. A sample
of 20 values has been generated from this model and the least squares line (shown
in blue) has been fitted to the simulated data. The least squares line provides
estimates of the slope and intercept but they are not exactly equal to the underlying
model values.</p>
<p class="eqn"><img src="../../../en/regnEst/images/s_lsAndModel.gif" width="406" height="357"> </p>
<p>In practice, the slope and intercept of the regression line are unknown, so <strong>the
errors are also unknown values</strong>, but  the least squares residuals provide
<strong>estimates</strong>.</p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/residDiagram.gif" width="355" height="274"> </p>
<p class="heading">Estimating the error standard deviation</p>
<p>The third unknown parameter of the normal linear model, σ, is the standard deviation
of the errors,</p>
<p class=eqn><span class="black">&sigma; &nbsp;=&nbsp;<strong>st devn</strong>( &epsilon; )</span> </p>
<p>σ can be estimated from the least squares residuals, {<em>e<sub>i</sub></em>},</p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/errorSdEst.gif" width="95" height="41"> </p>
<p>This is similar to the formula for the standard deviation of the residuals,
but uses the divisor (<em>n</em> &minus; 2) instead of (<em>n</em> &minus; 1).
It describes the size of a 'typical' residual.</p>
<p class="heading">Example</p>
<p class="eqn"><img src="../../../en/regnEst/images/s_residSd.gif" width="463" height="291"> </p>
<p>where <em>s</em><sub>x </sub> is the standard deviation of  <em>X. </em>Since
σ is unknown, we must replace it with an estimate from
the data to obtain a numerical value for the standard error,</p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/errorSdEst.gif" width="95" height="41"> </p>
<p class=heading>Example</p>
<p align="center"><img src="../../../en/regnEst/images/radiationCancer.gif" width="550" height="377"></p>
<p>In practice, we must replace σ in the formula for the standard error with
an estimate (based on the sum of squared residuals),</p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/sdSlopeEqn2.gif" width="234" height="52"> </p>
<p>so the constant 1.96 must be replaced by a larger
value from the t distribution with
(<em>n</em>&nbsp;-&nbsp;2) degrees of freedom. </p>

<div class="centred"><div class="boxed"><p><strong>A 95% confidence interval for the slope is</strong></p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/slopeCIFormula.gif" width="121" height="26"></p></div></div>
<p>Most statistical software will evaluate <em>b</em><sub>1</sub> and its standard
error for you when you fit a normal linear model, so it is fairly easy to evaluate
the confidence interval in practice &mdash; you will not need to use any of the formulae
above!</p>
<p class="heading">Example</p>
<p>For the example on the previous page, the least squares estimate of the slope
and its standard error were:
</p>
<p class="eqn"><em>b</em><sub>1</sub> = 9.27,        se (<em>b</em><sub>1</sub>)
= 1.42</p>
<p>Since there were <em>n</em> = 9 data points, <em>t</em><sub><em>n</em> &minus; 2</sub> =
t<sub>7</sub> = 2.365,  so a 95%
confidence interval for the slope is </p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/radiationCI.gif" width="284" height="39"></p>
<p>We are 95% confident that the expected number of deaths per 100,000
is between 5.9 and 12.6 higher for each unit increase in the exposure index.</p>




<h2 class="pageName">12.2.6 &nbsp; Properties of confidence interval</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Properties of 95% confidence interval</p>
<p>Since a confidence interval for the slope, β<sub>1</sub>, is evaluated from
random sample data, it will vary from sample to sample. In 95% of such samples,
the 95% confidence interval will include the true population slope, but in 5%
of samples it will not.</p>

<div class="centred"><div class="boxed">
<p>We cannot tell whether or not our single data set is one of the 'lucky'
ones.</p>
</div></div>

<p class="heading">Simulation</p>
<p class="eqn"><img src="../../../en/regnEst/images/s_ciSimulation.gif" width="437" height="344"> </p>
<p>where </p>
<ul>
<li>σ is the standard deviation of the errors &mdash; i.e. the spread of points<i></i> around
the regression line,</li>
<li><i>n</i> is the number of data points, and</li>
<li><em>s</em><sub>x</sub> is the sample standard deviation of <i>X</i>.</li>
</ul>
<div class="centred"><div class="boxed">
<p style="text-align:left">The standard error of  <em>b</em><sub>1</sub>
is lowest when: </p>
<ol>
<li>the response standard deviation, σ, is low</li>
<li>the sample size, <i>n</i>, is large</li>
<li>the spread of x-values is high</li>
</ol>
</div></div>
<p class=heading>Implications for experimental design </p>
<p>To get the most accurate estimate of the slope from experimental data,</p>
<dl>
<dt>Reduce σ</dt>
<dd>σ can be reduced by ensuring that the experimental units
are as similar as possible.</dd>
<dt>Increase <em>n</em></dt>
<dd>Collect as much data as possible.</dd>
<dt>Increase <em>s<sub>x</sub></em></dt>
<dd>Choose to run the experiment with x-values that are widely spread.</dd>
</dl>
<br>
<p>However if the spread of x-values is increased too much, the relationship
may not be sufficiently linear for a linear model to be used.</p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/nonlinearity.gif" width="271" height="210"> </p>
<p>Nonlinearity is a major problem, so it is important to be able to assess whether
a relationship is linear. Don't just collect data at the ends of the 'acceptable'
range of x-values, even though this maximises <em>s</em><sub>x</sub>. </p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/nonlinearity2.gif" width="271" height="210"></p>




<h1 class="sectionName breakBefore">12.3 &nbsp; Testing regression parameters</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Importance of zero slope</li>
<li>Testing whether slope is zero</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='3'>
<li>Strength of evidence and relationship</li>
<li>Properties of p-values</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">12.3.1 &nbsp; Importance of zero slope</h2><!DOCTYPE HTML>


<p class="heading">Does the response depend on X?</p>
<p>In a normal linear model, the response has a distribution whose mean, µ<sub>y</sub>,
depends linearly on the explanatory variable,</p>
<p class=eqn><span class="black"><em>Y</em>&nbsp; ~ &nbsp;<font face="Arial, Helvetica, sans-serif">normal</font> (&mu;<sub>y</sub>&nbsp;, &sigma;<sub>y</sub>)</span> </p>
<p>If the slope parameter, β<sub>1</sub>, is zero, then the response has a normal
distribution that <strong>does not depend on <i>X</i></strong>.</p>
<p class=eqn><span class="black"><em>Y</em> &nbsp; ~ &nbsp; <font face="Arial, Helvetica, sans-serif">normal</font> (&beta;<sub>0</sub> , &nbsp;&sigma;)</span> </p>
<p>This can be tested formally with a hypothesis test for whether β<sub>1</sub> is
zero.</p>




<h2 class="pageName">12.3.2 &nbsp; Testing whether slope is zero</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Testing for zero slope</p>
<p>To assess whether the explanatory variable affects the response, we test the
hypotheses </p>
<p class=eqn><span class="blue"><strong><font size="+1">H</font><sub>0</sub>&nbsp;:&nbsp;&nbsp;&nbsp;</strong>&beta;<sub>1</sub> &nbsp;=&nbsp; 0<br><strong><font size="+1">H</font><sub>A</sub>&nbsp;:&nbsp;&nbsp;&nbsp;</strong>&beta;<sub>1</sub>  &nbsp;&ne;&nbsp;  0</span> </p>
<p>The test is based on how far the least squares slope, <em>b</em><sub>1</sub>,
is from zero. To assess this, we must take into account its standard deviation
(standard error),</p>
<p class=eqn><img class="gif" src="../../../en/regnTest/images/sdSlopeEqn.gif" width="129" height="42"> </p>
<p>If we knew the value of σ, we could  standardise <em>b</em><sub>1</sub> to
get a test statistic,</p>
<p class=eqn><span class="black bold">standardised value,</span>  &nbsp;<img class="gif" src="../../../en/regnTest/images/standardisedSlope.gif" width="85" height="43"></p>
<p>If β<sub>1</sub> was really zero (<strong>H<sub>0</sub></strong>), the probability
of getting a least squares slope as far from zero as that recorded would be the
p-value,</p>
<p class=eqn><img class="gif" src="../../../en/regnTest/images/zForTestingSlope.gif" width="294" height="141"></p>
<p>Unfortunately σ is usually unknown and the standard deviation of <em>b</em><sub>1</sub> must
be <a href="javascript:showNamedPage('regnEst4')">estimated from the sample
data</a>. We therefore use a test statistic of the form </p>
<p class=eqn><span class="black bold">t ratio,</span>  &nbsp;<img class="gif" src="../../../en/regnTest/images/standardisedSlope2.gif" width="69" height="48"></p>
<p>and refer to a t distribution with <i><span class="black">n</span></i><span class="black">&nbsp;-&nbsp;2</span> degrees
of freedom to find the p-value.</p>
<p class=eqn><img class="gif" src="../../../en/regnTest/images/slopeTestP.gif" width="426" height="268"> </p>
<p>The p-value is interpreted in the same way as for other hypothesis tests &mdash;
a p-value close to zero means that the sample slope is far enough from zero to
be inconsistent with <strong>H<sub>0</sub>: &beta;<sub>1</sub> = 0</strong>.</p>
<p class="heading">Examples</p>
<p align="center"><img src="../../../en/regnTest/images/possumDamage.gif" width="550" height="442"></p>
<p>The test statistic and  the p-value therefore both depend on both <em>r</em> and
the sample size, <em>n</em>. Increasing <em>n</em> and increasing <em>r</em> <strong>both</strong> result
in a lower p-value.</p>
<p class=eqn><img class="gif" src="../../../en/regnTest/images/rnEffect.gif" width="550" height="440"></p>




<h2 class="pageName">12.3.4 &nbsp; Properties of p-values</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Properties of p-value</p>
<p>P-values for testing whether a linear model's slope is zero have the same
properties as p-values for other hypothesis tests. In particular, </p>
<ul>
<li>When <b>H<sub>0</sub></b> is true (i.e. <i>Y</i> is not related to <i>X</i>),
all p-values between 0 and 1 are equally likely.</li>
<li>If <b>H<sub>A</sub></b> is true (i.e. <i>Y</i> and <i>X</i> are
related), then  p-values  near zero
are more likely than p-values near 1.</li>
</ul>
<p>When <em>Y</em> and <em>X</em> are not related
(β<sub>1</sub> = 0), it is still possible to get small p-values, suggesting that
β<sub>1</sub> is <strong>not</strong> zero. However there is only probability
0.01 of getting a p-value as low as 0.01 &mdash; it is unlikely but possible. Such
a p-value is more likely if the variables <strong>are</strong> related so we
interpret it as giving strong evidence of a relationship.</p>




<h1 class="sectionName breakBefore">12.4 &nbsp; Predicting the response</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Estimated response distn at X</li>
<li>Variability of estimate at X</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='3'>
<li>Estimating the mean vs prediction</li>
<li>Confidence and prediction intervals</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">12.4.1 &nbsp; Estimated response distn at X</h2><!DOCTYPE HTML>


<p>A normal linear model provides
a response distribution <strong>for all <i>X</i></strong>. With estimates for
all three model parameters, we can obtain the approximate response distribution
at <strong>any</strong> x-value, even if we have no data at that x-value. </p>
<p class="eqn"><img src="../../../en/regnPred/images/s_estimDistn.gif" width="434" height="369"> </p>
<p>A formula for the standard error on the right exists, but you should rely
on statistical software to find its value.</p>
<p class=heading>95% prediction interval for a new individual's response</p>
<p>For prediction, a similar interval is used:</p>
<p class=eqn><img class="gif" src="../../../en/regnPred/images/predInterval.gif" width="169" height="21"> </p>
<p>where  <em>k</em> is greater than the corresponding standard error
for the confidence interval. Statistical software should again be used to find
its value.</p>
<p class=heading>Example</p>
<p>The diagram below shows 95% confidence intervals for the mean response at <em>x</em> and
95% prediction intervals for a new response at <em>x</em> as bands for a small
data set with <em>n</em> = 7 values. </p>
<p class="eqn"><img src="../../../en/regnPred/images/s_bands.gif" width="402" height="284"></p></td>
<td width="220" align="LEFT" valign="top"><p class=heading>Constant standard deviation</p>
<p>The response may be more variable at some <em>x</em> than others.</p>
<p class="eqn"><img class="gif" src="../../../en/regnProblem/images/hetroskedastic.gif" width="246" height="166"></p></td>
</tr>
<tr>
<td align="LEFT" valign="top"><p class=heading>Normal distribution for errors</p>
<p>The errors may have skew distributions.</p>
<p class="eqn"><img class="gif" src="../../../en/regnProblem/images/skewError.gif" width="246" height="166"></p></td>
<td align="LEFT" valign="top"><p class=heading>Independent errors</p>
<p>When the observations are ordered in time, successive errors may be correlated.</p>
<p class="eqn"><img class="gif" src="../../../en/regnProblem/images/autoCorr.gif" width="246" height="166"></p></td>
</tr>
</table></div>

<p class="heading">Residual plots</p>
<p>The above problems may be evident in a scatterplot of the raw data, but a <a href="javascript:showNamedPage('leastSqrs6')">residual
plot</a> often highlights any problems.</p>
<p class="eqn"><img src="../../../en/regnProblem/images/s_residPlot.gif" width="550" height="266"> </p>
<p class="heading">Standardised residuals</p>
<p>The least squares residuals are estimates of the unknown errors and
can be used in a similar way to give information about whether there is an outlier.</p>
<p class=eqn> <img class="gif" src="../../../en/regnProblem/images/errorsDiagram.gif" width="297" height="274">    <img class="gif" src="../../../en/regnProblem/images/residualsDiagram.gif" width="297" height="274"> </p>
<p>To help assess the residuals, we usually standardise them &mdash; dividing
each by an estimate of its standard deviation.</p>
<table border="0" cellspacing="0" cellpadding="0" class="centred" style="margin-top:0; margin-bottom:0; color:#000000">
<tr>
<td rowspan="3"><strong>standardised residual </strong>&nbsp;= &nbsp;</td>
<td style="text-align:center"><em><font size="+1">e</font></em></td>
</tr>
<tr>
<td style="border-bottom:1px solid #000000" height="3px"><img src="../../../en/../images/blankSquare.gif" width="37" height="20"></p>
<p>Large residuals pull very strongly on the line since they are <strong>squared</strong> in
the least squares criterion. As a result,</p>

<div class="centred"><div class="boxed">
<p>Outliers will strongly pull the least squares line towards themselves,
making their residuals smaller than you might otherwise expect.</p>
</div></div>

<p class="heading">Leverage</p>
<p>If an outlier corresponds to an <em>x</em>-value near its mean, it usually
will have a large residual,</p>
<p class="eqn"><img src="../../../en/regnProblem/images/s_outlier.gif" width="553" height="321"> </p>
<p>If successive residuals are  similar,
<em>d</em> will be close to zero. An approximate p-value can be obtained  from
a computer, special statistical tables or with a simulation such as that below.</p>
<p class="eqn"><img src="../../../en/regnProblem/images/s_durbinWatson.gif" width="530" height="451"></p>
<p class="heading">Warning</p>
<p>If a linear model is used for a time series, but the relationship is actually
nonlinear, successive residuals also tend to be similar and the Durbin-Watson
statistic will also be small.</p>

<div class="centred"><div class="boxed">
<p>An unusually small Durbin-Watson statistic can be caused by <strong>either
serial correlation or nonlinearity</strong>.</p>
</div></div>





</html>
