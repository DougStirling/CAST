<!DOCTYPE HTML>
<html>
<head>
	<title>Residual plots</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="regression model, linear model, curvature, outliers">
	<meta name="dataset" content="GDP in the USA">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Detecting problems with the model</p>
<p>If outliers or curvature are present in a data set, they are often visible 
    in a scatterplot of the response against the explanatory variable. However 
    these features are usually clearer if the <strong>residuals</strong> are plotted 
    against <i>X</i> rather than the original response.</p>
  <div class="centred"><div class="boxed">
  	<p>Plot residuals against X to look for problems 
  		in the model</p>
</div></div>
	
	<div class="diagram">

		<p class="heading">Gross Domestic Product in the USA</p>

		
<p>The scatterplot below shows how GDP has increased in the USA since 1960. The 
GDP has been measured in billion US dollars, corrected for inflation by expressing 
it in terms of 1996 dollars. We will use a linear model to try to describe how 
GDP has increased over time.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="300">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="regnProg.ResidualPlotApplet">
<param name="yVarName" value="GDP">
<param name="yUnits" value="billion dollars">
<param name="xVarName" value="Year">
<param name="yValues" value="2376.7 2432 2578.9 2690.4 2846.5 3028.5 3227.5 3308.3 3466.1 3571.4 3578 3697.7 3898.4 4123.4 4099 4084.4 4311.7 4511.8 4760.6 4912.1 4900.9 5021 4919.3 5132.3 5505.2 5717.1 5912.4 6113.3 6368.4 6591.8 6707.9 6676.4 6880 7062.6 7347.7 7543.8 7813.2 8159.5 8508.9 8856.5 9224 9332.3">
<param name="xValues" value="1960 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001">
<param name="vertAxis" value="2000 9500 2000 1000">
<param name="horizAxis" value="1960 2002 1960 10">
<param name="residAxis" value="-600 900 -600 200">
</applet>
</div>

		<p>The relationship seems reasonably linear until a least squares line is 
			drawn on the scatterplot of the raw data. The curvature in the relationship 
			is highlighted in the residual plot on the right.</p>
		<p>A simple linear model under-estimates GDP between 1970 and the early-1990s (the 
			residuals are negative) and over-estimates GDP at both ends of the series 
			(positive residuals). Due to the under-estimation in recent years, using 
			the linear model to predict into the future would be ill-advised.</p>
		<p>We will examine solutions to the problem of nonlinearity in the next section.
</p>
		<p class="heading">Residual plots and violated model assumptions</p>
		<p>The first example below shows a data set that satisfies the assumptions for 
			a normal linear model.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="600" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="loessProg.FitResid2Applet">
<param name="xVarName" value="Explanatory, x">
<param name="yVarName" value="Response, y">
<param name="horizAxis" value="0 41 0 10">
<param name="vertAxis" value="0 65 0 60">
<param name="residAxis" value="-10 14 -10 5">
<param name="decimals" value="3">
<param name="dataName0" value="Normal linear model OK">
<param name="xValues0" value="0.60 0.84 2.03 4.00 5.03 7.11 7.49 7.92 8.60 9.13 9.65 12.16 13.45 13.50 13.73 14.25 14.77 15.37 15.48 15.75 15.77 16.80 16.98 17.09 17.61 18.27 19.36 22.29 23.27 24.31 26.66 27.98 29.64 29.92 31.64 32.66 33.30 35.76 37.35 39.63">
<param name="yValues0" value="2.82 4.29 4.25 5.08 12.49 14.23 16.61 15.11 10.76 20.29 13.13 20.37 22.23 18.91 26.65 22.77 23.86 28.95 25.69 30.42 22.94 24.74 26.15 19.86 23.05 30.36 27.13 35.05 31.40 36.41 35.39 40.86 45.75 46.47 46.39 47.93 43.74 56.56 48.05 55.66">
<param name="dataName1" value="Curvature">
<param name="yValues1" value="1.18 6.72 2.46 3.17 4.92 6.27 5.42 4.03 9.31 5.46 5.52 5.78 11.39 9.52 12.06 11.98 12.64 11.91 12.14 13.02 9.66 13.28 14.64 15.96 13.73 19.77 19.79 21.71 23.53 23.59 35.98 33.91 36.95 41.15 38.80 47.23 44.51 54.63 57.99 61.81">
<param name="dataName2" value="Variance increases with X">
<param name="yValues2" value="2.53 2.90 4.70 6.97 8.08 10.45 11.73 12.92 14.90 13.95 14.32 22.57 21.11 18.97 18.82 18.91 24.60 23.87 24.70 25.55 24.18 28.62 27.66 25.38 27.51 25.22 29.63 32.90 30.16 31.32 42.69 40.14 47.17 40.67 47.74 43.17 53.57 51.47 48.48 65.03">
<param name="dataName3" value="Time series: errors autocorrelated">
<param name="xValues3" value="1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40">
<param name="yValues3" value="2.30 2.16 9.08 7.99 8.81 7.34 8.70 12.51 13.85 14.00 15.74 16.18 15.36 16.86 14.03 14.31 18.06 20.82 23.63 25.67 29.20 33.30 37.87 39.28 38.09 39.30 39.25 43.56 43.88 45.79 44.99 46.11 49.76 52.73 52.37 52.21 55.42 54.95 54.85 54.10">
<param name="customText" value="Fitted y=Fitted y#Actual y=Actual y">
</applet>
</div>
		<p>Observe that the plot of residuals against <em>X</em> is a horizontal band 
			of constant width. (Click on any point to see how the residual relates to the 
			plot of the raw data on the left.)</p>
		<p>Select other data sets from the pop-up menu at the top. These are data sets 
			for which different linear model assumptions are violated. Observe how the problems 
			are reflected in the residual plots.</p>
	</div>


<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
