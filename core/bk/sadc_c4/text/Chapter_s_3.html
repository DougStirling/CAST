<html>
<head>
  <title>3. Estimating Parameters</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="../../../structure/printStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/summaryStyles.css" type="text/css">
  <script src="../../../structure/videoControls/jquery.js"></script>
  <script src="../../../structure/printFixes.js"></script>
</head>

<body id="body" onLoad="showPrintDialog(true)">
<div id='overlay'>
	<div id='dialogWindow'>
		<div class='printDialog'>
			<script type='text/javascript'>
				document.write("<div class='heading'>" + top.document.title + "</div>");
				if (top.url != null) {
					document.write("<p class='text'>A version of this chapter has already been generated in PDF format and we recommend that it is used for printing. The button below will download and display it.</p>");
					document.write("<p><button onClick='top.showPdf()'>Show PDF version of chapter</button></p>");
					document.write("<p class='text'>However downloading could be slow depending on your internet connection. If this is a problem, click the button below to print the chapter without downloading (but perhaps not formatted as well as the PDF version).</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>If you are <strong>not</strong> using the PDF version, the best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
				else {
					document.write("<p class='text'>Click the button below to print this chapter.</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>The best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
			</script>
			
			<p class='text'>If you don't want to print now,</p>
			<p><button onClick='top.showPrintDialog(false)'>Browse formatted chapter</button></p>
		</div>
	</div>
</div>
<h1 class="chapterName">Chapter 3 &nbsp; Estimating Parameters</h1>
<h1 class="sectionName">3.1 &nbsp; Simulation and bootstrap</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Need for simulation</li>
<li>Error distribution by simulation</li>
<li>Simulations with normal distns</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='4'>
<li>Bootstrap error distribution</li>
<li>Standard error of correlation</li>
<li>CIs from simulation</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">3.1.1 &nbsp; Need for simulation</h2><!DOCTYPE HTML>


<p class=heading>Standard errors and CIs from formulae</p>
	<p>If a formula can be found for the standard error of an estimator, an approximate 95% confidence interval can be found 
	from</p>
	
<div class="centred"><div class="boxed">
<p><span class="bold black em">estimate</em> - 2 <em>s.e.</em><em>&nbsp; </em><strong>&nbsp;to</strong><em> &nbsp;&nbsp;estimate</em> + 2 <em>s.e.</span></p>
</div></div>

	<p>For some estimators, there is no formula for the standard error, so a different approach is needed.</p>
	<p class=heading>Rainfall example</p>
	<p>Understanding of the distribution of rainfall lets farmers make better choices about the crops 
		that are grown and when they are planted, especially in areas prone to drought. A useful summary is the <strong>upper quartile</strong> of the rainfall distribution in a month &mdash; the rainfall that is exceeded in only 1 out of 4 years.</p>
	<p>The diagram below shows October rainfall in Samaru, Nigeria for the 56 years between 1928 
		and 1983.</p>
	<p class=eqn><img class="gif" src="../../../en/estOther/images/samaruOctUQ.gif" id="gif_image_1_1_1" width="397" height="130"><iframe class="svg" src="../../../en/estOther/images/samaruOctUQ.svg" id="svg_image_1_1_1" width="397" height="130" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_1_1");</script></p>
	<p>Assuming that there is no climate change, the sample upper quartile is our best point estimate of the upper quartile for the underlying population distribution, but there is no  convenient formulae for its standard error.</p>




<h2 class="pageName">3.1.2 &nbsp; Error distribution by simulation</h2><!DOCTYPE HTML>


<p class="heading">Standard error of a proportion</p>
	<p>If statistical theory does <strong>not</strong> provide 
		the error distribution for the estimator of interest, 
		a <strong>simulation</strong> can often be used to find properties of the 
		error distribution numerically.</p>
	<p>This methodology is illustrated with a simulation to find the 
		standard error of a sample proportion. Since we already have a formula,</p>
	<p class=eqn><span style="position:relative; top:-14px"><span class="black"><em>standard error</em>&nbsp;&nbsp;=&nbsp;&nbsp;</span></span><img src="../../../en/../images/symbol.seP.png" width="80" height="44" align="baseline"></p>
	<p> a simulation is  unnecessary, but it allows us to simply illustrate the method. </p>
	<p class="heading">Example</p>
	<p>A sample of <em>n</em> = 36 values are selected from a population with probability π of success, so the number of successes will have a binomial distribution,</p>
	<p class=eqn><span class="black"><em>X</em>&nbsp; ~ &nbsp;<font face="Arial, Helvetica, sans-serif">binomial</font> (<em>n</em> = 36, &nbsp;&pi;)</span></p>
<p>If we knew the value of π, we could take repeated samples from this binomial distribution, find the estimation 
		error, (<em>p</em>&nbsp;-&nbsp;π) 
	for each sample, and build up the error distribution.</p>
<p>If <em>x</em> = 17 successes are observed, our best estimate of π is  <em>p</em> =<sup>&nbsp;17</sup>/<sub>36</sub>&nbsp;=&nbsp;0.472, so we could perform this simulation using <em>p</em> instead of π.</p>
<p class="eqn"><img src="../../../en/estOther/images/s_binomSim.gif" width="339" height="240"></p>
<p>This simulation of 100 samples provides approximations to the bias (-0.004) and standard error (0.080) for this type of estimator. These are  fairly close to the values  from the formulae,</p>
<p class=eqn><span style="position:relative; top:-14px"><em>bias</em>&nbsp; =&nbsp; 0<br><em>standard error</em>&nbsp; =&nbsp; </span><img src="../../../en/../images/symbol.seP.png" width="80" height="44" align="baseline"><span style="position:relative; top:-14px">&nbsp; =&nbsp; 0.0832</span></p>
<p>In practice, the formula would be used for the standard error of a proportion, but we can use simulations for other examples where a formula does not exist.</p>

	


<h2 class="pageName">3.1.3 &nbsp; Simulations with normal distns</h2><!DOCTYPE HTML>


<p class="heading">Normal distribution parameters</p>
	<p>The mean, µ, 
		of normal populations is usually of most interest, but we may also want to estimate:</p>
	<ul>
		<li>standard deviation</li>
		<li>interquartile range (upper quartile - lower quartile)</li>
		<li>median</li>
		<li>other percentiles (e.g. the upper quartile)</li>
	</ul>
	<p>The corresponding sample statistics provide point estimates of these parameters, but formulae for standard errors may be difficult to find.</p>
	<p class="heading">Simulation</p>
	<p>If the values of µ 
	and σ were known, we could perform a simulation with repeated samples to find the error distribution for the type of estimate that we were using. The standard deviation of the error distribution gives the standard error of the estimate.</p>
	<p>In practice, µ 
	and σ are unknown, but we can perform a similar simulation, replacing them with the sample mean and standard deviation.</p>
	<p class=heading>Example</p>
<p>We want to  how long one in four silkworm larvae will survive a certain dose of poison &mdash; i.e the <strong>upper quartile</strong> of the distribution of survival times. The diagram below shows the survival times of a sample of 80 larvae and the point estimate of the upper quartile.</p>
<p class=eqn><img class="gif" src="../../../en/estOther/images/silkwormUQ.gif" id="gif_image_1_3_2" width="396" height="136"><iframe class="svg" src="../../../en/estOther/images/silkwormUQ.svg" id="svg_image_1_3_2" width="396" height="136" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_3_2");</script></p>
<p>The survival times have a fairly symmetric distribution and the diagram below 
		shows a normal distribution whose mean and standard deviation are the same as those 
		of our actual data.</p>
	<p class=eqn><img class="gif" src="../../../en/estOther/images/silkwormModel.gif" id="gif_image_1_3_1" width="388" height="128"><iframe class="svg" src="../../../en/estOther/images/silkwormModel.svg" id="svg_image_1_3_1" width="388" height="128" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_3_1");</script></p>
	<p>This approximate normal distribution has upper quartile 293.3, so we can perform a simulation with samples of <em>n</em> = 80 values from this distribution and find how far the sample upper quartiles are from this theoretical value &mdash; the error distribution.</p>
	<p class="eqn"><img src="../../../en/estOther/images/s_normalSim.gif" width="339" height="240"></p>
	<p>From the 70-95-100 rule-of-thumb, the error has approximately 95% chance of being within 2 s.e. of 
	zero and will be almost certainly within 3 s.e. of zero. This means that  our point estimate of the upper quartile (292 secs) is likely to be less than 9 sec from the underlying population parameter and will be almost certain to be less than 13.5 sec from it.</p>




<h2 class="pageName">3.1.4 &nbsp; Bootstrap error distribution</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Bootstrap simulation</p>
	<p>The simulations can be based on random samples from any approximation to the population distribution. If a normal approximation does not seem reasonable, the actual data can be used as an approximate 'population' and random samples selected <strong>with replacement</strong> from it. Such 
	samples are called <strong>bootstrap samples</strong>.</p>
<p>A simulation with these bootstrap samples can again show the error distribution 
		and provide approximate values for the bias and standard error.</p>
	<p class=heading>Example</p>
	<p>The October rainfall data below is highly skew, so a normal approximation should not be used to generate simulated samples.</p>
	<p class=eqn><img class="gif" src="../../../en/estOther/images/samaruOctUQ.gif" id="gif_image_1_4_1" width="397" height="130"><iframe class="svg" src="../../../en/estOther/images/samaruOctUQ.svg" id="svg_image_1_4_1" width="397" height="130" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_4_1");</script></p>
	<p>A typical bootstrap sample is shown below:</p>
	<p class="eqn"><img src="../../../en/estOther/images/s_bootstrapSamp.gif" width="319" height="155"></p>
	<p>The diagram below shows the 'errors' from 100 of these simulated bootstrap samples &mdash; the differences between the sample upper quartiles and that from the 'population' underlying the simulation, 57.4.</p>
	<p class="eqn"><img src="../../../en/estOther/images/s_bootstrapSim.gif" width="339" height="292"></p>
<p>Using the 70-95-100 rule-of-thumb, our point estimate of the upper quartile, 57.4, is unlikely to be in error by more than about 20.</p>




<h2 class="pageName">3.1.5 &nbsp; Standard error of correlation</h2><!DOCTYPE HTML>


<p class="heading">Bivariate data</p>
	<p>Bootstrap sampling can be used to obtain an approximate error distribution in any situation where individuals are randomly sampled from a population. The scatterplot below shows a bivariate data set.</p>
	<p class="eqn"><img src="../../../en/estOther/images/s_scatter.gif" width="365" height="297"></p>
	<p>How accurately does the sample correlation coefficient, <em>r</em> = 0.787, estimate the underlying population correlation underlying the data?</p>
	<p class="heading">Bootstrap</p>
	<p>We can again find an approximate error distribution using bootstrap samples selected with replacement from the data. The scatterplot below describes one such bootstrap sample. The digits again represent data values that were sampled more than once.</p>
	<p class="eqn"><img src="../../../en/estOther/images/s_scatterBoot.gif" width="365" height="297"></p>
	<p>From each of several bootstrap samples, we can find how far their correlation coefficient is from the &quot;population&quot; value, 0.787 &mdash; the estimation error.</p>
	<p class="eqn"><img src="../../../en/estOther/images/s_scatterBootSim.gif" width="348" height="258"></p>
	<p>The bootstrap error distribution provides us with an approximate standard error for the correlation coefficient. The correlation coefficient from our data set, 0.787, will probably be within 2 standard errors (approx 0.065) of the underlying population value.</p>




<h2 class="pageName">3.1.6 &nbsp; CIs from simulation</h2><!DOCTYPE HTML>


<p class="heading">Confidence intervals</p>
	<p>If we can find an approximate value for the standard error of an estimator, whether by formula or a simulation, an approximate 95% confidence interval can be found,</p>
	<p class="eqn"><span class="bold black em">estimate</em> - 2 <em>s.e.</em><em>&nbsp; </em><strong>&nbsp;to</strong><em> &nbsp;&nbsp;estimate</em> + 2 <em>s.e.</span>  </p>
	<p>However the standard errors for some estimators cannot be so easily derived 
		(or cannot be evaluated by readily available software).</p>
	<p class=heading>Silkworm poisoning</p>
	<p>We again consider estimation of the upper quartile of the survival times of silkworms after poisoning.</p>
	<p class=eqn><img class="gif" src="../../../en/estOther/images/silkwormUQ.gif" id="gif_image_1_6_2" width="396" height="136"><iframe class="svg" src="../../../en/estOther/images/silkwormUQ.svg" id="svg_image_1_6_2" width="396" height="136" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_6_2");</script></p>
	<p>We again take several simulated samples from from a normal distribution with the same mean and standard deviation as the data,</p>
	<p class=eqn><img class="gif" src="../../../en/estOther/images/silkwormModel.gif" id="gif_image_1_6_1" width="388" height="128"><iframe class="svg" src="../../../en/estOther/images/silkwormModel.svg" id="svg_image_1_6_1" width="388" height="128" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_6_1");</script></p>
	<p>The diagram below shows the distribution of estimation errors from 200 such samples:</p>
	<p class="eqn"><img src="../../../en/estOther/images/s_uqCiSim.gif" width="348" height="258"></p>
	<p>We could use the standard deviation of these errors as the standard error to find a 95% confidence interval, but an alternative is to observe that 95% of the errors are between -9.0 and +9.0, so a 95% confidence interval would be</p>
	<p class="eqn">292 - 9.0   to   292 + 9.0</p>
	<p class="eqn">283.0   to   301.0</p>
	
<div class="centred"><div class="boxed">
<p>We are 95% confident that the underlying upper quartile <strong>is between <span class="eqn">283 and 301.</span></strong></p>
</div></div>

	



</html>
