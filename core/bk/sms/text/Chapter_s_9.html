<!DOCTYPE HTML>
<html>
<head>
  <title>9. General Modelling Ideas</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="../../../structure/summaryStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/maths/mathStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/printStyles.css" type="text/css">
  <script src="../../../structure/videoControls/jquery.js"></script>
  <script src="../../../structure/maths/theorems.js"></script>
  <script src="../../../structure/maths/mathJax/MathJax.js?config=TeX-AMS-MML_SVG,statMacros.js"></script>
  <script src="../../../structure/printFixes.js"></script>
</head>

<body id="body" onLoad="showPrintDialog(true)">
<div id='overlay'>
	<div id='dialogWindow'>
		<div class='printDialog'>
			<script type='text/javascript'>
				document.write("<div class='heading'>" + top.document.title + "</div>");
				if (top.url != null) {
					document.write("<p class='text'>A version of this chapter has already been generated in PDF format and we recommend that it is used for printing. The button below will download and display it.</p>");
					document.write("<p><button onClick='top.showPdf()'>Show PDF version of chapter</button></p>");
					document.write("<p class='text'>However downloading could be slow depending on your internet connection. If this is a problem, click the button below to print the chapter without downloading (but perhaps not formatted as well as the PDF version).</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>If you are <strong>not</strong> using the PDF version, the best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
				else {
					document.write("<p class='text'>Click the button below to print this chapter.</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>The best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
			</script>
			
			<p class='text'>If you don't want to print now,</p>
			<p><button onClick='top.showPrintDialog(false)'>Browse formatted chapter</button></p>
		</div>
	</div>
</div>
<h1 class="chapterName">Chapter 9 &nbsp; General Modelling Ideas</h1>
<h1 class="sectionName">9.1 &nbsp; Groups and regression</h1>
<h2 class="pageName">9.1.1 &nbsp; Additional variables in regression</h2>

<p class="heading">Three or more variables</p>
	<p>We previously described the relationship between two numerical variables, <em>X</em> and <em>Y</em>.</p>
	<ul>
		<li>The correlation coefficient summarises the strength of their relationship.</li>
		<li>The least squares line summarises the 'shape' of the relationship &mdash; it 
			can be used to predict <em>Y</em> from <em>X</em>.</li>
	</ul>
	<p>In many applications, more than two measurements are made from each individual and the  additional variables may throw light on the relationship.</p>
	<p>Use of this extra information may lead to  more accurate predictions of <em>Y</em>.</p>




<h2 class="pageName">9.1.2 &nbsp; Displaying groups</h2>

<p class="heading">Distinguishing groups in a  scatterplot</p>
	<p>We now consider  how a categorical variable, <em>Z</em>, can  help explain the relationship between two numerical variables, <em>X</em> and <em>Y</em>. It equivalently examines whether the relationship between <em>X</em> and <em>Y</em> is the same in each of several groups.</p>
	<p>As in most other situations, data analysis should  start by examining the data graphically. Differences between the groups can be shown with different symbols and/or colours for the crosses in a scatterplot of  <em>Y</em> against <em>X</em>.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_scatterGroups.gif" width="419" height="395"></p>




<h2 class="pageName">9.1.3 &nbsp; Regression with grouped data</h2>

<p class="heading">Least squares in each group</p>
	<p>We can separately examine the relationship between <em>X</em> and <em>Y</em> in each group (or equivalently for each value of a categorical variable, <em>Z</em>). If the 
		relationship between <em>X</em> and <em>Y</em> is different in the different groups, this 
	should lead to more accurate predictions of <em>Y</em> from <em>X</em>.</p>
	<p>A regression line can be separately fitted by least squares in each group.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_twoLines.gif" width="458" height="382"></p>





<h2 class="pageName">9.1.4 &nbsp; Parallel regression lines</h2>

<p class="heading">Separate   regression lines</p>
	<p>The problem with fitting separate regression lines by least squares in the different groups is that it is difficult to concisely explain the difference between the groups &mdash; the difference between the predicted response in the groups  depends on the value of the explanatory variable.</p>
	<p class="eqn"><img class="gif" src="../../../en/regnGroups/images/twoLines.gif" id="gif_image_1_4_2" width="313" height="274"><iframe class="svg" src="../../../en/regnGroups/images/twoLines.svg" id="svg_image_1_4_2" width="313" height="274" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_4_2");</script></p>
	<p class="heading">Parallel regression lines</p>
	<p>Interpretation is considerably simplified if we constrain the  regression lines for the different groups to have the same slope. In the diagram below, the difference between the groups is the same for all values of <em>X</em>.</p>
	<p class="eqn"><img class="gif" src="../../../en/regnGroups/images/parallelLines.gif" id="gif_image_1_4_1" width="313" height="274"><iframe class="svg" src="../../../en/regnGroups/images/parallelLines.svg" id="svg_image_1_4_1" width="313" height="274" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_4_1");</script></p>
	<p>Parallel lines are not appropriate descriptions of all data sets. Always check a scatterplot first.</p>
	<p class="heading">Least squares</p>
	<p>The principle behind fitting  parallel lines to two or more groups is the same as in ordinary simple regression &mdash; we choose the parameters to minimise the sum of squared residuals (vertical distances between the data crosses and their corresponding line). The resulting formulae are complicated, but most statistical software will do the calculations for you.</p>





<h2 class="pageName">9.1.5 &nbsp; Transformed variables and groups</h2>

<p class="heading">Transformation of the response</p>
	<p>It is much easier to interpret the parameters when parallel lines are fitted to different groups than when their slopes are different, but the data or the context may not justify such a simplification.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_beforeLog.gif" width="436" height="331"></p>
	<p>After a nonlinear transformation of the response, the relationships in the two groups may be closer to parallel. A  transformation to reduce skewness in the reponse often works well.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_afterLog.gif" width="436" height="331"></p>
	<p class="heading">Understanding the model for ln(<em>y</em>)</p>
	<p>Logarithmic transformations are particularly useful because the parallel least squares lines have a simple interpretation. For the above data they are:</p>
	<p align="center">Female:    ln (<em>y</em>) = 0.391 + 0.0747 <em>x<br>
	</em>Male:       ln (<em>y</em>) = 1.192 + 0.0747 <em>x</em></p>
	<p>This means that:</p>
	<div class="centred"><div class="boxed">
		<p><em>ln(y) </em> is (1.192&nbsp;-&nbsp;0.391)&nbsp;=&nbsp;0.801 higher for females than for males with the same <em>x</em>.</p>
	</div></div>
	<p>We can now concisely summarise the difference between males and females:</p>
	<div class="centred"><div class="boxed">
		<p><em>y </em> for females is e<sup>0.810</sup>&nbsp;=&nbsp;2.23 times that for males with the same <em>x</em>.</p>
	</div></div>




<h2 class="pageName">9.1.6 &nbsp; Grouping with a numerical variable</h2>

<p class="heading">Definition of groups</p>
	<p>A categorical variable naturally splits the individuals into groups, but a numerical variable, <em>Z</em>, can also be used to define groups.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_groupedNum.gif" width="432" height="346"></p>




<h2 class="pageName">9.1.7 &nbsp; Displaying groups</h2>

<p class="heading">Distinguishing groups in a scatterplot matrix</p>
	<p>A scatterplot matrix can help to describe the relationships between 3 or more numerical variables. If each individual belongs to one of several known groups, different symbols or colours can be used to distinguish the groups.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_scatMatrix.gif" width="520" height="495"></p>




<h1 class="sectionName breakBefore">9.2 &nbsp; Multiple regression</h1>
<h2 class="pageName">9.2.1 &nbsp; More than one explanatory variable</h2>

<p class="heading">Response and explanatory variables</p>
	<p>We are often interested in how 
		a  'response' variable, <em>Y</em>, depends on other explanatory variables. If there is a <strong>single</strong> explanatory variable, <em>X</em>,  we can predict <em>Y</em> from <em>X</em> with a simple linear model of the form,</p>
	<p class=eqn><span class="black"><em>y</em> &nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></span>
	<p>However if other explanatory variables have been recorded from each individual,  we should be able to use them to predict the response more accurately.</p>
	



<h2 class="pageName">9.2.2 &nbsp; Multiple regression equation</h2>

<p class="heading">Adding extra variables</p>
	<p>A simple linear model for a single explanatory variable,</p>
	<p class=eqn><span class="black"><em>y</em> &nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></span>
	<p>can be easily extended to describe the effect of a  second explanatory variable, <em>Z</em>, with an extra linear term,</p>
	<p class="eqn"><span class="black"><em>y</em> &nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em> + <em>b</em><sub>2 </sub><em>z</em></span></p>
	<p>and so on with more explanatory variables,</p>
	<p class="eqn"><span class="black"><em>y</em> &nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em> + <em>b</em><sub>2 </sub><em>z</em> + <em>b</em><sub>3 </sub><em>w</em> + ...</span></p>
	<p>This type of model is called a <strong>multiple regression</strong> model.</p>
	<p class="heading">Coefficients</p>
	<p>Despite our use of the same symbols (<em>b</em><sub>0</sub>, <em>b</em><sub>1</sub>, ...) for all three models above, their 'best' values are often different for the different models. An example will be given in the next page.</p>




<h2 class="pageName">9.2.3 &nbsp; Interpreting coefficients</h2>

<p class="heading">Marginal and conditional relationships</p>
	<p>In a linear model that predicts a response from several explanatory variables, the least squares coefficient associated with any explanatory variable describes its effect on the response <strong>if all other variables are held constant</strong>. 
		This is also called the variable's <strong>conditional effect</strong> on 
		the response.</p>
	<p>This may be very different from the size and even the sign of the coefficient when a linear model is fitted with <strong>only that single explanatory variable</strong>. This simple linear model describes the <strong>marginal</strong> relationship between the response and that variable.</p>
	<p class="heading">Example</p>
	<p>In a model for predicting the percentage body fat of men, the best model (as determined by least squares) in a simple model with <em>weight</em>, is</p>
	<p class="eqn"><em>Predicted body fat</em>   =   -10.00  +  0.162 <em>Weight</em></p>
	<p>However if we add <em>Abdomen circumference</em> to the model, the best values for the coefficients are</p>
	<p class="eqn"><em>Predicted body fat</em>   =   -41.35  -  0.136 <em>Weight</em>  +  0.915 <em>Abdomen</em></p>
	<ul>
		<li>For each 1lb extra <em>Weight</em>, men have, on average, 0.162% <strong>more</strong> body fat.</li>
		<li>For each 1lb extra <em>Weight</em>, men have, on average, 0.136% <strong>less</strong> body fat <strong>than others with the same <em>Abdomen circumference</em></strong>.</li>
	</ul>




<h2 class="pageName">9.2.4 &nbsp; Least squares estimation</h2>

<p class="heading">Goal of small residuals</p>
	<p>When fitting a model to data, the  fitted values are unlikely to match exactly the observed response values 
		and the prediction 'errors' are  the residuals, </p>
	<p class="eqn"><span class="red"><em>e</em><sub><em>i</em></sub></span> <span class="black">&nbsp;=&nbsp; <em>y<sub>i</sub></em> &minus;</span> <span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yiHatBlue.png" width="11" height="18" align="baseline"></span></p>
	<p>'Small' residuals are desirable.</p>
	<p class="heading">Least squares</p>
	<p>The size of the residuals is described by their sum of squares,</p>
	<p class="eqn"><span class="black">SS<sub>Residual</sub></span> &nbsp;<span style="position:relative; top:7px"><img class="gif" src="../../../en/multiRegn/images/residSsqMulti.gif" id="gif_image_2_4_1" width="110" height="29"><iframe class="svg" src="../../../en/multiRegn/images/residSsqMulti.svg" id="svg_image_2_4_1" width="110" height="29" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_2_4_1");</script></span><span class="black"></span> &nbsp;<span style="position:relative; top:11px"><img class="gif" src="../../../en/multiRegn/images/residSsq2Multi.gif" id="gif_image_2_4_2" width="222" height="37"><iframe class="svg" src="../../../en/multiRegn/images/residSsq2Multi.svg" id="svg_image_2_4_2" width="222" height="37" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_2_4_2");</script></span></p>
<p>The least squares estimates of <em>b</em><sub>0</sub>, <em>b</em><sub>1</sub> and <em>b</em><sub>2</sub> are the values that minimise this.</p>
	<p class="eqn"><img src="../../../en/multiRegn/images/s_redSquares.gif" alt="" width="428" height="342"></p>
	<p>The solution can be obtained algebraically but the formulae are relatively complex and a computer should be used to evaluate the least squares estimates.</p>




<h1 class="sectionName breakBefore">9.3 &nbsp; All-or-nothing anova (Optional)</h1>
<h1 class="sectionName breakBefore">9.4 &nbsp; Sequential sums of squares (Optional)</h1>
<h1 class="sectionName breakBefore">9.5 &nbsp; Logistic regression</h1>
<h2 class="pageName">9.5.1 &nbsp; Categorical responses</h2>

<p class="heading">Comparing the response distributions at different
x-values</p>
	<p>If a response, <em>Y</em>, is numerical and  explanatory variable, <em>X</em>,
is categorical, box plots can be used to compare the response distribution at
the different <em>x</em>-values.</p>
<p class=eqn><img class="gif" src="../../../en/logistic/images/incomeEducBox.gif" id="gif_image_5_1_1" width="176" height="183"><iframe class="svg" src="../../../en/logistic/images/incomeEducBox.svg" id="svg_image_5_1_1" width="176" height="183" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_5_1_1");</script></p>
	<p>If the response, <em>Y</em>, is categorical and the explanatory variable,
<em>X</em>,  is numerical, we are again interested in comparing the response
distribution at different <em>x</em>-values.
We might use <em>X</em> to define 'groups' by splitting its values
into classes (as might be done to draw a histogram) and this allows us to use
stacked bar charts to describe the relationship.</p>
<p class=eqn><img class="gif" src="../../../en/logistic/images/incomePensionStacked.gif" id="gif_image_5_1_2" width="173" height="162"><iframe class="svg" src="../../../en/logistic/images/incomePensionStacked.svg" id="svg_image_5_1_2" width="173" height="162" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_5_1_2");</script> </p>
	<p>It is not necessary for the 'classes' to be of equal width. For example, some of the age groups below are of width 3 months, whereas others are 6 months and the extreme classes are wider still.</p>
	<p class="eqn"><img src="../../../en/logistic/images/s_stackedBars.gif" width="550" height="289"></p>




<h2 class="pageName">9.5.2 &nbsp; Fitted values and predictions</h2>

<p class="heading">Linear model</p>
	<p>It is tempting to try a  linear
		model to explain how the proportion in one response category is affected by the explanatory
	variable, </p>
<p class=eqn style="color:#000000"><strong>predicted proportion</strong>, &nbsp; <img class="gif" src="../../../en/logistic/images/linearPredictEqn.gif" id="gif_image_5_2_1" width="104" height="24"><iframe class="svg" src="../../../en/logistic/images/linearPredictEqn.svg" id="svg_image_5_2_1" width="104" height="24" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_5_2_1");</script></p>
	<p>Unfortunately this may result in predicted proportions greater than 1 or less than 0.</p>
	<p class="eqn"><img src="../../../en/logistic/images/s_linearModel.gif" width="506" height="322"></p>
	<p class="heading">Nonlinear models</p>
	<p>We should use a model that gives values between 0 and 1<strong> for all possible
values of <em>X</em></strong>. This means that the equation must be <strong>nonlinear</strong> in <em>X</em>.</p>
	<p class="eqn"><img src="../../../en/logistic/images/s_logisticModel.gif" width="506" height="322"></p>




<h2 class="pageName">9.5.3 &nbsp; Logistic curve</h2>

<p class="heading notPrinted">A curve that lies between 0 and 1 for all values of x</p>
	<p>Various 
		nonlinear equations have values between 0 
		and 1 for all values of <em>x</em>, but the simplest of these is a <strong>logistic 
			curve</strong>, </p>
	<p class=eqn style="color:#000000"><strong>predicted proportion</strong>, &nbsp; <img class="gif" src="../../../en/logistic/images/logisticPredEqn.gif" id="gif_image_5_3_1" width="196" height="51"><iframe class="svg" src="../../../en/logistic/images/logisticPredEqn.svg" id="svg_image_5_3_1" width="196" height="51" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_5_3_1");</script></p>
	<p class="heading">The parameters of the logistic curve</p>
	<p>The parameter <em>b</em><sub>1</sub> is called the <strong>slope</strong> of the curve. Increasing it makes the curve steeper, and 
	its sign determines whether the curve slopes upwards or downwards.</p>
<p class="eqn"><img src="../../../en/logistic/images/s_slope.gif" width="407" height="259"></p>
	<p>The parameter <em>b</em><sub>0</sub> is the curve's <strong>intercept</strong> and it determines the horizontal position of the curve. Increasing it shifts the curve 
	to the left.</p>
<p class="eqn"><img src="../../../en/logistic/images/s_intercept.gif" width="407" height="259"></p>




<h2 class="pageName">9.5.4 &nbsp; Obtaining a good fit</h2>

<p class="heading notPrinted">Estimating the logistic parameters</p>
	<p>Estimating the parameters <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub> of a logistic model is more difficult than estimating the parameters for a linear model by least squares, but  many statistical programs will do the appropriate calculations for 
	you.</p>
	<p>We therefore take a 'black box' approach and simply show what parameter estimation 
		gives without further justification. </p>
	<p class="eqn"><img src="../../../en/logistic/images/s_maxLikelihood.gif" width="404" height="334"></p>




</body>
</html>
