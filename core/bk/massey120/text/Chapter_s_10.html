<!DOCTYPE HTML>
<html>
<head>
  <title>10. More Exploratory Graphics</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="../../../structure/summaryStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/maths/mathStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/printStyles.css" type="text/css">
  <script src="../../../structure/videoControls/jquery.js"></script>
  <script src="../../../structure/maths/theorems.js"></script>
  <script src="../../../structure/maths/mathJax/MathJax.js?config=TeX-AMS-MML_SVG,statMacros.js"></script>
  <script src="../../../structure/printFixes.js"></script>
</head>

<body id="body" onLoad="showPrintDialog(true)">
<div id='overlay'>
	<div id='dialogWindow'>
		<div class='printDialog'>
			<script type='text/javascript'>
				document.write("<div class='heading'>" + top.document.title + "</div>");
				if (top.url != null) {
					document.write("<p class='text'>A version of this chapter has already been generated in PDF format and we recommend that it is used for printing. The button below will download and display it.</p>");
					document.write("<p><button onClick='top.showPdf()'>Show PDF version of chapter</button></p>");
					document.write("<p class='text'>However downloading could be slow depending on your internet connection. If this is a problem, click the button below to print the chapter without downloading (but perhaps not formatted as well as the PDF version).</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>If you are <strong>not</strong> using the PDF version, the best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
				else {
					document.write("<p class='text'>Click the button below to print this chapter.</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>The best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
			</script>
			
			<p class='text'>If you don't want to print now,</p>
			<p><button onClick='top.showPrintDialog(false)'>Browse formatted chapter</button></p>
		</div>
	</div>
</div>
<h1 class="chapterName">Chapter 10 &nbsp; More Exploratory Graphics</h1>
<h1 class="sectionName">10.1 &nbsp; Improved simple graphs</h1>
<h2 class="pageName">10.1.1 &nbsp; Splitting the stems</h2>

<p class=heading>Need for more flexibility</p>
	<p>Sometimes basic stem and leaf plots are not flexible enough
&mdash; there would be either too many or too few rows of leaves to show the varying
density well.</p>
	<p>Repeating each stem 2 times (with leaves 0-4 on the lower copy and leaves
5-9 on the upper one) or 5 times (with leaves 0-1, 2-3, 4-5, 6-7 and 8-9 on the
different copies) gives intermediate numbers of stems.</p>
	<p class="eqn"><img src="../../../en/valueDisplay/images/s_splitStems.gif" alt="" width="550" height="550"><br clear="all">
	</p>



<h2 class="pageName">10.1.2 &nbsp; Histograms with varying class widths</h2>

<p class="heading notPrinted">Varying histogram classes</p>
<p>Histograms are sometimes drawn with classes that do not all have the same width.
If this is done, it is important that...</p>
<div class="centred"><div class="boxed">
<p> The vertical axis of a histogram with mixed class widths must <span class="red">not</span> be
'frequency'.</p>
</div></div>
<p>The example below illustrates the problem:</p>
<p class="eqn"><img src="../images/s_badHisto.gif" width="500" height="423"></p>
<p>A correct histogram for these data uses the <strong>density</strong> of cars on
its vertical axis instead of the raw count &mdash; the cars <strong>per year</strong>:</p>
<p class="eqn"><img src="../images/s_goodHisto.gif" width="500" height="423"></p>





<h2 class="pageName">10.1.3 &nbsp; Histogram areas and proportions</h2>

<p class="heading notPrinted">Area and proportion of values</p>
<p>In a correctly drawn histogram, each value contributes the same area.</p>
<p class="eqn"><img src="../../../en/density/images/s_mixedClasses.gif" width="504" height="431"></p>
<p>As a result,</p>
<div class="centred"><div class="boxed">
<p>The proportion of the total area above any classes equals the proportion of values
in them.</p>
</div></div>
<p>For example,</p>
<p class="eqn"><img src="../../../en/density/images/s_mixedProbs.gif" width="456" height="292"></p>





<h2 class="pageName">10.1.4 &nbsp; Displaying outliers</h2>

<p class="heading">Outliers and skew distributions</p>
<p>Basic box plots cannot show whether the minimum and maximum in a distribution are outliers or simply the end of skew distributions.</p>
<p class="eqn"><img src="../../../en/boxPlot/images/s_outlierSkew.gif" width="453" height="236"> </p>




<h2 class="pageName">10.1.5 &nbsp; Clusters</h2>

<p class="heading notPrinted">Box plots and clusters</p>
<p>Box plots cannot show clusters in data.</p>
<p class="eqn"><img src="../../../en/boxPlot/images/s_clusters.gif" width="448" height="221"></p>
<p>Before using a box plot, always look at the data with a dot plot or histogram
to make sure that there are no clusters.</p>




<h2 class="pageName">10.1.6 &nbsp; Pareto diagrams</h2>

<p class="heading">Ordering categories</p>
<p>If the categories have a natural ordering (an <strong>ordinal</strong> categorical variable), this ordering should be used in a bar chart.</p>
	<p>For <strong>nominal</strong> categorical variables (no natural ordering),
alphabetic ordering of the categories should be avoided. It is better to sort
them in order of decreasing frequencies, giving a <strong>Pareto diagram</strong>.</p>
	<p class="heading">Detecting 'important' categories</p>
	<p>Pareto diagrams are particularly useful in industrial quality control and 
		quality improvement where information is collected about the causes of problems 
		in manufacturing processes. The <strong>Pareto principle</strong> states that:</p>
	
<div class="centred"><div class="boxed">
<p>A large percentage of instances of any problem result from a small 
				percentage of the possible causes.</p>
</div></div>

	<p>The leftmost categories in a Pareto diagram are most important. A line is usually added  showing the <strong>cumulative</strong> proportions for the different causes. For the <em>i</em>'th category, the height 
	of the line gives the proportion of problems from <strong>any</strong> of the <em>i</em> most common categories.</p>
	<p class="eqn"><img src="../../../en/univarCat/images/s_pareto.gif" width="462" height="323"></p>





<h1 class="sectionName breakBefore">10.2 &nbsp; Transformations</h1>
<h2 class="pageName">10.2.1 &nbsp; Linear transformations</h2>

<p class="heading notPrinted">Linear transformations</p>
<p>When the  values are replaced by other using
an equation of the form </p>
<p class=eqn><span class="black"><strong>new value</strong> &nbsp; = &nbsp; <em>a</em> &nbsp;+ &nbsp;<em>b</em> &nbsp;&times &nbsp;<strong>old value</strong></span> </p>
<p>we say that there has been a <strong>linear transformation</strong> of the
original values. The original and transformed data can be displayed together with <strong>dual
axes</strong>.</p>
<p class="eqn"><img src="../../../en/transform/images/s_linear.gif" width="454" height="180"></p>
<p class="heading">Centre and spread</p>
<p>The centre and spread of the data are different, but the shape of the distribution
otherwise remains unchanged. The mean and standard deviation are related:</p>
<p class=eqn><span class="black"><strong>new mean</strong> &nbsp; = &nbsp; <em>a</em> &nbsp;+ &nbsp;<em>b</em> &nbsp;&times &nbsp;<strong>old mean</strong></span></p>
<p class=eqn> <span class="black"><strong>new sd</strong> &nbsp; = &nbsp;<em><font size="+1">|</font>b<font size="+1">|</font></em> &nbsp;&times &nbsp;<strong>old sd</strong></span> </p>
<p>Note that if the scale factor, b, is negative, we must change its sign since
 the standard deviation must always be positive.</p>
<p>Most other measures of centre (e.g. the median) and spread (e.g. the interquartile
range) are similarly related.</p>




<h2 class="pageName">10.2.2 &nbsp; Log transformations</h2>

<p class="heading">Nonlinear transformations</p>
	<p>Nonlinear transformations arise when the values are replaced by a nonlinear function of the original measurements, such as their logarithm or inverse. They  have a more fundamental effect on
	the shape of a distribution than linear transformations. </p>
	<p>The most commonly used nonlinear transformation is:</p>
	<p class=eqn><span class="black"><strong>new value</strong> &nbsp; = log<sub>10</sub> <font size="+1">(</font><strong>old value</strong><font size="+1">)</font></span> </p>
	<p>Natural logarithms (base <em>e</em>) have a similar effect on the distribution
of values but base-10 logarithms are easier to interpret so we use them here.</p>
<p class="heading">Properties of logarithms</p>
	<ul>
		<li>Multiplying any value by 10 increases its logarithm by 1.</li>
		<li>Doubling any value increases its logarithm by log<sub>10</sub>(2) = 0.3010.</li>
</ul>
<p>Consider four values 1, 10, 100 and 1000. The first two values are much closer 
		to each other than the last two values. However their logarithms are 0, 1, 
		2 and 3, so their logarithms are evenly spaced out.</p>
	<p class="heading">Effect on the shape of a distribution</p>
	<p>A logarithmic transformation selectively spreads out low values 
		in a distribution and compresses high values. It is therefore useful before
analysing skew data with a long tail towards the high values. It will spread
out a dense cluster of low values and may detect clustering or outliers that
would not be visible in graphical displays of the original data.</p>
	<p class="eqn"><img src="../../../en/transform/images/s_log.gif" width="499" height="236"></p>




<h2 class="pageName">10.2.3 &nbsp; When to use log transform?</h2>

<p class="heading notPrinted">'Quantities'</p>
	<p>Logarithmic transformation can only be used for data sets consisting of positive
 values &mdash; logarithms are undefined for negative or zero values. They are therefore
particularly useful for <strong>quantities</strong> &mdash; 
		i.e. amounts of something. Indeed, many researchers <strong>routinely</strong> apply
logarithmic transformation  to quantity data before analysis.</p>
<p class="heading notPrinted">When are they effective?</p>
	<p>A log transformation affects the shape of the distribution most when the
ratio of the largest to the smallest value in the data is large. When this ratio
is less than 10 (one <strong>order of magnitude</strong>) then the transformation
has much less influence on the shape of the distribution, as in the data set
below.</p>
<p class="eqn"><img src="../../../en/transform/images/s_log2.gif" width="499" height="272"></p>




<h2 class="pageName">10.2.4 &nbsp; Power transformations</h2>

<p class="heading notPrinted">Power transformations</p>
	<p>A more general family of transformations that is flexible enough to  reduce
or eliminate the skewness in a wide range of data sets is:</p>
	<p class=eqn><img class="gif" src="../../../en/transform/images/boxCoxEqn.gif" width="409" height="106"> </p>
	<p>This family of <strong>power transformations</strong> includes many common ones:</p>
	<p class=eqn><img class="gif" src="../../../en/transform/images/powerTable.gif" width="363" height="254"></p>




<h2 class="pageName">10.2.5 &nbsp; Power transforms &amp; skewness (opt) (Optional (not examined))</h2>

<p class="heading">Effect of power transformations</p>
<p>Power transformations affect the skewness of data.</p>
<p>If a power transformation with <em>p</em> &gt; 1 is applied to data with a
symmetric distribution, it will make the data skew with a long right tail. If
the power transformation has <em>p</em> &lt; 1, the distribution will become one
with a long left tail.</p>
<p>In practice, power transformations are used to do the opposite. They can change many skewness distributions into fairly symmetric ones.</p>




<h1 class="sectionName breakBefore">10.3 &nbsp; Nonlinear relationships</h1>
<h2 class="pageName">10.3.1 &nbsp; Correlation and nonlinear relationships</h2>

<p class="heading notPrinted">Correlation and nonlinear relationships</p>
	<p>The correlation coefficient, <i>r</i>, is a good description of the strength
of a relationship <strong>provided the crosses in a scatterplot of the data are not
scattered round a curve</strong>. If the data are scattered round a curve, the relationship
is called <strong>nonlinear</strong> and <i>r</i> may seriously underestimate its
strength.</p>
<p class="eqn"><img src="../../../en/correlation/images/s_curved.gif" width="556" height="246"></p>
	
<div class="centred"><div class="boxed">
<p>The correlation coefficient does <strong>not</strong> describe
the strength of nonlinear relationships adequately.</p>
</div></div>

	



<h2 class="pageName">10.3.2 &nbsp; Transformations and correlation</h2>

<p class="heading">Correlation coefficient and nonlinear relationships</p>
	<p>The correlation coefficient, <i>r</i>, is a good description of the strength 
		of linear relationship but <a href="javascript:showNamedPage('correlation4')">not 
			nonlinear ones</a>. If a scatterplot shows marked curvature, the correlation 
		coefficient can considerably understate the strength of the relationship.</p>
	<p class="heading">Transform the variables to linearise the relationship</p>
	<p>Nonlinear transformations of X and Y alters the shape of the relationship. It is often possible 
		to linearise a relationship by transforming one or both variables.</p>
<p>The strength of a nonlinear relationship can therefore be described with the
correlation coefficient after  a transformation to one or both variables has
been applied to <strong>remove
the nonlinearity</strong>.</p>
<p class="eqn"><img src="../../../en/curvature/images/s_rawCorr.gif" width="354" height="276"><img src="../../../en/curvature/images/s_logCorr.gif" width="354" height="276"></p>




<h2 class="pageName">10.3.3 &nbsp; Transformations and models</h2>

<p class="heading">Linear model with transformed variables</p>
	<p>If the relationship between <i>Y</i> and <i>X</i> is nonlinear, a linear 
		model will give poor predictions and must be avoided.</p>
	<p class="eqn"><img src="../../../en/curvature/images/s_rawModel.gif" width="303" height="230"></p>
	<p>However, by transforming 
		one or both of the variables, it is often possible to linearise the relationship 
		and therefore use least squares to fit a linear model to the transformed variables.</p>
	<p class="eqn"><img src="../../../en/curvature/images/s_logModel.gif" width="550" height="232"></p>
	<p>A logarithmic transformation of either Y or X often works, but a more general 
		power transformation is sometimes needed to linearise the relationship.</p>




<h2 class="pageName">10.3.4 &nbsp; Quadratic models</h2>

<p class="heading notPrinted">Adding a quadratic term</p>
	<p>An alternative solution to the problem of curvature is to extend the simple 
		linear model with the addition of a quadratic term, </p>
	<p class=eqn><span class="black"><em>y</em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x</em>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>2 </sub><em>x</em><sup>2</sup></span> </p>
	<p>Fitted values and residuals are defined (and interpreted) in a similar way 
		to those for a linear model,</p>
	<p class=eqn><span class="black"><span style="position:relative; top:4"><img src="../../../en/../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x<sub>i</sub></em>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x<sub>i</sub></em><sup>2</sup></span> <br>
			<span class="black"><em>e<sub>i</sub></em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>y<sub>i</sub></em> &minus; <span style="position:relative; top:4"><img src="../../../en/../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span></span> </p>
	<p>As in a linear model, the quadratic model's residuals are the vertical distances 
		between the crosses in a scatterplot and the curve. We again use <strong>least 
			squares</strong> to estimate the unknown parameters &mdash; choose values of the 
		three parameters to minimise the residual sum of squares, </p>
	<p class=eqn><img class="gif" src="../../../en/curvature/images/residSsqEqn.gif" width="369" height="28"> </p>
	<p class="eqn"><img src="../../../en/curvature/images/s_quadraticModel.gif" width="374" height="327"></p>




<h2 class="pageName">10.3.5 &nbsp; Dangers of extrapolation</h2>

<p class="heading notPrinted">The shape of a relationship is only known around the data</p>
	<p>The models that we have used to describe the relationship between a response, <i>Y</i>, and explanatory variable, <i>X</i>, are usually only approximations to
		the 'real' relationship. For example, a scatterplot may <strong>look</strong> linear,
		but we really have no information about the shape of the relationship beyond our data. </p>
	<p class=eqn><img class="gif" src="../../../en/curvature/images/extrapolate.gif" width="256" height="166">
	<p>A model may be useful for predicting <i>Y</i> from values of <i>X</i> that are within the range of x-values in our data, but we
		should be very cautious about using it to predict <em>Y</em> outside this range.
		This is called <strong>extrapolation</strong> and it can be badly in error. </p>
	
<div class="centred"><div class="boxed">
<p>Avoid using a model to predict <em>Y</em> far beyond the available 
				data.</p>
</div></div>





<h2 class="pageName">10.3.6 &nbsp; Lowess smoothing of scatterplots (opt) (Optional (not examined))</h2>

<p class="heading notPrinted">Local smoothing of scatterplots</p>
	<p>Lowess can be used to smooth time series but was originally developed as a general way to draw a smooth curve on any type of scatterplot. Again, the smoothed value for any observation is obtained by fitting a least squares line to the observations with adjacent values for the explanatory variable. The fitted values that are obtained in this way are joined with lines.</p>
	<p class="eqn"><img src="../../../en/smoothing/images/s_lowessScatter.gif" width="513" height="266"></p>
	<p>(Most computer software implements a version of lowess that is  a actually bit more complex than has been described here but our simpler version gives a good flavour of the method.)</p>




<h1 class="sectionName breakBefore">10.4 &nbsp; Displaying multivariate data</h1>
<h2 class="pageName">10.4.1 &nbsp; Representing a third variable</h2>

<p class="heading">Different plotting symbols for a third variable</p>
	<p>The simplest way to show the relationship between <strong>three</strong> numerical variables is based on a scatterplot of two of the variables, with the third 
		variable being represented by  differing symbols instead of identical 
		'crosses'. Possibilities are:</p>
	<ul>
		<li>Colour</li>
		<li>Size</li>
		<li>Angle</li>
	</ul>
	<p>Although this kind of scatterplot is easy to draw, it is usually hard to 
		interpret. The decision about  which of the three variables to represent using 
				the plotting symbol  can make interpretation easier.</p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_symbols.gif" width="408" height="257"></p>




<h2 class="pageName">10.4.2 &nbsp; Rotating 3D scatterplots</h2>

<p class="heading">3-dimensional scatterplots</p>
	<p>The most direct way to extend a standard scatterplot of two variables, <em>X</em> and <em>Y</em>, to include a third variable, <em>Z</em>, is to add a third dimension to become an axis for <em>Z</em>. Each individual would be represented by a cross in a 3-dimensional cube.</p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_3dScatter.gif" width="348" height="326"></p>
	<p>Although a computer screen is only 2-dimensional, it can display a projection of
		such a 3-dimensional scatterplot. Rotating such a display with the mouse gives a good
	feel for the shape of the underlying 3-dimensional scatter of points. This is a <strong>dynamic</strong> display that
	is only effective on a computer &mdash; the information in the display is conveyed by <strong>movement</strong>. On paper, we can only present information in two dimensions.</p>
	<p>Three-dimensional scatterplots are an interesting (and occasionally useful)
		way to display data. They are however <strong>much overrated</strong> as an analysis
		technique and simpler displays are usually
		more effective for extracting information from multivariate data.</p>




<h2 class="pageName">10.4.3 &nbsp; Scatterplot matrix and brushing</h2>

<p class="heading">Scatterplots of all pairs of variables</p>
	<p>The problem of displaying relationships becomes even more difficult when there
		are more than three variables. It is possible to gain some insight into their relationships 
		with an array of <strong>scatterplots of all pairs of variables</strong>, called a <strong> scatterplot matrix</strong>.</p>
	<p class="heading">Brushing</p>
	<p>Although a <strong>static</strong>  scatterplot matrix reveals some aspects of 
		the relationships between the variables, more insight into the data is obtained 
		by adding <strong>dynamic</strong> features. </p>
	<p>On a computer display, the scatterplots can be dynamically linked, so that clicking on a cross on one
		scatterplot highlights that individual in <strong>all</strong> scatterplots.
		<strong>Brushing</strong> extends this to allow highlighting of multiple crosses on
	a scatterplot with a 'brush' tool. </p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_scatMatrixBrush.gif" width="551" height="500"></p>




<h2 class="pageName">10.4.4 &nbsp; Brushing example</h2>

<p class="heading">More about brushing</p>
	<p>Brushing can be used on <strong>any</strong> linked displays of the same data set. </p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_brushUsa.gif" width="551" height="420"></p>




<h2 class="pageName">10.4.5 &nbsp; Slicing</h2>

<p class="heading">Slicing a scatterplot using a third variable</p>
	<p><strong>Slicing</strong> is a dynamic technique that only displays a subset of the individuals, based on a restricted range of values for one particular variable. For example, we might display a scatterplot of <em>Y</em> against <em>X</em>, but only for individuals whose values of <em>Z</em> are between 20 and 30. The subset can be dynamically changed with a slider or other control to show whether the relationship between <em>X</em> and <em>Y</em> is different for individuals with low <em>Z</em> and high <em>Z</em>.</p>
	<p class="heading">Trellis plot</p>
	<p>Slicing is a dynamic method and must therefore be performed on a computer. Although less effective, an alternative is to show a series of static plots for different slices of the data. This is called a <strong>trellis plot</strong>.</p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_trellis.gif" width="550" height="460"></p>




<h1 class="sectionName breakBefore">10.5 &nbsp; Exercises</h1>
</body>
</html>
