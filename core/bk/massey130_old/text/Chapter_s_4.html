<html>
<head>
  <title>4. Bivariate Relationships</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="../../../structure/printStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/summaryStyles.css" type="text/css">
  <script src="../../../structure/videoControls/jquery.js"></script>
  <script src="../../../structure/printFixes.js"></script>
</head>

<body id="body" onLoad="showPrintDialog(true)">
<div id='overlay'>
	<div id='dialogWindow'>
		<div class='printDialog'>
			<script type='text/javascript'>
				document.write("<div class='heading'>" + top.document.title + "</div>");
				if (top.url != null) {
					document.write("<p class='text'>A version of this chapter has already been generated in PDF format and we recommend that it is used for printing. The button below will download and display it.</p>");
					document.write("<p><button onClick='top.showPdf()'>Show PDF version of chapter</button></p>");
					document.write("<p class='text'>However downloading could be slow depending on your internet connection. If this is a problem, click the button below to print the chapter without downloading (but perhaps not formatted as well as the PDF version).</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>If you are <strong>not</strong> using the PDF version, the best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
				else {
					document.write("<p class='text'>Click the button below to print this chapter.</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>The best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
			</script>
			
			<p class='text'>If you don't want to print now,</p>
			<p><button onClick='top.showPrintDialog(false)'>Browse formatted chapter</button></p>
		</div>
	</div>
</div>
<h1 class="chapterName">Chapter 4 &nbsp; Bivariate Relationships</h1>
<h1 class="sectionName">4.1 &nbsp; Scatterplots</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Bivariate data sets</li>
<li>Scatterplots</li>
<li>Limitations of univariate displays</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='4'>
<li>Marginal distributions</li>
<li>Time series</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">4.1.1 &nbsp; Bivariate data sets</h2><!DOCTYPE HTML>


<p class="heading">The data matrix</p>
	<p>Many datasets contain several measurements from each <strong>individual</strong> (or plant, item
		or other unit). Each measurement type is called a <strong>variable</strong>. </p>
	<p class=eqn> <img class="gif" src="../../../en/structures/images/dataMatrix.gif" id="gif_image_1_1_1" width="258" height="283"><iframe class="svg" src="../../../en/structures/images/dataMatrix.svg" id="svg_image_1_1_1" width="258" height="283" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_1_1");</script> </p>
	<p>A data set with more than one variable is called <strong>multivariate</strong>.
One with two
variables is called <strong>bivariate</strong>.</p>




<h2 class="pageName">4.1.2 &nbsp; Scatterplots</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Scatterplots</p>
	<p>A scatterplot shows each individual as a single cross against a vertical axis
		(for the variable, <i>Y</i>) and a horizontal axis (for the other variable, <i>X</i>). </p>
	<p class=eqn> <img class="gif" src="../../../en/scatterplot/images/scatterValues.gif" id="gif_image_1_2_1" width="279" height="189"><iframe class="svg" src="../../../en/scatterplot/images/scatterValues.svg" id="svg_image_1_2_1" width="279" height="189" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_2_1");</script> </p>
	<p>By convention,  the variable on the vertical axis is called <i>Y</i> and
		the variable on the horizontal axis is called <i>X</i>. </p>





<h2 class="pageName">4.1.3 &nbsp; Limitations of univariate displays</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Scatterplots are needed to display  relationships</p>
	<p>The relationship between two variables cannot be determined from examination
 of the two variables in isolation. The two datasets shown in the scatterplots
below have the <strong>same marginal distributions</strong> for X and Y, but the variables are related
in very different ways.</p>
<p class="eqn"><img src="../../../en/scatterplot/images/s_sameMargins.gif" width="509" height="211"></p>





<h2 class="pageName">4.1.4 &nbsp; Marginal distributions</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Marginal distributions</p>
<p><span class="full_text">Although 
		they do not contain information about the relationship between the variables, 
	a display of the marginal distributions can be usefully <strong>added</strong> to a scatterplot to enhance it, perhaps highlighting skewness in X and Y.</span></p>
<p class="eqn"><img src="../../../en/scatterplot/images/s_margins.gif" width="354" height="272"></p>






<h2 class="pageName">4.1.5 &nbsp; Time series</h2><!DOCTYPE HTML>


<p class="heading">Time-ordering of univariate data</p>
	<p>Some data sets are apparently univariate, but the measurements are made sequentially 
		in time.  A data set of this form is called a <strong>time series</strong>.</p>
	<p>The time at which each measurement was made may be treated as an additional 
		numerical variable, and the measurement can then be plotted against time. 
		This type of scatterplot is often called a <strong>time series plot</strong>.</p>
	<p class="eqn"><img src="../../../en/scatterplot/images/s_timeSeries.gif" width="504" height="300"></p>





<h1 class="sectionName breakBefore">4.2 &nbsp; Understanding relationships</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Strength of a relationship</li>
<li>Outliers</li>
<li>Clusters</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='4'>
<li>Dangers of over-interpretation</li>
<li>Explanatory and response variables</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">4.2.1 &nbsp; Strength of a relationship</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Strength of relationship</p>
<p>The most important information that a scatterplot shows is the <strong>strength</strong> of the relationship between the variables. The closer the points to a straight line or curve, the stronger the relationship.</p>
<p>If higher values of one variable tend to be associated with higher values
 of the other variable, the crosses on the scatterplot will be in a band with
positive slope and the relationship is said to be <strong>positive</strong>. If high values of one variable tend to be associated with low values of the 
	other variable, we say that there is a <strong>negative</strong> relationship.</p>
<p class="eqn"><img src="../../../en/relationship/images/s_types.gif" width="398" height="323"></p>





<h2 class="pageName">4.2.2 &nbsp; Outliers</h2><!DOCTYPE HTML>


<p>The strength of the relationship between two variables is usually the most 
  important information that we gain from a scatterplot but a scatterplot may display other features.</p>
<p class="heading">Outliers</p>
<p>Values that seem 'different' from the rest of the data are called <strong>outliers</strong>.</p>
<p>An outlier may be an extreme value of one or other variable, but an individual
may be an outlier even though neither X nor Y is unusual on its own. One point
is an outlier in each of the three data sets below.</p>
<p class="eqn"><img class="gif" src="../../../en/relationship/images/outliers.gif" id="gif_image_2_2_1" width="312" height="157"><iframe class="svg" src="../../../en/relationship/images/outliers.svg" id="svg_image_2_2_1" width="312" height="157" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_2_2_1");</script>       <img class="gif" src="../../../en/relationship/images/outliers2.gif" id="gif_image_2_2_2" width="142" height="158"><iframe class="svg" src="../../../en/relationship/images/outliers2.svg" id="svg_image_2_2_2" width="142" height="158" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_2_2_2");</script></p>
<p>The point is an
outlier in the righthand data set  because it lies well above the main group
of points &mdash; its y-value is much higher than others with similar x-values.</p>
<p class=heading>Importance of outliers</p>
<p>Outliers are features of a data set that <strong>must</strong> be carefully 
	checked. An outlier is often caused by a recording or transcription error, 
	so...</p>

<div class="centred"><div class="boxed">
<p>First check that the values of the variables 
			are correctly recorded.</p>
</div></div>

<p>Sometimes an outlier arises because an individual is fundamentally different 
	from the others.  Identifying what makes the individual different  often gives considerable insight into the data.</p>

<div class="centred"><div class="boxed">
<p>The individuals should be further examined (perhaps 
			collecting further information from them) to try to assess whether the 
			outlier individual has distinct characteristics.</p>
</div></div>

<p>An outlier that is either extreme or that has other distinctive characteristics 
	would often be deleted from the data set, but should be mentioned in a report 
	about the data.</p>




<h2 class="pageName">4.2.3 &nbsp; Clusters</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Clusters</p>
	<p>Sometimes the cloud of crosses separates into two or more groups which are 
		called <strong>clusters</strong>. As with outliers, clusters provide important 
		information that should be further investigated.</p>
	<p class="eqn"><img src="../../../en/relationship/images/s_clusters.gif" width="241" height="222"></p>
	<p>The individuals should be  examined (perhaps collecting further 
		information from them) to  assess whether the clusters correspond to
 individuals with distinct characteristics. For example, the clusters may correspond
 to males and females, or  two different species of plant.</p>




<h2 class="pageName">4.2.4 &nbsp; Dangers of over-interpretation</h2><!DOCTYPE HTML>


<p class="heading">Interpreting outliers or clusters</p>
	<p>We have described some information that may be read from a scatterplot. But
		how strong must the corrresponding patterns be before we should report them? </p>
	<p>In both univariate and bivariate data sets, outliers or clusters must be <strong> distinct</strong> before we should conclude that they are real,
		in the absence of further external information confirming that the
		individuals are distinct. </p>
<p>Particularly in small data sets, outliers, clusters and other patterns may arise <strong>by chance</strong>, without being associated with any real features in the
		individuals. </p>
	
<div class="centred"><div class="boxed">
<p>Be careful not to overinterpret features in scatterplot unless they 
				are well defined, especially if the sample size is small.</p>
</div></div>

	



<h2 class="pageName">4.2.5 &nbsp; Explanatory and response variables</h2><!DOCTYPE HTML>


<p class=heading>Causal relationships</p>
	<p>In many bivariate data sets, the relationship between the two variables is 
		not symmetric. From the nature of the variables and the way that the data were collected, it may be clear that one variable, X, can potentially influence the other, Y, but that the opposite is impossible.</p>
	<p class="eqn"><img class="gif" src="../../../en/causal/images/reln1.gif" id="gif_image_2_5_1" width="297" height="65"><iframe class="svg" src="../../../en/causal/images/reln1.svg" id="svg_image_2_5_1" width="297" height="65" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_2_5_1");</script></p>
<p>In such data, the variable X is called the <strong>explanatory variable</strong> and Y is called the <strong>response</strong>.</p>
	<p class=heading>Experiments</p>
	<p>In an experiment,  the person conducting the experiment controls the values
of the explanatory variable. A well-designed experiment
always ensures that the relationship between the explanatory variable and response
is causal.</p>
<p class=heading>Observational studies</p>
	<p>If the person collecting the data has no control over either of the variables,
and simply records a pair of values from each individual, then the data are called <strong>observational</strong>.
If one variable is an earlier measurement than the other, we may also
be able to treat it as an explanatory variable and the later variable as the
response. </p>
<p>Even if the relationship is not causal, we are sometimes interested in <strong>predicting</strong> the
value of one variable from the other. The variable being predicted would then
be treated as the response.</p>




<h1 class="sectionName breakBefore">4.3 &nbsp; Correlation</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Units for X and Y</li>
<li>Units-free variables (z-scores)</li>
<li>Correlation coefficient</li>
<li>Scatterplots and the value of r</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='5'>
<li>Nonlinear relationships</li>
<li>R does not tell the whole story</li>
<li>Transformations and correlation</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">4.3.1 &nbsp; Units for X and Y</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Units and strength of a relationship</p>
	<p>A numerical summary of the strength of the relationship between two variables
should not depend on the units in which we measure the two variables. The strength
of the two relationships between the Metabolic rate (CO<sub>2</sub> produced) and Weight of
turkeys are the same in both of the scatterplots below.</p>
	<p class="eqn"><img src="../../../en/correlation/images/s_units_b.gif" width="550" height="219"></p>
	<p>We therefore start by defining <strong>units-free</strong> versions of the two variables and will summarise the strength of the relationship in terms of them.</p>




<h2 class="pageName">4.3.2 &nbsp; Units-free variables (z-scores)</h2><!DOCTYPE HTML>


<p class="heading">Z-scores</p>
	<p>The <strong>standardised</strong> form of a variable X is found by subtracting its mean then dividing by its standard deviation,</p>
	<p class=eqn><span class="black bold">standardised value,</span> &nbsp; <img class="gif" src="../../../en/correlation/images/standardiseX.gif" id="gif_image_3_2_1" width="105" height="39"><iframe class="svg" src="../../../en/correlation/images/standardiseX.svg" id="svg_image_3_2_1" width="105" height="39" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_2_1");</script></p>
	<p>The resulting values are  called <strong>z-scores</strong> and are the same,
whatever the units in which X was originally recorded.</p>
<p class="heading">Properties of z-scores</p>
	<p>A standardised variable always has zero mean and standard deviation one. </p>
	<p class=eqn> <img class="gif" src="../../../en/correlation/images/standardMeanSD.gif" id="gif_image_3_2_2" width="110" height="18"><iframe class="svg" src="../../../en/correlation/images/standardMeanSD.svg" id="svg_image_3_2_2" width="110" height="18" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_2_2");</script> </p>
	<p>From the  <a href="javascript:showNamedPage('centerSpread6')">70-95-100 
	rule-of-thumb</a>, </p>
	<div class="centred"><div class="boxed">
		<ul>
			<li>About 70% of z-scores will be between -1 and +1</li>
			<li>About 95% of z-scores will be between -2 and +2</li>
			<li>Almost all z-scores will be between -3 and +3</li>
		</ul>
	</div></div>
	<p>An individual's z-score tells you how many standard deviations it is above the mean. From its value, you can tell whether the value is very high (say over +2) or low (say under -2) in relation to the other values  of the variable.</p>




<h2 class="pageName">4.3.3 &nbsp; Correlation coefficient</h2><!DOCTYPE HTML>


<p class="heading">Definition</p>
<p>The <strong>correlation coefficient</strong> is usually defined by the formula </p>
<p class=eqn><img class="gif" src="../../../en/correlation/images/corrDefn2.gif" id="gif_image_3_3_2" width="213" height="67"><iframe class="svg" src="../../../en/correlation/images/corrDefn2.svg" id="svg_image_3_3_2" width="213" height="67" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_3_2");</script></p>
<p>It is however easier to understand if written in terms of standardised versions
of <em>X</em> and <em>Y</em>,</p>
<p class=eqn> <img class="gif" src="../../../en/correlation/images/corrDefn.gif" id="gif_image_3_3_1" width="110" height="44"><iframe class="svg" src="../../../en/correlation/images/corrDefn.svg" id="svg_image_3_3_1" width="110" height="44" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_3_1");</script> </p>
<div class="centred"><div class="boxed">
	<p>The correlation coefficient is a kind of <strong>average of the products</strong> of the z-scores.</p>
</div></div>
<p class="heading">How does <i>r</i> relate to the shape of a scatterplot?</p>
<p>The following properties of <i>r</i> explain in general terms how its value 
	is related to the strength of a relationship in any particular scatterplot.</p>
<div class="centred"><table border="0" cellpadding="5" cellspacing="0" class="centred" style="border-collapse:collapse">
<tr style="background-color:#D2EDFF; border-top:2px solid #CCCCCC; border-bottom:2px solid #CCCCCC;">
	<td style="vertical-align:middle; padding-right:30px;"><img class="gif" src="../../../en/correlation/images/property1.gif" id="gif_image_3_3_3" width="224" height="92"><iframe class="svg" src="../../../en/correlation/images/property1.svg" id="svg_image_3_3_3" width="224" height="92" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_3_3");</script></td>
	<td style="vertical-align:middle;"><img class="gif" src="../../../en/correlation/images/property2.gif" id="gif_image_3_3_4" width="224" height="92"><iframe class="svg" src="../../../en/correlation/images/property2.svg" id="svg_image_3_3_4" width="224" height="92" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_3_4");</script></td>
</tr>

<tr style="background-color:#F9FFF8; border-top:2px solid #CCCCCC; border-bottom:2px solid #CCCCCC;">
	<td colspan="2" align="center" style="vertical-align:middle; padding-right:30px;"><img class="gif" src="../../../en/correlation/images/property3.gif" id="gif_image_3_3_5" width="219" height="92"><iframe class="svg" src="../../../en/correlation/images/property3.svg" id="svg_image_3_3_5" width="219" height="92" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_3_5");</script></td>
</tr>

<tr style="background-color:#D2EDFF; border-top:2px solid #CCCCCC; border-bottom:2px solid #CCCCCC;">
	<td style="vertical-align:middle; padding-right:30px;"><img class="gif" src="../../../en/correlation/images/property4.gif" id="gif_image_3_3_6" width="224" height="92"><iframe class="svg" src="../../../en/correlation/images/property4.svg" id="svg_image_3_3_6" width="224" height="92" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_3_6");</script></td>
	<td style="vertical-align:middle;"><img class="gif" src="../../../en/correlation/images/property5.gif" id="gif_image_3_3_7" width="224" height="92"><iframe class="svg" src="../../../en/correlation/images/property5.svg" id="svg_image_3_3_7" width="224" height="92" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_3_7");</script></td>
</tr>

<tr style="background-color:#F9FFF8; border-top:2px solid #CCCCCC; border-bottom:2px solid #CCCCCC;">
	<td height="50" colspan="2" align="center" style="vertical-align:middle; padding-right:30px;"><span class="black">&minus;1 &nbsp;&le;&nbsp; <em>r</em> &nbsp;&le;&nbsp; +1</span></td>
</tr>
</table></div>




<h2 class="pageName">4.3.4 &nbsp; Scatterplots and the value of r</h2><!DOCTYPE HTML>


<p class="heading">How does <i>r</i> relate to the shape of a scatterplot?</p>
<p>The properties on the previous page describe the general behaviour of the correlation coefficient, 
	but do not give enough resolution for you to anticipate the type of scatterplot 
	that might have correlation coefficient 0.8 say, or 0.96.</p>
<p class="eqn"><img src="../../../en/correlation/images/s_rValue.gif" width="550" height="452"></p>
<p>Note that values of <em>r</em> between -0.5 and 0.5 correspond to very weak relationships.</p>




<h2 class="pageName">4.3.5 &nbsp; Nonlinear relationships</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Correlation and nonlinear relationships</p>
	<p>The correlation coefficient, <i>r</i>, is a good description of the strength
of a relationship <strong>provided the crosses in a scatterplot of the data are not
scattered round a curve</strong>. If the data are scattered round a curve, the relationship
is called <strong>nonlinear</strong> and <i>r</i> may seriously underestimate its
strength.</p>
<p class="eqn"><img src="../../../en/correlation/images/s_curved.gif" width="556" height="246"></p>
	
<div class="centred"><div class="boxed">
<p>The correlation coefficient does <strong>not</strong> describe
the strength of nonlinear relationships adequately.</p>
</div></div>

	



<h2 class="pageName">4.3.6 &nbsp; R does not tell the whole story</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Always look at a scatterplot first</p>
	<p>Although the correlation coefficient is a good description of the strength 
		of many relationships, it does not adequately describe others.</p>
	
<div class="centred"><div class="boxed">
<p>A scatterplot should always be examined to help 
				assess whether there are features in the data that the correlation coefficient 
				cannot describe.</p>
</div></div>

	<p>The data sets below share the same value of <em>r</em> = 0.816 (and the same
means and st devns for <em>X</em> and <em>Y</em>) but their scatterplots show
that different conclusions should be drawn from them.</p>
	<p align="center"><img src="../../../en/correlation/images/s_anscombe.gif" width="550" height="440"></p>




<h2 class="pageName">4.3.7 &nbsp; Transformations and correlation</h2><!DOCTYPE HTML>


<p class="heading">Correlation coefficient and nonlinear relationships</p>
	<p>The correlation coefficient, <i>r</i>, is a good description of the strength 
		of linear relationship but <a href="javascript:showNamedPage('correlation4')">not 
			nonlinear ones</a>. If a scatterplot shows marked curvature, the correlation 
		coefficient can considerably understate the strength of the relationship.</p>
	<p class="heading">Transform the variables to linearise the relationship</p>
	<p>Nonlinear transformations of X and Y alters the shape of the relationship. It is often possible 
		to linearise a relationship by transforming one or both variables.</p>
<p>The strength of a nonlinear relationship can therefore be described with the
correlation coefficient after  a transformation to one or both variables has
been applied to <strong>remove
the nonlinearity</strong>.</p>
<p class="eqn"><img src="../../../en/curvature/images/s_rawCorr.gif" width="354" height="276"><img src="../../../en/curvature/images/s_logCorr.gif" width="354" height="276"></p>




<h1 class="sectionName breakBefore">4.4 &nbsp; Least squares</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Predicting Y from X</li>
<li>Linear models</li>
<li>Fitted values and residuals</li>
<li>Least squares</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='5'>
<li>Curvature and outliers</li>
<li>Residual plots</li>
<li>Predicting Y and predicting X</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">4.4.1 &nbsp; Predicting Y from X</h2><!DOCTYPE HTML>


<p class="heading">The notion of prediction</p>
	<dl>
		<dt>Causal relationships</dt>
		<dd>If one variable, <em>X</em>, is thought to directly affect the 
			other, <em>Y</em>, we might hope to predict 
			the value of <em>Y</em> if the value of <em>X</em> is changed.<br>
		</dd>
		<dt>Non-causal relationships</dt>
		<dd>Even if the relationship is not causal, we are often still interested 
			in predicting the value of one variable from a known value of the other 
			variable.<br>
		</dd>
	</dl>
	<p class="heading">Notation and convention</p>
	<p>If the variables can be classified as an <strong>explanatory 
		variable</strong> and a <strong>response</strong>, we  use the letter<i> X</i> to denote the explanatory 
		variable and <i>Y</i> to denote the response.</p>
	
<div class="centred"><div class="boxed">
<p>Always draw the response variable, <i>Y</i>, on the vertical 
				axis of a scatterplot and <i>X</i> on the horizontal axis.</p>
</div></div>

	<p class="heading">Predicting the response</p>
	<p>The correlation coefficient describes the <strong>strength</strong> of a
 relationship, but does not help you to predict <em>Y</em> from <em>X</em>.</p>
<p>A  curve or
straight line that is drawn close to the crosses on a scatterplot (by eye or
by any other method) is called a <strong>regression line</strong> and can be
used to 'read off' the y-value corresponding to any <em>x</em>.</p>
<p class="eqn"><img src="../../../en/leastSqrs/images/s_predict.gif" width="357" height="272"></p>
	



<h2 class="pageName">4.4.2 &nbsp; Linear models</h2><!DOCTYPE HTML>


<p class="heading">Equation to describe a regression line</p>
	<p>A regression line could be drawn 'by eye' through a scatterplot, 
		but we restrict attention to simple mathematical functions</p>
	<p class=eqn><span class="black"><em>y</em> &nbsp;=&nbsp; <em>&fnof;</em> (<em> x</em> )</span></p>
	<p>since they are  easier and more objective to use.</p>
<p class="heading">Linear model</p>
	<p>Some relationships must be described by curves, but a straight line 
		is an adequate description of many bivariate data sets.</p>
	<p class=eqn><span class="black"><em>y</em> &nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></span> </p>
	<p>The constant <em>b</em><sub>0</sub> is  the <strong>intercept</strong> of
the line and describes the <em>y</em>-value when <em>x</em> is zero. The constant <em>b</em><sub>1</sub> is
the line's <strong>slope</strong>; it 
		describes the change in <i>y</i> when <i>x</i> increases by one. </p>
<p class="eqn"><img src="../../../en/leastSqrs/images/s_slopeIntercept.gif" width="238" height="197"></p>
	<p>The predicted response at any <em>x</em>-value is</p>
<p class=eqn><span class="black"><span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yHat.png" width="10" height="17" align="baseline"></span>&nbsp; =&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></span> </p>




<h2 class="pageName">4.4.3 &nbsp; Fitted values and residuals</h2><!DOCTYPE HTML>


<p class="heading">Fitted values</p>
	<p>To assess how well a particular linear model fits any one of our data points, (<em>x<sub>i</sub></em>,&nbsp;<em>y<sub>i</sub></em>), 
	we might consider how well the model would predict the y-value of the point, </p>
	<p class=eqn><span class="black"><span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span>&nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x<sub>i</sub></em></span> </p>
	<p>These predictions  are called <strong>fitted 
		values</strong>. </p>
	<p class="heading">Residuals</p>
	<p>The difference between the <em>i</em>'th fitted values  and its actual 
		y-value is called its <strong>residual</strong>. </p>
	<p class=eqn><span class="black"><em>e<sub>i</sub></em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>y<sub>i</sub></em> &minus; <span style="position:relative; top:4"><img src="../../../en/../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span></span> </p>
	<p>The residuals describe the 'errors' that would have resulted from using the
 model to predict <em>y</em> from the <em>x</em>-values of our data points.</p>
<p class="eqn"><img src="../../../en/leastSqrs/images/s_resid.gif" width="351" height="207"></p>
	
	<p>Note that the residuals are the <strong>vertical distances of the crosses to the line</strong>.</p>
	
	



<h2 class="pageName">4.4.4 &nbsp; Least squares</h2><!DOCTYPE HTML>


<p class="heading">Aim of small residuals</p>
	<p>The residuals from a linear model (vertical distances from the crosses 
		to the line) indicate how closely the model's predictions  match the actual responses in the data. </p>
	<p class="eqn"><img src="../../../en/leastSqrs/images/s_allResids.gif" width="354" height="310"></p>
	<p>Small residuals are good, so the parameters <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub>  should
be set to make them as small as possible.</p>
	<p class="heading">Least squares</p>
	<p>The size 
		of the residuals is summarised by the <strong>residual sum of squares</strong>, </p>
<p class=eqn><img class="gif" src="../../../en/leastSqrs/images/residSsq.gif" id="gif_image_4_4_2" width="317" height="28"><iframe class="svg" src="../../../en/leastSqrs/images/residSsq.svg" id="svg_image_4_4_2" width="317" height="28" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_4_4_2");</script> </p>
	<p>'Good' values for <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub> can be
objectively chosen to be the values that minimise the residual sum of squares.
This is the <strong>method
of least squares</strong> and the values of <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub> are
called  <strong>least squares 
		estimates</strong>.</p>
<p>The diagram below respresents the squared residuals as blue squares. The least squares estimates minimise the total blue area.</p>
	<p class="eqn"><img src="../../../en/leastSqrs/images/s_sqrResids.gif" width="359" height="316"></p>
	<p class="heading">Formulae</p>
	<p>The problem of minimising the residual sum of squares is not difficult mathematically, 
    but you will rarely require or use the resulting formulae for <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub> since spreadsheets, statistical programs and even scientific calculators will 
  do the calculations for you. However, for completeness, the formulae are </p>
	<p class=eqn><img class="gif" src="../../../en/leastSqrs/images/lsFormulae.gif" id="gif_image_4_4_1" width="350" height="57"><iframe class="svg" src="../../../en/leastSqrs/images/lsFormulae.svg" id="svg_image_4_4_1" width="350" height="57" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_4_4_1");</script> </p>




<h2 class="pageName">4.4.5 &nbsp; Curvature and outliers</h2><!DOCTYPE HTML>


<p class="heading">Nonlinear relationships</p>
	<p>A simple linear model is only appropriate when the cloud of crosses 
	in a scatterplot of the data is regularly spread around a straight line. If the crosses are scattered round a <strong>curve</strong>, the relationship is called <strong>nonlinear</strong> and
other models must be used.</p>
<p class="heading">Outliers</p>
<p>Another problem arises if there are <strong>outliers</strong> &mdash; observations that do not conform to the 
		pattern and variability exhibited by the rest of the data. In a linear model, 
		the most important type of outlier is a data point that lies at a distance 
		from the line that would fit through the rest of the data. </p>
	<p>The individual corresponding to any outlier should be carefully examined. Recording
		or transcription errors may be the cause. Alternatively, it may be possible to determine some
		distinguishing characteristic of the individual that underlies the unusual response
		measurement. </p>
	<p>If an outlier is extreme enough, or if a special cause for its unusual behaviour can be
		found from outside information, the individual can be classified as aberrant
		and deleted from the data set.</p>
	<div class="centred"><div class="boxed">
		<p>It is important to <strong>look at any data set graphically</strong> before
fitting a linear model to check that no curvature or outliers is present.</p>
	</div></div>
	



<h2 class="pageName">4.4.6 &nbsp; Residual plots</h2><!DOCTYPE HTML>


<p class="heading">Detecting problems with the model</p>
	<p>If outliers or curvature are present in a data set, they are often visible 
		in a scatterplot of the response against the explanatory variable. However 
		these features are usually clearer if the <strong>residuals</strong> are plotted 
		against <i>X</i> rather than the original response.</p>
	<p class="eqn"><img src="../../../en/leastSqrs/images/s_residPlot.gif" width="557" height="264"></p>




<h2 class="pageName">4.4.7 &nbsp; Predicting Y and predicting X</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Different lines are used to predict Y and to predict X</p>
	<p>The 
		least squares line for predicting Y from X,</p>
	<p class=eqn><span class="black"><em>y</em> &nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></span></p>
	<p> minimises the sum of squared <strong>vertical</strong> distances between 
		the points on a scatterplot and the line. On the other hand, if we are interested 
		in predicting X from Y using a line,</p>
	<p class=eqn><span class="black"><em>x</em> &nbsp;=&nbsp; <em>c</em><sub>0</sub> + <em>c</em><sub>1 </sub><em>y</em></span></p>
	<p>the residuals are the <strong>horizontal</strong> distances between the points 
		and the line, and least squares minimises their sum 
		of squares.</p>
	<p class=eqn><img class="gif" src="../../../en/leastSqrs/images/predictAndInverse.gif" id="gif_image_4_7_1" width="469" height="209"><iframe class="svg" src="../../../en/leastSqrs/images/predictAndInverse.svg" id="svg_image_4_7_1" width="469" height="209" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_4_7_1");</script></p>
	<p><strong>Different lines</strong> minimise the sum of squares of horizontal and vertical distances.</p>
	<p class="heading">About the two least squares lines</p>
	<p>The two least squares lines can be  written in terms of standardised 
		variables,</p>
<div class="centred"><table border="0" cellspacing="0" cellpadding="10" class="centred">
		<tr>
			<th>Equation of least squares line to predict Y from X</th>
			<td><img class="gif" src="../../../en/leastSqrs/images/yxLsLine.gif" id="gif_image_4_7_3" width="135" height="44"><iframe class="svg" src="../../../en/leastSqrs/images/yxLsLine.svg" id="svg_image_4_7_3" width="135" height="44" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_4_7_3");</script></td>
		</tr>
		<tr>
			<th>Equation of least squares line to predict X from Y</th>
			<td><img class="gif" src="../../../en/leastSqrs/images/xyLsLine.gif" id="gif_image_4_7_2" width="136" height="44"><iframe class="svg" src="../../../en/leastSqrs/images/xyLsLine.svg" id="svg_image_4_7_2" width="136" height="44" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_4_7_2");</script></td>
		</tr>
	</table></div>
	<p>where <i>r</i> is the correlation coefficient between <i>X</i> and <i>Y</i>. 
		Since <i>r</i> is always less than 1, the least squares line for predicting <i>Y</i> from <i>X</i> is the more horizontal (closer to being parallel to 
		the x-axis) of the two lines.</p>
<p class="eqn"><img src="../../../en/leastSqrs/images/s_dualLines.gif" width="410" height="313"></p>




<h1 class="sectionName breakBefore">4.5 &nbsp; Nonlinear relationships (advanced)</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Transformations and models</li>
<li>Quadratic models</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='3'>
<li>Dangers of extrapolation</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">4.5.1 &nbsp; Transformations and models</h2><!DOCTYPE HTML>


<p class="heading">Linear model with transformed variables</p>
	<p>If the relationship between <i>Y</i> and <i>X</i> is nonlinear, a linear 
		model will give poor predictions and must be avoided.</p>
	<p class="eqn"><img src="../../../en/curvature/images/s_rawModel.gif" width="303" height="230"></p>
	<p>However, by transforming 
		one or both of the variables, it is often possible to linearise the relationship 
		and therefore use least squares to fit a linear model to the transformed variables.</p>
	<p class="eqn"><img src="../../../en/curvature/images/s_logModel.gif" width="550" height="232"></p>
	<p>A logarithmic transformation of either Y or X often works, but a more general 
		power transformation is sometimes needed to linearise the relationship.</p>




<h2 class="pageName">4.5.2 &nbsp; Quadratic models</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Adding a quadratic term</p>
	<p>An alternative solution to the problem of curvature is to extend the simple 
		linear model with the addition of a quadratic term, </p>
	<p class=eqn><span class="black"><em>y</em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x</em>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>2 </sub><em>x</em><sup>2</sup></span> </p>
	<p>Fitted values and residuals are defined (and interpreted) in a similar way 
		to those for a linear model,</p>
	<p class=eqn><span class="black"><span style="position:relative; top:4"><img src="../../../en/../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x<sub>i</sub></em>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x<sub>i</sub></em><sup>2</sup></span> <br>
			<span class="black"><em>e<sub>i</sub></em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>y<sub>i</sub></em> &minus; <span style="position:relative; top:4"><img src="../../../en/../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span></span> </p>
	<p>As in a linear model, the quadratic model's residuals are the vertical distances 
		between the crosses in a scatterplot and the curve. We again use <strong>least 
			squares</strong> to estimate the unknown parameters &mdash; choose values of the 
		three parameters to minimise the residual sum of squares, </p>
	<p class=eqn><img class="gif" src="../../../en/curvature/images/residSsqEqn.gif" id="gif_image_5_2_1" width="369" height="28"><iframe class="svg" src="../../../en/curvature/images/residSsqEqn.svg" id="svg_image_5_2_1" width="369" height="28" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_5_2_1");</script> </p>
	<p class="eqn"><img src="../../../en/curvature/images/s_quadraticModel.gif" width="374" height="327"></p>




<h2 class="pageName">4.5.3 &nbsp; Dangers of extrapolation</h2><!DOCTYPE HTML>


<p class="heading notPrinted">The shape of a relationship is only known around the data</p>
	<p>The models that we have used to describe the relationship between a response, <i>Y</i>, and explanatory variable, <i>X</i>, are usually only approximations to
		the 'real' relationship. For example, a scatterplot may <strong>look</strong> linear,
		but we really have no information about the shape of the relationship beyond our data. </p>
	<p class=eqn><img class="gif" src="../../../en/curvature/images/extrapolate.gif" id="gif_image_5_3_1" width="256" height="166"><iframe class="svg" src="../../../en/curvature/images/extrapolate.svg" id="svg_image_5_3_1" width="256" height="166" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_5_3_1");</script>
	<p>A model may be useful for predicting <i>Y</i> from values of <i>X</i> that are within the range of x-values in our data, but we
		should be very cautious about using it to predict <em>Y</em> outside this range.
		This is called <strong>extrapolation</strong> and it can be badly in error. </p>
	
<div class="centred"><div class="boxed">
<p>Avoid using a model to predict <em>Y</em> far beyond the available 
				data.</p>
</div></div>





<h1 class="sectionName breakBefore">4.6 &nbsp; Displaying multivariate data</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Representing a third variable</li>
<li>Rotating 3D scatterplots</li>
<li>Scatterplot matrix and brushing</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='4'>
<li>Brushing example</li>
<li>Slicing</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">4.6.1 &nbsp; Representing a third variable</h2><!DOCTYPE HTML>


<p class="heading">Different plotting symbols for a third variable</p>
	<p>The simplest way to show the relationship between <strong>three</strong> numerical variables is based on a scatterplot of two of the variables, with the third 
		variable being represented by  differing symbols instead of identical 
		'crosses'. Possibilities are:</p>
	<ul>
		<li>Colour</li>
		<li>Size</li>
		<li>Angle</li>
	</ul>
	<p>Although this kind of scatterplot is easy to draw, it is usually hard to 
		interpret. The decision about  which of the three variables to represent using 
				the plotting symbol  can make interpretation easier.</p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_symbols.gif" width="408" height="257"></p>




<h2 class="pageName">4.6.2 &nbsp; Rotating 3D scatterplots</h2><!DOCTYPE HTML>


<p class="heading">3-dimensional scatterplots</p>
	<p>The most direct way to extend a standard scatterplot of two variables, <em>X</em> and <em>Y</em>, to include a third variable, <em>Z</em>, is to add a third dimension to become an axis for <em>Z</em>. Each individual would be represented by a cross in a 3-dimensional cube.</p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_3dScatter.gif" width="348" height="326"></p>
	<p>Although a computer screen is only 2-dimensional, it can display a projection of
		such a 3-dimensional scatterplot. Rotating such a display with the mouse gives a good
	feel for the shape of the underlying 3-dimensional scatter of points. This is a <strong>dynamic</strong> display that
	is only effective on a computer &mdash; the information in the display is conveyed by <strong>movement</strong>. On paper, we can only present information in two dimensions.</p>
	<p>Three-dimensional scatterplots are an interesting (and occasionally useful)
		way to display data. They are however <strong>much overrated</strong> as an analysis
		technique and simpler displays are usually
		more effective for extracting information from multivariate data.</p>




<h2 class="pageName">4.6.3 &nbsp; Scatterplot matrix and brushing</h2><!DOCTYPE HTML>


<p class="heading">Scatterplots of all pairs of variables</p>
	<p>The problem of displaying relationships becomes even more difficult when there
		are more than three variables. It is possible to gain some insight into their relationships 
		with an array of <strong>scatterplots of all pairs of variables</strong>, called a <strong> scatterplot matrix</strong>.</p>
	<p class="heading">Brushing</p>
	<p>Although a <strong>static</strong>  scatterplot matrix reveals some aspects of 
		the relationships between the variables, more insight into the data is obtained 
		by adding <strong>dynamic</strong> features. </p>
	<p>On a computer display, the scatterplots can be dynamically linked, so that clicking on a cross on one
		scatterplot highlights that individual in <strong>all</strong> scatterplots.
		<strong>Brushing</strong> extends this to allow highlighting of multiple crosses on
	a scatterplot with a 'brush' tool. </p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_scatMatrixBrush.gif" width="551" height="500"></p>




<h2 class="pageName">4.6.4 &nbsp; Brushing example</h2><!DOCTYPE HTML>


<p class="heading">More about brushing</p>
	<p>Brushing can be used on <strong>any</strong> linked displays of the same data set. </p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_brushUsa.gif" width="551" height="420"></p>




<h2 class="pageName">4.6.5 &nbsp; Slicing</h2><!DOCTYPE HTML>


<p class="heading">Slicing a scatterplot using a third variable</p>
	<p><strong>Slicing</strong> is a dynamic technique that only displays a subset of the individuals, based on a restricted range of values for one particular variable. For example, we might display a scatterplot of <em>Y</em> against <em>X</em>, but only for individuals whose values of <em>Z</em> are between 20 and 30. The subset can be dynamically changed with a slider or other control to show whether the relationship between <em>X</em> and <em>Y</em> is different for individuals with low <em>Z</em> and high <em>Z</em>.</p>
	<p class="heading">Trellis plot</p>
	<p>Slicing is a dynamic method and must therefore be performed on a computer. Although less effective, an alternative is to show a series of static plots for different slices of the data. This is called a <strong>trellis plot</strong>.</p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_trellis.gif" width="550" height="460"></p>




</html>
