<!DOCTYPE HTML>
<html>
<head>
	<title>Diagnostic residual plots</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="residual, curvature, non-constant variance, normal distribution, probability plot, autocorrelation">
	<meta name="dataset" content="Slug weight and length">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Diagnostic residual plots</p>

  <p>The reasonableness of the assumptions underlying a normal linear model are 
	best assessed by examining the residuals. Linearity and constant variance 
	can usually be seen in a scatterplot of residuals against the explanatory 
	variable.</p>
  <p>If the assumptions of normality and independence hold, the residuals should 
	have approximately a normal distribution and they should display no trend 
	over time. Time-trend can be examined with a scatterplot of the residuals 
	against either time or, if the exact data-collection time is unavailable, 
	an evenly spaced time index (i.e. the values 1, 2, ..., <i>n</i>). </p>
<p>Normality is often examined with a <strong>probability plot</strong>. This 
	is a scatterplot of the ordered residuals against a set of values that are 
	spaced as would be expected from a standard normal distribution. If the residuals 
	are normally distributed, the crosses should lie approximately on a straight 
	line.</p>

<p>(Page 1.8.5 of the <a href="javascript:openEbook('regn')">CAST e-book about regression</a> gives more detail about how probability plots are used to detect non-normality.)</p>

<div class="diagram">

<p>The diagram below shows four diagnostic plots for the slug data relating to 
	a linear model of log(weight) against log(length).</p>  <p>The first two are scatterplots of the raw data and residuals against the explanatory 
	variable in the model. They show no evidence nonlinearity or non-constant 
	variance.</p>

<div align="center">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="600" height="500">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="loessProg.ResidDiagnosticApplet">
<param name="xVarName" value="Len">
<param name="yVarName" value="Wt">
<param name="xValues" value="7.3 7.8 7.5 6.9 6.0 7.4 8.5 8.6 8.2 8.5 7.0 4.3 3.2 4.7 4.2 9.0 4.6 3.8 4.0 3.9 3.2 1.0 4.1 6.1 4.2 4.4 5.6 5.7 1.7 4.5 4.5 3.5 2.0 2.9 2.1 2.6 2.6 3.6 1.6 3.5 3.6 2.2 2.4 4.2 3.3 3.9 5.6 4.6 2.2 1.2 2.7 3.4 3.2 2.3 2.8 1.4 2.2 1.7 1.0 2.3 3.5 2.9 2.6 2.1 1.6 1.6 2.0 7.5 7.8 2.2 6.1 5.9 7.8 9.0 9.3 7.1 9.4 8.5 8.5 2.4 2.5 5.7 4.5 1.0 1.0 1.0 1.1 1.9 1.6 2.3 1.9 1.8 2.3 2.5 3.3 4.2 2.1 9.0 9.4">
<param name="yValues" value="3.68 5.48 4.94 3.47 3.26 4.36 6.44 8.37 6.40 8.23 4.99 1.69 0.39 2.14 1.07 8.75 1.02 1.07 0.88 0.76 0.48 0.04 0.98 3.34 1.02 1.10 2.35 3.93 0.10 0.65 1.64 0.50 0.12 0.40 0.14 0.35 0.29 0.88 0.12 0.66 0.62 0.17 0.25 2.28 1.26 2.20 4.78 3.27 0.20 0.09 0.30 0.52 0.47 0.19 0.28 0.08 0.18 0.13 0.06 0.20 0.60 0.39 0.31 0.16 0.06 0.04 0.16 4.94 5.48 0.36 3.16 1.91 8.44 13.62 8.70 4.39 8.23 6.30 6.06 0.24 0.27 2.04 1.30 0.03 0.03 0.02 0.03 0.14 0.08 0.18 0.10 0.09 0.23 0.26 0.71 0.85 0.18 12.00 11.22">
<param name="horizAxis" value="-0.02 1.02 0.0 0.2">
<param name="vertAxis" value="-2 2 -2 1">
<param name="indexAxis" value="0.5 100 20 20 1">
<param name="residAxis" value="-0.5 0.5 -0.4 0.2">
<param name="nscoreAxis" value="-3 3 -3 1">
<param name="random" value="3.0 384958677">
<param name="labelAxes" value="true">
<param name="customText" value="Actual Data=Actual Data#Random Normal Data=Random Normal Data#Ordered residual=Ordered residual#Observation order=Observation order">
</applet>
</div>

  
<p>The plot of residuals against time order does not show any prominent pattern 
other than a cluster of high residuals around observation 50 &mdash; these slugs were 
unusually heavy for their lengths. Click on the crosses 
to check the weights and lengths of this cluster of slugs. Are they similarly 
sized slugs? If possible, it would be worth checking whether these slugs were 
all collected at the same time.</p>

<p>The probability plot on the bottom right shows curvature, suggesting that 
	the residuals are not normally distributed. The flat section of the plot shows 
	a high density of residuals just below zero, so the response distribution 
	seems skew with a long positive tail. There are also two negative residuals 
	that stand out as possible outliers.</p>

<p class="heading">Are Features in the Residual Plots Real?</p>  <p>It is important not to rush to conclusions about features in graphical displays 
	of data. Random data may exhibit patterns even when the underlying population 
	does not. So are the patterns that we have observed in the time-ordered plot 
	and probability plot really indicative of problems with the model or are they 
	just random patterns?</p>  <p>To help answer this question, we can examine the patterns that would arise 
	from data that <strong>do</strong> come from a normal linear model. Select 
	the option <strong>Random Normal Data</strong> from the popup menu then click 
	<strong>Take sample</strong> several times.</p>
	
	<p>The pattern observed in the time-order plot is perhaps not unusual in view 
	of the variability of the corresponding plots from random data. However the 
	curvature in the probability plot is rarely observed in random samples, so 
	we could conclude that the residuals probably do not have normal distribution.</p>

<p><font color="#666666">(Minitab can perform a hypothesis test to confirm what 
	we observed in the above simulation. The residuals must be saved in a worksheet 
	column. A Minitab command draws a normal probability plot and also provides 
	a p-value for testing normality. The p-value for the Anderson-Darling normality 
	test is reported to be '0.000' so there is extremely strong evidence that 
	the null hypothesis of normality does not hold.)</font></p>

</div>

  <p>Violation of the assumption of normality has less impact on the validity of 
	the Minitab analysis than other model problems, and the violation is not severe, 
	so the earlier analysis is not particularly compromised by the problem identified 
	in this page.</p>
  
<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
