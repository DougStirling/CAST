<html>
<head>
  <title>5. Time Series</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="../../../structure/printStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/summaryStyles.css" type="text/css">
  <script src="../../../structure/videoControls/jquery.js"></script>
  <script src="../../../structure/printFixes.js"></script>
</head>

<body id="body" onLoad="showPrintDialog(true)">
<div id='overlay'>
	<div id='dialogWindow'>
		<div class='printDialog'>
			<script type='text/javascript'>
				document.write("<div class='heading'>" + top.document.title + "</div>");
				if (top.url != null) {
					document.write("<p class='text'>A version of this chapter has already been generated in PDF format and we recommend that it is used for printing. The button below will download and display it.</p>");
					document.write("<p><button onClick='top.showPdf()'>Show PDF version of chapter</button></p>");
					document.write("<p class='text'>However downloading could be slow depending on your internet connection. If this is a problem, click the button below to print the chapter without downloading (but perhaps not formatted as well as the PDF version).</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>If you are <strong>not</strong> using the PDF version, the best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
				else {
					document.write("<p class='text'>Click the button below to print this chapter.</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>The best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
			</script>
			
			<p class='text'>If you don't want to print now,</p>
			<p><button onClick='top.showPrintDialog(false)'>Browse formatted chapter</button></p>
		</div>
	</div>
</div>
<h1 class="chapterName">Chapter 5 &nbsp; Time Series</h1>
<h1 class="sectionName">5.1 &nbsp; Time series plots</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Time series plots</li>
<li>Patterns in time series</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='3'>
<li>Multiple time series</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">5.1.1 &nbsp; Time series plots</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Time series data</p>
	<p>Data sets whose measurements  are made sequentially at regular 
		intervals are called <strong>time series</strong>. We often want to forecast
future values of a time series.</p>
<p class="heading">The importance of plotting</p>
	<p>As with other data structures, the information 
		in a time series is most easily understood from a <strong>graphical</strong> display.
A <strong>time series plot</strong> is a type of scatterplot whose horizontal
axis shows the time-ordering of the values. Successive crosses are often  joined
by lines.</p>
 <p class=eqn><img class="gif" src="../../../en/timePlot/images/timePlotDisplay.gif" width="310" height="183"></p>




<h2 class="pageName">5.1.2 &nbsp; Patterns in time series</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Types of pattern</p>
	<div class="centred"><table class="centred" width="90%">
	<tr><th width="50%">Trend</th>
	<th width="50%">Seasonal variation</th>
	</tr>
	<tr>
<td>Trend refers to long-term increases and decreases in the values.
		<div class="centred"><img src="../../../en/timePlot/images/pattern_trend.gif" width="204" height="135"> </p>
	<p>Moving 
		averages are also called <strong>running means</strong>. In the example below,
a 7-point moving average replaces each value with the mean of it and the 3 adjacent
 values on each side.</p>
	<p class="eqn"><img src="../../../en/smoothing/images/s_movingAverage.gif" width="501" height="249">          <img class="gif" src="../../../en/smoothing/images/movingAverage4.gif" width="237" height="218"></p>
	<p>If averaging over an even number of values, the smoothed value is for a time between those of the data values, such as &quot;year 2005.5&quot;.</p>
	<p class="heading">A second stage of averaging for even run lengths</p>
	<p>To provide smoothed values at the same times as the raw data, we often take a further 2-point moving average.</p>
	<p class=eqn><img class="gif" src="../../../en/smoothing/images/movingAverageDouble.gif" width="428" height="218"> </p>
	<p>This is equivalent to giving <strong>half weight</strong> to the two outermost values. If  based on moving averages of 4, this is called a 4-point centred moving average.</p>
	<div class="centred"><div class="boxed">
		<p>These centred averages are particularly useful when analysing seasonal data. For example, 12-point centred moving averages are often used for monthly data.</p>
	</div></div>
	



<h2 class="pageName">5.2.3 &nbsp; Robust smoothing</h2><!DOCTYPE HTML>


<p class="heading">Outliers and running medians</p>
	<p>Since medians are less sensitive to outliers than means, a more robust alternative to running means replaces each value by the <strong>median</strong> of it and adjacent values. A <strong>3-point running median</strong> is: </p>
	<p class=eqn><img class="gif" src="../../../en/smoothing/images/runningMedianEqn.gif" width="225" height="25"> </p>
	<p>and higher-order running medians will use more adjacent values. </p>
	<p class="heading">Comparison of means and medians</p>
	<ul>
		<li>Moving averages are more affected by outliers in the series</li>
		<li>Running medians often have a 'stepped' appearance &mdash; the smoothed series 
			is level for periods, followed by relatively sharp jumps.</li>
	</ul>
	<p class=eqn><img src="../../../en/smoothing/images/s_meanMedian.gif" width="539" height="283"> </p>
	<p class=eqn><img class="gif" src="../../../en/smoothing/images/expSmoothEqn.gif" width="175" height="25"></p>
	<p>where the smoothing constant, <i>a</i>, is a value between 0 and 1. The smoothed
value is a 'weighted average' of the actual value at that time and the previous
smoothed value.</p>
<p class="heading">Alternative formula</p>
	<p>The formula can also be expressed as </p>
	<p class=eqn><img class="gif" src="../../../en/smoothing/images/expSmoothEqn2.gif" width="486" height="26"></p>
	<p>For example, if <em>a</em>&nbsp;=&nbsp;<sup>1</sup>/<sub>2 </sub>, </p>
	<p class=eqn><img class="gif" src="../../../en/smoothing/images/expSmoothHalf.gif" width="299" height="26"> </p>
	<p>The smoothed value puts more weight on the recent past (which is an intuitively sensible thing to do).</p>
	<ul>
		<li>The closer <em>a</em> becomes to one, the greater the influence of the
actual value, and the less smoothing.</li>
		<li>The closer <em>a</em> becomes to zero, the more smoothing.</li>
</ul>
	<p class="heading">Forecasting future values</p>
	<p>If the most recent value is at time <em>i</em>, we forecast
the value at time <em>i</em> + <em>k</em> to be the last exponentially smoothed
value,</p>
<p class=eqn><img class="gif" src="../../../en/smoothing/images/expPredict.gif" width="252" height="23"></p>
	<ul>
		<li>If <i>a</i>&nbsp;=&nbsp;1, the forecast is just the last observed value 
			in the time series.</li>
		<li>As <i>a</i> is reduced, the forecast becomes more affected by earlier 
			values in the series.</li>
	</ul>
	
	<p class="heading">Time series with trend</p>
	<p>If the time 
		series has an increasing trend, exponential smoothing will 
		tend to underestimate the trend. Similarly, the smoothed series will be too high if 
		there is a decreasing trend.</p>
	<p class="eqn"><img src="../../../en/smoothing/images/s_expSmoothTrend.gif" width="455" height="258"></p>
	<p class="eqn"><img src="../../../en/smoothing/images/s_lowess.gif" width="513" height="272"> </p>
	<p class=eqn><img src="../../../en/trend/images/s_linear.gif" width="456" height="311"> </p>
	<p>We can try to predict <em>y<sub>t</sub></em> from its previous value by fitting
a straight line by least squares to this scatterplot,</p>
	<p class=eqn><span class="black"><em>y<sub>t</sub></em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>y<sub>t</sub></em><sub>&minus;1</sub></span> </p>
	<p>This  is a type of <strong>auto-regressive model</strong>, and is usually 
		called an <strong>AR(1) model</strong>.</p>
	<p class=eqn><img class="gif" src="../../../en/cyclic/images/arForecastPlot.gif" width="376" height="206"> </p>
	<p class="heading">Forecasting further into the future</p>
	<p>The model only directly predicts one time period into the future,</p>
<p class=eqn><span class="black"><span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yHat.png" width="10" height="17"></span><em><sub>t</sub></em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>y<sub>t</sub></em><sub> &minus; 1</sub></span> </p>
	<p>but we can predict further into the future using:</p>
	<p class=eqn><span class="black"><span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yHat.png" width="10" height="17"></span><em><sub>t</sub></em><sub> + </sub><em><sub>k</sub></em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em><span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yHat.png" width="10" height="17"></span><sub>t</sub></em><sub> + <em>k </em>&minus;1</sub></span></p>




<h2 class="pageName">5.4.3 &nbsp; AR(1) model and trend</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Forecasting when there is trend</p>
	<p>The method described in the previous page works well if there is no trend
in the time series. If there <strong>is</strong> trend, we should remove it before
using an AR(1) model. The steps for forecasting a future value are therefore...</p>
 <ol>
		<li>Estimate the trend in the series.</li>
		<li>Fit an AR(1) model to the detrended values (residuals).</li>
		<li>Forecast future detrended values by applying the AR(1) model to the most
recent detrended value.</li>
		<li>Forecast the trend (using the model fitted in step 1) and add the detrended
 forecast from step 3.</li>
	</ol>
	<p class="gray">(There are more efficient ways to do steps 
		1 and 2 together, but these are beyond the scope of an introductory course.)</p>




<h2 class="pageName">5.4.4 &nbsp; Trend or autocorrelation?</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Dangers of over-interpretation</p>
	<p>Very strong autocorrelation in a time series can result in apparent trends,
even when there is no real trend underlying the series. Autocorrelation and trend
are especially difficult to distinguish in short time series. You should therefore
be wary of extrapolating a trend into the future if there is high autocorrelation.</p>




<h2 class="pageName">5.4.5 &nbsp; Cyclical patterns</h2><!DOCTYPE HTML>


<p>Many time series change in cycles, with increases and decreases that cannot 
			be explained by a smooth trend line.</p>
	<p class="heading">Seasonal patterns</p>
	<p>Some cycles are <strong>seasonal</strong>. Seasonal patterns are distinguished by a period that repeats exactly &mdash; for 
		example, monthly data has a period of <strong>exactly</strong> 12 months.</p>
	<div class="centred"><div class="boxed">
		<p>Seasonal patterns are not usually referred to as 'cyclical'.</p>
	</div></div>
	<p class="heading">Cyclical patterns</p>
	<p>Other cycles  repeat much less regularly. Sun-spot activity
has  cycles of approximately 11 years, and the 'business cycle' can be anywhere
between 3 and 10 years. In both cases, different cycles are not  <strong>exactly</strong> the
same length.</p>
<div class="centred"><div class="boxed">
		<p>The AR(1) method can be used to obtain forecasts for cyclical data with irregular cycle lengths.</p>
	</div></div>
	<p>We will not distinguish cyclical patterns from other forms of autocorrelation
here.</p>




<h1 class="sectionName breakBefore">5.5 &nbsp; Seasonal data</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Seasonal patterns</li>
<li>Smoothing out seasonal variation</li>
<li>Estimating the seasonal effect</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='4'>
<li>Deseasonalised data</li>
<li>Putting it all together</li>
<li>Forecasting with seasonal data</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">5.5.1 &nbsp; Seasonal patterns</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Seasonal data</p>
	<p>In monthly or quarterly data, there is often a pattern of peaks and troughs
 that repeats in a similar way each year. Daily data often show a  pattern
 that repeats each week, and hourly data often have a daily pattern. These 
		are all called <strong>seasonal patterns</strong>.</p>
<p class="eqn"><img src="../../../en/seasonal/images/s_seasonalPlot.gif" width="541" height="305"></p>
	<p>The diagram below removes a monthly seasonal effect with 12-point moving averages.</p>
	<p class="eqn"><img src="../../../en/seasonal/images/s_movingAve.gif" width="537" height="287"></p>
	<p class="heading">Using per capita data</p>
	<p>Looking at trends in 'quantity' values (e.g. a country's total alcohol consumption) is misleading over a period in which the population  increases. It is more meaningful to examine quantities <strong>per person</strong>.</p>
	
	<div class="centred"><div class="boxed">
<p>Always consider carefully whether a different variable would describe the
data more meaningfully.</p>
</div></div>




<h2 class="pageName">5.6.5 &nbsp; Types of time series data</h2><!DOCTYPE HTML>


<p class="heading notPrinted">A classification of time series</p>
	<p>Time series data arise in various different contexts.</p>
	<dl>
		<dt><strong>Measurements relating to events that occur at discrete times</strong></dt>
		<dt><strong>Regular snapshots of a continuous process</strong></dt>
		<dt><strong>Quantities that are aggregated over a period</strong></dt>
	</dl>
	<p>The measurements themselves may be:</p>
	<dl>
		<dt><strong>Continuous</strong></dt>
		<dt><strong>Discrete</strong></dt>
	</dl>
	<p>In this e-book, all of the above types of time series are analysed in the
same way.</p>




</html>
