<html>
<head>
  <title>4. Exploring Multivariate Data</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="../../../structure/printStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/summaryStyles.css" type="text/css">
  <script src="../../../structure/videoControls/jquery.js"></script>
  <script src="../../../structure/printFixes.js"></script>
</head>

<body id="body" onLoad="showPrintDialog(true)">
<div id='overlay'>
	<div id='dialogWindow'>
		<div class='printDialog'>
			<script type='text/javascript'>
				document.write("<div class='heading'>" + top.document.title + "</div>");
				if (top.url != null) {
					document.write("<p class='text'>A version of this chapter has already been generated in PDF format and we recommend that it is used for printing. The button below will download and display it.</p>");
					document.write("<p><button onClick='top.showPdf()'>Show PDF version of chapter</button></p>");
					document.write("<p class='text'>However downloading could be slow depending on your internet connection. If this is a problem, click the button below to print the chapter without downloading (but perhaps not formatted as well as the PDF version).</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>If you are <strong>not</strong> using the PDF version, the best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
				else {
					document.write("<p class='text'>Click the button below to print this chapter.</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>The best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
			</script>
			
			<p class='text'>If you don't want to print now,</p>
			<p><button onClick='top.showPrintDialog(false)'>Browse formatted chapter</button></p>
		</div>
	</div>
</div>
<h1 class="chapterName">Chapter 4 &nbsp; Exploring Multivariate Data</h1>
<h1 class="sectionName">4.1 &nbsp; Groups and regression</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Additional variables in regression</li>
<li>Displaying groups</li>
<li>Regression with grouped data</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='4'>
<li>Parallel regression lines</li>
<li>Transformed variables and groups</li>
<li>Grouping with a numerical variable</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">4.1.1 &nbsp; Additional variables in regression</h2><!DOCTYPE HTML>


<p class="heading">Three or more variables</p>
	<p>We previously described the relationship between two numerical variables, <em>X</em> and <em>Y</em>.</p>
	<ul>
		<li>The correlation coefficient summarises the strength of their relationship.</li>
		<li>The least squares line summarises the 'shape' of the relationship &mdash; it 
			can be used to predict <em>Y</em> from <em>X</em>.</li>
	</ul>
	<p>In many applications, more than two measurements are made from each individual and the  additional variables may throw light on the relationship.</p>
	<p>Use of this extra information may lead to  more accurate predictions of <em>Y</em>.</p>




<h2 class="pageName">4.1.2 &nbsp; Displaying groups</h2><!DOCTYPE HTML>


<p class="heading">Distinguishing groups in a  scatterplot</p>
	<p>We now consider  how a categorical variable, <em>Z</em>, can  help explain the relationship between two numerical variables, <em>X</em> and <em>Y</em>. It equivalently examines whether the relationship between <em>X</em> and <em>Y</em> is the same in each of several groups.</p>
	<p>As in most other situations, data analysis should  start by examining the data graphically. Differences between the groups can be shown with different symbols and/or colours for the crosses in a scatterplot of  <em>Y</em> against <em>X</em>.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_scatterGroups.gif" width="419" height="395"></p>
	<p class="heading">Parallel regression lines</p>
	<p>Interpretation is considerably simplified if we constrain the  regression lines for the different groups to have the same slope. In the diagram below, the difference between the groups is the same for all values of <em>X</em>.</p>
	<p class="eqn"><img class="gif" src="../../../en/regnGroups/images/parallelLines.gif" width="313" height="274"></p>
	<p>Parallel lines are not appropriate descriptions of all data sets. Always check a scatterplot first.</p>
	<p class="heading">Least squares</p>
	<p>The principle behind fitting  parallel lines to two or more groups is the same as in ordinary simple regression &mdash; we choose the parameters to minimise the sum of squared residuals (vertical distances between the data crosses and their corresponding line). The resulting formulae are complicated, but most statistical software will do the calculations for you.</p>





<h2 class="pageName">4.1.5 &nbsp; Transformed variables and groups</h2><!DOCTYPE HTML>


<p class="heading">Transformation of the response</p>
	<p>It is much easier to interpret the parameters when parallel lines are fitted to different groups than when their slopes are different, but the data or the context may not justify such a simplification.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_beforeLog.gif" width="436" height="331"></p>
	<p>After a nonlinear transformation of the response, the relationships in the two groups may be closer to parallel. A  transformation to reduce skewness in the reponse often works well.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_afterLog.gif" width="436" height="331"></p>
	<p class="heading">Understanding the model for ln(<em>y</em>)</p>
	<p>Logarithmic transformations are particularly useful because the parallel least squares lines have a simple interpretation. For the above data they are:</p>
	<p align="center">Female:    ln (<em>y</em>) = 0.391 + 0.0747 <em>x<br>
	</em>Male:       ln (<em>y</em>) = 1.192 + 0.0747 <em>x</em></p>
	<p>This means that:</p>
	<div class="centred"><div class="boxed">
		<p><em>ln(y) </em> is (1.192&nbsp;-&nbsp;0.391)&nbsp;=&nbsp;0.801 higher for females than for males with the same <em>x</em>.</p>
	</div></div>
	<p>We can now concisely summarise the difference between males and females:</p>
	<div class="centred"><div class="boxed">
		<p><em>y </em> for females is e<sup>0.810</sup>&nbsp;=&nbsp;2.23 times that for males with the same <em>x</em>.</p>
	</div></div>




<h2 class="pageName">4.1.6 &nbsp; Grouping with a numerical variable</h2><!DOCTYPE HTML>


<p class="heading">Definition of groups</p>
	<p>A categorical variable naturally splits the individuals into groups, but a numerical variable, <em>Z</em>, can also be used to define groups.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_groupedNum.gif" width="432" height="346"></p>




<h1 class="sectionName breakBefore">4.2 &nbsp; Representing a third variable</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Representing a third variable</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='2'>
<li>Rotating 3D scatterplots</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">4.2.1 &nbsp; Representing a third variable</h2><!DOCTYPE HTML>


<p class="heading">Different plotting symbols for a third variable</p>
	<p>The simplest way to show the relationship between <strong>three</strong> numerical variables is based on a scatterplot of two of the variables, with the third 
		variable being represented by  differing symbols instead of identical 
		'crosses'. Possibilities are:</p>
	<ul>
		<li>Colour</li>
		<li>Size</li>
		<li>Angle</li>
	</ul>
	<p>Although this kind of scatterplot is easy to draw, it is usually hard to 
		interpret. The decision about  which of the three variables to represent using 
				the plotting symbol  can make interpretation easier.</p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_symbols.gif" width="408" height="257"></p>




<h2 class="pageName">4.2.2 &nbsp; Rotating 3D scatterplots</h2><!DOCTYPE HTML>


<p class="heading">3-dimensional scatterplots</p>
	<p>The most direct way to extend a standard scatterplot of two variables, <em>X</em> and <em>Y</em>, to include a third variable, <em>Z</em>, is to add a third dimension to become an axis for <em>Z</em>. Each individual would be represented by a cross in a 3-dimensional cube.</p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_3dScatter.gif" width="348" height="326"></p>
	<p>Although a computer screen is only 2-dimensional, it can display a projection of
		such a 3-dimensional scatterplot. Rotating such a display with the mouse gives a good
	feel for the shape of the underlying 3-dimensional scatter of points. This is a <strong>dynamic</strong> display that
	is only effective on a computer &mdash; the information in the display is conveyed by <strong>movement</strong>. On paper, we can only present information in two dimensions.</p>
	<p>Three-dimensional scatterplots are an interesting (and occasionally useful)
		way to display data. They are however <strong>much overrated</strong> as an analysis
		technique and simpler displays are usually
		more effective for extracting information from multivariate data.</p>




<h1 class="sectionName breakBefore">4.3 &nbsp; Scatterplot matrices & brushing</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Scatterplot matrix and brushing</li>
<li>Brushing example</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='3'>
<li>Slicing</li>
<li>Scatterplot matrix with groups</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">4.3.1 &nbsp; Scatterplot matrix and brushing</h2><!DOCTYPE HTML>


<p class="heading">Scatterplots of all pairs of variables</p>
	<p>The problem of displaying relationships becomes even more difficult when there
		are more than three variables. It is possible to gain some insight into their relationships 
		with an array of <strong>scatterplots of all pairs of variables</strong>, called a <strong> scatterplot matrix</strong>.</p>
	<p class="heading">Brushing</p>
	<p>Although a <strong>static</strong>  scatterplot matrix reveals some aspects of 
		the relationships between the variables, more insight into the data is obtained 
		by adding <strong>dynamic</strong> features. </p>
	<p>On a computer display, the scatterplots can be dynamically linked, so that clicking on a cross on one
		scatterplot highlights that individual in <strong>all</strong> scatterplots.
		<strong>Brushing</strong> extends this to allow highlighting of multiple crosses on
	a scatterplot with a 'brush' tool. </p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_scatMatrixBrush.gif" width="551" height="500"></p>




<h2 class="pageName">4.3.2 &nbsp; Brushing example</h2><!DOCTYPE HTML>


<p class="heading">More about brushing</p>
	<p>Brushing can be used on <strong>any</strong> linked displays of the same data set. </p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_brushUsa.gif" width="551" height="420"></p>




<h2 class="pageName">4.3.3 &nbsp; Slicing</h2><!DOCTYPE HTML>


<p class="heading">Slicing a scatterplot using a third variable</p>
	<p><strong>Slicing</strong> is a dynamic technique that only displays a subset of the individuals, based on a restricted range of values for one particular variable. For example, we might display a scatterplot of <em>Y</em> against <em>X</em>, but only for individuals whose values of <em>Z</em> are between 20 and 30. The subset can be dynamically changed with a slider or other control to show whether the relationship between <em>X</em> and <em>Y</em> is different for individuals with low <em>Z</em> and high <em>Z</em>.</p>
	<p class="heading">Trellis plot</p>
	<p>Slicing is a dynamic method and must therefore be performed on a computer. Although less effective, an alternative is to show a series of static plots for different slices of the data. This is called a <strong>trellis plot</strong>.</p>
	<p class="eqn"><img src="../../../en/multivariate/images/s_trellis.gif" width="550" height="460"></p>




<h2 class="pageName">4.3.4 &nbsp; Scatterplot matrix with groups</h2><!DOCTYPE HTML>


<p class="heading">Distinguishing groups in a scatterplot matrix</p>
	<p>A scatterplot matrix can help to describe the relationships between 3 or more numerical variables. If each individual belongs to one of several known groups, different symbols or colours can be used to distinguish the groups.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_scatMatrix.gif" width="520" height="495"></p>




</html>
