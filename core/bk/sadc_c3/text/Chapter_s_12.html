<html>
<head>
  <title>12. Describing Relationships</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="../../../structure/printStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/summaryStyles.css" type="text/css">
  <script src="../../../structure/videoControls/jquery.js"></script>
  <script src="../../../structure/printFixes.js"></script>
</head>

<body id="body" onLoad="showPrintDialog(true)">
<div id='overlay'>
	<div id='dialogWindow'>
		<div class='printDialog'>
			<script type='text/javascript'>
				document.write("<div class='heading'>" + top.document.title + "</div>");
				if (top.url != null) {
					document.write("<p class='text'>A version of this chapter has already been generated in PDF format and we recommend that it is used for printing. The button below will download and display it.</p>");
					document.write("<p><button onClick='top.showPdf()'>Show PDF version of chapter</button></p>");
					document.write("<p class='text'>However downloading could be slow depending on your internet connection. If this is a problem, click the button below to print the chapter without downloading (but perhaps not formatted as well as the PDF version).</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>If you are <strong>not</strong> using the PDF version, the best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
				else {
					document.write("<p class='text'>Click the button below to print this chapter.</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>The best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
			</script>
			
			<p class='text'>If you don't want to print now,</p>
			<p><button onClick='top.showPrintDialog(false)'>Browse formatted chapter</button></p>
		</div>
	</div>
</div>
<h1 class="chapterName">Chapter 12 &nbsp; Describing Relationships</h1>
<h1 class="sectionName">12.1 &nbsp; Correlation</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Units for X and Y</li>
<li>Units-free variables (z-scores)</li>
<li>Correlation coefficient</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='4'>
<li>Scatterplots and the value of r</li>
<li>Nonlinear relationships</li>
<li>R does not tell the whole story</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">12.1.1 &nbsp; Units for X and Y</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Units and strength of a relationship</p>
	<p>A numerical summary of the strength of the relationship between two variables
should not depend on the units in which we measure the two variables. The strength
of the two relationships between Angle and Temperature are the same in both of
the scatterplots below.</p>
	<p class="eqn"><img src="../../../en/correlation/images/s_units.gif" width="550" height="219"></p>
	<p>We therefore start by defining <strong>units-free</strong> versions of the two variables and will summarise the strength of the relationship in terms of them.</p>




<h2 class="pageName">12.1.2 &nbsp; Units-free variables (z-scores)</h2><!DOCTYPE HTML>


<p class="heading">Z-scores</p>
	<p>The <strong>standardised</strong> form of a variable X is found by subtracting its mean then dividing by its standard deviation,</p>
	<p class=eqn><span class="black bold">standardised value,</span> &nbsp; <img class="gif" src="../../../en/correlation/images/standardiseX.gif" id="gif_image_1_2_1" width="105" height="39"><iframe class="svg" src="../../../en/correlation/images/standardiseX.svg" id="svg_image_1_2_1" width="105" height="39" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_2_1");</script></p>
	<p>The resulting values are  called <strong>z-scores</strong> and are the same,
whatever the units in which X was originally recorded.</p>
<p class="heading">Properties of z-scores</p>
	<p>A standardised variable always has zero mean and standard deviation one. </p>
	<p class=eqn> <img class="gif" src="../../../en/correlation/images/standardMeanSD.gif" id="gif_image_1_2_2" width="110" height="18"><iframe class="svg" src="../../../en/correlation/images/standardMeanSD.svg" id="svg_image_1_2_2" width="110" height="18" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_2_2");</script> </p>
	<p>From the  <a href="javascript:showNamedPage('centerSpread6')">70-95-100 
	rule-of-thumb</a>, </p>
	<div class="centred"><div class="boxed">
		<ul>
			<li>About 70% of z-scores will be between -1 and +1</li>
			<li>About 95% of z-scores will be between -2 and +2</li>
			<li>Almost all z-scores will be between -3 and +3</li>
		</ul>
	</div></div>
	<p>An individual's z-score tells you how many standard deviations it is above the mean. From its value, you can tell whether the value is very high (say over +2) or low (say under -2) in relation to the other values  of the variable.</p>




<h2 class="pageName">12.1.3 &nbsp; Correlation coefficient</h2><!DOCTYPE HTML>


<p class="heading">Definition</p>
<p>The <strong>correlation coefficient</strong> is usually defined by the formula </p>
<p class=eqn><img class="gif" src="../../../en/correlation/images/corrDefn2.gif" id="gif_image_1_3_2" width="213" height="67"><iframe class="svg" src="../../../en/correlation/images/corrDefn2.svg" id="svg_image_1_3_2" width="213" height="67" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_3_2");</script></p>
<p>It is however easier to understand if written in terms of standardised versions
of <em>X</em> and <em>Y</em>,</p>
<p class=eqn> <img class="gif" src="../../../en/correlation/images/corrDefn.gif" id="gif_image_1_3_1" width="110" height="44"><iframe class="svg" src="../../../en/correlation/images/corrDefn.svg" id="svg_image_1_3_1" width="110" height="44" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_3_1");</script> </p>
<div class="centred"><div class="boxed">
	<p>The correlation coefficient is a kind of <strong>average of the products</strong> of the z-scores.</p>
</div></div>
<p class="heading">How does <i>r</i> relate to the shape of a scatterplot?</p>
<p>The following properties of <i>r</i> explain in general terms how its value 
	is related to the strength of a relationship in any particular scatterplot.</p>
<div class="centred"><table border="0" cellpadding="5" cellspacing="0" class="centred" style="border-collapse:collapse">
<tr style="background-color:#D2EDFF; border-top:2px solid #CCCCCC; border-bottom:2px solid #CCCCCC;">
	<td style="vertical-align:middle; padding-right:30px;"><img class="gif" src="../../../en/correlation/images/property1.gif" id="gif_image_1_3_3" width="224" height="92"><iframe class="svg" src="../../../en/correlation/images/property1.svg" id="svg_image_1_3_3" width="224" height="92" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_3_3");</script></td>
	<td style="vertical-align:middle;"><img class="gif" src="../../../en/correlation/images/property2.gif" id="gif_image_1_3_4" width="224" height="92"><iframe class="svg" src="../../../en/correlation/images/property2.svg" id="svg_image_1_3_4" width="224" height="92" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_3_4");</script></td>
</tr>

<tr style="background-color:#F9FFF8; border-top:2px solid #CCCCCC; border-bottom:2px solid #CCCCCC;">
	<td colspan="2" align="center" style="vertical-align:middle; padding-right:30px;"><img class="gif" src="../../../en/correlation/images/property3.gif" id="gif_image_1_3_5" width="219" height="92"><iframe class="svg" src="../../../en/correlation/images/property3.svg" id="svg_image_1_3_5" width="219" height="92" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_3_5");</script></td>
</tr>

<tr style="background-color:#D2EDFF; border-top:2px solid #CCCCCC; border-bottom:2px solid #CCCCCC;">
	<td style="vertical-align:middle; padding-right:30px;"><img class="gif" src="../../../en/correlation/images/property4.gif" id="gif_image_1_3_6" width="224" height="92"><iframe class="svg" src="../../../en/correlation/images/property4.svg" id="svg_image_1_3_6" width="224" height="92" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_3_6");</script></td>
	<td style="vertical-align:middle;"><img class="gif" src="../../../en/correlation/images/property5.gif" id="gif_image_1_3_7" width="224" height="92"><iframe class="svg" src="../../../en/correlation/images/property5.svg" id="svg_image_1_3_7" width="224" height="92" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_1_3_7");</script></td>
</tr>

<tr style="background-color:#F9FFF8; border-top:2px solid #CCCCCC; border-bottom:2px solid #CCCCCC;">
	<td height="50" colspan="2" align="center" style="vertical-align:middle; padding-right:30px;"><span class="black">&minus;1 &nbsp;&le;&nbsp; <em>r</em> &nbsp;&le;&nbsp; +1</span></td>
</tr>
</table></div>




<h2 class="pageName">12.1.4 &nbsp; Scatterplots and the value of r</h2><!DOCTYPE HTML>


<p class="heading">How does <i>r</i> relate to the shape of a scatterplot?</p>
<p>The properties on the previous page describe the general behaviour of the correlation coefficient, 
	but do not give enough resolution for you to anticipate the type of scatterplot 
	that might have correlation coefficient 0.8 say, or 0.96.</p>
<p class="eqn"><img src="../../../en/correlation/images/s_rValue.gif" width="550" height="452"></p>
<p>Note that values of <em>r</em> between -0.5 and 0.5 correspond to very weak relationships.</p>




<h2 class="pageName">12.1.5 &nbsp; Nonlinear relationships</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Correlation and nonlinear relationships</p>
	<p>The correlation coefficient, <i>r</i>, is a good description of the strength
of a relationship <strong>provided the crosses in a scatterplot of the data are not
scattered round a curve</strong>. If the data are scattered round a curve, the relationship
is called <strong>nonlinear</strong> and <i>r</i> may seriously underestimate its
strength.</p>
<p class="eqn"><img src="../../../en/correlation/images/s_curved.gif" width="556" height="246"></p>
	
<div class="centred"><div class="boxed">
<p>The correlation coefficient does <strong>not</strong> describe
the strength of nonlinear relationships adequately.</p>
</div></div>

	



<h2 class="pageName">12.1.6 &nbsp; R does not tell the whole story</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Always look at a scatterplot first</p>
	<p>Although the correlation coefficient is a good description of the strength 
		of many relationships, it does not adequately describe others.</p>
	
<div class="centred"><div class="boxed">
<p>A scatterplot should always be examined to help 
				assess whether there are features in the data that the correlation coefficient 
				cannot describe.</p>
</div></div>

	<p>The data sets below share the same value of <em>r</em> = 0.816 (and the same
means and st devns for <em>X</em> and <em>Y</em>) but their scatterplots show
that different conclusions should be drawn from them.</p>
	<p align="center"><img src="../../../en/correlation/images/s_anscombe.gif" width="550" height="440"></p>




<h1 class="sectionName breakBefore">12.2 &nbsp; Least squares</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Predicting Y from X</li>
<li>Linear models</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='3'>
<li>Fitted values and residuals</li>
<li>Least squares</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">12.2.1 &nbsp; Predicting Y from X</h2><!DOCTYPE HTML>


<p class="heading">The notion of prediction</p>
	<dl>
		<dt>Causal relationships</dt>
		<dd>If one variable, <em>X</em>, is thought to directly affect the 
			other, <em>Y</em>, we might hope to predict 
			the value of <em>Y</em> if the value of <em>X</em> is changed.<br>
		</dd>
		<dt>Non-causal relationships</dt>
		<dd>Even if the relationship is not causal, we are often still interested 
			in predicting the value of one variable from a known value of the other 
			variable.<br>
		</dd>
	</dl>
	<p class="heading">Notation and convention</p>
	<p>If the variables can be classified as an <strong>explanatory 
		variable</strong> and a <strong>response</strong>, we  use the letter<i> X</i> to denote the explanatory 
		variable and <i>Y</i> to denote the response.</p>
	
<div class="centred"><div class="boxed">
<p>Always draw the response variable, <i>Y</i>, on the vertical 
				axis of a scatterplot and <i>X</i> on the horizontal axis.</p>
</div></div>

	<p class="heading">Predicting the response</p>
	<p>The correlation coefficient describes the <strong>strength</strong> of a
 relationship, but does not help you to predict <em>Y</em> from <em>X</em>.</p>
<p>A  curve or
straight line that is drawn close to the crosses on a scatterplot (by eye or
by any other method) is called a <strong>regression line</strong> and can be
used to 'read off' the y-value corresponding to any <em>x</em>.</p>
<p class="eqn"><img src="../../../en/leastSqrs/images/s_predict.gif" width="357" height="272"></p>
	



<h2 class="pageName">12.2.2 &nbsp; Linear models</h2><!DOCTYPE HTML>


<p class="heading">Equation to describe a regression line</p>
	<p>A regression line could be drawn 'by eye' through a scatterplot, 
		but we restrict attention to simple mathematical functions</p>
	<p class=eqn><span class="black"><em>y</em> &nbsp;=&nbsp; <em>&fnof;</em> (<em> x</em> )</span></p>
	<p>since they are  easier and more objective to use.</p>
<p class="heading">Linear model</p>
	<p>Some relationships must be described by curves, but a straight line 
		is an adequate description of many bivariate data sets.</p>
	<p class=eqn><span class="black"><em>y</em> &nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></span> </p>
	<p>The constant <em>b</em><sub>0</sub> is  the <strong>intercept</strong> of
the line and describes the <em>y</em>-value when <em>x</em> is zero. The constant <em>b</em><sub>1</sub> is
the line's <strong>slope</strong>; it 
		describes the change in <i>y</i> when <i>x</i> increases by one. </p>
<p class="eqn"><img src="../../../en/leastSqrs/images/s_slopeIntercept.gif" width="238" height="197"></p>
	<p>The predicted response at any <em>x</em>-value is</p>
<p class=eqn><span class="black"><span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yHat.png" width="10" height="17" align="baseline"></span>&nbsp; =&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></span> </p>




<h2 class="pageName">12.2.3 &nbsp; Fitted values and residuals</h2><!DOCTYPE HTML>


<p class="heading">Fitted values</p>
	<p>To assess how well a particular linear model fits any one of our data points, (<em>x<sub>i</sub></em>,&nbsp;<em>y<sub>i</sub></em>), 
	we might consider how well the model would predict the y-value of the point, </p>
	<p class=eqn><span class="black"><span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span>&nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x<sub>i</sub></em></span> </p>
	<p>These predictions  are called <strong>fitted 
		values</strong>. </p>
	<p class="heading">Residuals</p>
	<p>The difference between the <em>i</em>'th fitted values  and its actual 
		y-value is called its <strong>residual</strong>. </p>
	<p class=eqn><span class="black"><em>e<sub>i</sub></em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>y<sub>i</sub></em> &minus; <span style="position:relative; top:4"><img src="../../../en/../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span></span> </p>
	<p>The residuals describe the 'errors' that would have resulted from using the
 model to predict <em>y</em> from the <em>x</em>-values of our data points.</p>
<p class="eqn"><img src="../../../en/leastSqrs/images/s_resid.gif" width="351" height="207"></p>
	
	<p>Note that the residuals are the <strong>vertical distances of the crosses to the line</strong>.</p>
	
	



<h2 class="pageName">12.2.4 &nbsp; Least squares</h2><!DOCTYPE HTML>


<p class="heading">Aim of small residuals</p>
	<p>The residuals from a linear model (vertical distances from the crosses 
		to the line) indicate how closely the model's predictions  match the actual responses in the data. </p>
	<p class="eqn"><img src="../../../en/leastSqrs/images/s_allResids.gif" width="354" height="310"></p>
	<p>Small residuals are good, so the parameters <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub>  should
be set to make them as small as possible.</p>
	<p class="heading">Least squares</p>
	<p>The size 
		of the residuals is summarised by the <strong>residual sum of squares</strong>, </p>
<p class=eqn><img class="gif" src="../../../en/leastSqrs/images/residSsq.gif" id="gif_image_2_4_2" width="317" height="28"><iframe class="svg" src="../../../en/leastSqrs/images/residSsq.svg" id="svg_image_2_4_2" width="317" height="28" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_2_4_2");</script> </p>
	<p>'Good' values for <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub> can be
objectively chosen to be the values that minimise the residual sum of squares.
This is the <strong>method
of least squares</strong> and the values of <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub> are
called  <strong>least squares 
		estimates</strong>.</p>
<p>The diagram below respresents the squared residuals as blue squares. The least squares estimates minimise the total blue area.</p>
	<p class="eqn"><img src="../../../en/leastSqrs/images/s_sqrResids.gif" width="359" height="316"></p>
	<p class="heading">Formulae</p>
	<p>The problem of minimising the residual sum of squares is not difficult mathematically, 
    but you will rarely require or use the resulting formulae for <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub> since spreadsheets, statistical programs and even scientific calculators will 
  do the calculations for you. However, for completeness, the formulae are </p>
	<p class=eqn><img class="gif" src="../../../en/leastSqrs/images/lsFormulae.gif" id="gif_image_2_4_1" width="350" height="57"><iframe class="svg" src="../../../en/leastSqrs/images/lsFormulae.svg" id="svg_image_2_4_1" width="350" height="57" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_2_4_1");</script> </p>




<h1 class="sectionName breakBefore">12.3 &nbsp; Simple diagnostics</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Curvature and outliers</li>
<li>Residual plots</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='3'>
<li>Predicting Y and predicting X</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">12.3.1 &nbsp; Curvature and outliers</h2><!DOCTYPE HTML>


<p class="heading">Nonlinear relationships</p>
	<p>A simple linear model is only appropriate when the cloud of crosses 
	in a scatterplot of the data is regularly spread around a straight line. If the crosses are scattered round a <strong>curve</strong>, the relationship is called <strong>nonlinear</strong> and
other models must be used.</p>
<p class="heading">Outliers</p>
<p>Another problem arises if there are <strong>outliers</strong> &mdash; observations that do not conform to the 
		pattern and variability exhibited by the rest of the data. In a linear model, 
		the most important type of outlier is a data point that lies at a distance 
		from the line that would fit through the rest of the data. </p>
	<p>The individual corresponding to any outlier should be carefully examined. Recording
		or transcription errors may be the cause. Alternatively, it may be possible to determine some
		distinguishing characteristic of the individual that underlies the unusual response
		measurement. </p>
	<p>If an outlier is extreme enough, or if a special cause for its unusual behaviour can be
		found from outside information, the individual can be classified as aberrant
		and deleted from the data set.</p>
	<div class="centred"><div class="boxed">
		<p>It is important to <strong>look at any data set graphically</strong> before
fitting a linear model to check that no curvature or outliers is present.</p>
	</div></div>
	



<h2 class="pageName">12.3.2 &nbsp; Residual plots</h2><!DOCTYPE HTML>


<p class="heading">Detecting problems with the model</p>
	<p>If outliers or curvature are present in a data set, they are often visible 
		in a scatterplot of the response against the explanatory variable. However 
		these features are usually clearer if the <strong>residuals</strong> are plotted 
		against <i>X</i> rather than the original response.</p>
	<p class="eqn"><img src="../../../en/leastSqrs/images/s_residPlot.gif" width="557" height="264"></p>




<h2 class="pageName">12.3.3 &nbsp; Predicting Y and predicting X</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Different lines are used to predict Y and to predict X</p>
	<p>The 
		least squares line for predicting Y from X,</p>
	<p class=eqn><span class="black"><em>y</em> &nbsp;=&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></span></p>
	<p> minimises the sum of squared <strong>vertical</strong> distances between 
		the points on a scatterplot and the line. On the other hand, if we are interested 
		in predicting X from Y using a line,</p>
	<p class=eqn><span class="black"><em>x</em> &nbsp;=&nbsp; <em>c</em><sub>0</sub> + <em>c</em><sub>1 </sub><em>y</em></span></p>
	<p>the residuals are the <strong>horizontal</strong> distances between the points 
		and the line, and least squares minimises their sum 
		of squares.</p>
	<p class=eqn><img class="gif" src="../../../en/leastSqrs/images/predictAndInverse.gif" id="gif_image_3_3_1" width="469" height="209"><iframe class="svg" src="../../../en/leastSqrs/images/predictAndInverse.svg" id="svg_image_3_3_1" width="469" height="209" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_3_1");</script></p>
	<p><strong>Different lines</strong> minimise the sum of squares of horizontal and vertical distances.</p>
	<p class="heading">About the two least squares lines</p>
	<p>The two least squares lines can be  written in terms of standardised 
		variables,</p>
<div class="centred"><table border="0" cellspacing="0" cellpadding="10" class="centred">
		<tr>
			<th>Equation of least squares line to predict Y from X</th>
			<td><img class="gif" src="../../../en/leastSqrs/images/yxLsLine.gif" id="gif_image_3_3_3" width="135" height="44"><iframe class="svg" src="../../../en/leastSqrs/images/yxLsLine.svg" id="svg_image_3_3_3" width="135" height="44" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_3_3");</script></td>
		</tr>
		<tr>
			<th>Equation of least squares line to predict X from Y</th>
			<td><img class="gif" src="../../../en/leastSqrs/images/xyLsLine.gif" id="gif_image_3_3_2" width="136" height="44"><iframe class="svg" src="../../../en/leastSqrs/images/xyLsLine.svg" id="svg_image_3_3_2" width="136" height="44" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_3_3_2");</script></td>
		</tr>
	</table></div>
	<p>where <i>r</i> is the correlation coefficient between <i>X</i> and <i>Y</i>. 
		Since <i>r</i> is always less than 1, the least squares line for predicting <i>Y</i> from <i>X</i> is the more horizontal (closer to being parallel to 
		the x-axis) of the two lines.</p>
<p class="eqn"><img src="../../../en/leastSqrs/images/s_dualLines.gif" width="410" height="313"></p>




<h1 class="sectionName breakBefore">12.4 &nbsp; Nonlinear relationships</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Transformations and correlation</li>
<li>Transformations and models</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='3'>
<li>Quadratic models</li>
<li>Dangers of extrapolation</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">12.4.1 &nbsp; Transformations and correlation</h2><!DOCTYPE HTML>


<p class="heading">Correlation coefficient and nonlinear relationships</p>
	<p>The correlation coefficient, <i>r</i>, is a good description of the strength 
		of linear relationship but <a href="javascript:showNamedPage('correlation4')">not 
			nonlinear ones</a>. If a scatterplot shows marked curvature, the correlation 
		coefficient can considerably understate the strength of the relationship.</p>
	<p class="heading">Transform the variables to linearise the relationship</p>
	<p>Nonlinear transformations of X and Y alters the shape of the relationship. It is often possible 
		to linearise a relationship by transforming one or both variables.</p>
<p>The strength of a nonlinear relationship can therefore be described with the
correlation coefficient after  a transformation to one or both variables has
been applied to <strong>remove
the nonlinearity</strong>.</p>
<p class="eqn"><img src="../../../en/curvature/images/s_rawCorr.gif" width="354" height="276"><img src="../../../en/curvature/images/s_logCorr.gif" width="354" height="276"></p>




<h2 class="pageName">12.4.2 &nbsp; Transformations and models</h2><!DOCTYPE HTML>


<p class="heading">Linear model with transformed variables</p>
	<p>If the relationship between <i>Y</i> and <i>X</i> is nonlinear, a linear 
		model will give poor predictions and must be avoided.</p>
	<p class="eqn"><img src="../../../en/curvature/images/s_rawModel.gif" width="303" height="230"></p>
	<p>However, by transforming 
		one or both of the variables, it is often possible to linearise the relationship 
		and therefore use least squares to fit a linear model to the transformed variables.</p>
	<p class="eqn"><img src="../../../en/curvature/images/s_logModel.gif" width="550" height="232"></p>
	<p>A logarithmic transformation of either Y or X often works, but a more general 
		power transformation is sometimes needed to linearise the relationship.</p>




<h2 class="pageName">12.4.3 &nbsp; Quadratic models</h2><!DOCTYPE HTML>


<p class="heading notPrinted">Adding a quadratic term</p>
	<p>An alternative solution to the problem of curvature is to extend the simple 
		linear model with the addition of a quadratic term, </p>
	<p class=eqn><span class="black"><em>y</em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x</em>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>2 </sub><em>x</em><sup>2</sup></span> </p>
	<p>Fitted values and residuals are defined (and interpreted) in a similar way 
		to those for a linear model,</p>
	<p class=eqn><span class="black"><span style="position:relative; top:4"><img src="../../../en/../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x<sub>i</sub></em>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x<sub>i</sub></em><sup>2</sup></span> <br>
			<span class="black"><em>e<sub>i</sub></em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>y<sub>i</sub></em> &minus; <span style="position:relative; top:4"><img src="../../../en/../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span></span> </p>
	<p>As in a linear model, the quadratic model's residuals are the vertical distances 
		between the crosses in a scatterplot and the curve. We again use <strong>least 
			squares</strong> to estimate the unknown parameters &mdash; choose values of the 
		three parameters to minimise the residual sum of squares, </p>
	<p class=eqn><img class="gif" src="../../../en/curvature/images/residSsqEqn.gif" id="gif_image_4_3_1" width="369" height="28"><iframe class="svg" src="../../../en/curvature/images/residSsqEqn.svg" id="svg_image_4_3_1" width="369" height="28" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_4_3_1");</script> </p>
	<p class="eqn"><img src="../../../en/curvature/images/s_quadraticModel.gif" width="374" height="327"></p>




<h2 class="pageName">12.4.4 &nbsp; Dangers of extrapolation</h2><!DOCTYPE HTML>


<p class="heading notPrinted">The shape of a relationship is only known around the data</p>
	<p>The models that we have used to describe the relationship between a response, <i>Y</i>, and explanatory variable, <i>X</i>, are usually only approximations to
		the 'real' relationship. For example, a scatterplot may <strong>look</strong> linear,
		but we really have no information about the shape of the relationship beyond our data. </p>
	<p class=eqn><img class="gif" src="../../../en/curvature/images/extrapolate.gif" id="gif_image_4_4_1" width="256" height="166"><iframe class="svg" src="../../../en/curvature/images/extrapolate.svg" id="svg_image_4_4_1" width="256" height="166" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_4_4_1");</script>
	<p>A model may be useful for predicting <i>Y</i> from values of <i>X</i> that are within the range of x-values in our data, but we
		should be very cautious about using it to predict <em>Y</em> outside this range.
		This is called <strong>extrapolation</strong> and it can be badly in error. </p>
	
<div class="centred"><div class="boxed">
<p>Avoid using a model to predict <em>Y</em> far beyond the available 
				data.</p>
</div></div>





<h1 class="sectionName breakBefore">12.5 &nbsp; Groups and regression</h1>
<div class='leftTocCol'>
<ol class='toc'>
<li>Additional variables in regression</li>
<li>Displaying groups</li>
<li>Regression with grouped data</li>
<li>Parallel regression lines</li>
</ol>
</div>
<div class='rightTocCol'>
<ol class='toc' start='5'>
<li>Transformed variables and groups</li>
<li>Grouping with a numerical variable</li>
<li>Scatterplot matrix with groups</li>
</ol>
</div>
<br clear='all'>
<h2 class="pageName">12.5.1 &nbsp; Additional variables in regression</h2><!DOCTYPE HTML>


<p class="heading">Three or more variables</p>
	<p>We previously described the relationship between two numerical variables, <em>X</em> and <em>Y</em>.</p>
	<ul>
		<li>The correlation coefficient summarises the strength of their relationship.</li>
		<li>The least squares line summarises the 'shape' of the relationship &mdash; it 
			can be used to predict <em>Y</em> from <em>X</em>.</li>
	</ul>
	<p>In many applications, more than two measurements are made from each individual and the  additional variables may throw light on the relationship.</p>
	<p>Use of this extra information may lead to  more accurate predictions of <em>Y</em>.</p>




<h2 class="pageName">12.5.2 &nbsp; Displaying groups</h2><!DOCTYPE HTML>


<p class="heading">Distinguishing groups in a  scatterplot</p>
	<p>We now consider  how a categorical variable, <em>Z</em>, can  help explain the relationship between two numerical variables, <em>X</em> and <em>Y</em>. It equivalently examines whether the relationship between <em>X</em> and <em>Y</em> is the same in each of several groups.</p>
	<p>As in most other situations, data analysis should  start by examining the data graphically. Differences between the groups can be shown with different symbols and/or colours for the crosses in a scatterplot of  <em>Y</em> against <em>X</em>.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_scatterGroups.gif" width="419" height="395"></p>




<h2 class="pageName">12.5.3 &nbsp; Regression with grouped data</h2><!DOCTYPE HTML>


<p class="heading">Least squares in each group</p>
	<p>We can separately examine the relationship between <em>X</em> and <em>Y</em> in each group (or equivalently for each value of a categorical variable, <em>Z</em>). If the 
		relationship between <em>X</em> and <em>Y</em> is different in the different groups, this 
	should lead to more accurate predictions of <em>Y</em> from <em>X</em>.</p>
	<p>A regression line can be separately fitted by least squares in each group.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_twoLines.gif" width="458" height="382"></p>





<h2 class="pageName">12.5.4 &nbsp; Parallel regression lines</h2><!DOCTYPE HTML>


<p class="heading">Separate   regression lines</p>
	<p>The problem with fitting separate regression lines by least squares in the different groups is that it is difficult to concisely explain the difference between the groups &mdash; the difference between the predicted response in the groups  depends on the value of the explanatory variable.</p>
	<p class="eqn"><img class="gif" src="../../../en/regnGroups/images/twoLines.gif" id="gif_image_5_4_2" width="313" height="274"><iframe class="svg" src="../../../en/regnGroups/images/twoLines.svg" id="svg_image_5_4_2" width="313" height="274" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_5_4_2");</script></p>
	<p class="heading">Parallel regression lines</p>
	<p>Interpretation is considerably simplified if we constrain the  regression lines for the different groups to have the same slope. In the diagram below, the difference between the groups is the same for all values of <em>X</em>.</p>
	<p class="eqn"><img class="gif" src="../../../en/regnGroups/images/parallelLines.gif" id="gif_image_5_4_1" width="313" height="274"><iframe class="svg" src="../../../en/regnGroups/images/parallelLines.svg" id="svg_image_5_4_1" width="313" height="274" frameborder="0"></iframe><script type="text/javascript">showCorrectImage("image_5_4_1");</script></p>
	<p>Parallel lines are not appropriate descriptions of all data sets. Always check a scatterplot first.</p>
	<p class="heading">Least squares</p>
	<p>The principle behind fitting  parallel lines to two or more groups is the same as in ordinary simple regression &mdash; we choose the parameters to minimise the sum of squared residuals (vertical distances between the data crosses and their corresponding line). The resulting formulae are complicated, but most statistical software will do the calculations for you.</p>





<h2 class="pageName">12.5.5 &nbsp; Transformed variables and groups</h2><!DOCTYPE HTML>


<p class="heading">Transformation of the response</p>
	<p>It is much easier to interpret the parameters when parallel lines are fitted to different groups than when their slopes are different, but the data or the context may not justify such a simplification.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_beforeLog.gif" width="436" height="331"></p>
	<p>After a nonlinear transformation of the response, the relationships in the two groups may be closer to parallel. A  transformation to reduce skewness in the reponse often works well.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_afterLog.gif" width="436" height="331"></p>
	<p class="heading">Understanding the model for ln(<em>y</em>)</p>
	<p>Logarithmic transformations are particularly useful because the parallel least squares lines have a simple interpretation. For the above data they are:</p>
	<p align="center">Female:    ln (<em>y</em>) = 0.391 + 0.0747 <em>x<br>
	</em>Male:       ln (<em>y</em>) = 1.192 + 0.0747 <em>x</em></p>
	<p>This means that:</p>
	<div class="centred"><div class="boxed">
		<p><em>ln(y) </em> is (1.192&nbsp;-&nbsp;0.391)&nbsp;=&nbsp;0.801 higher for females than for males with the same <em>x</em>.</p>
	</div></div>
	<p>We can now concisely summarise the difference between males and females:</p>
	<div class="centred"><div class="boxed">
		<p><em>y </em> for females is e<sup>0.810</sup>&nbsp;=&nbsp;2.23 times that for males with the same <em>x</em>.</p>
	</div></div>




<h2 class="pageName">12.5.6 &nbsp; Grouping with a numerical variable</h2><!DOCTYPE HTML>


<p class="heading">Definition of groups</p>
	<p>A categorical variable naturally splits the individuals into groups, but a numerical variable, <em>Z</em>, can also be used to define groups.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_groupedNum.gif" width="432" height="346"></p>




<h2 class="pageName">12.5.7 &nbsp; Scatterplot matrix with groups</h2><!DOCTYPE HTML>


<p class="heading">Distinguishing groups in a scatterplot matrix</p>
	<p>A scatterplot matrix can help to describe the relationships between 3 or more numerical variables. If each individual belongs to one of several known groups, different symbols or colours can be used to distinguish the groups.</p>
	<p class="eqn"><img src="../../../en/regnGroups/images/s_scatMatrix.gif" width="520" height="495"></p>




</html>
