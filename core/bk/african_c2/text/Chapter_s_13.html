<!DOCTYPE HTML>
<html>
<head>
  <title>13. Inference for Regression</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="../../../structure/summaryStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/maths/mathStyles.css" type="text/css">
  <link rel="stylesheet" href="../../../structure/printStyles.css" type="text/css">
  <script src="../../../structure/videoControls/jquery.js"></script>
  <script src="../../../structure/maths/theorems.js"></script>
  <script src="../../../structure/maths/mathJax/MathJax.js?config=TeX-AMS-MML_SVG,statMacros.js"></script>
  <script src="../../../structure/printFixes.js"></script>
</head>

<body id="body" onLoad="showPrintDialog(true)">
<div id='overlay'>
	<div id='dialogWindow'>
		<div class='printDialog'>
			<script type='text/javascript'>
				document.write("<div class='heading'>" + top.document.title + "</div>");
				if (top.url != null) {
					document.write("<p class='text'>A version of this chapter has already been generated in PDF format and we recommend that it is used for printing. The button below will download and display it.</p>");
					document.write("<p><button onClick='top.showPdf()'>Show PDF version of chapter</button></p>");
					document.write("<p class='text'>However downloading could be slow depending on your internet connection. If this is a problem, click the button below to print the chapter without downloading (but perhaps not formatted as well as the PDF version).</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>If you are <strong>not</strong> using the PDF version, the best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
				else {
					document.write("<p class='text'>Click the button below to print this chapter.</p>");
					document.write("<p><button onClick='top.doPrint()'>Show print dialog</button></p>");
					document.write("<p class='text'>The best print results are obtained if the text is reduced in size and printed on  sheets of paper that are smaller than A4. This can be done using your browser's Page Setup command to scale by 71% and then printing on A5 paper.</p>");
				}
			</script>
			
			<p class='text'>If you don't want to print now,</p>
			<p><button onClick='top.showPrintDialog(false)'>Browse formatted chapter</button></p>
		</div>
	</div>
</div>
<h1 class="chapterName">Chapter 13 &nbsp; Inference for Regression</h1>
<h1 class="sectionName">13.1 &nbsp; Confidence intervals</h1>
<h2 class="pageName">13.1.1 &nbsp; Distn of least squares estimates</h2>

<p class="heading notPrinted">Distribution of the least squares slope and intercept</p>
<p>The least squares line<sub></sub> varies from sample
to sample &mdash; it is random.</p>
<p class="eqn"><img src="../../../en/regnEst/images/s_randomLines.gif" width="550" height="290"></p>
<p>The least squares estimates <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub> of
the two linear model parameters β<sub>0</sub> and β<sub>1</sub> therefore also
vary from sample to sample and have normal distributions that are centered
on β<sub>0</sub> and β<sub>1</sub> respectively.</p>
<p class="eqn"><img src="../../../en/regnEst/images/s_slopeInterceptDistn.gif" width="541" height="321"></p>




<h2 class="pageName">13.1.2 &nbsp; Standard error of least squares slope</h2>

<p class="heading notPrinted">Standard error of slope</p>
<p>When <em>b</em><sub>1 </sub> is used as an estimate of β<sub>1</sub>, the
estimation error has a normal distribution,</p>
<p class=eqn><span class="black"><strong>error in estimate of &beta;<sub>1</sub></strong> &nbsp; = &nbsp; (<em>b</em><sub>1</sub> &minus; &beta;<sub>1</sub>) &nbsp; ~ &nbsp; <font face="Arial, Helvetica, sans-serif">normal</font> ( 0, &nbsp;&sigma;<sub><em>b</em><sub>1</sub></sub> )</span> </p>
<p>This standard deviation is the  <strong>standard error</strong> of
the estimate,</p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/sdSlopeEqn.gif" width="227" height="42"> </p>
<p>where <em>s</em><sub>x </sub> is the standard deviation of  <em>X. </em>Since
σ is unknown, we must replace it with an estimate from
the data to obtain a numerical value for the standard error,</p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/errorSdEst.gif" width="95" height="41"> </p>
<p class=heading>Example</p>
<p align="center"><img src="../../../en/regnEst/images/radiationCancer.gif" width="550" height="377" class="summaryPict"></p>
<p>The estimated error distribution  gives in indication of how close our least
squares estimate, <em>b</em><sub>1</sub> = 9.27, is likely to be to the population
regression slope, &beta;<sub>1</sub>.</p>




<h2 class="pageName">13.1.3 &nbsp; 95% confidence interval for slope</h2>

<p class="heading notPrinted">Confidence interval for the slope</p>
<p>When the least squares slope, <em>b</em><sub>1</sub>, is used to estimate
β<sub>1</sub>,
the error  has a normal distribution,</p>
<p class=eqn><span class="black"><strong>error in estimate of &beta;<sub>1</sub></strong> &nbsp; = &nbsp; (<em>b</em><sub>1</sub> &minus; &beta;<sub>1</sub>) &nbsp; ~ &nbsp; <font face="Arial, Helvetica, sans-serif">normal</font> ( 0, &nbsp;&sigma;<sub><em>b</em><sub>1</sub></sub> )</span> </p>
<p>This suggests a 95% confidence interval of
the form </p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/slopeCIFormula2.gif" width="124" height="24"></p>
<p>In practice, we must replace σ in the formula for the standard error with
an estimate (based on the sum of squared residuals),</p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/sdSlopeEqn2.gif" width="234" height="52"> </p>
<p>so the constant 1.96 must be replaced by a larger
value from the t distribution with
(<em>n</em>&nbsp;-&nbsp;2) degrees of freedom. </p>

<div class="centred"><div class="boxed"><p><strong>A 95% confidence interval for the slope is</strong></p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/slopeCIFormula.gif" width="121" height="26"></p></div></div>
<p>Most statistical software will evaluate <em>b</em><sub>1</sub> and its standard
error for you when you fit a normal linear model, so it is fairly easy to evaluate
the confidence interval in practice &mdash; you will not need to use any of the formulae
above!</p>
<p class="heading">Example</p>
<p>For the example on the previous page, the least squares estimate of the slope
and its standard error were:
</p>
<p class="eqn"><em>b</em><sub>1</sub> = 9.27,        se (<em>b</em><sub>1</sub>)
= 1.42</p>
<p>Since there were <em>n</em> = 9 data points, <em>t</em><sub><em>n</em> &minus; 2</sub> =
t<sub>7</sub> = 2.365,  so a 95%
confidence interval for the slope is </p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/radiationCI.gif" width="284" height="39"></p>
<p>We are 95% confident that the expected number of deaths per 100,000
is between 5.9 and 12.6 higher for each unit increase in the exposure index.</p>




<h2 class="pageName">13.1.4 &nbsp; Properties of confidence interval</h2>

<p class="heading notPrinted">Properties of 95% confidence interval</p>
<p>Since a confidence interval for the slope, β<sub>1</sub>, is evaluated from
random sample data, it will vary from sample to sample. In 95% of such samples,
the 95% confidence interval will include the true population slope, but in 5%
of samples it will not.</p>

<div class="centred"><div class="boxed">
<p>We cannot tell whether or not our single data set is one of the 'lucky'
ones.</p>
</div></div>

<p class="heading">Simulation</p>
<p class="eqn"><img src="../../../en/regnEst/images/s_ciSimulation.gif" width="437" height="344"></p>




<h2 class="pageName">13.1.5 &nbsp; Influences on accuracy ((advanced))</h2>

<p class="heading notPrinted">What affects the accuracy of the least squares slope?</p>
<p>The standard deviation of <em>b</em><sub>1</sub> (its standard error) is</p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/sdSlopeEqn.gif" width="227" height="42"> </p>
<p>where </p>
<ul>
<li>σ is the standard deviation of the errors &mdash; i.e. the spread of points<i></i> around
the regression line,</li>
<li><i>n</i> is the number of data points, and</li>
<li><em>s</em><sub>x</sub> is the sample standard deviation of <i>X</i>.</li>
</ul>
<div class="centred"><div class="boxed">
<p style="text-align:left">The standard error of  <em>b</em><sub>1</sub>
is lowest when: </p>
<ol style="margin-top:6pt; font-weight:bold;">
	<li>the response standard deviation, σ, 
		is low</li>
	<li>the sample size, <i>n</i>, is large</li>
	<li>the spread of x-values is high</li>
</ol>
</div></div>
<p class=heading>Implications for experimental design </p>
<p>To get the most accurate estimate of the slope from experimental data,</p>
<dl>
<dt>Reduce σ</dt>
<dd>σ can be reduced by ensuring that the experimental units
are as similar as possible.</dd>
<dt>Increase <em>n</em></dt>
<dd>Collect as much data as possible.</dd>
<dt>Increase <em>s<sub>x</sub></em></dt>
<dd>Choose to run the experiment with x-values that are widely spread.</dd>
</dl>
<br>
<p>However if the spread of x-values is increased too much, the relationship
may not be sufficiently linear for a linear model to be used.</p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/nonlinearity.gif" width="271" height="210"> </p>
<p>Nonlinearity is a major problem, so it is important to be able to assess whether
a relationship is linear. Don't just collect data at the ends of the 'acceptable'
range of x-values, even though this maximises <em>s</em><sub>x</sub>. </p>
<p class=eqn><img class="gif" src="../../../en/regnEst/images/nonlinearity2.gif" width="271" height="210"></p>




<h1 class="sectionName breakBefore">13.2 &nbsp; Testing regression parameters</h1>
<h2 class="pageName">13.2.1 &nbsp; Importance of zero slope</h2>

<p class="heading">Does the response depend on X?</p>
<p>In a normal linear model, the response has a distribution whose mean, µ<sub>y</sub>,
depends linearly on the explanatory variable,</p>
<p class=eqn><span class="black"><em>Y</em>&nbsp; ~ &nbsp;<font face="Arial, Helvetica, sans-serif">normal</font> (&mu;<sub>y</sub>&nbsp;, &sigma;)</span> </p>
<p>If the slope parameter, β<sub>1</sub>, is zero, then the response has a normal
distribution that <strong>does not depend on <i>X</i></strong>.</p>
<p class=eqn><span class="black"><em>Y</em> &nbsp; ~ &nbsp; <font face="Arial, Helvetica, sans-serif">normal</font> (&beta;<sub>0</sub> , &nbsp;&sigma;)</span> </p>
<p>This can be tested formally with a hypothesis test for whether β<sub>1</sub> is
zero.</p>




<h2 class="pageName">13.2.2 &nbsp; Testing whether slope is zero</h2>

<p class="heading notPrinted">Testing for zero slope</p>
<p>To assess whether the explanatory variable affects the response, we test the
hypotheses </p>
<p class=eqn><span class="blue"><strong><font size="+1">H</font><sub>0</sub>&nbsp;:&nbsp;&nbsp;&nbsp;</strong>&beta;<sub>1</sub> &nbsp;=&nbsp; 0<br><strong><font size="+1">H</font><sub>A</sub>&nbsp;:&nbsp;&nbsp;&nbsp;</strong>&beta;<sub>1</sub>  &nbsp;&ne;&nbsp;  0</span> </p>
<p>The test is based on how far the least squares slope, <em>b</em><sub>1</sub>,
is from zero. To assess this, we must take into account its standard deviation
(standard error),</p>
<p class=eqn><img class="gif" src="../../../en/regnTest/images/sdSlopeEqn.gif" width="129" height="42"> </p>
<p>If we knew the value of σ, we could  standardise <em>b</em><sub>1</sub> to
get a test statistic,</p>
<div class="centred">
	<table border="0" cellspacing="0" cellpadding="10" class="centred">
		<tr>
			<th style="margin:0px; padding:0px"><span class="black bold">standardised value,</span>&nbsp;&nbsp;&nbsp;</th>
			<td style="margin:0px; padding:0px"><span class="eqn"><img class="gif" src="../../../en/regnTest/images/standardisedSlope.gif" width="85" height="43">
			</span></td>
		</tr>
	</table>
</div>
<p class=eqn>&nbsp;</p>
<p>If β<sub>1</sub> was really zero (<strong>H<sub>0</sub></strong>), the probability
of getting a least squares slope as far from zero as that recorded would be the
p-value,</p>
<p class=eqn><img class="gif" src="../../../en/regnTest/images/zForTestingSlope.gif" width="294" height="141"></p>
<p>Unfortunately σ is usually unknown and the standard deviation of <em>b</em><sub>1</sub> must
be <a href="javascript:showNamedPage('regnEst4')">estimated from the sample
data</a>. We therefore use a test statistic of the form </p>
<div class="centred">
	<table border="0" cellspacing="0" cellpadding="10" class="centred">
		<tr>
			<th style="margin:0px; padding:0px"><span class="black bold">t ratio,</span>&nbsp;&nbsp;&nbsp;</th>
			<td style="margin:0px; padding:0px"><span class="eqn"><img class="gif" src="../../../en/regnTest/images/standardisedSlope2.gif" width="69" height="48">
			</span></td>
		</tr>
	</table>
</div>
<p>and refer to a t distribution with <i><span class="black">n</span></i><span class="black">&nbsp;-&nbsp;2</span> degrees
of freedom to find the p-value.</p>
<p class=eqn><img class="gif" src="../../../en/regnTest/images/slopeTestP.gif" width="426" height="268"> </p>
<p>The p-value is interpreted in the same way as for other hypothesis tests &mdash;
a p-value close to zero means that the sample slope is far enough from zero to
be inconsistent with <strong>H<sub>0</sub>: &beta;<sub>1</sub> = 0</strong>.</p>
<p class="heading">Examples</p>
<p align="center"><img src="../../../en/regnTest/images/possumDamage.gif" width="550" height="442" class="summaryPict"></p>
<p align="center"><img src="../../../en/regnTest/images/alcoholStrength.gif" width="550" height="442" class="summaryPict"></p>





<h2 class="pageName">13.2.3 &nbsp; Strength of evidence and relationship</h2>

<p class="heading notPrinted">Strength of  relationship vs strength of <span class="darkred">evidence</span> for
relationship</p>
<p>It is important to distinguish between the correlation coefficient, <em>r</em>,
and the p-value for testing whether there is a relationship between <em>X</em> and <em>Y</em>. </p>
<dl>
<dt>Correlation coefficient</dt>
<dd>Describes the strength of the relationship between <em>X</em> and <em>Y</em></dd>
<dt>The p-value for testing whether <em>X</em> and <em>Y</em> are related</dt>
<dd>Describes the strength of <strong>evidence</strong> for whether <em>X</em> and <em>Y</em> are
related <strong>at all</strong></dd>
</dl>
<p>It is important not to confuse these two values when interpreting the p-value
for a test.</p>
<ul>
<li>A p-value  close to zero does <strong>not</strong> imply that there must
be a strong relationship. It
just means that we are <strong>sure</strong> that
there is <strong>some</strong> relationship, however weak.</li>
<li>A large p-value  does <strong>not</strong> imply that the relationship
must be weak. The sample size might just be too small to be sure that the relationship
exists.</li>
</ul>
<p>This is partly explained by an alternative formula for the test statistic,</p>
<p class=eqn><img class="gif" src="../../../en/regnTest/images/s_tFromR.gif" width="162" height="48"></p>
<p>The test statistic and  the p-value therefore both depend on both <em>r</em> and
the sample size, <em>n</em>. Increasing <em>n</em> and increasing <em>r</em> <strong>both</strong> result
in a lower p-value.</p>
<p class=eqn><img class="gif" src="../../../en/regnTest/images/rnEffect.gif" width="550" height="440"></p>




<h2 class="pageName">13.2.4 &nbsp; Properties of p-values ((advanced))</h2>

<p class="heading notPrinted">Properties of p-value</p>
<p>P-values for testing whether a linear model's slope is zero have the same
properties as p-values for other hypothesis tests. In particular, </p>
<ul>
<li>When <b>H<sub>0</sub></b> is true (i.e. <i>Y</i> is not related to <i>X</i>),
all p-values between 0 and 1 are equally likely.</li>
<li>If <b>H<sub>A</sub></b> is true (i.e. <i>Y</i> and <i>X</i> are
related), then  p-values  near zero
are more likely than p-values near 1.</li>
</ul>
<p>When <em>Y</em> and <em>X</em> are not related
(β<sub>1</sub> = 0), it is still possible to get small p-values, suggesting that
β<sub>1</sub> is <strong>not</strong> zero. However there is only probability
0.01 of getting a p-value as low as 0.01 &mdash; it is unlikely but possible. Such
a p-value is more likely if the variables <strong>are</strong> related so we
interpret it as giving strong evidence of a relationship.</p>




<h1 class="sectionName breakBefore">13.3 &nbsp; Predicting the response</h1>
<h2 class="pageName">13.3.1 &nbsp; Estimated response distn at X</h2>

<p>A normal linear model provides
a response distribution <strong>for all <i>X</i></strong>. With estimates for
all three model parameters, we can obtain the approximate response distribution
at <strong>any</strong> x-value, even if we have no data at that x-value. </p>
<p class="eqn"><img src="../../../en/regnPred/images/s_estimDistn.gif" width="434" height="369"></p>




<h2 class="pageName">13.3.2 &nbsp; Variability of estimate at X</h2>

<p class="heading notPrinted">What affects the accuracy of a prediction?</p>
<p>The predicted response at <i>X</i> is</p>
<p class=eqn><span class="black"><span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yHat.png" width="10" height="17" align="baseline"></span>&nbsp; =&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></span> </p>
<p>and has a normal distribution
with mean</p>
<p class=eqn><span class="black">&mu;<sub><em>y</em></sub> &nbsp;=&nbsp; &beta;<sub>0</sub> &nbsp;+&nbsp; &beta;<sub>1</sub><em>x</em></span> </p>
<p>Its standard deviation   depends on the value <i>x</i> at which the prediction
is being made. The further <i>x</i> is from
its mean in the training data, <img src="../../../en/../images/symbol.xBar.png" width="10" height="10" align="baseline">,
the greater the variability in the prediction.</p>
<p class="heading">Simulation</p>
<p>The effect of the x-value on the variability of the predicted response can
be shown using least squares lines fitted to simulated data:</p>
<p class="eqn"><img src="../../../en/regnPred/images/s_lsVariability.gif" width="550" height="294"></p>
<p>The diagram below shows two theoretical distributions from the above model.
(The spread would be even greater for predicting at <em>x</em> = 10.)</p>
<p class="eqn"><img src="../../../en/regnPred/images/s_predictDistn.gif" width="348" height="281"></p>




<h2 class="pageName">13.3.3 &nbsp; Estimating the mean vs prediction</h2>

<p class="heading">Estimating the <span class="red">mean</span> response</p>
<p>In some situations, we are interested in estimating the mean response at some
x-value,</p>
<p class=eqn><span class="black">&mu;<sub><em>y</em></sub> &nbsp;=&nbsp; &beta;<sub>0</sub> &nbsp;+&nbsp; &beta;<sub>1</sub><em>x</em></span> </p>
<p>The least squares estimate, </p>
<p class=eqn><span class="black"><span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yHat.png" width="10" height="17" align="baseline"></span>&nbsp; =&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></span> </p>
<p>becomes increasingly accurate as the sample size increases (since  <em>b</em><sub>0</sub> and <em>b</em><sub>1</sub> become
more accurate estimates of β<sub>0</sub> and β<sub>1</sub>).</p>
<p class=heading>Predicting a <span class="red">single item's</span> response</p>
<p>To predict the response for a <strong>single</strong> new
individual with a known x-value, the
same prediction would be used,</p>
<p class=eqn><span class="black"><span style="position:relative; top:4px"><img src="../../../en/../images/symbol.yHat.png" width="10" height="17" align="baseline"></span>&nbsp; =&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></span> </p>
<p>However no matter how accurately we estimate the <strong>mean</strong> response
for such individuals, a single new individual's response will have a distribution
with standard deviation σ around this mean and we have no information to help
us predict how far it will be from its mean. The 
prediction error <strong>cannot</strong> have a standard deviation
that is less than σ.</p>
<div class="centred"><div class="boxed"><p>The error in predicting an individual's response is usually greater than the
error in estimating the mean response.</p></div></div>
<p class=heading>Simulation</p>
<p>The diagram below contrasts estimation of the mean response and prediction
of a new individual's response at <em>x</em> = 5.5. Least squares lines have
been fitted to several simulated data sets, one of which is shown on the left.
The two kinds of errors from the simulations are shown on the right, showing
that the prediction errors are usually greater.</p>
<p class="eqn"><img src="../../../en/regnPred/images/s_estimPredict.gif" width="453" height="525"></p>




<h2 class="pageName">13.3.4 &nbsp; Confidence and prediction intervals</h2>

<p>The same value,</p>
<div class="centred">
	<table border="0" cellpadding="0" cellspacing="0" class="centred">
		<tr>
			<td valign="middle"><img src="../../../en/../images/symbol.yHat.png" width="10" height="17" align="baseline"></td>
			<td valign="middle">&nbsp; =&nbsp; <em>b</em><sub>0</sub> + <em>b</em><sub>1 </sub><em>x</em></td>
		</tr>
	</table>
</div>
<p>is used both to estimate the mean response at <em>x</em> and to predict a
new individual's response at <em>x</em>, but the errors are different in
the two situations &mdash; they tend to be larger for predicting a new value.</p>
<p class="heading">95% confidence interval for  mean response </p>
<p class=eqn><img class="gif" src="../../../en/regnPred/images/ciForMeanY.gif" width="224" height="26"> </p>
<p>A formula for the standard error on the right exists, but you should rely
on statistical software to find its value.</p>
<p class=heading>95% prediction interval for a new individual's response</p>
<p>For prediction, a similar interval is used:</p>
<p class=eqn><img class="gif" src="../../../en/regnPred/images/predInterval.gif" width="169" height="21"> </p>
<p>where  <em>k</em> is greater than the corresponding standard error
for the confidence interval. Statistical software should again be used to find
its value.</p>
<p class=heading>Example</p>
<p>The diagram below shows 95% confidence intervals for the mean response at <em>x</em> and
95% prediction intervals for a new response at <em>x</em> as bands for a small
data set with <em>n</em> = 7 values. </p>
<p class="eqn"><img src="../../../en/regnPred/images/s_bands.gif" width="402" height="284"></p>
<p class=heading>Extrapolation</p>
<p>These 95% confidence intervals and 95% prediction intervals are valid within
the range of x-values about which we have collected data, but <strong>they should
not be relied on for extrapolation</strong>.
Both intervals assume that the normal linear model describes the process, but
we have no information about linearity beyond the x-values that have been collected.</p>




</body>
</html>
