<!DOCTYPE HTML>
<html>
<head>
	<title>Test for any discrete distribution</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>
	
	<link rel='stylesheet' href='../../structure/maths/mathStyles.css' type='text/css'>
	<script src='../../structure/videoControls/jquery.js'></script>
	<script src='../../structure/maths/theorems.js'></script>
	<script src='../../structure/maths/mathJax/MathJax.js?config=TeX-AMS-MML_SVG,statMacros.js'></script>

	<meta name="index" content="frequency table, chi-squared test, goodness-of-fit test">
	<meta name="dataset" content="Sex of children in family">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Goodness-of-fit test for other discrete distributions</p>

<p>The same approach that was used on the previous page can be applied to test whether a discrete data set is a random sample from <strong>any</strong> distribution.</p>
<ol>
	<li>Estimate any unknown parameters of the model.</li>
	<li>Summarise the data in a frequency table; the frequencies in the table are our observed counts, \(\{O_x\}\).</li>
	<li>Use the model's probability function (with estimated parameters) to estimate probabilities for the values in the frequency table.</li>
	<li>Multiply these probabilities by the number of raw data values to get expected counts, \(\{E_x\}\).</li>
	<li>Combine cells in the frequency table to avoid small expected counts.</li>
	<li>Calculate the chi-squared test statistic,</li>
</ol>

\[
X^2 \;=\; \sum_{x} {\frac{\left(O_x - E_x\right)^2}{E_x}} \]
<ol start="7">
	<li>The number of 'constraints' is the number of estimated parameters plus one (since \(\sum{E_i} \;=\; \sum{O_i}\)). The degrees of freedom are the number of combined counts minus the number of constraints.</li>
	<li>Find the p-value for the test as the upper tail of the chi-squared distribution with this number of degrees of freedom.</li>
	<li>Interpret the p-value — small values give evidence that the data do <strong>not</strong> fit the distribution.</li>
</ol>
<p>The steps will be illustrated in an example.</p>
<div class="questionSoln">
	<div class="question">
		<p class="questionTitle">Example</p>
		<p>The following table gives the number of male children among the first 12 children in 6,115 families of size 13, taken from hospital records in 19th century Saxony. (The 13th child has been ignored to avoid the possible distortion of families stopping when a desired sex is reached.)</p>
		<div class="centred">
			<table border="0" cellpadding="5" cellspacing="0" class="centred">
				<tr>
					<th>Males</th>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-left:1px solid #999999;">0</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">1</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">2</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">3</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">4</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">5</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">6</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">7</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">8</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">9</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">10</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">11</td>
					<td width="30" align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-right:1px solid #999999;">12</td>
				</tr>
				<tr>
					<th>Frequency</th>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-left:1px solid #999999;">3</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">24</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">104</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">286</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">670</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">1033</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">1343</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">1112</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">829</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">478</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">181</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">45</td>
					<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-right:1px solid #999999;">7</td>
				</tr>
			</table>
		</div>
		<p>Assuming independence and that each child has the same probability of being male, \(\pi\), this would be a random sample from a \(\BinomDistn(n=12, \; \pi)\) distribution.</p>
		<p>Is there evidence that the probability of a birth being male differs from family to family?</p>
	</div>
	<div class="solution">
		<p>This is equivalent to asking whether the 6,115 values are a random sample from a \(\BinomDistn(n=12, \; \pi)\) distribution. If the probability of a birth being male varies from family to family, there would be <a href="javascript:showNamedPage('overdispersion3')">overdispersion</a> and a beta-binomial distribution may fit better.</p>
		<p>The binomial distribution has one unknown parameter. Its best estimate is the overall proportion of males in the 6,115 families,</p>
		
\[
\hat{\pi} \;=\; \frac{38,100}{12 \times 6,115} \;=\; 0.5192\]
		<p>Using the binomial probability function, we can obtain expected cell counts for the frequency table,</p>
\[
E_x \;=\; 6,115 \times {{12} \choose x} {0.5192}^x (1 - 0.5192)^{12-x}\]
		<p>These are shown in the table below.</p>
		
		<div class="centred">
		<table border="0" cellpadding="5" cellspacing="0" class="centred">
			<tr>
				<th width="20" align="center">x</th>
				<th width="20" align="center">0</th>
				<th width="20" align="center">1</th>
				<th width="20" align="center">2</th>
				<th width="20" align="center">3</th>
				<th width="20" align="center">4</th>
				<th width="20" align="center">5</th>
				<th width="20" align="center">6</th>
				<th width="20" align="center">7</th>
				<th width="20" align="center">8</th>
				<th width="20" align="center">9</th>
				<th width="20" align="center">10</th>
				<th width="20" align="center">11</th>
				<th width="20" align="center">12</th>
			</tr>
			<tr>
				<th align="center">\(O_x\)</th>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-left:1px solid #999999;">3</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">24</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">104</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">286</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">670</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">1033</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">1343</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">1112</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">829</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">478</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">181</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">45</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-right:1px solid #999999;">7</td>
			</tr>
			<tr>
				<th align="center">\(E_x\)</th>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-left:1px solid #999999;">0.93</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">12.09</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">71.80</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">258.48</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">628.06</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">1085.2</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">1367.3</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">1265.6</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">854.25</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">410.01</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">132.84</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">26.08</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-right:1px solid #999999;">2.35</td>
			</tr>
		</table>
		</div>
		
		<p>Since the first expected cell count is under one, we combine it with the next:</p>
		
		<div class="centred">
		<table border="0" cellpadding="5" cellspacing="0" class="centred">
			<tr>
				<th width="20" align="center">x</th>
				<th width="20" align="center">0,1</th>
				<th width="20" align="center">2</th>
				<th width="20" align="center">3</th>
				<th width="20" align="center">4</th>
				<th width="20" align="center">5</th>
				<th width="20" align="center">6</th>
				<th width="20" align="center">7</th>
				<th width="20" align="center">8</th>
				<th width="20" align="center">9</th>
				<th width="20" align="center">10</th>
				<th width="20" align="center">11</th>
				<th width="20" align="center">12</th>
			</tr>
			<tr>
				<th align="center">\(O_x\)</th>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-left:1px solid #999999;">27</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">104</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">286</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">670</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">1033</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">1343</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">1112</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">829</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">478</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">181</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">45</td>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-right:1px solid #999999;">7</td>
			</tr>
			<tr>
				<th align="center">\(E_x\)</th>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-left:1px solid #999999;">13.02</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">71.80</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">258.48</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">628.06</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">1085.2</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">1367.3</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">1265.6</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">854.25</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">410.01</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">132.84</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">26.08</td>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-right:1px solid #999999;">2.35</td>
			</tr>
		</table>
		</div>
		
		<p>The test statistic is</p>
		
\[
X^2 \;=\; \sum_{x} {\frac{\left(O_x - E_x\right)^2}{E_x}} \;=\; 109.19 \]
		<p>and this should be compared to a chi-squared distribution with \((12 - 1 - 1) = 10\) degrees of freedom, giving a p-value that is virtually zero.</p>
		<p>Since such a large difference between the observed and expected cell counts would be almost impossible if the data were a random sample from a binomial distribution, we can conclude that it is almost certain that this model does not hold.</p>
		<p>Comparing the observed and expected counts, there is overdispersion — there were more families with mostly boys and with mostly girls than would be expected by chance.</p>
	</div>
</div>
<script type='text/javascript'>writePageEnd();</script>
</body>
</html>
