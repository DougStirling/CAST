<!DOCTYPE HTML>
<html>
<head>
	<title>Test based on frequency table</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>
	
	<link rel='stylesheet' href='../../structure/maths/mathStyles.css' type='text/css'>
	<script src='../../structure/videoControls/jquery.js'></script>
	<script src='../../structure/maths/theorems.js'></script>
	<script src='../../structure/maths/mathJax/MathJax.js?config=TeX-AMS-MML_SVG,statMacros.js'></script>

	<meta name="index" content="frequency table, chi-squared test, goodness-of-fit test">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Data with small counts</p>

<p>The chi-squared goodness-of-fit test that was described earlier in this section has two requirements:</p>
<ul>
	<li>It is only applicable to count data that are thought to have a Poisson distribution</li>
	<li>It requires all of the expected counts to be 1 or more, and most to be over 5. </li>
</ul>
<p>Firstly consider how we might test whether the following data set is a random sample from a \(\PoissonDistn(\lambda=2)\) distribution.</p>
<div class="centred">
	<table border="0" cellpadding="5" cellspacing="0" class="centred" style="border:1px solid #999999;">
		<tr>
			<td width="25" align="center" bgcolor="#FFFFFF">1</td>
			<td width="25" align="center" bgcolor="#FFFFFF">3</td>
			<td width="25" align="center" bgcolor="#FFFFFF">2</td>
			<td width="25" align="center" bgcolor="#FFFFFF">2</td>
			<td width="25" align="center" bgcolor="#FFFFFF">5</td>
			<td width="25" align="center" bgcolor="#FFFFFF">4</td>
			<td width="25" align="center" bgcolor="#FFFFFF">5</td>
			<td width="25" align="center" bgcolor="#FFFFFF">2</td>
			<td width="25" align="center" bgcolor="#FFFFFF">0</td>
			<td width="25" align="center" bgcolor="#FFFFFF">2</td>
		</tr>
		<tr>
			<td align="center" bgcolor="#FFFFFF">2</td>
			<td align="center" bgcolor="#FFFFFF">4</td>
			<td align="center" bgcolor="#FFFFFF">3</td>
			<td align="center" bgcolor="#FFFFFF">5</td>
			<td align="center" bgcolor="#FFFFFF">2</td>
			<td align="center" bgcolor="#FFFFFF">3</td>
			<td align="center" bgcolor="#FFFFFF">1</td>
			<td align="center" bgcolor="#FFFFFF">4</td>
			<td align="center" bgcolor="#FFFFFF">2</td>
			<td align="center" bgcolor="#FFFFFF">6</td>
		</tr>
	</table>
</div>
<p>These counts are small, so the chi-squared test cannot be directly used.</p>
<p class="heading">Frequency table</p>
<p>Rather than applying the test to the raw counts, we  first summarise the data in a frequency table.</p>
<div class="centred">
	<table border="0" cellpadding="5" cellspacing="0" class="centred">
		<tr>
			<th align="center">x</th>
			<th width="30" align="center">0</th>
			<th width="30" align="center">1</th>
			<th width="30" align="center">2</th>
			<th width="30" align="center">3</th>
			<th width="30" align="center">4</th>
			<th width="30" align="center">5</th>
			<th width="30" align="center">6+</th>
		</tr>
		<tr>
			<th align="center">Freq(x)&nbsp;</th>
			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999; border-right:0px;">1</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-bottom:1px solid #999999;">2</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-bottom:1px solid #999999;">7</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-bottom:1px solid #999999;">3</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-bottom:1px solid #999999;">3</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-bottom:1px solid #999999;">3</td>
			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999; border-left:0px;">1</td>
		</tr>
	</table>
</div>
<p>We will treat these frequencies as our observed counts, then find expected counts from the Poisson distribution's probability function,</p>
\[
p(x) \;\;=\;\; \frac{\lambda^x e^{-\lambda}}{x!}\]
<p>Since there were \(n=20\) values in the data set, and the null hypothesis value is \(\lambda=2\), the count that we would expect in the frequency table for the value \(x\) is</p>
\[
E_x \;\;=\;\; 20 \times  p(x) \;\;=\;\; 20 \times \frac{2^x e^{-2}}{x!}\]
<p>This results in the following  table of observed and expected counts.</p>
<div class="centred">
	<table border="0" cellpadding="5" cellspacing="0" class="centred">
		<tr>
			<th align="center">x</th>
			<th width="20" align="center">0</th>
			<th width="20" align="center">1</th>
			<th width="20" align="center">2</th>
			<th width="20" align="center">3</th>
			<th width="20" align="center">4</th>
			<th width="20" align="center">5</th>
			<th width="20" align="center">6+</th>
		</tr>
		<tr>
			<th align="center">\(O_x\)</th>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-left:1px solid #999999;">1</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">2</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">7</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">3</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">3</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">3</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-right:1px solid #999999;">1</td>
		</tr>
		<tr>
			<th align="center">\(E_x\)</th>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-left:1px solid #999999;">2.707</td>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">5.413</td>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">5.413</td>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">3.609</td>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">1.804</td>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">0.722</td>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-right:1px solid #999999;">0.331</td>
		</tr>
	</table>
</div>
<p class="heading">Combining cells</p>
<p>These counts still do not satisfy the requirement for all \(E_x\) to be ≥1 and 80% to be ≥5. Before applying a chi-squared goodness-of-fit test to them, cells in the table should be combined.</p>
<div class="centred">
	<table border="0" cellpadding="5" cellspacing="0" class="centred">
		<tr>
			<th align="center">x</th>
			<th width="20" align="center">0,1</th>
			<th width="20" align="center">2</th>
			<th width="20" align="center">3+</th>
		</tr>
		<tr>
			<th align="center">\(O_x\)</th>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-left:1px solid #999999;">3</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">7</td>
			<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-right:1px solid #999999;">10</td>
		</tr>
		<tr>
			<th align="center">\(E_x\)</th>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-left:1px solid #999999;">8.120</td>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">5.413</td>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-right:1px solid #999999;">6.466</td>
		</tr>
	</table>
</div>
<p>Based on these three counts,</p>
\[ \begin{align}
X^2 \;&amp;=\; \sum_{i=1}^{3} {\frac{\left(O_i - E_i\right)^2}{E_i}} \\
&amp;=\; \frac{(3-8.120)^2}{8.120} + \frac{(7-5.413)^2}{5.413} + \frac{(10-6.466)^2}{6.466} \\
&amp;=\; 5.624
\end{align} \]
<p class="heading">P-value and conclusion</p>
<p>To calculate the degrees of freedom, we note that there are 3 categories (after grouping) and one constraint: the expected frequencies from the model are &ldquo;constrained&rdquo; to add up to 20 by how they were calculated.</p>
\[
\sum{E_i} \;=\; \sum{O_i} \;=\; 20
\]
<p>The chi-squared test should therefore be based on \(3-1 = 2\) degrees of freedom. The p-value for testing whether our model for the data fits is the probability that a \(\ChiSqrDistn(2 \text{ df})\) distribution is greater than the observed value,</p>
<p class="eqn">p-value = \(P(X^2 \ge 5.621) = 0.060\)</p>
<p>Since this is between 0.05 and 0.10, we would conclude that there is only very weak evidence against the null hypothesis that the original data set was a random sample from a \(\PoissonDistn(2)\) distribution.</p>
<p>(It is hardly surprising that a data set with only 20 values does not show up problems with a model — a larger data set would be more sensitive to any possible lack of fit of the model.)</p>
<script type='text/javascript'>writePageEnd();</script>
</body>
</html>
