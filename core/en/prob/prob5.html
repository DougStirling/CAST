<!DOCTYPE HTML>
<html>
<head>
	<title>Calculations with probabilities</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="conditional probability, Bayes theorem">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Marginal and conditional probs can be found from joint probs 
(and vice versa)</p>

<p>We have used three types of probability to describe a model for two categorical 
variables &mdash; the <strong>joint</strong> probabilities, the <strong>marginal</strong> 
probabilities for the two variables and the <strong>conditional</strong> probabilities 
for each variable given the value of the other variable. These sets of probabilities 
are closely related. Indeed, the model can be equivalently described by any of 
the following.</p>

<ul>
	<li>The joint probabilities, 
		<span class="black em">p<sub>xy</sub></span></li>
	
<li>The marginal probabilities for <i><span class="black">X</span></i>, <span class="black em">p<sub>x</sub></span>, 
and the conditional probabilities for <i><span class="black">Y</span></i>, <span class="black"><em>p</em><sub><em>y</em> | <em>x</em></sub></span></li>
	
<li>The marginal probabilities for <i><span class="black">Y</span></i>, <span class="black em">p<sub>y</sub></span>, 
and the conditional probabilities for <i><span class="black">X</span></i>, <span class="black"><em>p</em><sub><em>x</em> | <em>y</em></sub></span></li>
</ul>

<p>The diagram below shows how to find each set of probabilities from the others, using
the formulae described in the earlier pages of this section.
</p>

<p class=eqn><img class="gif" src="images/jointCondit.gif" width="537" height="234">
</p>

  <p class="heading">Bayes theorem</p>
  
<p>In particular, note that it is possible to obtain the conditional probabilities 
for <i><span class="black">X</span></i> given <i><span class="black">Y</span></i>, 
<span class="black"><em>p</em><sub><em>x</em> | <em>y</em></sub></span>, 
from the marginal probabilities of <i>X</i>, <span class="black em"> p<sub>x</sub></span>, 
and the conditional probabilities for <i><span class="black">Y</span></i> given 
<i><span class="black">X</span></i>, <span class="black"><em>p</em><sub><em>y</em> | <em>x</em></sub></span>. 
This can be expressed in a single formula that is called <strong>Bayes Theorem</strong>, 
but it is easier in practice to do the calculations in two steps, obtaining the 
joint probabilities, <span class="black em">p<sub>xy</sub></span>, 
in the first step. There are several important applications of Bayes Theorem.</p>


<div class="diagram" title="Example: Accuracy of medical diagnostic tests">
<p class="heading">Accuracy of medical diagnostic tests</p>
<p>Medical diagnostic tests for a disease are rarely 100% accurate. There are 
two types of error: </p>

<ul>
	<li>A positive test result for someone who does not have the disease.</li>
	<li>A negative test result for someone who has the disease.</li>
</ul>

<p>There are commonly non-zero probabilities for each of these types of error. Consider
a diagnostic test with probability 0.05 of a negative test
result for someone who has the target disease, and probability 0.10 of a positive test
result for someone who does not have the disease. These are conditional probabilities and
can be written formally as:
</p>

<p class=eqn><span class="black"><em>p</em><sub style="font-family:sans-serif; font-size:small;">negative | disease</sub> = &nbsp;0.05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>p</em><sub style="font-family:sans-serif; font-size:small;">positive | no disease</sub> = &nbsp;0.10</span>
</p>

<p>Since the probability (proportion) of people with the disease having a positive 
test result is one minus the conditional probability of a negative test result 
(and a similar result for those who do not have the disease), the remaining conditional 
probabilities are</p>

<p class=eqn><span class="black"><em>p</em><sub style="font-family:sans-serif; font-size:small;">positive | disease</sub> = &nbsp;0.95&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>p</em><sub style="font-family:sans-serif; font-size:small;">negative | no disease</sub> = &nbsp;0.90</span>
</p>

<p>We will also assume that 10% of people who are given the test have the disease. This
corresponds to a marginal probability, P(disease) = 0.10.
</p>

<p>The diagram below shows how these marginal probabilities for <i>Y</i> (disease status)
and conditional probabilities for <i>X</i> (test results) given <i>Y</i> can be
used to obtain the conditional probabilities for <i>Y</i> (disease status) given
<i>X</i> (test results).
</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="600" height="400">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="continProg.ConditCalcApplet">
<param name="yVarName" value="Test">
<param name="xVarName" value="Disease">
<param name="yLabels" value="Positive Negative">
<param name="xLabels" value="#Has disease# #No disease#">
<param name="xMargin" value="0.10 0.90">
<param name="yCondit" value="0.95 0.05 0.10 0.90">
<param name="customText" value="Conditional=Conditional#Marginal=Marginal#Joint probabilities=Joint probabilities">
</applet>
</div>

<p>The initial information is shown in blue at the top of the diagram.
The joint probabilities (green) are first found from them. Click on any value in the
table of joint probabilities to see how it is related to the initial information.
</p>

<p>Marginal probabilities for the test results are next obtained by adding the
columns of joint probabilities. Click on any of the black marginal probabilities to
see how they are obtained from the joint probabilities.
</p>

<p>Finally the conditional probabilities for disease status (given test results)
are obtained from the joint probabilities and the marginal probabilities for
the test results. Click on the conditional probabilities on the bottom right
of the diagram to see the formula.
</p>

<hr align=center width="75%">

<p>Initially there might seem to be a contradiction between the two conditional
probabilities,
</p>

<p class=eqn><span class="black"><em>p</em><sub style="font-family:sans-serif; font-size:small;">positive | disease</sub> &nbsp;= &nbsp;0.95</span>
</p>

<p class=eqn><span class="black"><em>p</em><sub style="font-family:sans-serif; font-size:small;">disease | positive</sub> &nbsp;= &nbsp;0.514</span>
</p>

<p>However the two probabilities are consistent since they have very different
interpretations. The proportional Venn diagrams below help to explain the difference. The
diagram on the left shows the marginal and conditional probabilities given in
the question. The corresponding diagram on the right shows the marginal
probabilities for the test results and the conditional probabilities for disease
status.
</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="300">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="continProg.AreaContinDragApplet">
<param name="yVarName" value="Test, Y">
<param name="xVarName" value="Disease, X">
<param name="yLabels" value="Pos Neg">
<param name="xLabels" value="Disease #No disease#">
<param name="xMargin" value="0.10 0.90">
<param name="yCondit" value="0.95 0.05 0.10 0.90">
</applet>
</div>

<p>Remember that <strong>the areas of the rectangles equal the joint probabilities and are
therefore the same in both diagrams</strong>.
</p>

<p>Drag the slider to alter the proportion of people who have the disease
in the population. (We assume that the probabilities of false negatives and false positives
from the test remain the same.) Observe that:
</p>

<ul>
	<li>When a large proportion in the population have the disease,
		<span class="black"><em>p</em><sub style="font-family:sans-serif; font-size:small;">disease | positive</sub></span>
		is high. This is because there are very few positive test
		results from people who do not have the disease.</li>
	<li>When P(disease) is small,
		<span class="black"><em>p</em><sub style="font-family:sans-serif; font-size:small;">disease | positive</sub></span>
		is also small since the
		small number who have the disease and are positive is outweighed by
		those who do not have the disease but are positive.</li>
</ul>

</div>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
