<!DOCTYPE HTML>
<html>
<head>
	<title>Least squares with matrices</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="general linear model, matrix notation, least squares, residual, fitted values">
	<meta name="dataset" content="Grandfather clock price">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p>We next develop the method of least squares using matrices for a general 
    linear model,</p>
  <p class=eqn><img src="images/generalMatrixModel.gif" width="91" height="17"></p>
  <p>The residual sum of squares can also be expressed in terms of matrices,</p>
  <p class=eqn><img src="images/residSsqMatrix.gif" width="270" height="23"></p>
  <p class="heading">Least squares estimates</p>
  <p>The <strong>least squares estimates</strong> of the parameters are given 
    by the vector <em><span class="bold red">b</span> </em> that 
    minimises the sum of squared residuals.</p>
  <p>The least squares estimates are therefore the solution to a mathematical 
    minimisation problem that is relatively easily specified in terms of matrices 
    &mdash; minimising</p>
  <p class=eqn><img src="images/residSsqMatrix2.gif" width="154" height="23"></p>
  <p>with respect to <em><span class="bold red">b</span> </em>. 
    Note that the vector <em><strong>y</strong></em> and the matrix <strong>X</strong> 
    contain known values. The solution to this mathematical problem is given by 
    the equation,</p>
  <p class=eqn><img src="images/lsEquation.gif" width="138" height="23"></p>
<br>
  
<div class="centred"><div class="boxed">
<p>Neither the proof nor the matrix equation for 
        <span class="em red">b</span>  are important for understanding 
        how to use general linear models.</p>
</div></div>

  <p>It is however important to observe that:</p>
	
<div class="centred"><div class="boxed">
<p>The same matrix equation provides least squares 
				estimates for <strong>all</strong> general linear models.</p>
</div></div>

	<p>We will also show that inference for all general linear models can be expressed 
		in common terms.</p>
  <div class="diagram">
<p class="heading">Sale price of grandfather clocks</p>
    <p>The selling prices at auction of 32 antique grandfather clocks were recorded, 
      with the ages of the clocks and the number of people who made a bid. The 
      least squares estimates of the parameters are shown in the equation below 
      for the fitted values.</p>
    <p class=eqn><img src="images/grandfatherFit.gif" width="291" height="20"></p>
    <p>The matrices below shows the matrix equation for the residuals.</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="600" height="630">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="matrixProg.ActualResidApplet">
<param name="nXColumns" value="2">
<param name="fullNameX1" value="Age, x">
<param name="shortNameX1" value="x">
<param name="valuesX1" value="127 115 127 150 156 182 156 132 137 113 137 117 137 153 117 126 170 182 162 184 143 159 108 175 108 179 111 187 111 115 194 168">
<param name="fullNameX2" value="Bids, z">
<param name="shortNameX2" value="z">
<param name="valuesX2" value="13 12 7 9 6 11 12 10 9 9 15 11 8 6 13 10 14 8 11 10 6 9 14 8 6 9 15 8 7 7 5 7">
<param name="yName" value="Price">
<param name="yValues" value="1235 1080 845 1522 1047 1979 1822 1253 1297 946 1713 1024 1147 1092 1152 1336 2131 1550 1884 2041 854 1483 1055 1545 729 1792 1175 1593 785 744 1356 1262">
<param name="errorName" value="e">
<param name="lsDecimals" value="1 2 2">
<param name="residDecimals" value="1">
<param name="matrixFont" value="standard">
</applet> 
</div>

    <p>Any other values for the three parameter estimates would result in residuals 
      with a greater sum of squares.</p>
</div>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
