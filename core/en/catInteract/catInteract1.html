<!DOCTYPE HTML>
<html>
<head>
	<title>Interaction between numerical variables</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="interaction, general linear model">
	<meta name="dataset" content="Bee energy expenditure">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Importance of models without interaction</p>
	<p>If the explanatory variables in a general linear model (GLM) do not interact 
		in their effect on the response, the model can be written in the form,</p>
	<p class=eqn><img src="../mixedModel/images/generalModel.gif" width="379" height="21"></p>
	<p>The effect of changing any explanatory variable is then the same whatever 
		the values of the other variables.</p>
	
<div class="centred"><div class="boxed">
<p>If there is no interaction, we can <strong>separately</strong> 
						describe the effects of each explanatory variable on the response.</p>
</div></div>

	<p>This greatly simplifies the description of the relationships and makes the 
		model much easier to understand.</p>
  
  <p class="heading">Models for 2 numerical explanatory variables, X and Z</p>
	<p>The simplest type of general linear model (GLM) for two numerical explanatory 
		variables, <em>X</em> and <em>Z</em>, is:</p>
		<p class="eqn"><img src="../regnInfTwo/images/normModelTwo2.gif" width="418" height="21"></p>
	<p>In this model, the effect on the response of changing <em>X</em> by 1 is 
		β<sub>1</sub> 
		whatever the value of <em>Z</em>. In a similar way, the effect on the response 
		of changing <em>Z</em> by 1 is β<sub>2</sub> 
		whatever the value of <em>X</em>. We therefore say that there is <strong>no 
		interaction</strong> between the effects of <em>X</em> and <em>Z</em>.</p>
	<p> In some applications, the explanatory variables <strong>do</strong> interact 
		in their effect on the response. For example, increasing the amount of fertiliser 
		may increase crop yield if the temperature is high, but have no effect at 
		low temperatures. A simple model that allows for interaction is:</p>
	<p class=eqn><img src="../interact/images/interactModel.gif" width="496" height="21"></p>
	<p>This model was <a href="javascript:showNamedPage('interact2')">described 
		more fully in an earlier section</a>.</p>
	
<div class="centred"><div class="boxed">
<p>An interaction between 2 variables is 
						often modelled with an extra explanatory variable that is their product.</p>
</div></div>

  
  <p class="heading">Graphical display of models</p>
	<p>Both the models with and without interaction can be represented as surfaces 
		on a 3-dimensional scatterplot of the data. For the model without interaction, 
		the surface is a plane, but the model with interaction allows some curvature.</p>
	
<div class="centred"><div class="boxed">
<p>If there is no interaction, slices through 
						this surface at different values of Z are parallel.</p>
</div></div>

	<p>If there is interaction, these slices are <strong>not</strong> parallel.</p>
	<div class="diagram"> 
		<p class="heading">Energy expenditure of bees</p>

		<p>In an experiment, an entomologist recorded energy expenditure (joules/sec) 
			for bees drinking water with different sucrose concentrations (%) and at 
			different temperatures. The following 3-dimensional scatterplot shows the 
			data. </p>
		<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="450">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="responseSurfaceProg.DragLinInteractApplet">
<param name="yVarName" value="Energy (E)">
<param name="xVarName" value="Temperature (T)">
<param name="zVarName" value="Sucrose (S)">
<param name="shortNames" value="E T S">
<param name="yValues" value="3.1 3.7 4.7 5.5 6.7 7.3 7.9 9.2 9.3 6.0 6.9 7.5 11.5 12.9 13.4 17.5 15.8 14.7 7.7 8.3 9.5 15.7 14.3 15.9 19.1 18.0 19.9">
<param name="xValues" value="9@20 9@30 9@40">
<param name="zValues" value="3@20 3@40 3@60 3@20 3@40 3@60 3@20 3@40 3@60">
<param name="yAxis" value="0 20 0 5">
<param name="xAxis" value="17 43 20 10">
<param name="zAxis" value="15 65 20 20">
<param name="contourAxis" value="0 25 0 5">
<param name="shadeCutoff" value="0 15 25">
<param name="startMean" value="10">
<param name="maxCoeffs" value="-99.999 -9.999 -9.9999 0 0 9.9999">
<param name="fixedContours" value="0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22">
<param name="customText" value="Display type=Display type#Shaded surface=Shaded surface#Selected contours=Selected contours#Grid=Grid">
</applet> 

</div>

		<p>A surface represents the model in the scatterplot. Click <strong>Least 
			squares</strong> to see the least squares estimates for the model parameters. 
			<strong>Rotate</strong> the diagram by dragging with the mouse or using 
			the rotation buttons on the right to get a feel for where the data lie in 
			relation to the surface.</p>
			
			
		<dl>
			<dt class="black">Estimated effect of increasing temperature by 1 degree:</dt>
		</dl>
		<ul>
			<li>Energy will increase by 0.118 when there is <strong>no sucrose</strong>.</li>
			<li>Energy will increase by 0.0069 more than this for each extra unit sucrose 
				concentration.</li>
		</ul>
		<br>
		<hr width="75%">
		<p>Finally, select <strong>Grid</strong> from the <strong>Display type</strong> 
			menu, then click the <strong>y-x</strong> rotation button. The grid lines 
			correspond to slices through the surface at different z-values. Observe 
			that they are not parallel, corresponding to an interaction between the 
			effects of <em>temperature</em> and <em>sucrose</em>.</p>
		
<div class="centred"><div class="boxed">
<p>Increasing temperature at low sucrose 
							levels seems to increase energy consumption by less than at high 
							sucrose levels.</p>
</div></div>

		<br>

</div>
  
  <p class="heading">Inference</p>
	<p>The existence of interaction between two numerical explanatory variables 
		can be tested using a t-test for whether the coefficient of the interaction 
		term in the GLM is zero.</p>
	
  <div class="diagram">
<p class="heading">Energy expenditure of bees</p>
		<p>We will now test whether the interaction between sucrose and temperature 
			that is apparent in the least squares estimates could have arisen by chance.</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="550">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="curveInteractProg.QuadParamTestApplet">
<param name="dataName" value="Energy expenditure of bees">
<param name="yAxis" value="0 20 0 5">
<param name="xAxis" value="17 43 20 10">
<param name="zAxis" value="15 65 20 20">
<param name="longYVarName" value="energy (y)">
<param name="longXVarName" value="temperature (x)">
<param name="longZVarName" value="sucrose (z)">
<param name="yVarName" value="y">
<param name="xVarName" value="x">
<param name="zVarName" value="z">
<param name="yValues" value="3.1 3.7 4.7 5.5 6.7 7.3 7.9 9.2 9.3 6.0 6.9 7.5 11.5 12.9 13.4 17.5 15.8 14.7 7.7 8.3 9.5 15.7 14.3 15.9 19.1 18.0 19.9">
<param name="xValues" value="9@20 9@30 9@40">
<param name="zValues" value="3@20 3@40 3@60 3@20 3@40 3@60 3@20 3@40 3@60">
<param name="initialParams" value="6.00 0.000 0.000 0.0000 0.0000 0.0000 0">
<param name="paramMinMax" value="-99.99 99.99 0.999 9.999 -9.999 9.999 -9.9999 9.9999 -9.9999 9.9999 0.0000 9.9999">
<param name="shadeCutoff" value="0 10 20">
<param name="paramNames" value="Intercept Temperature Sucrose ? ? Interaction">
<param name="maxTableEntries" value="-99.999 9.999 99.99">
<param name="initialRotation" value="45 40">
<param name="customText" value="param=param#se=se">
</applet> 
</div>

		<p>From the p-value associated with the interaction term, 0.0013, we conclude 
			that there is extremely strong evidence of an interaction between the effects 
			of <em>temperature</em> and <em>sucrose</em>.</p>
		<p>Note that we should not attempt to interpret the p-values for the main 
			effects of <em>temperature</em> or <em>sucrose</em> if we believe that there 
			is an interaction.</p>
		
<div class="centred"><div class="boxed">
<p>Since we have concluded that the effect 
							of <em>temperature</em> is different at different <em>sucrose</em> 
							levels, it makes no sense to test whether <em>temperature</em> has 
							any effect on the response.</p>
</div></div>

		<br>
		
	</div>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
