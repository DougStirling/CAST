<!DOCTYPE HTML>
<html>
<head>
	<title>Interaction between categorical variables</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="interaction, indicator variable, general linear model, parallel regn lines">
	<meta name="dataset" content="Exercise and smoking">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Model without interaction</p>
	<p>As with numerical explanatory variables, if two categorical variables do 
		not interact in their effect on the response, then the effects of the two 
		variables add together,</p>
	<p class=eqn><img src="images/noInteractModel.gif" width="323" height="21"></p>
	<p>For categorical variables, the effect of each variable is defined in a GLM 
		with indicator variables.</p>
	
<div class="centred"><div class="boxed">
<p>If the mean response is plotted against 
						<em>x</em> with different colours for each <em>z</em>, then the pattern 
						is 'parallel' for each <em>z</em> (colour).</p>
</div></div>

	<br>
	<p class=eqn><img src="images/catParallelLines.gif" width="324" height="253"></p>
	<p>As in other models, interpretation and analysis is simpler if there is no 
		interaction since the effects of <em>X</em> and <em>Z</em> can be described 
		separately. </p>
	<p class="heading">Model with interaction</p>
	<p>If there is interaction, then these lines are not parallel, making it much 
		harder to understand and explain the model.</p>
	<p class=eqn><img src="images/catNonParallelLines.gif" width="324" height="253"></p>
<br>
	
	<div class="diagram"> 
		<p class="heading">Exercise and smoking</p>

		<p>The data below are based on an experiment that investigated the effect 
			of smoking on physical activity. The experiment involved 9 heavy smokers, 
			9 moderate smokers and 9 non-smokers, and 3 were randomly selected from 
			each group to exercise on a bicycle ergometer, treadmill and stepper. The 
			scatterplot below shows the time until maximum oxygen uptake (minutes) for 
			each subject.</p>
		<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="500" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="indicatorProg.DragCatLinesApplet">
<param name="yVarName" value="Time to max O2">
<param name="yValues" value="12.8 13.5 11.2 10.9 11.1 9.8 8.7 9.2 7.5 19.2 21.1 20.8 15.5 13.8 17.2 12.7 11.2 9.8 22.6 20.3 21.9 19.1 18.0 15.9 12.2 12.1 14.8">
<param name="xVarName" value="Exercise">
<param name="xValues" value="9@0 9@1 9@2">
<param name="xLabels" value="Bicycle Treadmill Step">
<param name="zVarName" value="Smoking">
<param name="zValues" value="3@0 3@1 3@2 3@0 3@1 3@2 3@0 3@1 3@2">
<param name="zLabels" value="Nonsmoker #Moderate smoker# #Heavy smoker#">
<param name="yAxis" value="5 25 5 5">
<param name="shortNames" value="e s">
<param name="initModelParams" value="15.00 6.00 8.00 -3.00 -7.00 0.00 0.00 0.00 0.00 0">
<param name="maxParam" value="99.99">
<param name="showCoeffs" value="false">
<param name="customText" value="Allow interaction=Allow interaction">
</applet> 

</div>

		<p>The coloured lines represent a model with no interaction for the data. 
			<strong>Drag</strong> the five arrows to investigate this model, then click 
			<strong>Least squares</strong>. Observe that the lines are parallel for 
			the different smoking groups.</p>
		<p>Now click <strong>Allow interaction</strong>. This allows the mean responses 
			for all 9 combinations of smoking group and exercise to be separately adjusted. 
			Click <strong>Least squares</strong> to see the best-fitting model.</p>
		
<div class="centred"><div class="boxed">
<p>The response means for the 3 smoking 
							groups seem more similar on the bicycle than on the treadmill or 
							stepper.</p>
</div></div>

		<br>
	</div>

		
	<p class="heading">Defining the model with interaction</p>

	<p>We define the model with interaction by adding terms to the no-interaction 
		model. This will make it easier to test whether interaction exists since we 
		can test whether these additional terms are required.</p>
	<p class=eqn><img src="images/interactModel.gif" width="468" height="21"></p>
	<p>If <em>X</em> has <em>n</em><sub>X</sub> different categories and <em>Z</em> 
		has <em>n</em><sub>Z</sub> categories, then the interaction can be defined 
		with (<em>n</em><sub>X</sub>&nbsp;-&nbsp;1)(<em>n</em><sub>Z</sub>&nbsp;-&nbsp;1) 
		extra parameters that correspond to the green arrows in the diagram above. 
		These specify the differences between response mean for this model and the 
		no-interaction model for the non-baseline categories of <em>X</em> and <em>Z</em>.</p>
	<div class="diagram"> 
		<p class="heading">Exercise and smoking</p>

		<p>The diagram below again allows the parameters of the models to be adjusted.</p>
		<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="500" height="600">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="indicatorProg.DragCatLinesApplet">
<param name="yVarName" value="Time to max O2">
<param name="yValues" value="12.8 13.5 11.2 10.9 11.1 9.8 8.7 9.2 7.5 19.2 21.1 20.8 15.5 13.8 17.2 12.7 11.2 9.8 22.6 20.3 21.9 19.1 18.0 15.9 12.2 12.1 14.8">
<param name="xVarName" value="Exercise">
<param name="xValues" value="9@0 9@1 9@2">
<param name="xLabels" value="Bicycle Treadmill Step">
<param name="zVarName" value="Smoking">
<param name="zValues" value="3@0 3@1 3@2 3@0 3@1 3@2 3@0 3@1 3@2">
<param name="zLabels" value="Nonsmoker #Moderate smoker# #Heavy smoker#">
<param name="yAxis" value="5 25 5 5">
<param name="shortNames" value="e s">
<param name="initModelParams" value="15.00 6.00 8.00 -3.00 -7.00 0.00 0.00 0.00 0.00 0">
<param name="maxParam" value="99.99">
<param name="customText" value="Allow interaction=Allow interaction#Main effects=Main effects#Interactions=Interactions#Intercept=Intercept">
</applet> 

</div>

		<p>Firstly drag the red arrows on the baseline categories for the no-interaction 
			model.</p>
		
<div class="centred"><div class="boxed">
<p>For any exercise-smoking combination, 
							the estimated response mean is the sum of the intercept and the 
							main effects for exercise and smoking.</p>
</div></div>

		<p>Now click <strong>Allow interaction</strong>. Drag the four green arrows 
			and observe that the interaction parameters for any smoking group are the 
			differences between the pattern for this smoking group and that of the non-smoking 
			group.</p>
		<p>Click <strong>Least squares</strong>. The interaction term for heavy smokers 
			on a treadmill is interpreted as follows.</p>
		
<div class="centred"><div class="boxed">
<p>The difference between times to maximum 
							O<sub>2</sub> on a treadmill and bicycle are estimated to be 5.10 
							minutes less for heavy smokers than for nonsmokers.</p>
</div></div>

		<br>

</div>
		
	<p class="heading">Expressing the model as a GLM</p>
		
	<p>The interaction was defined above using extra parameters that are added to 
		the model for the (<em>n</em><sub>X</sub>&nbsp;-&nbsp;1)(<em>n</em><sub>Z</sub>&nbsp;-&nbsp;1) 
		combinations of non-baseline categories of <em>X</em> and <em>Z</em>. Indicator 
		variables can be used to 'turn on' the appropriate parameters for these combinations.</p>

	<div class="diagram"> 
		<p class="heading">Exercise and smoking</p>
		<p>To reduce the size of the matrices, we will only show the model for 18 
			individuals (two instead of three for each combination of smoking and exercise). 
			The GLM for these individuals is shown below.</p>
		<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="600">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="matrixProg.InteractModelEqnApplet">
<param name="nXColumns" value="2">
<param name="fullNameX1" value="Exercise, e">
<param name="shortNameX1" value="e">
<param name="valuesX1" value="6@0 6@1 6@2">
<param name="labelsX1" value="Bicycle Treadmill Step">
<param name="fullNameX2" value="Smoking, s">
<param name="shortNameX2" value="s">
<param name="valuesX2" value="2@0 2@1 2@2 2@0 2@1 2@2 2@0 2@1 2@2">
<param name="labelsX2" value="Nonsmoker #Moderate smoker# #Heavy smoker#">
<param name="yName" value="Time, Y">
<param name="errorName" value="error">
<param name="matrixFont" value="standard">
<param name="interactionName" value="e * s">
<param name="customText" value="effect=effect#interaction=interaction">
</applet> 
</div>

		<p>Drag over the rows of the matrices. Observe that there is no interaction 
			term if either exercise or smoking are at their baseline levels (bicycle 
			and non-smoker).</p>
		<p>There are four interaction parameters (and four corresponding columns of 
			indicator variables in the design matrix, X) corresponding to the combinations 
			of non-baseline categories of the variables. The indicator variables pick 
			out the appropriate interaction parameter for the non-baseline categories.</p>
		<p>(You can also click on the table at the bottom of the diagram to see the 
			model for observations with any combination of smoking and exercise.)</p>
		
	</div>
  
  <p class="heading">Three-dimensional representation of model (optional)</p>
	<p>The models with and without interaction can be successfully represented in 
		a 2-dimensional plot of <em>Y</em> against <em>X</em>, with different colours 
		representing <em>Z</em>. However a 3-dimensional diagram with axes for <em>Y</em>, 
		<em>X</em> and <em>Z</em> is an alternative representation.</p>
	
  <div class="diagram"> 
		<p class="heading">Exercise and smoking</p>
		<p>The 3-dimensional scatterplot below initially shows a model without interaction 
			for the data.</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="500">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="twoFactorProg.RotateDragFactorsApplet">
<param name="yVarName" value="Time to max O2">
<param name="yValues" value="12.8 13.5 11.2 10.9 11.1 9.8 8.7 9.2 7.5 19.2 21.1 20.8 15.5 13.8 17.2 12.7 11.2 9.8 22.6 20.3 21.9 19.1 18.0 15.9 12.2 12.1 14.8">
<param name="yAxis" value="5 25 5 5">
<param name="xVarName" value="Exercise, e">
<param name="xValues" value="9@0 9@1 9@2">
<param name="xLabels" value="Bicycle Treadmill Step">
<param name="zVarName" value="Smoking, s">
<param name="zValues" value="3@0 3@1 3@2 3@0 3@1 3@2 3@0 3@1 3@2">
<param name="zLabels" value="Nonsmoker #Moderate smoker# #Heavy smoker#">
<param name="zModelTerms" value="factor">
<param name="xModelTerms" value="factor">
<param name="interaction" value="true">
<param name="initialModel" value="15.0">
<param name="maxRss" value="99.999">
<param name="customText" value="None=None#Linear=Linear#Factor=Factor#Interaction=Interaction">
</applet> 
</div>

		<p><strong>Drag</strong> the five red arrows to adjust the model then click 
			<strong>Least squares</strong>.</p>
		<p>Click the <strong>Interaction</strong> checkbox to allow an interaction 
			in the model. This enables four extra green arrows that can be used to adjust 
			the model with interaction. Finally click <strong>Least squares</strong> 
			again to see the best model for the data.</p>
		
	</div>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
