<!DOCTYPE HTML>
<html>
<head>
	<title>Latin squares</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="orthogonal factors, pairwise orthogonal factors, blocks, analysis of variance, anova, latin square design">
	<meta name="dataset" content="Winter feeding and milk production">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Two blocking variables</p>  
<p>One special type of  design with pairwise orthogonal factors is particularly important. A <strong>Latin square</strong> design is mainly used for experiments in which there are <em>n</em>&nbsp;=&nbsp;<em>r</em><sup>2</sup> experimental units that are indexed by <strong>two </strong>  blocking variables with <em>r</em> levels each.</p>
<p> Two blocking variables arise when  the <em>n</em> experimental units are effectively <em>n</em> separate blocks, but the block effect is defined by <strong>two</strong> different types of categorical variables. There are two main situations where two such blocking variables exist:</p>
<ul>
	<li>The experimental units are an  <em>r</em>-by-<em>r</em> array of  adjacent rectangular plots of land in a field where it is suspected that there may be fertility gradients in two dimensions. Rows and columns of the array may be treated as blocking variables.</li>
	<li>There are <em>r</em> physical units and treatments and measurements are applied to each at <em>r</em> different times. For example, an experiment might test the effects of <em>r</em> drugs to alleviate the symptoms of a disease on <em>r</em> patients. Each patient is given the <em>r</em> drugs on different days. The passage of time explains variation since symptoms may naturally decrease over time, so both patient and time would be treated as blocking variables.</li>
</ul>
<p>Two blocking variables often occur when there are <em>r</em> physical units and treatments and measurements are applied to each at <em>r</em> different times.</p>
<ul>
	<li>An experiment using <em>r</em> animals uses <em>r</em> different diets in different weeks for each animal. The times should not be ignored since each animal may change over time.</li>
	<li>An experiment tests the effects of <em>r</em> drugs to alleviate the symptoms of a disease on <em>r</em> patients. Each patient is given the <em>r</em> drugs on different days. The passage of time explains variation since symptoms may naturally decrease over time.</li>
	<li>The experimental units are an <em>r</em>-by-<em>r</em> array of plots in a field and it is suspected that there may be fertility gradients in two dimensions. Rows and columns of the array may be treated as blocking variables.</li>
</ul>
<p>We will assume here that these two blocking variables act independently on the response.</p>
<p class="heading">Latin square designs</p>
<p>A Latin square design allocates <em>r</em> treatments to these units in such a way that the treatments and two blocking variables are pairwise orthogonal.</p>
<p>The design is usually described by a square grid with rows and columns for the two blocking variables and capital letters in the cells describing the treatments. An example is shown below for <em>r</em>&nbsp;=&nbsp;5. In this example, the two blocking variables correspond to five different animals and five time periods. Each animal is given one of five different treatments at each of the five time periods.</p>
<div class="centred"><table border="0" class="centred" cellpadding="3" cellspacing="0">
	<tr>
		<td>&nbsp;</td>
		<th colspan="5">Time</th>
		</tr>
	<tr>
		<td>&nbsp;</td>
		<th>&nbsp;Period 1&nbsp;</th>
		<th>&nbsp;Period 2&nbsp;</th>
		<th>&nbsp;Period 3&nbsp;</th>
		<th>&nbsp;Period 4&nbsp;</th>
		<th>&nbsp;Period 5&nbsp;</th>
	</tr>
	<tr>
		<th>Animal 1</th>
		<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-left:1px solid #999999;">B</td>
		<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">A</td>
		<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">E</td>
		<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">D</td>
		<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-right:1px solid #999999;">C</td>
	</tr>
	<tr>
		<th>Animal 2</th>
		<td align="center" bgcolor="#FFFFFF" style="border-left:1px solid #999999;">D</td>
		<td align="center" bgcolor="#FFFFFF">E</td>
		<td align="center" bgcolor="#FFFFFF">B</td>
		<td align="center" bgcolor="#FFFFFF">C</td>
		<td align="center" bgcolor="#FFFFFF" style="border-right:1px solid #999999;">A</td>
	</tr>
	<tr>
		<th>Animal 3</th>
		<td align="center" bgcolor="#FFFFFF" style="border-left:1px solid #999999;">C</td>
		<td align="center" bgcolor="#FFFFFF">B</td>
		<td align="center" bgcolor="#FFFFFF">A</td>
		<td align="center" bgcolor="#FFFFFF">E</td>
		<td align="center" bgcolor="#FFFFFF" style="border-right:1px solid #999999;">D</td>
	</tr>
	<tr>
		<th>Animal 4</th>
		<td align="center" bgcolor="#FFFFFF" style="border-left:1px solid #999999;">A</td>
		<td align="center" bgcolor="#FFFFFF">D</td>
		<td align="center" bgcolor="#FFFFFF">C</td>
		<td align="center" bgcolor="#FFFFFF">B</td>
		<td align="center" bgcolor="#FFFFFF" style="border-right:1px solid #999999;">E</td>
	</tr>
	<tr>
		<th>Animal 5</th>
		<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-left:1px solid #999999;">E</td>
		<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">C</td>
		<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">D</td>
		<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">A</td>
		<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-right:1px solid #999999;">B</td>
	</tr>
</table></div>
<p>Note that every letter appears once in each row and column, ensuring pairwise orthogonality.</p>
<p class="heading">Experiments with two or more factors</p>
<p>Although Latin Square designs are often used when there are two blocking variables and a single controlled factor, they can also be used for:</p>
<ul>
	<li>three factors with <em>r</em> levels each, or</li>
	<li>two factors with <em>r</em> levels and <em>r</em> blocks</li>
	</ul>
<p>In the table above,  the rows or columns could refer to levels of the second or third controlled variable.</p>
<p class="heading">Interactions</p>
<p>Although the main effects for all three factors (or factors and blocking variables) can be estimated and tested, there are not enough observations to estimate or test interactions.</p>
<div class="centred"><div class="boxed">
	<p>We must assume that there are no interactions in a Latin square design.</p>
</div></div>
<br>

<div class="diagram"> 
<p class="heading">Winter feeding and milk production</p>
<p>An experiment was conducted to assess the effect of winter feeding on milk production. The experiment was conducted over four 3-week periods using four cows. Four diets (the treatments) were compared in the experiment and have been labelled A, B, C and D in order of increasing starch equivalent. Each cow received all four diets in different 3-week periods  and the total yield of milk in the third week of each period was recorded. The reason for using only the third week was that there might be some carryover effects of the previous treatment during the first 2 weeks of a period.</p>

<p>The diets given to the cows and yields (in pounds of milk) were:</p>
<div class="centred"><table border="0" class="centred" cellpadding="3" cellspacing="0">
	<tr>
		<th>&nbsp;</th>
		<th colspan="4">Cow</th>
		</tr>
	<tr>
		<th>Period</th>
		<th>1</th>
		<th>2</th>
		<th>3</th>
		<th>4</th>
	</tr>
	<tr>
		<th>1</th>
		<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-left:1px solid #999999;">&nbsp;(A)192&nbsp;</td>
		<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">&nbsp;(B)195&nbsp;</td>
		<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">&nbsp;(C)292&nbsp;</td>
		<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-right:1px solid #999999;">&nbsp;(D)249&nbsp;</td>
	</tr>
	<tr>
		<th>2</th>
		<td align="center" bgcolor="#FFFFFF" style="border-left:1px solid #999999;">(B)190</td>
		<td align="center" bgcolor="#FFFFFF">(D)203</td>
		<td align="center" bgcolor="#FFFFFF">(A)218</td>
		<td align="center" bgcolor="#FFFFFF" style="border-right:1px solid #999999;">(C)210</td>
	</tr>
	<tr>
		<th>3</th>
		<td align="center" bgcolor="#FFFFFF" style="border-left:1px solid #999999;">(C)214</td>
		<td align="center" bgcolor="#FFFFFF">(A)139</td>
		<td align="center" bgcolor="#FFFFFF">(D)245</td>
		<td align="center" bgcolor="#FFFFFF" style="border-right:1px solid #999999;">(B)163</td>
	</tr>
	<tr>
		<th>4</th>
		<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-left:1px solid #999999;">(D)221</td>
		<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">(C)152</td>
		<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">(B)204</td>
		<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-right:1px solid #999999;">(A)134</td>
	</tr>
</table></div>

<p>This  is a Latin square design since each letter appears once in every row and column so Cows, Periods and Diets are pairwise orthogonal. The analysis of variance table for the data is shown below.</p>
<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="200">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="glmAnovaProg.AnovaTableReorderApplet">
<param name="yVarName" value="Milk">
<param name="yValues" value="192 195 292 249 190 203 218 210 214 139 245 163 221 152 204 134">
<param name="xVariables" value="C1 C2 C3 P1 P2 P3 D1 D2 D3">
<param name="C1VarName" value="Cow1">
<param name="C1Values" value="0 3@1 0 3@1 0 3@1 0 3@1">
<param name="C2VarName" value="Cow2">
<param name="C2Values" value="2@0 2@1 2@0 2@1 2@0 2@1 2@0 2@1">
<param name="C3VarName" value="Cow3">
<param name="C3Values" value="3@0 1 3@0 1 3@0 1 3@0 1">

<param name="P1VarName" value="Period1">
<param name="P1Values" value="4@0 12@1">
<param name="P2VarName" value="Period2">
<param name="P2Values" value="8@0 8@1">
<param name="P3VarName" value="Period2">
<param name="P3Values" value="12@0 4@1">

<param name="D1VarName" value="Diet1">
<param name="D1Values" value="0 1 1 1 1 1 0 1 1 0 1 1 1 1 1 0">
<param name="D2VarName" value="Diet2">
<param name="D2Values" value="0 0 1 1 0 1 0 1 1 0 1 0 1 1 0 0">
<param name="D3VarName" value="Diet3">
<param name="D3Values" value="0 0 0 1 0 1 0 0 0 0 1 0 1 0 0 0">

<param name="maxSsq" value="9999.9 99 9999.9 99.99">
<param name="maxBarSsq" value="8000.0">
<param name="xGroups" value="3:C:Cow#3:P:Period#3:D:Diet">
</applet>
</div>

<p>From the p-value associated with Diets, we  conclude that there is extremely strong evidence that milk yield is affected by the diet used.</p>
<p>In this data set, both Cows and Periods can be considered to be blocking variables since neither is under the control of the researcher so there is only a single sensible ordering of terms in an analysis of variance table for these data with Cows and Periods added before Diets. However to illustrate the orthogonality of the three terms, drag the red arrows to <strong>change the ordering</strong> and observe that:</p>
<div class="centred"><div class="boxed">
	<p>The explained sums of squares (and their p-values) do not depend on the ordering of terms.</p>
</div></div>
<p>We would have little interest in testing for differences between the Cows, but the effect of Periods on milk yield is of some interest. From the p-value associated with Periods, there is very strong evidence that milk yields change over the course of the experiment.</p>
<p>The treatment means are:</p>
<div class="centred"><table border="0" class="centred" cellpadding="5" cellspacing="0">
	<tr>
		<th colspan="4">Mean milk yields</th>
		</tr>
	<tr>
		<th>A</th>
		<th>B</th>
		<th>C</th>
		<th>D</th>
	</tr>
	<tr>
		<td bgcolor="#FFFFFF" style="border:1px solid #999999; border-right:0px;">&nbsp;&nbsp;171&nbsp;&nbsp;</td>
		<td bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-bottom:1px solid #999999;">&nbsp;&nbsp;188&nbsp;&nbsp;</td>
		<td bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-bottom:1px solid #999999;">&nbsp;&nbsp;217&nbsp;&nbsp;</td>
		<td bgcolor="#FFFFFF" style="border:1px solid #999999; border-left:0px;">&nbsp;&nbsp;229&nbsp;&nbsp;</td>
	</tr>
</table></div>
<p>These means suggest that increasing starch content improves yield. A further analysis might make use of the numerical value of the starch content for each of the diets and split the diet sum of squares into linear and nonlinear components. This  allows us to test whether yield increases linearly with the starch content or levels out at higher starch contents.</p>
</div>


<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
