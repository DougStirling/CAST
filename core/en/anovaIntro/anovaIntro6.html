<!DOCTYPE HTML>
<html>
<head>
	<title>Testing linearity</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>
	
	<script language="javascript">
	var quadraticExpanded = false;
	var linearExpanded = false;
	
	function expandLinear() {
		var linearOff = document.getElementById("linearOff");
		var linearOn = document.getElementById("linearOn");
		linearOn.style.display = linearExpanded ? "none" : "block";
		linearOff.style.display = linearExpanded ? "block" : "none";
		linearExpanded = !linearExpanded;
	}
	
	function expandQuadratic() {
		var quadraticOff = document.getElementById("quadraticOff");
		var quadraticOn = document.getElementById("quadraticOn");
		quadraticOn.style.display = quadraticExpanded ? "none" : "block";
		quadraticOff.style.display = quadraticExpanded ? "block" : "none";
		quadraticExpanded = !quadraticExpanded;
	}
	</script>

	<meta name="index" content="anova, analysis of variance, linear model, quadratic model, lack of fit, f ratio, f test">
	<meta name="dataset" content="Hardness of ball bearings">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Comparing models</p>
<p>When modelling the effect of a numerical factor, we usually prefer to use simple linear or quadratic models rather than a more general model that treats the factor levels as categorical. However we must test whether the data are consistent with such models.</p>
<p>Tests are based on the explained sums of squares that were described on the previous page. Each move down the hierarchy of models (no effect, linear, quadratic and categorical) reduces the residual sum of squares by an amount that is <strong>explained</strong> by the extra parameters. We must assess whether each explained sum of squares is higher than could be reasonably expected if the simpler model was true. This is done in an <strong>analysis of variance table</strong>.</p>
<p>As in the simple analysis of variance table that was described earlier, mean sums of squares are found by dividing each sum of squares by its degrees of freedom. F ratios are then calculated by dividing each mean explained sum of squares by the mean residual sum of squares.</p>
<p class="eqn"><img src="images/fGroupRatio.gif" width="115" height="37"></p>
<p>If the parameter(s) being added have no effect, the corresponding F ratio is expected to be around 1.0, though it can be somewhat higher or lower by chance. A p-value assesses whether it is unusually high and is interpreted in a similar way to all other p-values &mdash; the closer the p-value to zero, the stronger the evidence that the term is needed in the model.</p>
<p>The method will be clearer with an example.</p>

<div class="diagram">
<p class="heading">Hardness of ball bearings</p>
<p>The anova table below initially treats the cooling rate as categorical (with 15 levels) so there is a single row for the explained variation (with 14 degrees of freedom).</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="250">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="glmAnovaProg.CombineSsqApplet">
<param name="yVarName" value="Hardness index">
<param name="yValues" value="48.60 47.80 47.60 46.70 46.20 45.70 46.55 46.57 46.49 41.82 41.40 42.10 42.01 41.67 38.96 40.97 38.71 37.00 35.88 36.25 39.23 34.18 34.59 37.56 33.49 33.93 31.02 31.57 26.99 28.38">
<param name="xVariables" value="Cool Cool2 Factor">
<param name="CoolVarName" value="Linear">
<param name="CoolValues" value="2@0 2@1 2@2 2@3 2@4 2@5 2@6 2@7 2@8 2@9 2@10 2@11 2@12 2@13 2@14">
<param name="Cool2VarName" value="Quadratic">
<param name="Cool2Values" value="2@49 2@36 2@25 2@16 2@9 2@4 2@1 2@0 2@1 2@4 2@9 2@16 2@25 2@36 2@49">
<param name="FactorVarName" value="Categorical">
<param name="FactorValues" value="6@0 2@1 2@2 2@3 2@4 2@5 2@6 2@7 2@8 2@9 2@10 2@11 2@12">
<param name="FactorLabels" value="L123 L4 L5 L6 L7 L8 L9 L10 L11 L12 L13 L14 L15">
<param name="maxSsq" value="9999.99 99 999.99 99.99">
<param name="componentNames" value="Linear cooling#Adding quadratic#Quadratic lack-of-fit">
<param name="split" value="1:3:Split ssq for factor:Cooling rate (categorical)">
</applet>
</div>

<p>Click <strong>Split ssq for factor</strong> to split the explained sum of squares into sums of squares for linear, quadratic and 'lack of fit' rows.</p>
<p>The p-values are interpreted as follows:</p>
<p class="heading">Interpretation</p>
<dl>
<dt>Lack-of-fit for quadratic model</dt>
<dd>Restricting the parameters of the full categorical model to lie on a quadratic curve increases the residual sum of squares by 0.26.84. This explained sum of squares (with 12 degrees of freedom) is associated with a p-value of 0.5010, 
so we conclude that the quadratic model fits the data as well as the full categorical model &mdash; there is no evidence of lack-of-fit of the quadratic model.</dd>
<dt>Quadratic term</dt>
<dd>The residual sum of squares increases by a further 8.34 if the quadratic 
term is dropped leaving a linear model. The corresponding p-value is 0.0742, so there is only weak evidence of curvature 
in the relationship. (Curvature is significant at the 10% level but not 
at the 5% level.)</dd>
<dt>Linear term</dt>
<dd>If we decide that there is no curvature in the relationship, the explained sum of squares for the linear term can be examined. It is 1,029.15 so dropping the linear term increases the residual sum of squares considerably. The p-value associated with it is reported as &quot;0.0000&quot; so it is almost certain that this term is necessary. The linear term is very important and explains most of the variability in the response.</dd>
</dl>
<p>We therefore conclude that cooling rate does affect the hardness of the ball bearings and that a linear model appears adequate to describe the relationship between cooling rates of 10 and 80.	</p></div>

<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
