<!DOCTYPE HTML>
<html>
<head>
	<title>Confidence interval for median</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>
	
	<link rel='stylesheet' href='../../structure/maths/mathStyles.css' type='text/css'>
	<script src='../../structure/videoControls/jquery.js'></script>
	<script src='../../structure/maths/theorems.js'></script>
	<script src='../../structure/maths/mathJax/MathJax.js?config=TeX-AMS-MML_SVG,statMacros.js'></script>

	<meta name="index" content="confidence interval, hypothesis test, test, median">
	<meta name="dataset" content="Protein levels in dogs">
</head>


<body>
<script type="text/javascript">writePageStart();</script>
<p>As a final example in which a confidence interval can be obtained by inverting a hypothesis test, we will find a 95% confidence interval for the <strong>median</strong> of a data set from a random sample, without making any assumptions about the shape of the distribution from which the sample was selected.</p>
<p class="heading">Hypothesis test about the median</p>
<p>We find the confidence interval by considering a hypothesis test for the hypotheses</p>
<ul>
	<li>Null hypothesis, <strong>H<sub>0</sub></strong>: \(\theta = \theta_0\)</li>
	<li>Alternative hypothesis, <strong>H<sub>A</sub></strong>: \(\theta \ne \theta_0\)</li>
</ul>
<p>where the parameter \(\theta\) is the median of the distribution. Rather than using the \(n\) raw data values, we will base the test on the<strong> number</strong> of values less than \(\theta_0\). If \(\theta_0\) really is the median (and the null hypothesis is true), this will have a binomial distribution,</p>
\[
Y \;\;=\;\; \text{number of values below }\theta_0 \;\;\sim\;\; \BinomDistn(n, \pi=0.5)
\]
<p>This can be used as a test statistic and the p-value for the test is the probability of \(Y\) being further from \(\diagfrac{n}{2}\) than was observed in the data.</p>
<p>We can apply trial-and-error to find the values of \(\theta_0\) that would result in the null hypothesis being accepted.</p>
<div class="questionSoln">
	<div class="question">
<p class="questionTitle">Example</p>
<p>A certain disease in dogs is characterized in the early stages by unusually high levels of a blood protein. This measurement has been proposed as a diagnostic test for infection: if the measured level is above a threshold value, the dog is diagnosed as having the disease. A &lsquo;false positive&rsquo; occurs when a healthy dog happens to have a level above the threshold and is wrongly diagnosed as having the disease.</p>
<p>Measurements on a sample of 50 unaffected dogs gave the following results:</p>
<div class="centred">
	<table border="0" cellpadding="5" cellspacing="0" class="centred" style="border:1px solid #999999; background-color:#FFFFFF;">
		<tr>
			<td style="text-align:right; padding-right:7px; width:40px;">14.4<br>
				16.1<br>
				11.9<br>
				7.5<br>
				9.3</td>
			<td style="text-align:right; padding-right:7px; width:40px;">9.3<br>
				16.4<br>
				4.9<br>
				12.8<br>
				23.7</td>
			<td style="text-align:right; padding-right:7px; width:40px;">23.7<br>
				13.5<br>
				9.3<br>
				8.6<br>
				17.6</td>
			<td style="text-align:right; padding-right:7px; width:40px;">19.0<br>
				20.3<br>
				17.0<br>
				30.4<br>
				8.3</td>
			<td style="text-align:right; padding-right:7px; width:40px;">13.9<br>
				20.1<br>
				10.2<br>
				23.6<br>
				14.9</td>
			<td style="text-align:right; padding-right:7px; width:40px;">19.7<br>
				20.9<br>
				17.1<br>
				14.2<br>
				15.7</td>
			<td style="text-align:right; padding-right:7px; width:40px;">50.4<br>
				8.5<br>
				7.5<br>
				23.0<br>
				18.7</td>
			<td style="text-align:right; padding-right:7px; width:40px;">5.5<br>
				11.2<br>
				31.8<br>
				20.4<br>
				13.0</td>
			<td style="text-align:right; padding-right:7px; width:40px;">13.4<br>
				11.7<br>
				7.8<br>
				19.4<br>
				21.4</td>
			<td style="text-align:right; padding-right:7px; width:40px;">16.4<br>
				28.2<br>
				31.3<br>
				30.3<br>
				26.6</td>
		</tr>
	</table>
</div>
<p>Measurements on a sample of 27 diseased dogs gave the results:</p>
<div class="centred">
	<table border="0" cellpadding="5" cellspacing="0" class="centred" style="border:1px solid #999999; background-color:#FFFFFF;">
		<tr>
			<td style="text-align:right; padding-right:7px; width:40px;">21.9<br>
				40.8<br>
				37.6</td>
			<td style="text-align:right; padding-right:7px; width:40px;">41.7<br>
				23.3<br>
				39.8</td>
			<td style="text-align:right; padding-right:7px; width:40px;">66.3<br>
				34.4<br>
				27.8</td>
			<td style="text-align:right; padding-right:7px; width:40px;">49.8<br>
				19.3<br>
				55.5</td>
			<td style="text-align:right; padding-right:7px; width:40px;">50.7<br>
				27.5<br>
				30.2</td>
			<td style="text-align:right; padding-right:7px; width:40px;">60.7<br>
				8.5<br>
				51.2</td>
			<td style="text-align:right; padding-right:7px; width:40px;">24.2<br>
				24.9<br>
				16.1</td>
			<td style="text-align:right; padding-right:7px; width:40px;">28.2<br>
				30.2<br>
				&nbsp;</td>
			<td style="text-align:right; padding-right:7px; width:40px;">15.7<br>
				18.3<br>
				&nbsp;</td>
			<td style="text-align:right; padding-right:7px; width:40px;">22.5<br>
				8.4<br>
				&nbsp;
			</tr>
	</table>
</div>
<p>Find 95% confidence intervals for the median level of blood protein in the two groups.</p>
	</div>

<div class="solution">
<p>For the 50 unaffected dogs, we would accept the null hypothesis that the median is \(\theta_0\) if the number of values less than \(\theta_0\), \(Y\), is not in the upper or lower 2.5% tails of the \(\BinomDistn(50, 0.5)\) distribution.</p>
<p>With a little trial-and-error, we would only reject <strong>H<sub>0</sub></strong> if \(y \le 17\) since</p>
\[
P(Y \le 17) \;\;=\;\; 0.0164 \spaced{and} P(Y \le 18) \;\;=\;\; 0.0325
\]
<p>and similarly we would reject <strong>H<sub>0</sub></strong> if \(y \ge 33\).</p>
<p>Values, \(y\), that would lead us to <strong>accepting </strong>the null hypothesis are therefore</p>
\[
18 \;\;\le\;\; y \;\;\le\;\; 32
\]
<p>A 95% confidence interval for the median, \(\theta\), therefore consists of values such that between 18 and 32 data values (inclusive) are less â€” between the 17th and 33rd values (exclusive)in the data set when sorted into order. For the unaffected dogs, this results in a 95% confidence interval for the median,</p>
\[
13.4 \;\;\lt\;\; \theta \;\;\lt\;\; 19.4
\]
<p>For the 27 diseased dogs, we would accept the null hypothesis that the median is \(\theta_0\) if the number of values less than it, \(y\), is between 8 and 19, so a 95% confidence interval for the median is between the 8th and 19th values in that data set when sorted into order,</p>
\[
22.5 \;\;\lt\;\; \theta \;\;\lt\;\; 40.9
\]
<hr width="75%">

<p class="heading">Illustration of the method for the 27 diseased dogs</p>
<p>The diagram below illustrates the procedure for the 27 diseased dogs.</p>
<div class="centred">
	<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="500" height="550">
		<script type="text/javascript">writeAppletParams();</script>
		<param name="appletName" value="estimationProg.MedianTestApplet">
		<param name="backgroundColor" value="FFFFFF">
		<param name="dataAxis" value="0 70 0 5">
		<param name="varName" value="Protein level, X">
		<param name="values" value="21.9 40.8 37.6 41.7 23.3 39.8 66.3 34.4 27.8 49.8 19.3 55.5 50.7 27.5 30.2 60.7 8.5 51.2 24.2 24.9 16.1 28.2 30.2 15.7 18.3 22.5 8.4">
		<param name="binomAxis" value="-0.5 27.5 0 2">
		<param name="probAxis" value="0 0.20 0 0.05">
		<param name="sigLevel" value="0.0500">
		<param name="medianLimits" value="10.0 45.0 20.0">
		<param name="customText" value="values below=values below#values less than=values less than">
	</applet>
</div>
<p>The stacked dot plot at the bottom shows the data set. The diagram initially shows the steps for a two-tailed test for whether the median, \(\theta\), is 20.0.</p>
<ol>
	<li>Of the \(n=27\) values in the data set, \(y=6\) are below 20.</li>
	<li>If the median was really 20.0, the number below it would have a \(\BinomDistn(n=27, \pi=0.5)\) distribution and this is shown in the  bar chart at the top.</li>
	<li>The probability of getting as a &quot;extreme&quot; a value from this binomial distribution is twice the lower tail probability, 0.0059, and this is the p-value for the test.</li>
	<li>If testing at the 5% significance level, we would reject the null hypothesis <strong>H<sub>0</sub></strong>: \(\theta = 20.0\).</li>
</ol>
<p>Since the null hypothesis value \(\theta = 20.0\) is rejected by a test at 5% significance level, this value is <strong>not</strong> in a 95% confidence interval for \(\theta\).</p>
<p><strong>Drag</strong> the slider to perform tests about whether \(\theta\) is other values. The values that result in accepting the null hypothesis (p-values over 0.05) are those that are in a 95% confidence interval,</p>
\[
22.5 \;\;\lt\;\; \theta \;\;\lt\;\; 40.9
\]
</div>
</div>

<script type='text/javascript'>writePageEnd();</script>
</body>
</html>
