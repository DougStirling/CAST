<!DOCTYPE HTML>
<html>
<head>
	<title>Least squares</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="regression model, linear model, least squares, residual/minimising sum of squares">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Positioning the line to give small residuals</p>

  <p>The residuals from a linear model are the vertical distances from the crosses 
		to the line on a scatterplot. They indicate how closely predictions from the 
		line (the fitted values) match the actual responses in the data. </p>

  <p>Therefore positioning the line to make the residuals small improves the model's 
    fit to the data. The parameters <em>b</em><sub>0</sub> 
    and <em>b</em><sub>1</sub> 
    of the linear model should be set to make the residuals as small as possible. 
  </p>

<div class="diagram" title="Illustration: Size of residuals">
<p>In the diagram below, the residuals for all observations are displayed as
vertical blue lines.
</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="350" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="regnProg.DragLineApplet">
<param name="xVarName" value="x">
<param name="yVarName" value="y">
<param name="xValues" value="27.6 23 20.8 31.9 17.6 8.1 28.5 12.7 38 26.5 6.4 2.5 8.4 26.1 17.7 9.8 36.7 35.4 13.9 23.6 8.6 31.3 4.6 5 28.2 1.3 27.2 8.1 36.9 38.1">
<param name="yValues" value="14.3 9.3 9.4 15.1 7.9 4.4 12 9 18.6 12.1 3.4 3.8 6.6 12.3 9.6 6 16.3 14.5 8.1 11.5 7.4 16.4 5.8 4.2 12.7 2.7 14.8 4.3 16.3 19.2">
<param name="horizAxis" value="0 40 0 5">
<param name="vertAxis" value="0 20 0 2">
<param name="interceptLimits" value="0.0 20.0 5.0">
<param name="slopeLimits" value="-0.50 0.50 0.20">
<param name="labelAxes" value="true">
</applet>
</div>

<p><strong>Drag</strong> the red arrows on the diagram to adjust the intercept and
slope of the line to make the residuals small.
</p>

</div>

  <p class="heading">Least squares: minimising the sum of squares of residuals</p>
  <p>To turn this into an objective procedure, we must define what is meant by 
	'making the residuals small'. The most useful overall measure of the size 
	of the residuals is the <strong>residual sum of squares</strong>, </p>

<p class=eqn><img class="gif" src="../leastSqrs/images/residSsq.gif" width="317" height="28">
</p>

  <p>The values of <em>b</em><sub>0</sub> 
    and <em>b</em><sub>1</sub> 
    that minimise the residual sum of squares are called the <strong>least squares 
    estimates</strong> of the parameters and the method is called <strong>the 
    method of least squares</strong>. </p>

<div class="diagram" title="Illustration of the method of least squares">
<p>In the diagram below, the squared residuals are represented by the areas of the
boxes at each data point. <strong>Drag</strong> the red arrows to position
the line in such a way that the residual sum of squares (the total area of the boxes)
is as small as you can achieve.
</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="350" height="400">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="regnProg.DragLineRssApplet">
<param name="dataNames" value="Example 1#Example 2#Example 3">
<param name="xVarName" value="x">
<param name="yVarName" value="y">
<param name="xValues" value="20 22 24 26 28 30">
<param name="yValues" value="8.5 9.3 12.7 14.1 16.8 17.5">
<param name="y2Values" value="8.5 10.1 9.3 12.9 15.2 16.4">
<param name="y3Values" value="16.5 15.4 14.5 13.4 12.2 7.9">
<param name="horizAxis" value="19.5 30.5 20 2">
<param name="vertAxis" value="7 19 8 2">
<param name="interceptLimits" value="-20.0 20.0 8.0">
<param name="slopeLimits" value="-2.00 2.00 0.20">
<param name="labelAxes" value="true">
<param name="biggestRss" value="48000.00">
<param name="customText" value="resid=resid">
</applet>
</div>

<p>After trying by hand, click the button <strong>Least squares</strong> to
let the computer determine the best values.
</p>

    <p>Repeat this exercise with the data sets <strong>Example 2</strong> and 
      <strong>Example 3</strong>. In the third data set, note that the line may 
      be positioned to make five of the six residuals very small, but the squared 
      6th residual is then very large. The least squares line has several moderately 
      large residuals. </p>

</div>

  <p>The problem of minimising the residual sum of squares is not difficult mathematically, 
    but you will rarely require or use the resulting formulae for <em>b</em><sub>0</sub> 
    and <em>b</em><sub>1</sub> 
    since spreadsheets, statistical programs and even scientific calculators will 
    do the calculations for you. However, for completeness, the formulae are </p>

<p class=eqn><img class="gif" src="../leastSqrs/images/lsFormulae.gif" width="350" height="57"> </p>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
