<!DOCTYPE HTML>
<html>
<head>
	<title>Leverage</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="leverage">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Variability of least squares plane</p>
  <p>We <a href="javascript:showNamedPage('regnInfTwo2')">showed 
		earlier</a> that the least squares plane is a random quantity &mdash; it varies 
		from sample to sample. The position of the least squares plane has greatest 
		variability for <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> 
		combinations far from the data and this is particularly pronounced when <em>X</em> 
		and <em>Z</em> are multicollinear.</p>
	<p>The variability of predictions from the least squares plane therefore also 
		depends on the <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> 
		combination at which the prediction of <em>Y</em> is made:</p>
	<p class=eqn><img src="images/predictVar.gif" width="599" height="53"></p>
	<p>where <em>r<sub>xz</sub></em> is the correlation coefficient between <em>X</em> 
		and <em>Z</em>. </p>
	<p>Do <strong>not</strong> try to remember this formula, but observe that it 
		defines a quadratic surface in <span class="em red">x</span>  and 
		<span class="em red">z</span>  and is smallest at the means of <em>X</em> 
		and <em>Z</em>.</p>
		
	<div class="diagram">
    <p class="heading">Illustration</p>

    <p>The left of the diagram below represents a normal linear model with two 
			planes, 2σ 
			above and below the regression plane (which is not shown). The (<em>x</em>,&nbsp;<em>z</em>) 
			values at which data are to be collected are represented by crosses on the 
			<em>x</em>-<em>z</em> plane and as red lines between the two planes.</p>
		<p>If response measurements were taken from this model, 95% of them would 
			lie on the red lines (i.e. between the two planes) and 5% would be either 
			above or below.</p>
    <div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="420">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="residTwoProg.LeverageGraphApplet">
<param name="yAxis" value="0 50 0 10">
<param name="xAxis" value="35 140 40 20">
<param name="zAxis" value="55 85 60 10">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="randomSeed" value="6456893">
<param name="multiRegnModel" value="-15.0 0.5 0.0 5">
<param name="xValues" value="90.7 83.6 84.1 82.2 93.3 90.5 77.0 84.9 88.9 73.1 86.3 84.4 102.7 86.1 96.8 98.4 97.6 82.3 84.5 98.7 79.7 83.8 70.4 73.1 85.0 79.4 ?">
<param name="zValues" value="66.0 72.9 68.0 66.1 66.3 70.6 69.4 68.1 70.0 68.3 68.0 70.5 73.6 66.0 71.1 67.8 68.2 68.4 71.7 71.2 68.3 71.7 68.7 71.2 67.4 66.6 ?">
<param name="maxFitVar" value="999.99">
<param name="leverageAxis" value="0 130 0 20">
<param name="customText" value="Var(prediction)=Var(prediction)">
</applet> 
</div>

    <p>The right of the diagram shows the variance of predictions as a quadratic 
			surface. Click anywhere on the x-z planes to read off the variance of predictions 
			for that <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> combination.</p>
		
<div class="centred"><div class="boxed">
<p>The predictions would be much more variable away from the 
					values of <strong>(<em>x</em>,&nbsp;<em>z</em>)</strong> 
					at which data are obtained.</p>
</div></div>

	  <p class="heading">Multicollinear data</p>
		<p>The following diagram is the same, but <em>X</em> and <em>Z</em> have higher 
			correlation.</p>
    <div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="420">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="residTwoProg.LeverageGraphApplet">
<param name="yAxis" value="0 50 0 10">
<param name="xAxis" value="40 135 40 20">
<param name="zAxis" value="55 85 60 10">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="randomSeed" value="6456893">
<param name="multiRegnModel" value="-15.0 0.5 0.0 5">
<param name="xValues" value="84.1 82.2 90.5 77.0 84.9 88.9 86.3 84.4 102.7 86.1 96.8 82.3 84.5 98.7 79.7 83.8 85.0 79.4 ?">
<param name="zValues" value="68.0 66.1 70.6 69.4 68.1 70.0 68.0 70.5 73.6 66.0 71.1 68.4 71.7 71.2 68.3 71.7 67.4 66.6 ?">
<param name="maxFitVar" value="999.99">
<param name="leverageAxis" value="0 400 0 100">
<param name="customText" value="Var(prediction)=Var(prediction)">
</applet> 
</div>

		<p>Observe that the variance of the predictions are highest at <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> 
			combinations in the corners away from the data.</p>
	</div>
		
	<p class="heading">'Best' place for new data</p>
	<p>The most effective place to make a new observation is at an <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> 
		combination where the position of the least squares plane is least accurately 
		determined &mdash; i.e. where the variance of the predictions from the model are 
		highest.</p>
	<div class="diagram">
    <p class="heading">Effect of an extra observation at (<em>x</em>, <em>z</em>)</p>

    <p>The diagram below again shows a model on the left. The normal distributions 
			on the right show the resulting distributions of the three least squares 
			parameter estimates.</p>
    <div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="420">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="residTwoProg.LeverageApplet">
<param name="yAxis" value="0 50 0 10">
<param name="xAxis" value="40 135 40 20">
<param name="zAxis" value="50 90 50 10">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="randomSeed" value="6456893">
<param name="multiRegnModel" value="-15.0 0.5 0.0 5">
<param name="xValues" value="84.1 82.2 90.5 77.0 84.9 88.9 86.3 84.4 102.7 86.1 96.8 82.3 84.5 98.7 79.7 83.8 85.0 79.4 ?">
<param name="zValues" value="68.0 66.1 70.6 69.4 68.1 70.0 68.0 70.5 73.6 66.0 71.1 68.4 71.7 71.2 68.3 71.7 67.4 66.6 ?">
<param name="b0AxisInfo" value="-150 150 -150 50">
<param name="bxAxisInfo" value="-0.3 1.3 -0.2 0.2">
<param name="bzAxisInfo" value="-2.5 2.5 -2 1">
<param name="maxFitVar" value="999.99">
<param name="customText" value="Var(prediction)=Var(prediction)#LS intercept=LS intercept#LS slope for=LS slope for">
</applet> 
</div>

    <p>Click on the x-z plane on the left to see the effect of adding an extra 
			observation there. By dragging this new point, you can see how much this 
			extra observation will increase the accuracy of the parameter estimates.</p>
		
<div class="centred"><div class="boxed">
<p>Accuracy is improved most when the new observation is collected 
					at an <strong>(<em>x</em>,&nbsp;<em>z</em>)</strong> combination 
					at which the variance of the predictions is highest.</p>
</div></div>

		<br>
		</div>
		
	<p class="heading">Leverage</p>
	<p>Since σ 
		is unknown in practice, we cannot use the variance of the prediction at <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span> 
		to describe the effectiveness of collecting extra data there. Instead, we 
		use the <strong>leverage</strong> of <span class="red">(<em>x</em>,&nbsp;<em>z</em>)</span>.</p>
	<p class=eqn><img src="images/leverageFormula.gif" width="593" height="90"></p>
	<p>In a similar way, we can use leverage to describe the potential influence 
		of each data point in the actual data set. As in simple linear regression, 
		the leverage of the <em>i</em>'th data point is denoted by <em>h<sub>ii</sub></em></p>
	<p class=eqn><img src="images/leverage2.gif" width="236" height="39"></p>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
