<!DOCTYPE HTML>
<html>
<head>
	<title>Inference with covariates</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="covariate, anova, analysis of variance, f test">
	<meta name="dataset" content="Pruning cherry trees">
	<meta name="dataset" content="Inhibitor and bacteria growth">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">One factor with two levels</p>
  <p>We first consider models for an experiment with a factor that has two levels and a covariate.</p>
  <div class="centred"><table border="0" class="centred" cellpadding="2" cellspacing="0">
		<tr>
			<td align="center"><br>
					<br>
					<span class="em black">y<sub>ij</sub></span>  &nbsp;= &nbsp;<span class="blue">µ</span></td>
			<td align="center"><br>
					<br>
				&nbsp;+&nbsp;</td>
			<td align="center"><span class="red"><em>explained <br>
				by factor</em><br>
				β<em><sub>i</sub></em></span></td>
			<td align="center"><br>
					<br>
				&nbsp;+&nbsp;</td>
			<td align="center" class="green"><em>explained <br>
			by covariate</em><br>
γ&nbsp;<em>x<sub>i</sub></em></td>
			<td align="center"><br>
					<br>
				&nbsp;+&nbsp;</td>
			<td align="center"><br>
					<br>
				ε<em><sub>ij</sub></em></td>
		</tr>
	</table></div>
  <p>Since there are only two parameters of interest, <span class="red">β<sub>2</sub></span> and <span class="green">γ</span>, their significance can be assessed from their least squares estimates and their standard errors.</p>
  <div class="diagram">
		<p class="heading">Pruning sweet cherry trees</p>
  	<p>A horticulturist wanted to determine the effect of  different pruning systems on the yield of sweet cherries. Because there appeared to be differences in size of the trees in the orchard that was used, he recorded the cross-sectional area (cm<sup>2</sup>) of each tree at a height of 1m above the soil surface before the start of the experiment. Six trees were pruned with each of the   systems.</p>
  	<p>Three years after the pruning treatments had begun, measurement of the yield of cherries (kg) from each tree was started. To avoid a possible problem with biennial bearing, the table below shows the mean yield of sweet cherries from the trees getting two of the pruning systems.</p>
  	<div class="centred"><table border="0" class="centred" cellpadding="4" cellspacing="0">
  		<tr>
  			<th>&nbsp;</th>
  			<th colspan="6">Pruning system</th>
 			</tr>
  		<tr>
  			<th>&nbsp;</th>
  			<th colspan="2">System 1</th>
  			<th>&nbsp;</th>
  			<th colspan="2">System 4</th>
 			</tr>
  		<tr>
  			<th>Tree</th>
  			<th>Area</th>
  			<th>Yield</th>
  			<th width="8">&nbsp;</th>
  			<th>Area</th>
  			<th>Yield</th>
 			</tr>
  		<tr>
  			<th>1<br>
  				2<br>
  				3<br>
  				4<br>
  				5<br>
  				6</th>
  			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999; border-right:0px;">140<br>
 				200<br>
 				144<br>
 				127<br>
 				173<br>
 				225</td>
  			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999; border-left:0px;">2.1<br>
  				3.5<br>
  				1.8<br>
  				3.6<br>
  				3.8<br>
  				5.0</td>
  			<td align="center">&nbsp;</td>
  			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999; border-right:0px;">110<br>
  				95<br>
  				171<br>
  				199<br>
  				215<br>
 				191</td>
  			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999; border-left:0px;">4.1<br>
  				4.1<br>
  				4.9<br>
  				7.1<br>
  				6.5<br>
  				6.2</td>
 			</tr>
 		</table></div>
<p>The diagram below shows the data and the  parameter estimates for the model with terms for the pruning system and covariate.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="450" height="450">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="indicatorProg.TwoGroupInferenceApplet">
<param name="yVarName" value="Yield">
<param name="yValues" value="2.1 4.1 3.5 4.1 1.8 4.9 3.6 7.1 3.8 6.5 5.0 6.2">
<param name="xVarName" value="Area">
<param name="xValues" value="140 110 200 95 144 171 127 199 173 215 225 191">
<param name="zVarName" value="Pruning method">
<param name="zValues" value="0 1 0 1 0 1 0 1 0 1 0 1">
<param name="zLabels" value="#System 1# #System 4#">
<param name="yAxis" value="1 8 1 1">
<param name="xAxis" value="100 250 100 50">
<param name="maxParam" value="9.999 -9.999 -9.999">
<param name="maxTableEntries" value="-99.999 9.999 -99.99">
<param name="groupEffectName" value="System (4 - 1)">
<param name="customText" value="param=param#se=se#intercept=intercept">
</applet>
</div>

  	<p>Since the p-value for the pruning system parameter (difference between System 4 and the baseline System 1) is close to zero, we conclude that:</p>
  	<div class="centred"><div class="boxed">
  		<p>It is almost certain that the two pruning systems result in different cherry yields. </p>
  	</div></div>
  	<p>The p-value associated with the covariate <em>Area</em> is also close to zero. Although there is rarely any interest in testing the covariate, it would be valid to also conclude that there <strong>is</strong> a significant relationship between the cross-sectional area of the trees at the start of the experiment and the response.</p>
  	<p>Click the checkbox for the covariate to remove it from the model. Analysing the data without the covariate would have resulted in a much higher standard error for the estimate of the difference between the pruning systems and a less significant effect for the factor.</p>
  	<div class="centred"><div class="boxed">
  		<p>If the values for a covariate are known, it should always be used in the model. </p>
  	</div></div>

<br>
</div>
		
		
<p class="heading">Models with more factors and factor levels</p>
<p>If the factor of interest has more than two levels, analysis of variance must be used to test whether the factor has an effect. Analysis of variance is also commonly used when there are two or more factors, as in the example below.</p>

<div class="diagram">
<p class="heading">Inhibitor and bacteria growth</p>


<p>A bacteriologist investigated the effect of various inhibitors on the growth rate of colonies of a species of bacteria. Five different inhibitors were used in the experiment (four established ones and a new contender). Temperature was also known to affect growth, so it was also controlled and the experiment was conducted as a factorial experiment with the five inhibitors and five temperatures (10, 15, 20, 25 and 30°C).</p>
<p>25 cultures were prepared and the potential growth rate of each was determined. Each culture was treated with one of the inhibitors and left to incubate at one of the temperatures for eight hours after which its actual growth rate was determined.</p>
<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="650" height="220">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="glmAnovaProg.AnovaTableSeqApplet">
<param name="yVarName" value="Growth rate">
<param name="yValues" value="24 58 29 88 57 42 7 33 37 18 20 39 65 18 27 43 27 50 39 45 62 52 28 54 61">
<param name="xVariables" value="Covar TempLin TempNonlin Factor">
<param name="CovarVarName" value="Potential">
<param name="CovarValues" value="23 71 24 107 69 53 0 33 39 17 20 45 75 14 27 56 23 57 43 51 73 59 25 70 78">
<param name="TempLinVarName" value="Temp (lin)">
<param name="TempLinValues" value="10 15 20 25 30 10 15 20 25 30 10 15 20 25 30 10 15 20 25 30 10 15 20 25 30">
<param name="TempNonlinVarName" value="Temp (nonlin)">
<param name="TempNonlinValues" value="2@0 1 2 3 2@0 1 2 3 2@0 1 2 3 2@0 1 2 3 2@0 1 2 3">
<param name="TempNonlinLabels" value="L12 L3 L4 L5">
<param name="FactorVarName" value="Inhibitor">
<param name="FactorValues" value="1 0 3 4 2 3 1 4 2 0 2 4 0 1 3 0 2 1 3 4 4 3 2 0 1">
<param name="FactorLabels" value="A B C D E">
<param name="maxSsq" value="99.999 99 99.999 999.99">
<param name="componentNames" value="Potential#Linear temp#Nonlin temp#Inhibitor">
<param name="initVariables" value="1">
<param name="showR2" value="false">
</applet>
</div>

<p>The potential growth rate is a covariate and should always be added first to the model in the analysis of variance table. Since the two factors are orthogonal in this factorial design (with one replicate for each combination of inhibitor and temperature), the sums of squares for temperature and inhibitor are the same whichever order they are subsequently added to the model.</p>


<p>Drag the red arrow to add terms to the model. Observe that although the linear term for temperature is not significant, there is moderately strong evidence that nonlinear term in temperature is needed, so we should retain both terms in the model. The p-value for differences between the inhibitors is 0.1832, so we should conclude that:</p>
<div class="centred"><div class="boxed">
	<p>Even after taking account of differences between the potential growth rates of the cultures and differences between the temperatures, there is no evidence of differences between the inhibitors. </p>
</div></div>
<p>A further refinement of the analysis might split the sum of squares for the inhibitors into a sum of squares with 3 degrees of freedom for comparing the four established inhibitors, and a sum of squares with 1 degree of freedom for comparing the new inhibitor to the established ones.</p>
</div>

		

<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
