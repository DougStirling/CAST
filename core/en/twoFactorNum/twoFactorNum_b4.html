<!DOCTYPE HTML>
<html>
<head>
	<title>Interaction between numerical factors</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="anova, analysis of variance, interaction">
	<meta name="dataset" content="Soybean yield and trace elements">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Model for interaction</p>  
  <p>A linear model for two numerical factors, X and Z, can be written as:</p>
  <div class="centred"><table border="0" class="centred" cellpadding="2" cellspacing="0">
  	<tr>
  		<td align="center"><br>
  			<em><span class="black">y</span><sub><span class="blue">i</span><span class="green">j</span><span class="red">k</span></sub></em>&nbsp;= &nbsp;µ&nbsp;+&nbsp;</td>
  		<td align="center" class="blue">(<em>explained by X</em>)<br>
  			β<em> x<sub>i</sub></em></td>
  		<td align="center"><br>
  			&nbsp;+&nbsp;</td>
  		<td align="center" class="green">(<em>explained by Z</em>)<br>
  			γ<em> z<sub>j</sub></em></td>
  		<td align="center"><br>
  			&nbsp;+&nbsp;</td>
  		<td align="center" class="red">(<em>unexplained</em>)<br>
  			ε<em><sub>ijk</sub></em></td>
 		</tr>
 	</table></div>
  <p>The simplest way to model an interaction between the effect of these two factors
    is to add a term involving the product of X and Z,</p>
  <div class="centred"><table border="0" class="centred" cellpadding="2" cellspacing="0">
  	<tr>
  		<td align="center"><br>
 			<em><span class="black">y</span><sub><span class="blue">i</span><span class="green">j</span><span class="red">k</span></sub></em>&nbsp;= &nbsp;µ&nbsp;+&nbsp;</td>
  		<td align="center" class="blue">(<em>explained by X</em>)<br>
	β<em> x<sub>i</sub></em></td>
  		<td align="center"><br>
  			&nbsp;+&nbsp;</td>
  		<td align="center" class="green">(<em>explained by Z</em>)<br>
γ<em> z<sub>j</sub></em></td>
  		<td align="center"><br>
  			&nbsp;+&nbsp;</td>
  		<td align="center" class="purple">(<em>interaction</em>)<br>
  			δ <em>x<sub>i</sub></em><em>z<sub>j</sub></em></td>
  		<td align="center"><br>
  			&nbsp;+&nbsp;</td>
  		<td align="center" class="red">(<em>unexplained</em>)<br>
ε<em><sub>ijk</sub></em></td>
 		</tr>
 	</table></div>
  <p>To help understand this model, it can be rewritten in the form,</p>
  <p class=eqn><em><span class="black">y</span><sub><span class="blue">i</span><span class="green">j</span><span class="red">k</span></sub></em>&nbsp; &nbsp;=&nbsp; &nbsp;µ&nbsp; +&nbsp; (<span class="blue">β</span>&nbsp;+&nbsp;<span class="purple">δ</span><span class="purple"><em>z<sub>j</sub></em></span>)&nbsp;<span class="blue em">x<sub>i</sub></span> &nbsp; + &nbsp;<span class="green">γ<em> z<sub>j</sub></em></span> &nbsp; + &nbsp;<span class="red">ε<em><sub>ijk</sub></em></span></p>
  <p>In this form, it can be seen that the 'slope' for X depends on Z &mdash; the effect 
    of changing <em>x</em> is different depending on the value of <em>z</em>. 
    Similarly, writing the model as:</p>
  <p class=eqn><em><span class="black">y</span><sub><span class="blue">i</span><span class="green">j</span><span class="red">k</span></sub></em>&nbsp; &nbsp;=&nbsp; &nbsp;µ&nbsp; +&nbsp; <span class="blue">β<em> x<sub>i</sub></em></span>&nbsp; + &nbsp;(<span class="green">γ</span>&nbsp;+&nbsp;<span class="purple">δ<em>x<sub>j</sub></em></span>)&nbsp;<span class="green em">z<sub>j</sub></span> &nbsp;+ &nbsp;<span class="red">ε<em><sub>ijk</sub></em></span></p>
  <p>it can be seen that the effect of changing <em>z</em> depends on the value 
    of <em>x</em>.</p>
  <div class="diagram">
    <p class="heading">Soybean and trace elements</p>
    <p>The diagram below shows a no-interaction model for the yields of soybeans in an experiment that used 
			four different applications of manganese (Mn) and four different applications 
			of copper (Cu) in a factorial design with two replicates. Three red arrows allow the three parameters to be adjusted. Click <strong>Least 
			squares</strong> to see the best-fitting model.</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="500">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="twoFactorProg.RotateDragFactorsApplet">
<param name="yVarName" value="Soybean yield (tonne/hectare)">
<param name="yValues" value="1.558 1.578 2.003 2.033 2.490 2.470 2.830 2.810 1.590 1.610 2.020 2.051 2.620 2.632 2.860 2.841 1.558 1.550 2.003 2.010 2.490 2.690 2.830 2.910 1.328 1.427 2.010 2.031 2.887 2.832 2.960 2.941">
<param name="yAxis" value="1.2 3.2 1.5 0.5">
<param name="zVarName" value="Cu">
<param name="zValues" value="8@0 8@1 8@2 8@3">
<param name="zLabels" value="1 3 5 7">
<param name="xVarName" value="Mn">
<param name="xValues" value="2@0 2@1 2@2 2@3 2@0 2@1 2@2 2@3 2@0 2@1 2@2 2@3 2@0 2@1 2@2 2@3">
<param name="xLabels" value="20 50 80 110">
<param name="zModelTerms" value="linear">
<param name="xModelTerms" value="linear">
<param name="interaction" value="true">
<param name="initialModel" value="2.0">
<param name="maxRss" value="99.999">
<param name="customText" value="None=None#Linear=Linear#Factor=Factor">
</applet> 
</div>

<p>Click the checkbox <strong>Interaction</strong> and observe that a fourth 
<span class="green"> <strong>green</strong></span> arrow appears in the 
diagram &mdash; there are four parameters and four degrees of freedom for the 
model with interaction. Drag the arrows to get a feel for the types of relationship 
that can be modelled.</p>
<p>Click <strong>Least squares</strong> to fit the model to the soybean data. 
Click <strong>y-z</strong> to rotate the model. Observe that the relationship 
of yield to Cu is no longer the same for all values of Mn. Indeed, the model 
predicts that increasing Cu will increase yield when Mn is high, but will 
decrease yield when Mn is low.</p>

<p class="heading">Analysis of variance</p>
<div class="centred">
	<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="180">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="glmAnovaProg.AnovaTableSeqApplet">
	<param name="yVarName" value="Soybean yield">
	<param name="yValues" value="1.558 1.578 2.003 2.033 2.490 2.470 2.830 2.810 1.590 1.610 2.020 2.051 2.620 2.632 2.860 2.841 1.558 1.550 2.003 2.010 2.490 2.690 2.830 2.910 1.328 1.427 2.010 2.031 2.887 2.832 2.960 2.941">
	<param name="xVariables" value="Cu Mn Interact">
	<param name="CuVarName" value="Cu">
	<param name="CuValues" value="8@0 8@1 8@2 8@3">
	<param name="MnVarName" value="Mn">
	<param name="MnValues" value="2@0 2@1 2@2 2@3 2@0 2@1 2@2 2@3 2@0 2@1 2@2 2@3 2@0 2@1 2@2 2@3">
	<param name="InteractVarName" value="Interaction">
	<param name="InteractValues" value="8@0  2@0 2@1 2@2 2@3  2@0 2@2 2@4 2@6  2@0 2@3 2@9 2@12 2@16">
	<param name="maxSsq" value="99.999 99 99.999 999.99">
	<param name="componentNames" value="Copper#Manganese#Interaction">
	<param name="initVariables" value="0">
	<param name="showR2" value="false">
	</applet>
</div>

<p>In the analysis of variance table above, drag the red arrow down to display the sums of squares explained by the main effects of the factors and their interaction. All three explained sums of squares have 1 degree of freedom since they each involve one parameter.</p>
<p>From the p-value associated with the interaction, we would conclude that there is  strong evidence that the copper and manganese interact in their effects on soybean yield.</p>
	</div>


<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
