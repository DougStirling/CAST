<!DOCTYPE HTML>
<html>
<head>
	<title>Sums of squares for nested design</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="nested design, blocks, anova, analysis of variance">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Hierarchy of models for factor that <span class="red">varies within blocks</span></p>  
<p>The usual analysis of experiments in which the experimental units are grouped into blocks is based on the following hierarchy of models for a response value <span class="em black">y<sub>ijk</sub></span>  that is in block <em>i</em> and gets factor level <em>j</em>.</p>
<div class="centred"><table class="centred">
	<tr>
		<td align="center"><strong><em><span class="bold black">No difference between blocks and factor does not affect Y</span> </em></strong><br>
				<span class="em black">y<sub>ijk</sub></span>  &nbsp;= &nbsp;<span class="blue">µ</span> &nbsp; + &nbsp;ε<em><sub>ijk</sub></em></td>
	</tr>
	<tr>
		<td align="center"><img src="../factorInteract/images/downArrow.gif" width="24" height="42"></td>
	</tr>
	<tr>
		<td align="center"><strong><em><strong><em><span class="bold black">The blocks differ</span> </em><span class="black">, but factor does not affect Y</span></strong></em></strong><br>
				<span class="em black">y<sub>ijk</sub></span>  &nbsp;= &nbsp;<span class="blue">µ</span> &nbsp; + &nbsp; <span class="red">β<em><sub>i</sub></em></span> &nbsp;+ &nbsp; ε<em><sub>ijk</sub></em></td>
	</tr>
	<tr>
		<td align="center"><img src="../factorInteract/images/downArrow.gif" width="24" height="42"></td>
	</tr>
	<tr>
		<td align="center"><strong><em><strong><em><strong><em><span class="bold black">The blocks differ</span> </em></strong></em><span class="black"> and factor  affects Y</span></strong></em></strong><br>
				<span class="em black">y<sub>ijk</sub></span>  &nbsp;= &nbsp;<span class="blue">µ</span> &nbsp; + &nbsp; <span class="red">β<em><sub>i</sub></em></span> &nbsp; + &nbsp; <span class="green">γ<em><sub>j</sub></em></span> &nbsp; + &nbsp; ε<em><sub>ijk</sub></em></td>
	</tr>
</table></div>
<p class="heading">Hierarchy of models for factor that <span class="red">varies at block level</span></p>
<p>As mentioned on the previous page, the above hierarchy is not useful if the factor is varied at block level since adding the term for the factor (lower arrow) does not reduce the residual sum of squares. A more useful hierarchy adds the block effect <strong>after</strong> the factor effect.
</p>
<div class="centred"><table class="centred">
	<tr>
		<td align="center"><strong><em><span class="bold black">No difference between blocks and factor does not affect Y</span> </em></strong><br>
				<span class="em black">y<sub>ijk</sub></span>  &nbsp;= &nbsp;<span class="blue">µ</span> &nbsp; + &nbsp;ε<em><sub>ijk</sub></em></td>
	</tr>
	<tr>
		<td align="center"><img src="../factorInteract/images/downArrow.gif" width="24" height="42" align="absmiddle"><span class="green">(<em>g</em><sub>F</sub>&nbsp;-&nbsp;1) extra params<img src="../factorInteract/images/downArrow.gif" width="24" height="42" align="absmiddle"></span></td>
	</tr>
	<tr>
		<td align="center"><strong><em><strong><em><span class="bold black">The f</span> </em><span class="black">actor  affects Y but there are no differences between blocks</span></strong></em></strong><br>
				<span class="em black">y<sub>ijk</sub></span>  &nbsp;= &nbsp;<span class="blue">µ</span> &nbsp; + &nbsp;<span class="green">γ<em><sub>j</sub></em></span>&nbsp;+ &nbsp; ε<em><sub>ijk</sub></em></td>
	</tr>
	<tr>
		<td align="center"><img src="../factorInteract/images/downArrow.gif" width="24" height="42" align="absmiddle"><span class="red">(<em>g</em><sub>B</sub>&nbsp;-&nbsp;<em>g</em><sub>F</sub>) extra params<img src="../factorInteract/images/downArrow.gif" width="24" height="42" align="absmiddle"></span></td>
	</tr>
	<tr>
		<td align="center"><strong><em><strong><em><strong><em><span class="bold black">The </span><em><strong><em><strong><span class="black">f</span> </em><span class="black">actor  affects Y and the </span></strong></em><span class="black">blocks differ</span></strong></em></strong></em></strong></em></strong><br>
				<span class="em black">y<sub>ijk</sub></span>  &nbsp;= &nbsp;<span class="blue">µ</span> &nbsp; + &nbsp; <span class="red">β<em><sub>i</sub></em></span> &nbsp;+ &nbsp; ε<em><sub>ijk</sub></em></td>
	</tr>
</table></div>
<p>Note that there is no need for an explicit term for the factor in the bottom model since the factor is confounded with differences between the blocks. The <strong>effective</strong> number of parameters added is the difference between the number of blocks and the number of treatments.</p>
<p class="heading">Evidence for a factor effect</p>
<p>In earlier chapters, testing the effect of a factor involved comparison of the mean sums of squares explained by the factor and the mean residual sum of squares from the full model with all terms for factors and blocks. This is not appropriate for factors that are varied at block level.</p>
<p class="eqn"><img src="images/ssqComparisons.gif" width="518" height="111"></p>
<p>When a factor is varied at block level, the factor sum of squares should<strong> not</strong> be compared to the residual sum of squares. Instead,</p>
<div class="centred"><div class="boxed">
	<p>The factor sum of squares must be compared to the sum of squares that describes variation between the blocks.</p>
</div></div>
<p>This is explained in the diagram below.</p>
<div class="diagram">
<p class="heading">Artificial data set</p>
<p>The diagram below shows data from an experiment in which the 45 experimental units are grouped into 9 blocks of 5 units. A factor with three levels (A, B and C) is varied at block level:</p>
<ul>
	<li>blocks B1, B2 and B3 get factor level A,</li>
	<li>blocks B4, B5 and B6 get factor level B, and</li>
	<li>blocks B7, B8 and B9 get factor level C.</li>
</ul>
<br>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="500" height="550">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="exper2Prog.NestedFactorApplet">
<param name="blockVarName" value="Block">
<param name="blockValues" value="5@0 5@1 5@2 5@3 5@4 5@5 5@6 5@7 5@8">
<param name="blockLabels" value="B1 B2 B3 B4 B5 B6 B7 B8 B9">
<param name="factorVarName" value="Factor">
<param name="factorValues" value="15@0 15@1 15@2">
<param name="factorLabels" value="#Level A# #Level B# #Level C#">
<param name="yVarName" value="Response">
<param name="yModel" value="10   16 8  10 12 2  4 6 14   20 8  2">
<param name="yAxis" value="10 50 10 5">
<param name="paramDecimals" value="3">
<param name="componentNames" value="Total#Factor#Blocks within factor#Residual">
<param name="maxSummaries" value="9999.99 9999.99 99.999">
<param name="customText" value="Variability between factor levels=Variability between factor levels#Variability between blocks=Variability between blocks#Low=Low#High=High#No variation within blocks=No variation within blocks#Shade components=Shade components">
</applet>
</div>

<p>The slider on the top left adjusts the difference between the factor means.</p>
<div class="centred"><div class="boxed">
	<p>The more variable the factor means (and hence the greater the factor sum of squares), the more obvious it becomes that the factor does affect the response.</p></div></div>
<p>Click the checkbox <strong>No variation within blocks</strong> under the sliders to make all observations equal within each block. Observe that:</p>
<div class="centred"><div class="boxed">
	<p>Even if there is zero residual sum of squares, we cannot be sure that the factor affects the response because of the variability between the blocks.</p>
</div></div>
<p>Finally drag the slider to adjust variability between blocks and observe that:</p>
<div class="centred"><div class="boxed">
	<p>The more variable the blocks, the weaker the evidence that the factor affects the response.</p>
</div></div>
<p>The evidence for a factor effect therefore depends on the relative sizes of the factor sum of squares and the sum of squares describing variation between the blocks.</p>
</div>


<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
