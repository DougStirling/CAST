<!DOCTYPE HTML>
<html>
<head>
	<title>More levels of nesting</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="nested design, anova, analysis of variance, f test">

	<index dataset="Glycogen in rat livers" />
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Nested structure of experimental units</p>  
<p>In many experiments, the experimental units are structured in a two-level hierarchy &mdash; they are grouped into blocks of similar units.</p>
<p>Sometimes this structure can be extended with three of more levels. For example, an agricultural experiment may use 10 fields with 6 small plots of land selected within each. At the end of the growing season, 5 individual plants are analysed within each plot. The plots are nested within fields and the plants are nested within plots.</p>
<p class="heading">Analysis of variance</p>
<p>If the factor is varied at one level, its mean sum of squares should be compared to the sum of squares explained by  the blocks (within the factor levels) <strong>at that level of the hierarchy</strong> to test for the effect of the factor.</p>
<div class="diagram">
<p class="heading">Glycogen in rat livers</p>
<p>An experiment was conducted with 3 treatments given to 6 rats &mdash; each treatment was applied to two of the rats. The analysis was complicated by the fact that three preparations were taken from the liver of each rat, and two readings of glycogen content were taken from each preparation. The colours in the table below indicate the three treatments that were applied to the rats.</p>
<div class="centred"><table border="0" class="centred" cellpadding="3" cellspacing="0">
	<tr>
		<td>&nbsp;</td>
		<td>&nbsp;</td>
		<th>&nbsp;Glycogen&nbsp;</th>
		<th width="20">&nbsp;</th>
		<th>&nbsp;</th>
		<th>&nbsp;</th>
		<th>&nbsp;Glycogen&nbsp;</th>
	</tr>
	<tr>
		<th rowspan="3">Rat 1</th>
		<th bgcolor="#CCCCFF">Preparation 1</th>
		<td align="center" bgcolor="#CCCCFF">131 &nbsp; 130</td>
		<td align="center">&nbsp;</td>
		<th rowspan="3">Rat 4</th>
		<th bgcolor="#FFFF66">Preparation 10</th>
		<td align="center" bgcolor="#FFFF66">151 &nbsp;  155</td>
	</tr>
	<tr>
		<th bgcolor="#CCCCFF">Preparation 2</th>
		<td align="center" bgcolor="#CCCCFF">131  &nbsp; 125</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FFFF66">Preparation 11</th>
		<td align="center" bgcolor="#FFFF66">147 &nbsp;  147</td>
	</tr>
	<tr>
		<th bgcolor="#CCCCFF">Preparation 3</th>
		<td align="center" bgcolor="#CCCCFF">136 &nbsp;  142</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FFFF66">Preparation 12</th>
		<td align="center" bgcolor="#FFFF66">162  &nbsp; 152</td>
	</tr>
	<tr>
		<th>&nbsp;</th>
		<th>&nbsp;</th>
		<td align="center">&nbsp;</td>
		<td align="center">&nbsp;</td>
		<th>&nbsp;</th>
		<th>&nbsp;</th>
		<td align="center">&nbsp;</td>
	</tr>
	<tr>
		<th rowspan="3">Rat 2</th>
		<th bgcolor="#CCCCFF">Preparation 4</th>
		<td align="center" bgcolor="#CCCCFF">150 &nbsp;  148</td>
		<td align="center">&nbsp;</td>
		<th rowspan="3">Rat 5</th>
		<th bgcolor="#FF99FF">Preparation 13</th>
		<td align="center" bgcolor="#FF99FF">134  &nbsp; 125</td>
	</tr>
	<tr>
		<th bgcolor="#CCCCFF">Preparation 5</th>
		<td align="center" bgcolor="#CCCCFF">140 &nbsp;  143</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FF99FF">Preparation 14</th>
		<td align="center" bgcolor="#FF99FF">138  &nbsp; 138</td>
	</tr>
	<tr>
		<th bgcolor="#CCCCFF">Preparation 6</th>
		<td align="center" bgcolor="#CCCCFF">160 &nbsp;  150</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FF99FF">Preparation 15</th>
		<td align="center" bgcolor="#FF99FF">135  &nbsp; 136</td>
	</tr>
	<tr>
		<th>&nbsp;</th>
		<th>&nbsp;</th>
		<td align="center">&nbsp;</td>
		<td align="center">&nbsp;</td>
		<th>&nbsp;</th>
		<th>&nbsp;</th>
		<td align="center">&nbsp;</td>
	</tr>
	<tr>
		<th rowspan="3">Rat 3</th>
		<th bgcolor="#FFFF66">Preparation 7</th>
		<td align="center" bgcolor="#FFFF66">157  &nbsp; 145</td>
		<td align="center">&nbsp;</td>
		<th rowspan="3">Rat 6</th>
		<th bgcolor="#FF99FF">Preparation 16</th>
		<td align="center" bgcolor="#FF99FF">138 &nbsp;  140</td>
	</tr>
	<tr>
		<th bgcolor="#FFFF66">Preparation 8</th>
		<td align="center" bgcolor="#FFFF66">154  &nbsp; 142</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FF99FF">Preparation 17</th>
		<td align="center" bgcolor="#FF99FF">139  &nbsp; 138</td>
	</tr>
	<tr>
		<th bgcolor="#FFFF66">Preparation 9</th>
		<td align="center" bgcolor="#FFFF66">147 &nbsp;  153</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FF99FF">Preparation 18</th>
		<td align="center" bgcolor="#FF99FF">134 &nbsp;  127</td>
	</tr>
</table></div>
<p>The analysis of variance table initially describes the structure of the experimental units.</p>
<div class="centred">
	<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="500" height="220">
	<script type="text/javascript">writeAppletParams();</script>
	<param name="appletName" value="glmAnovaProg.CombineNestedApplet">
	<param name="yVarName" value="Glycogen">
	<param name="yValues" value="131 130 131 125 136 142 150 148 140 143 160 150 157 145 154 142 147 153 151 155 147 147 162 152 134 125 138 138 135 136 138 140 139 138 134 127">
	<param name="xVariables" value="Treat Rat Prep">
	<param name="TreatVarName" value="Treatments">
	<param name="TreatValues" value="12@0 12@1 12@2">
	<param name="TreatLabels" value="T1 T2 T3">
	<param name="RatVarName" value="Blocks">
	<param name="RatValues" value="6@0 6@1 6@0 6@2 6@0 6@3">
	<param name="RatLabels" value="R135 R2 R4 R6">
	<param name="PrepVarName" value="Preparation">
	<param name="PrepValues" value="2@0 2@1 2@2 2@0 2@3 2@4 2@0 2@5 2@6 2@0 2@7 2@8 2@0 2@9 2@10 2@0 2@11 2@12">
	<param name="PrepLabels" value="P147... P2 P3 P5 P6 P8 P9 P11 P12 P14 P15 P17 P18">
	<param name="maxSsq" value="9999.9 9 999.99 99.99">
	<param name="componentNames" value="Treatment#Rats (within treat)#Preparations (within rats)">
	<param name="split" value="1:2:Split rats:Between all rats">
	<param name="denomIndex" value="0 2 3 4">
	</applet>
</div>
<p> Since the treatments were varied at rat level &mdash; each rat got one treatment &mdash; the treatment sum of squares should be compared to the sum of squares between rats (within treatments) in the analysis of variance table.</p>
<p>Click <strong>Split rats</strong> to expand the sum of squares between rats and separate out the effect of the factor. Note that:</p>
<div class="centred"><div class="boxed">
	<p>Each sum of squares is compared with the sum of squares at the lower level of the nesting hierarchy using an F ratio.	
</div></div>
<p>We therefore conclude that there is no evidence of any difference between the three factors.</p>
<p>We could also conclude that there is moderately strong evidence that the rats differ in their mean glycogen content (p-value&nbsp;=&nbsp;0.0141), but very little evidence of a difference between the preparations  (p-value&nbsp;=&nbsp;0.0503).</p>
<p class="heading">Different experiment (artificial)</p>
<p>In order to illustrate how the structure of the data affects the analysis, consider another experiment in which the treatment can be varied at the level of the preparations instead of at rat level. All three treatments are therefore used within each rat in the table below.</p>
<div class="centred"><table border="0" class="centred" cellpadding="3" cellspacing="0">
	<tr>
		<td>&nbsp;</td>
		<td>&nbsp;</td>
		<th>&nbsp;Glycogen&nbsp;</th>
		<th width="20">&nbsp;</th>
		<th>&nbsp;</th>
		<th>&nbsp;</th>
		<th>&nbsp;Glycogen&nbsp;</th>
	</tr>
	<tr>
		<th rowspan="3">Rat 1</th>
		<th bgcolor="#CCCCFF">Preparation 1</th>
		<td align="center" bgcolor="#CCCCFF">131 &nbsp; 130</td>
		<td align="center">&nbsp;</td>
		<th rowspan="3">Rat 4</th>
		<th bgcolor="#CCCCFF">Preparation 10</th>
		<td align="center" bgcolor="#CCCCFF">151 &nbsp;  155</td>
	</tr>
	<tr>
		<th bgcolor="#FFFF66">Preparation 2</th>
		<td align="center" bgcolor="#FFFF66">131  &nbsp; 125</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FFFF66">Preparation 11</th>
		<td align="center" bgcolor="#FFFF66">147 &nbsp;  147</td>
	</tr>
	<tr>
		<th bgcolor="#FF99FF">Preparation 3</th>
		<td align="center" bgcolor="#FF99FF">136 &nbsp;  142</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FF99FF">Preparation 12</th>
		<td align="center" bgcolor="#FF99FF">162  &nbsp; 152</td>
	</tr>
	<tr>
		<th>&nbsp;</th>
		<th>&nbsp;</th>
		<td align="center">&nbsp;</td>
		<td align="center">&nbsp;</td>
		<th>&nbsp;</th>
		<th>&nbsp;</th>
		<td align="center">&nbsp;</td>
	</tr>
	<tr>
		<th rowspan="3">Rat 2</th>
		<th bgcolor="#CCCCFF">Preparation 4</th>
		<td align="center" bgcolor="#CCCCFF">150 &nbsp;  148</td>
		<td align="center">&nbsp;</td>
		<th rowspan="3">Rat 5</th>
		<th bgcolor="#CCCCFF">Preparation 13</th>
		<td align="center" bgcolor="#CCCCFF">134  &nbsp; 125</td>
	</tr>
	<tr>
		<th bgcolor="#FFFF66">Preparation 5</th>
		<td align="center" bgcolor="#FFFF66">140 &nbsp;  143</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FFFF66">Preparation 14</th>
		<td align="center" bgcolor="#FFFF66">138  &nbsp; 138</td>
	</tr>
	<tr>
		<th bgcolor="#FF99FF">Preparation 6</th>
		<td align="center" bgcolor="#FF99FF">160 &nbsp;  150</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FF99FF">Preparation 15</th>
		<td align="center" bgcolor="#FF99FF">135  &nbsp; 136</td>
	</tr>
	<tr>
		<th>&nbsp;</th>
		<th>&nbsp;</th>
		<td align="center">&nbsp;</td>
		<td align="center">&nbsp;</td>
		<th>&nbsp;</th>
		<th>&nbsp;</th>
		<td align="center">&nbsp;</td>
	</tr>
	<tr>
		<th rowspan="3">Rat 3</th>
		<th bgcolor="#CCCCFF">Preparation 7</th>
		<td align="center" bgcolor="#CCCCFF">157  &nbsp; 145</td>
		<td align="center">&nbsp;</td>
		<th rowspan="3">Rat 6</th>
		<th bgcolor="#CCCCFF">Preparation 16</th>
		<td align="center" bgcolor="#CCCCFF">138 &nbsp;  140</td>
	</tr>
	<tr>
		<th bgcolor="#FFFF66">Preparation 8</th>
		<td align="center" bgcolor="#FFFF66">154  &nbsp; 142</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FFFF66">Preparation 17</th>
		<td align="center" bgcolor="#FFFF66">139  &nbsp; 138</td>
	</tr>
	<tr>
		<th bgcolor="#FF99FF">Preparation 9</th>
		<td align="center" bgcolor="#FF99FF">147 &nbsp;  153</td>
		<td align="center">&nbsp;</td>
		<th bgcolor="#FF99FF">Preparation 18</th>
		<td align="center" bgcolor="#FF99FF">134 &nbsp;  127</td>
	</tr>
</table></div>
<p>The analysis of variance table below is initially the same as that above since it describes the structure of the experimental units and not the treatments applied.</p>
<div class="centred">
	<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="500" height="220">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="glmAnovaProg.CombineNestedApplet">
	<param name="yVarName" value="Glycogen">
	<param name="yValues" value="131 130 131 125 136 142 150 148 140 143 160 150 157 145 154 142 147 153 151 155 147 147 162 152 134 125 138 138 135 136 138 140 139 138 134 127">
	<param name="xVariables" value="Rat Treat Prep">
	<param name="RatVarName" value="Blocks">
	<param name="RatValues" value="6@0 6@1 6@2 6@3 6@4 6@5">
	<param name="RatLabels" value="R1 R2 R3 R4 R5 R6">
	<param name="TreatVarName" value="Treatment">
	<param name="TreatValues" value="2@0 2@1 2@2 2@0 2@1 2@2 2@0 2@1 2@2 2@0 2@1 2@2 2@0 2@1 2@2 2@0 2@1 2@2">
	<param name="TreatLabels" value="T1 T2 T3">
	<param name="PrepVarName" value="Preparation">
	<param name="PrepValues" value="2@0 2@0 2@0 2@0 2@1 2@2 2@0 2@3 2@4 2@0 2@5 2@6 2@0 2@7 2@8 2@0 2@9 2@10">
	<param name="PrepLabels" value="P12347... P5 P6 P8 P9 P11 P12 P14 P15 P17 P18">
	<param name="maxSsq" value="9999.9 9 999.99 99.99">
	<param name="componentNames" value="Between rats#Treatments#Preparations (within treat)">
	<param name="split" value="2:2:Split preparations:Between prepns (within rats)">
	<param name="denomIndex" value="0 3 3 4">
	</applet>
</div>

<p> Click <strong>Split preparations</strong> to expand the sum of squares for the preparations into a sum of squares explained by the treatments and the 'residual' variation between preparations that is unexplained by the treatments.</p>
<div class="centred"><div class="boxed">
	<p>Note that the treatment sum of squares should now be compared to the sum of squares between preparations (within treatments) in this experiment.</p>
</div></div>

<br>
</div>


<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
