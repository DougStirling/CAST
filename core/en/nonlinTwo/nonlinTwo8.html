<!DOCTYPE HTML>
<html>
<head>
	<title>Visualising least squares</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="least squares, residual sum of squares, estimation">
	<meta name="dataset" content="Leafing out time">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Residuals</p>
  <p>For all general linear models, we can find fitted values. For a model with 
		quadratic terms in <em>x</em> and <em>z</em>, the <strong>fitted values</strong> 
		are:</p>
	<p class=eqn><img src="images/fittedValue.gif" width="299" height="23"></p>
	<p>The <strong>residuals</strong> are differences between the observed and fitted 
		values, </p>
	<p class=eqn><img src="images/residualNonlin.gif" width="87" height="21"></p>
	<p class="heading">Visualising the residuals</p>
	<p>In simpler models with one or two linear terms (but no quadratic terms), 
		we showed that the residuals could be represented as vertical lines from the 
		data points to the least squares line or plane.</p>
	<p>There is a similar representation of the residuals in the quadratic model 
		&mdash; the residuals are vertical lines from the data points to the <strong>quadratic 
		surface</strong> that represents the model.</p>
	<p class="heading">Squared residuals and least squares</p>
	<p>Least squares minimises the sum of squared residuals,</p>
	<p class=eqn><img src="images/residSsqNonlin.gif" width="249" height="26"></p>
	<p>If these squared residuals are represented as squares in the 3-dimensional 
		scatterplot, the least squares line results in the smallest possible total 
		area for these squares.</p>

<div class="diagram">
		<p class="heading">Illustration</p>

		<p>The scatterplot below shows a data set of 7 response values and the corresponding 
			values of two explanatory variables.</p>
<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="480">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="curveInteractProg.DragQuadCrossApplet">
<param name="yAxis" value="0 45 0 10">
<param name="xAxis" value="1 2 1 0.2">
<param name="zAxis" value="1 2 1 0.2">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="longYVarName" value="response (Y)">
<param name="longXVarName" value="X">
<param name="longZVarName" value="Z">
<param name="yValues" value="15.31 30.91 22.42  7.23 25.88 20.01 17.77 ">
<param name="xValues" value="1.128 1.940 1.193 1.069 1.825 1.405 1.497">
<param name="zValues" value="1.974 1.110 1.653 1.141 1.920 1.560 1.230">
<param name="initialParams" value="20.0 0.0 0.0 0.0 0.0 0.0 0">
<param name="paramMinMax" value="-100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0 -100.0 100.0">
<param name="shadeCutoff" value="0 25 50">
<param name="quadX" value="on">
<param name="quadZ" value="on">
<param name="maxRss" value="9999.9">
<param name="customText" value="resid=resid#Don't show=Don't show#Show as lines=Show as lines#Show as squares=Show as squares">
</applet> 
</div>

		<p>Choose <strong>Show as lines</strong> from the pop-up menu to display the 
			residuals &mdash; they are vertical lines from the data points to the regression 
			surface. Rotate the scatterplot a little with the mouse to get a better 
			idea of where the points lie in 3-dimensions, then drag the five red arrows 
			to adjust the parameters of the model, trying to make the residuals small.</p>
		<p>Choose <strong>Show as squares</strong> from the pop-up menu to display 
			each residual as a square. The total area is the residual sum of squares. 
			Try adjusting the parameters again to make the residual sum of squares (the 
			red area) as small as possible.</p>
		
<div class="centred"><div class="boxed">
<p>It is difficult to minimise the residual sum 
					of squares by hand. However a computer can easily perform the matrix 
					calculations to obtain the least squares estimates.</p>
</div></div>

	  <p>Click <strong>Least squares</strong> to show the least squares fit of the 
			model.</p>
		<p class="heading">Leafing-out time of maples</p>

		<p>Are there genetic differences between maple trees that grow in different 
			parts of the USA and Canada? The data set below arose from a study in which 
			batches of seeds were collected from maple trees in different parts of the 
			Eastern USA and Canada. All seeds were germinated in Wooster, Ohio and an 
			index of the <em>leafing-out time</em> of the batches was recorded.</p>
		<p>Regression is used to examine whether the mean <em>leafing-out time</em> 
			depends on the <em>latitude (X</em>° North - 30<em>)</em> and <em>mean 
			July temperature (Z</em>° F - 60<em>)</em> of the place of origin of 
			the batches of seeds. A relationship would prove that there is a genetic 
			difference between seeds from the different locations. <span class="gray">(Note 
			that we have subtracted 30 from each latitude and 60 from each temperature 
			to make the coefficients smaller. The fit of the models is unchanged.)</span></p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="480">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="curveInteractProg.ChooseTermsQuadApplet">
<param name="yAxis" value="10 22 10 2">
<param name="xAxis" value="0 18 0 5">
<param name="zAxis" value="0 23 0 5">
<param name="yVarName" value="Y">
<param name="xVarName" value="X">
<param name="zVarName" value="Z">
<param name="longYVarName" value="leafing-out time (Y)">
<param name="longXVarName" value="latitude (X)">
<param name="longZVarName" value="temperature (Z)">
<param name="yValues" value="20.5 21.0 18.3 18.6 18.6 19.8 20.6 19.2 19.8 15.8 14.5 18.5 16.7 13.9 14.3 15.2 16.6 18.2 18.3 13.3 20.0 18.1 17.0 15.6 15.7 15.4 15.4 15.8 15.0 15.9 14.0 10.8">
<param name="xValues" value="16.95 15.55 15.00 15.42 14.50 16.37 15.03 13.00 12.80 12.70 12.42 10.75 11.38 10.35 10.80 10.92 10.33 11.58 11.92 10.12 12.75 12.00 12.55 11.50 9.25 7.45 8.33 6.25 5.80 1.38 2.83 0.75">
<param name="zValues" value="6.7 4.3 1.8 5.0 3.5 5.5 7.7 7.9 10.2 11.1 14.4 16.4 15.9 16.4 11.9 14.2 13.0 11.4 9.7 12.6 9.2 8.0 10.0 12.5 16.7 19.5 9.5 14.3 8.9 20.8 21.2 21.0">
<param name="initialParams" value="6.000 0.000 0.000 0.0000 0.0000 0.0000 0">
<param name="paramMinMax" value="5.000 10.000 -9.000 9.000 -9.000 9.000 0.0000 9.0000 -9.0000 9.0000 -9.0000 9.0000">
<param name="shadeCutoff" value="12 17 21">
<param name="quadX" value="on">
<param name="quadZ" value="on">
<param name="initialRotation" value="45 60">
<param name="maxRss" value="99999.9">
<param name="customText" value="Terms in model=Terms in model#Linear=Linear#Quadratic=Quadratic#resid=resid">
</applet> 
</div>

		<p>Use the checkboxes at the right of the diagram to investigate the fit of 
			different linear and nonlinear models to these data. For each model, the 
			least squares fitted model and corresponding residual sum of squares are 
			displayed.</p>
		<p>Note that adding an extra term always reduces the residual sum of squares 
			&mdash; each extra term gives additional flexibility allowing the surface to 
			get closer to the crosses.</p>
		
<div class="centred"><div class="boxed">
<p>It rarely makes sense to have a quadratic term 
					in <em>x</em> in the model if there is not already a linear term in 
					<em>x</em>, so the diagram does not allow you to remove a linear term 
					without also removing the corresponding quadratic term.</p>
</div></div>

	<br>
</div>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
