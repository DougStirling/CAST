<!DOCTYPE HTML>
<html>
<head>
	<title>Polynomial models</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="general linear model, sequential sums of squares, polynomial model">
	<meta name="dataset" content="Onion yield and density">
	<meta name="dataset" content="Traffic fatal crashes in NZ">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Nonlinear regression with polynomials</p>
	<p>We now extend quadratic models with extra terms involving higher powers of 
		<em>x</em>.</p>
	<p class="eqn"><img src="images/polyModel.gif" width="522" height="22"></p>
	<p>The extra polynomial terms give considerable flexibility in modelling curvature 
		in the relationship between <em>Y</em> and <em>x</em>. Since the parameters 
		again appear linearly, this model is also a general linear model and all general 
		results about GLMs apply to it. </p>
	

<div class="diagram">
		<p class="heading">Cubic model</p>
		<p>The diagram below shows the <strong>X</strong> matrix that corresponds 
			to a cubic model for a single explanatory variable, <em>x</em>.</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="450" height="370">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="matrixProg.GenericModelEqnApplet">
<param name="xRows" value="12">
<param name="nXColumns" value="3">
<param name="fullNameX1" value="x">
<param name="shortNameX1" value="x">
<param name="fullNameX2" value="x">
<param name="shortNameX2" value="x">
<param name="powerX2" value="x1 2">
<param name="fullNameX3" value="x">
<param name="shortNameX3" value="x">
<param name="powerX3" value="x1 3">
<param name="yName" value="Y">
<param name="errorName" value="error">
</applet> 
</div>

		<p>Click any row to see how the 'linear part' of the model is a cubic in <em>x</em>.</p>
</div>
	<p class="heading">Finding the best degree of polynomials</p>
	<p>When using polynomial models, we are interested in using the lowest possible 
		degree of polynomial &mdash; the lower the degree of polynomial, the smoother the 
		fitted curve tends to become.</p>
	<p>The test for whether the highest-order coefficients of a polynomial model 
		is significantly different from zero can be used to decide whether to use 
		a polynomial with lower degree.</p>
	<p>For models of this type, we are interested in using the lowest possible degree 
		of polynomial, but it makes no sense to have any power of <em>x</em> without 
		all lower powers.</p>
	
<div class="centred"><div class="boxed">
<p>Note that it makes no sense to use a polynomial 
				whose highest-order term is <em>x<sup>p</sup></em> without including all 
				lower powers in the model.</p>
</div></div>

  <p>Do not therefore consider deletion of terms from the polynomial model if 
		a higher-order term is still in the model.</p>
	<p class="heading">Warning</p>
	<p>A polynomial of degree 4 or higher might be found to fit the data best, but 
		you will often find that it behaves in unreasonable ways outside the range 
		of data that were collected. High-degree polynomials should <strong>never</strong> 
		be used for extrapolation.</p>
	
<div class="centred"><div class="boxed">
<p>Some other form of nonlinear function should 
				always be considered before using high-order polynomials.</p>
</div></div>

	<p>For example, consider a nonlinear transformation of either <em>X</em> or 
		<em>Y</em>. </p>
  <div class="diagram">
		<p class="heading">Onion yield</p>
    <p>The data below arose from an experiment in Purnong Landing, South Australia 
			involving production of white Spanish onions. The explanatory variable is 
			the density of planting (plants per square metre) and the response is onion 
			yield (grams per plant).</p>
		
		<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="400">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="glmAnovaProg.PolynomialApplet">
<param name="yVarName" value="Yield">
<param name="yValues" value="223 234 221 221 197 189 211 191 156 168 197 154 153 142 126 167 144 151 130 125 114 116 120 134 114 91 101 97 101 97 87 81 76 87 84 69 64 66 63 55 62 54">
<param name="xVarName" value="Density">
<param name="xValues" value="23 26 27 32 33 36 37 37 41 42 44 44 51 55 55 57 58 59 60 62 67 70 70 73 73 78 95 96 96 101 103 104 105 108 117 127 134 137 151 163 166 184">
<param name="xCenter" value="100">
<param name="maxSsq" value="99999.99 99 99999.99 999.99">
<param name="polyDegree" value="6">
<param name="xCenteredAxis" value="-100 100 -100 20">
<param name="xAxis" value="0 200 0 20">
<param name="yAxis" value="0 300 0 50">
<param name="customText" value="Polynomial degree=Polynomial degree#Constant=Constant#Linear=Linear#Quadratic=Quadratic#Cubic=Cubic#Power=Power">
</applet> 
</div>

		<p>The diagram initially shows a polynomial of degree 0 fitted by least squares 
			to the data &mdash; simply the sample mean.</p>
		<p>Use the pop-up menu to increase the polynomial degree. As extra polynomial 
			terms are added to the model, the criterion of least squares ensures that 
			the curve becomes closer to the data &mdash; the residual sum of squares reduces.</p>
		
<div class="centred"><div class="boxed">
<p>The polynomial is fairly smooth for all degrees 
					up to 5. However observe that the polynomial of degree 5 has a sharp 
					increase for densities over 180 and would be a poor predictor of yield 
					outside the range of the data (densities of 20 to 180).</p>
</div></div>

	<p class="heading">Traffic fatal crashes in New Zealand</p>
    <p>The next data set gives the number of fatal vehicle crashes in New Zealand 
			per 100,000 population between 1970 and 2005.</p>
		
		<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="400">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="glmAnovaProg.PolynomialApplet">
<param name="yVarName" value="Fatal crashes per 100,000 popn">
<param name="yValues" value="20.3 20.7 21.0 24.5 19.8 18.3 17.0 19.7 18.6 15.9 16.8 18.3 18.7 17.4 18.6 20.0 19.8 20.6 18.7 19.2 18.7 16.1 15.6 14.7 13.9 13.8 12.3 12.4 11.5 11.4 10.0 10.3 9.3 10.1 9.2 8.3">
<param name="xVarName" value="Year">
<param name="xValues" value="1970 1971 1972 1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003 2004 2005">
<param name="xCenter" value="1990">
<param name="maxSsq" value="999.99 99 999.99 99.99">
<param name="polyDegree" value="7">
<param name="xCenteredAxis" value="-21 20 -20 5">
<param name="xAxis" value="1969 2010 1970 5">
<param name="yAxis" value="5 30 5 5">
<param name="customText" value="Polynomial degree=Polynomial degree#Constant=Constant#Linear=Linear#Quadratic=Quadratic#Cubic=Cubic#Power=Power">
</applet> 
</div>

		<p>Again examine how the shape of the least squares curve changes as the polynomial 
			degree increases.</p>
		
<div class="centred"><div class="boxed">
<p>Several of the polynomials seem reasonable 
					descriptions of the changes in fatal vehicle crashes between 1970 and 
					2005. However none of the polynomials would provide reasonable predictions 
					after 2005.</p>
</div></div>

		<br>

</div>


<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
