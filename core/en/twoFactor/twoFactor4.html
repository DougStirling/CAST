<!DOCTYPE HTML>
<html>
<head>
	<title>Model for categorical factors</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="factorial design, model, normal model">
	<meta name="dataset" content="Strength of asphaltic concrete">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Notation</p>
<p>If two factors, <span class="blue">X</span> and <span class="green">Z</span>, are varied in an experiments, a model in which there is no interaction between their effects has the following form.</p>
<div class="centred"><table border="0" class="centred" cellpadding="2" cellspacing="0">
	<tr>
		<td align="center"><br>
				<span class="em black">y<sub>i</sub></span>  &nbsp;= &nbsp;</td>
		<td align="center" class="blue">(<em>explained by X</em>)<br>
					<em>f</em>&nbsp;(<em>x<sub>i</sub></em>)</td>
		<td align="center"><br>
			&nbsp;+&nbsp;</td>
		<td align="center" class="green">(<em>explained by Z</em>)<br>
					<em>g</em>&nbsp;(<em>z<sub>i</sub></em>)</td>
		<td align="center"><br>
			&nbsp;+&nbsp;</td>
		<td align="center" class="red">(<em>unexplained</em>)<br>
			ε<em><sub>i</sub></em></td>
	</tr>
</table></div>
<p>There are various ways to specified the functions <span class="blue"><em>f</em>&nbsp;(<em>x<sub>i</sub></em>)</span> and <span class="green"><em>g</em>&nbsp;(<em>z<sub>i</sub></em>)</span> and these depend on whether <span class="blue">X</span> and <span class="green">Z</span> are numerical or categorical.</p>
<p>To express these models more easily, a different notation is needed using multiple subscripts for the observations. If the factor X has <em>a</em> levels and Z has <em>b</em> levels, and there are <em>r</em> replicates for each treatment combination,&nbsp;...</p>
<table border="1" cellpadding="3" cellspacing="0">
	<tr>
		<th style="border-bottom:1px solid #999999;">Notation for response</th>
		<th style="border-bottom:1px solid #999999;">In words:</th>
		<th style="border-bottom:1px solid #999999;">Possible subscripts</th>
	</tr>
	<tr bgcolor="#FFFFFF">
		<td align="center" style="border-bottom:1px solid #999999;"><em>y<sub><span class="blue">i</span><span class="green">j</span><span class="red">k</span></sub></em></td>
		<td style="border-bottom:1px solid #999999;"><span class="red"><em>k</em></span> <span class="red">'th</span> of the replicate response values for the treatment combination <span class="blue">X&nbsp;=&nbsp;<em>i</em></span> and <span class="green">Z&nbsp;=&nbsp;<em>j</em></span></td>
		<td align="center" style="border-bottom:1px solid #999999;"><span class="blue"><em>i</em>&nbsp;=&nbsp;1 to <em>a</em></span><br>
				<span class="green"><em>j</em>&nbsp;=&nbsp;1 to <em>b</em></span><br>
				<span class="red"><em>k</em>&nbsp;=&nbsp;1 to <em>r</em> </span> </td>
	</tr>
</table>
<p class="heading">Model for two categorical factors</p>
<p>For categorical factors, we allow each factor level to have a parameter that allows it to have an arbitrary effect. This model can be expressed in the form,</p>
<div class="centred"><table border="0" class="centred" cellpadding="2" cellspacing="0">
	<tr>
		<td align="center"><br>
			<em><span class="black">y</span><sub><span class="blue">i</span><span class="green">j</span><span class="red">k</span></sub></em>&nbsp; = &nbsp;</td>
		<td align="center" class="blue">(<em>explained by X</em>)<br>
			µ<em><sub>i</sub></em></td>
		<td align="center"><br>
			&nbsp;+&nbsp;</td>
		<td align="center" class="green">(<em>explained by Z</em>)<br>
			γ<em><sub>j</sub></em></td>
		<td align="center"><br>
			&nbsp;+&nbsp;</td>
		<td align="center" class="red">(<em>unexplained</em>)<br>
			ε<em><sub>ijk</sub></em></td>
	</tr>
</table></div>
<p>As in our models for a single categorical factor, there are <span class="darkblue em">a</span> parameters, <span class="blue">µ<sub>1</sub></span>, <span class="blue">µ<sub>2</sub></span>, ..., <span class="blue">µ<sub><em>a</em></sub></span>, for factor X. However we cannot estimate all <span class="em green">b</span>  of the parameters <span class="green">γ<sub>1</sub></span>, <span class="green">γ<sub>2</sub></span>, ...,<span class="green">γ<em><sub>b</sub></em></span>, for factor Z. We therefore set <span class="green">γ<sub>1</sub>&nbsp;=&nbsp;0</span> since this does not restrict the flexibility of the model.</p>
<p>In order to treat both factors in a more symmetric way (and to make it easier to extend the models later), we  write the two-factor model in the form:</p>

<div class="centred"><table border="0" class="centred" cellpadding="2" cellspacing="0">
	<tr>
		<td align="center"><br>
			<em><span class="black">y</span><sub><span class="blue">i</span><span class="green">j</span><span class="red">k</span></sub></em>&nbsp;= &nbsp;µ&nbsp;+&nbsp;</td>
		<td align="center" class="blue">(<em>explained by X</em>)<br>
			β<em><sub>i</sub></em></td>
		<td align="center"><br>
			&nbsp;+&nbsp;</td>
		<td align="center" class="green">(<em>explained by Z</em>)<br>
			γ<em><sub>j</sub></em></td>
		<td align="center"><br>
			&nbsp;+&nbsp;</td>
		<td align="center" class="red">(<em>unexplained</em>)<br>
			ε<em><sub>ijk</sub></em></td>
	</tr>
</table></div>

<p>where <span class="blue">β<sub>1</sub>&nbsp;=&nbsp;0</span> and <span class="green">γ<sub>1</sub>&nbsp;=&nbsp;0</span>.</p>
<p>The model therefore has <span class="blue">(<em>a</em>&nbsp;-&nbsp;1)</span> parameters describing differences between the factor levels for X and <span class="green">(<em>b</em>&nbsp;-&nbsp;1)</span> parameters describing differences between the factor levels for Z.</p>
<div class="centred"><div class="boxed">
	<p>The model with two categorical factors X (<span class="em blue">a</span>  levels) 
		and Z (<span class="em green">b</span>  levels) has <strong>(<em>a</em>&nbsp;+&nbsp;<em>b</em>&nbsp;-&nbsp;1) 
			degrees of freedom</strong>.</p>
</div></div>
<p class="heading">Interpretation of parameters</p>
<p>The parameters are interpreted as follows:</p>
<ul>
  <li><span class="blue">µ</span> is the mean response when both factors are at their first level ('baseline' levels).</li>
  <li><span class="red">β<em><sub>i</sub></em></span> is the difference between the mean response when X is at level <em>i</em> and at level 1, irrespective of the level of Z.</li>
  <li><span class="green">γ<em><sub>j</sub></em></span> is the difference between the mean response when Z is at level <em>j</em> and at level 1, irrespective of the level of X.</li>
</ul>
<br>
	
	<div class="diagram">
		<p class="heading">Strength of asphaltic concrete</p>

		<p>A civil engineer conducted an experiment to evaluate how different compaction 
			methods and types of aggregate affect the strength of asphaltic concrete. 
			Two types of aggegate and four levels of compaction were used in the experiment 
			and three specimens were tested at each combination of levels for the two 
			factors. The tensile strength of each specimen (psi) was recorded and will 
			be modelled in terms of the two categorical explanatory variables <em>Aggregate</em> 
			and <em>Compaction</em>.</p>
		
		<div class="centred"><table border="0" class="centred" cellpadding="4" cellspacing="0">
			<tr> 
				<th>&nbsp;</th>
				<th colspan="4"><em>Compaction method</em></th>
			</tr>
			<tr> 
				<th align="left" valign="bottom"><em>Aggregate type</em></th>
				<th>Static</th>
				<th>Regular<br>
					kneading</th>
				<th>Low<br>
					kneading</th>
				<th>Very low<br>
					kneading</th>
			</tr>
			<tr> 
				<th align="left">Basalt</th>
				<td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-left:1px solid #999999;">68<br>
			    63<br>
			    65</td>
		  <td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;">126<br>
    128<br>
					<em>&nbsp;</em>133</td>
		  <td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999;"><em>&nbsp;</em>93<br>
    101<br>
    98</td>
		  <td align="center" bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-right:1px solid #999999;">56<br>
    59<br>
    57</td>
		  </tr>
			<tr> 
				<th align="left">Silicious</th>
				<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-left:1px solid #999999;">71<br>
			    66<br>
			    66</td>
		  <td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">107<br>
    110<br>
    116</td>
		  <td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;">63<br>
    60<br>
    59</td>
		  <td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-right:1px solid #999999;">40<br>
			<em>&nbsp;</em>41<br>
			44</td>
		  </tr>
		</table></div>
		
		<p>We will treat <em>Static</em> compression and <em>Basalt</em> as the baseline 
			levels for the two factors. (Any other factor levels could have been used 
			with equivalent results.)  </p>

	  <p class="heading">Graphical display of model</p>
		<p>The diagram below shows the actual data against two categorical axes (for 
			the two factors). The means from the best model without interaction are shown by 
			the coloured grid.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="550">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="indicatorProg.Rotate2FactorDragApplet">
<param name="yVarName" value="Concrete strength">
<param name="yValues" value="68 63 65 126 128 133 93 101 98 56 59 57 71 66 66 107 110 116 63 60 59 40 41 44">
<param name="yAxis" value="20 150 20 20">
<param name="zVarName" value="Aggregate">
<param name="zValues" value="12@0 12@1">
<param name="zLabels" value="Basalt Silicious">
<param name="xVarName" value="Compaction">
<param name="xValues" value="3@0 3@1 3@2 3@3 3@0 3@1 3@2 3@3">
<param name="xLabels" value="Static Regular Low #Very low#">
<param name="initialMean" value="90">
<param name="maxParam" value="999.99 -99.99 -99.99">
<param name="separateX" value="Separate aggregates#0#34">
<param name="customText" value="Baseline=Baseline">
</applet>
</div>

		<p>The blue value under the table is <span class="blue">µ</span> in the equation earlier in the page. The four red values are the parameters <span class="red">β<em><sub>i</sub></em></span> and the two green values are the parameters <span class="green">γ<em><sub>j</sub></em></span>.</p>
		<p>Drag the  red arrow for <em>Silicious</em> aggregate  to change the parameter <span class="green">γ<sub>2</sub></span> and observe that its value is the difference between the mean response for this aggregate and the baseline aggregate (<em>Basalt</em>).</p>
		<p>Similarly drag the three red arrows for <em>Regular</em>, <em>Low</em> and <em>Very low</em> compaction and observe that the values for the corresponding parameters are differences from the baseline compaction (<em>Static</em>).</p>
		<p>Finally, click <strong>Least squares</strong> to show the least squares estimates 
		of the parameters. Observe that the model estimates that:</p>
  <ul>
			<li>The mean strength for <em>Static</em> compaction with <em>Basalt</em> 
				aggregate is 75.00</li>
			<li>The mean strength for <em>Regular</em> compaction is 53.50 higher than 
				for <em>Static</em> compaction.</li>
			<li>The mean strength for <em>Silicious</em> aggregate is 17.00 lower than 
				for <em>Basalt</em> aggregate.</li>
		</ul>
	<br>
</div>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
