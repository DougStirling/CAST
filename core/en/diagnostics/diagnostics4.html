<!DOCTYPE HTML>
<html>
<head>
	<title>Standardised residuals</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="residual, standardisation, standardised residual">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Need for standardisation</p>
<p>In the previous page, we showed that all residuals do not have the same variance,</p>
	<p class=eqn> <img src="images/residVar.gif" width="159" height="20" alt="log(wt) = log(a) + p log(len)"> 
	</p>
	<p>Since the residuals at the high-leverage points have lower variances, they 
		are <strong>expected</strong> to be smaller and fewer than 95% will be outside 
		the ±2σ
	limits that are often used to suggest outliers.</p>
	<p class="heading">Standardisation</p>
	<p>We therefore standardise the residuals before examining or plotting them,</p>
	<p class=eqn> <img src="images/standardResid.gif" width="303" height="42" alt="log(wt) = log(a) + p log(len)"> 
	</p>
	<p>(Remember that the mean square residual is the best estimate of σ<sup>2</sup>.
		This has the effect of scaling up the residuals, especially for the high leverage 
		points.</p>

<div class="centred"><div class="boxed">
<p>If the normal linear model holds, the standardised 
						residuals will have approximately normal(0,&nbsp;1) distributions.</p>
</div></div>

<br>

<div class="diagram">
<p class="heading">Examples</p>

<p>The diagram below shows a few regression data sets.
The ordinary residuals are initially displayed on the right.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="400">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="residProg.StudentResidApplet">
<param name="noOfDataSets" value="4">

<param name="dataName" value="Cancer deaths and radiation">
<param name="description" value="Radioactive waste from the Hanford Atomic Energy Plant in Washington has seeped into the Columbia River. The diagram below shows an exposure index based on distance from the river and distance from the plant, and cancer deaths per 100,000 residents.">
<param name="yVarName" value="Deaths">
<param name="xVarName" value="Exposure">
<param name="yValues" value="147 130 130 114 138 162 208 178 210">
<param name="xValues" value="2.5 2.6 3.4 1.3 1.6 3.8 11.6 6.4 8.3">
<param name="xAxis" value="0 12 0 2">
<param name="yAxis" value="100 250 100 50">
<param name="decimals" value="2">
<param name="residAxis" value="-30 30 -30 10">

<param name="dataName2" value="Cat body and heart weight">
<param name="description2" value="The heart and body weights of 47 female cats were measured.">
<param name="xVarName2" value="Body wt (kg)">
<param name="yVarName2" value="Heart wt (g)">
<param name="xValues2" value="2.3 3 2.9 2.4 2.3 2 2.2 2.1 2.3 2.1 2.1 2.2 2 2.3 2.2 2.3 2.1 2 2.9 2.7 2.6 2.3 2.6 2.1 2.1 2.7 2.2 2.3 2.1 2.4 2.7 2.3 2.1 2.2 2.3 2.1 2.9 3 2.2 2.4 2.4 2.5 2.5 2.3 2.3 2.6 2.3">
<param name="yValues2" value="9.6 10.6 9.9 8.7 10.1 7 11 8.2 9 7.3 8.5 9.7 7.4 7.3 7.1 9 7.6 9.5 10.1 10.2 10.1 9.5 8.7 7.2 9.8 10.8 9.1 11.2 8.1 10.2 8.5 10.1 8.7 10.9 7.9 8.3 10.1 13 8.7 6.3 8.8 10.9 9 9.7 8.4 10.1 10.6">
<param name="xAxis2" value="1.7 3.2 2.0 0.5">
<param name="yAxis2" value="5.8 14 6 2">
<param name="decimals2" value="2">
<param name="residAxis2" value="-3 3 -3 1">

<param name="dataName3" value="Soybeans and ozone">
<param name="description3" value="An experiment was conducted to assess how chronic levels of ozone affected the yield of soybeans. Four different ozone levels (ppm) were used.">
<param name="yVarName3" value="Soybean yield">
<param name="xVarName3" value="Ozone level (ppm)">
<param name="yValues3" value="238.3 270.7 210.0 248.7 242.4 235.1 228.9 236.2 255.0 228.9 236.2 208.0 243.5 233.0 233.0 178.7 186.0 206.9 215.3 219.5">
<param name="xValues3" value="5@0.02 5@0.07 5@0.11 5@0.15">
<param name="xAxis3" value="0 0.17 0 0.05">
<param name="yAxis3" value="170 280 180 20">
<param name="decimals3" value="2">
<param name="residAxis3" value="-50 50 -40 20">

<param name="dataName4" value="Alcoholism and strength">
<param name="description4" value="50 alcoholic men were selected from a larger group of alcoholic patients to be as similar as possible in age and physical characteristics. The total lifetime consumption of alcohol (kg per kg body wt) was determined and the strength of the non-dominant arm was measured.">
<param name="xVarName4" value="Alcohol consumption">
<param name="yVarName4" value="Strength (kg)">
<param name="xValues4" value="36.2 39.7 39.5 18.2 29.2 32.5 13.2 14.8 28.6 30.8 34.5 39.7 28.3 34.5 40.3 19.1 27.7 40.8 17.7 22.8 28.3 4 5.2 11.7 12.5 13.7 15.7 17.4 18.9 20 32.3 3.5 9.8 14 18.3 19.7 29.8 9.7 11.1 32.9 10.8 14 17.5 12.6 22.6 5.2 9.4 13.5 19.1 7.4">
<param name="yValues4" value="10 10 10.8 12.2 13.1 14 15.5 15.5 15.2 15.2 15.2 15.5 16.2 16.2 16.2 17.9 18.2 18.2 19.1 18.8 19.3 20.9 20.9 20.9 20.9 20.9 20.9 20.9 21.1 21.1 21.2 22.3 22.1 21.8 22.2 22.2 23.3 23.9 24 24.1 25.1 25.1 25.1 26.2 26.3 28.2 28.2 28.4 28.2 29.5">
<param name="xAxis4" value="0 45 0 10">
<param name="yAxis4" value="5 31 5 5">
<param name="decimals4" value="2">
<param name="residAxis4" value="-10 10 -10 5">

<param name="customText" value="Data set=Data set#Ordinary residual=Ordinary residual#Standardised residual=Standardised residual">
</applet>
</div>

		<p>Select <strong>Standardised residual</strong> from the pop-up menu to display 
			the standardised residuals. This makes the residuals on the left and right 
			(with higher leverage) slightly larger, relative to the residuals in the 
			centre.</p>
		<p>Repeat with other data sets.</p>
</div>
  <p class="heading">Guidelines for interpreting standardised residuals</p>

  <p>If the normal linear model holds, the standardised residuals have approximately 
		standard normal distributions. Therefore approximately 95% of them will be 
		between -2 and +2, and almost all will be between -3 and +3.</p>
	
<div class="centred"><div class="boxed">
<p>Many statistical programs automatically 
						flag standardised residuals outside these ranges as being possible 
						outliers.</p>
</div></div>

	<p>Note however that you should <strong>expect</strong> 5% of standardised residuals 
		to be &gt;2 or &lt;-2, so in large data sets it is not unusual to find several 
		residuals outside ±2 and even a few outside ±3. (There is probability 
		0.003 that a value from the standard normal distribution will be outside ±3, 
		so it would be <strong>expected</strong> that 3 values would be outside this 
		range in a data set of 1,000 values.)</p>
	
<div class="centred"><div class="boxed">
<p>In large data sets, do not assume that 
						standardised residuals outside ±3 <strong>must</strong> 
						be outliers &mdash; values a little outside can also occur by chance.</p>
</div></div>

	<br>
	<div class="diagram">
		<p class="heading">Illustration</p>

		<p>The diagram below simulates data from a normal linear model.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="residProg.StdResidApplet">
<param name="yVarName" value="Response, y">
<param name="xVarName" value="Explanatory, x">
<param name="xValues0" value="0.6 0.8 1.0 1.2 1.4 1.6 1.8 2.0 2.2 2.4 2.6 2.8 3.0 3.2 3.4 3.6 3.8 4.0 4.2 4.4">
<param name="xValues1" value="0.8 3@0.9 3@1.0 3@1.1 3@1.2 3@1.3 3@1.4 3@1.5 3@1.6 3@1.7 3@1.8 3@1.9 3@2.0 3@2.1 3@2.2 3@2.3 3@2.4 3@2.5 3@2.6 3@2.7 3@2.8 3@2.9 3@3.0 3@3.1 3@3.2 3@3.3 3@3.4 3@3.5 3@3.6 3@3.7 3@3.8 3@3.9 3@4.0 2@4.1 4.2">
<param name="xValues2" value="4@0.65 4@0.68 4@0.71 4@0.74 4@0.77 4@0.8 4@0.83 4@0.86 4@0.89 4@0.92 4@0.95 4@0.98 4@1.01 4@1.04 4@1.07 4@1.1 4@1.13 4@1.16 4@1.19 4@1.22 4@1.25 4@1.28 4@1.31 4@1.34 4@1.37 4@1.4 4@1.43 4@1.46 4@1.49 4@1.52 4@1.55 4@1.58 4@1.61 4@1.64 4@1.67 4@1.7 4@1.73 4@1.76 4@1.79 4@1.82 4@1.85 4@1.88 4@1.91 4@1.94 4@1.97 4@2 4@2.03 4@2.06 4@2.09 4@2.12 4@2.15 4@2.18 4@2.21 4@2.24 4@2.27 4@2.3 4@2.33 4@2.36 4@2.39 4@2.42 4@2.45 4@2.48 4@2.51 4@2.54 4@2.57 4@2.6 4@2.63 4@2.66 4@2.69 4@2.72 4@2.75 4@2.78 4@2.81 4@2.84 4@2.87 4@2.9 4@2.93 4@2.96 4@2.99 4@3.02 4@3.05 4@3.08 4@3.11 4@3.14 4@3.17 4@3.2 4@3.23 4@3.26 4@3.29 4@3.32 4@3.35 4@3.38 4@3.41 4@3.44 4@3.47 4@3.5 4@3.53 4@3.56 4@3.59 4@3.62 4@3.65 4@3.68 4@3.71 4@3.74 4@3.77 4@3.8 4@3.83 4@3.86 4@3.89 4@3.92 4@3.95 4@3.98 4@4.01 4@4.04 4@4.07 4@4.1 4@4.13 4@4.16 4@4.19 4@4.22 4@4.25 4@4.28 4@4.31 4@4.34 4@4.37">
<param name="sampleSize" value="20 100 500">
<param name="regnModel" value="33.0 7.5 6.0">
<param name="horizAxis" value="0.5 4.5 1 1">
<param name="vertAxis" value="25 80 30 10">
<param name="randomSeed" value="345945782">
<param name="residName" value="Standardised residual">
</applet>
</div>

		<p>Initially the sample size is 20. Generate a few data sets and observe that 
			it is not unusual to find a standardised residual outside ±2.</p>
		<p>Increase the sample size and take a few more samples. Observe that standardised 
			residuals outside ±3 occasionally occur.</p>

</div>


<script type='text/javascript'>writePageEnd();</script>
</p>
</div>

</body>
</html>
