<!DOCTYPE HTML>
<html>
<head>
	<title>Can groups be combined?</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="factor, indicator variable, analysis of variance, sequential sums of squares, contrast">
	<meta name="dataset" content="Pain threshold and hair colour">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Alternative parameterisations</p>  
  <p>There are several alternative ways to write a general linear model that all 
		allow an arbitrary mean for each of <em>g</em> groups. We have already seen 
		parameterisations with:</p>
	<ul>
		<li><em>g</em> parameters for the separate group means, or</li>
		<li>a baseline mean and (<em>g</em>&nbsp;-&nbsp;1) parameters for the differences 
			between the other group means and the baseline mean.</li>
	</ul>
	<p>Many other parameterisations of the same basic model are possible. </p>
	
<div class="centred"><div class="boxed">
<p>We will describe a few alternative parameterisations 
						in this page.</p>
</div></div>

	
		
	<p>Different parameterisations can allow the explained sum of squares for the 
		factor (with <em>g</em>&nbsp;-&nbsp;1 degrees of freedom) to be split into 
		components that can be used in an anova table to test meaningful hypotheses.</p>
	<p class="heading">Parameterisation for testing whether some group means are 
		equal</p>  
		
	<p>We first consider how to define indicator variables for testing whether some 
		group means are equal.</p>
	<ol>
		<li>One or more indicator variables specify a model with the required group 
			means equal.</li>
		<li>Additional indicator variables are defined to give the additional flexibility 
			of allowing <strong>all</strong> group means to be different.</li>
	</ol>
	<p>This can be explained most easily in an example.</p>
	<div class="diagram">
		<p class="heading">Comparisons with a control group</p>  
		<p>Consider experimental data that includes a <em>Control</em> group and three 
			other treatment groups, <em>AAA</em>, <em>BBB</em> and <em>CCC</em>. We 
			might be interested in testing whether <em>AAA</em>, <em>BBB</em> and <em>CCC</em> 
			have equal group means. We might define the indicator variables as follows:</p>
		<ol>
			<li>The first indicator variable contrasts the <em>Control</em> group with 
				all others.</li>
			<li>Two further indicator variables allow for differences between the means 
				of the three treatment groups.</li>
		</ol>
		<p>If there were 3 response measurements (replicates) at each factor level, 
			the X matrix would be as shown below:</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="450" height="320">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="matrixProg.FactorLinearPartApplet">
<param name="xRows" value="12">
<param name="nXColumns" value="1">
<param name="fullNameX1" value="Group">
<param name="shortNameX1" value="x">
<param name="valuesX1" value="3@0 3@1 3@2 3@3">
<param name="labelsX1" value="Control AAA BBB CCC">
<param name="oneFactor" value="twoGroup 1">
<param name="customText" value="Contrast=Contrast">
</applet> 
</div>

		<p>Click any row to see how the indicator variables select parameters to form 
			the response mean. The next diagram shows the meanings of the parameters 
			graphically. (The response values were simply chosen to illustrate the model.)</p>

		<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="500" height="600">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="matrixProg.FactorFittedValApplet">
<param name="yName" value="Response">
<param name="yValues" value="1 2 3 9 10 11 6 7 8 11 12 13">
<param name="xRows" value="12">
<param name="nXColumns" value="1">
<param name="fullNameX1" value="Group">
<param name="shortNameX1" value="x">
<param name="valuesX1" value="3@0 3@1 3@2 3@3">
<param name="labelsX1" value="Control AAA BBB CCC">
<param name="oneFactor" value="xx">
<param name="fitDecimals" value="2">
<param name="lsDecimals" value="2 2 2 2">
<param name="yAxis" value="0 14 0 2">
<param name="oneFactor" value="twoGroup 1">
<param name="customText" value="Contrast=Contrast">
</applet> 
</div>

<p>Drag the red arrows and observe that the model still allows arbitrary means 
	for all groups.</p>
</div>

  <p class="heading">Testing equality of some group means</p>
  <p>For the above example, if the last two parameters were zero &mdash; i.e. if the 
		last two indicator variables were deleted from the model, the response means 
		for <em>AAA</em>, <em>BBB</em> and <em>CCC</em> would be constrained to be 
		equal. The sequential sum of squares for these two indicator variables therefore 
		leads to a hypothesis test for whether these three response means are equal.</p>
	
<div class="centred"><div class="boxed">
<p>The following numerical example explains.</p>
</div></div>

	<br>
	
<div class="diagram">
		<p class="heading">Pain tolerance and hair colour</p>  
		<p>Studies conducted at the University of Melbourne indicate that there may be 
			a difference between the pain thresholds of blonds and brunettes. Men and 
			women of various ages were divided into four categories according to hair 
			colour: light blond, dark blond, light brunette, and dark brunette. The 
			purpose of the experiment was to determine whether hair colour is related 
			to the amount of pain produced by common types of mishaps and assorted types 
			of trauma. Each person in the experiment was given a pain threshold score 
			based on his or her performance in a pain sensitivity test (the higher the 
			score, the higher the person's pain tolerance).</p>
		<p>In the parameterisation below, the first indicator variable is a contrast 
			between the blonds and brunettes. The other indicator variables distinguish 
			(light and dark blonds) and (light and dark brunettes).</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="450" height="460">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="matrixProg.FactorLinearPartApplet">
<param name="xRows" value="19">
<param name="nXColumns" value="1">
<param name="fullNameX1" value="Hair">
<param name="shortNameX1" value="x">
<param name="valuesX1" value="5@0 5@1 4@2 5@3">
<param name="labelsX1" value="#Lt blond# #Dk blond# #Lt brunette# #Dk brunette#">
<param name="oneFactor" value="twoGroup 2">
<param name="customText" value="Contrast=Contrast">
</applet> 
</div>

		<p class="heading">Analysis of variance table</p>
		<p>The analysis of variance table below shows the sequential sums of squares, 
			split into a component for the first indicator variable contrasting blonds 
			and brunettes, then a component for the other two indicator variables comparing 
			the sub-colours (light vs dark blonds and light vs dark brunettes).</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="450" height="200">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="glmAnovaProg.CombineSsqApplet">
<param name="yVarName" value="Pain threshold">
<param name="yValues" value="62 60 71 55 48 63 57 52 41 43 42 50 41 37 32 39 51 30 35">
<param name="xVariables" value="X Z">
<param name="XVarName" value="Blond vs brunette">
<param name="XValues" value="10@0 9@1">
<param name="xLabels" value="#Blond# #Brunette#">
<param name="ZVarName" value="Within main colour">
<param name="ZValues" value="5@0 5@1 4@0 5@2">
<param name="ZLabels" value="L13 L2 L4">
<param name="maxSsq" value="9999.9 99 9999.9 99.99">
<param name="componentNames" value="Blond vs brunette#Between sub-colours">
<param name="combine" value="1:2:Combined ssq for hair colour:Between hair colour">
</applet> 
</div>

		<p>From the p-value associated with the sequential sum of squares between 
			sub-colours, we conclude that there is no evidence in the data of differences 
			in pain threshold between light and dark blonds or between light and dark 
			brunettes.</p>
		<p>Since this p-value is not significant, we can continue to interpret the 
			p-value above as giving strong evidence of a difference between blonds and 
			brunettes.</p>
		<p>Click the checkbox <strong>Combined ssq for hair colour</strong> to add 
			together these sequential sums of squares. The resulting sum of squares 
			(3 d.f.) is identical to the explained sum of squares that would be obtained 
			from other parameterisations of the model.</p>
		<p class="heading">Illustration of the sequential sums of squares</p>
		<p>The explained sums of squares in an anova table (whether sequential or 
			not) are always the sum of squares of differences between the fitted values 
			from two models. The diagram below illustrates the explained sums of squares 
			for the pain tolerance data.</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="450" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="glmAnovaProg.ContrastComponentsApplet">
<param name="yVarName" value="Pain threshold">
<param name="yValues" value="62 60 71 55 48 63 57 52 41 43 42 50 41 37 32 39 51 30 35">
<param name="yAxis" value="20 80 20 10">
<param name="xVarName" value="Hair colour">
<param name="xValues" value="5@0 5@1 4@2 5@3">
<param name="xLabels" value="#Light blond# #Dark blond# #Light brunette# #Dark brunette#">
<param name="x2VarName" value="Blond vs brunette">
<param name="x2Values" value="10@0 9@1">
<param name="x2Labels" value="Blond Brunette">
<param name="group1Count" value="2">
<param name="componentNames" value="Between hair colours#Blond vs brunette#Between sub-colours">
</applet> 
</div>

		<p>Use the pop-up menu to see the differences that are summed for each of 
			the explained sums of squares.</p>
	  <dl>
			<dt>Between hair colours</dt>
			<dd>Differences between group means and overall mean</dd>
			<dt>Blond vs brunette</dt>
			<dd>Differences between main hair colour mean and overall mean</dd>
			<dt>Between sub-colours</dt>
			<dd>Differences between sub-colour mean and main hair colour mean</dd>
		</dl>
	<br>
		
</div>


<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
