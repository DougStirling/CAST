<!DOCTYPE HTML>
<html>
<head>
	<title>Removing block effects</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="randomised block design">
	<meta name="dataset" content="Amino acid uptake by fish">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Adjusting data to make all block means equal</p>

  <p>The  blocks of similar experimental units in a randomised block design improve accuracy because they can be used to <strong>explain</strong> some of the observed variability in the response. It is often found that some blocks  have consistently higher response values than others.</p>
  <p>One approach that takes account of the block-to-block variation is to adjust the values in each block (adding or subtracting a constant) to 'correct' for these block differences and make all blocks have the same mean response.</p>
  <p>After 'correcting' for the block differences in this way, we could ignore the existence of blocks and use the simpler analysis of variance for a completely randomised design to test for differences between the treatments. Although the resulting 
  	anova table is not completely correct for testing whether the treatment means 
  	are equal, its sums of squares are the <strong>basis</strong> for the test that will be described in the next section.</p>
  <div class="diagram"> 
    <p class="heading">Amino acid uptake by fish</p>

    <p>To examine how NaCN (sodium cyanide) affected the uptake of an amino acid 
      by intestinal preparations from a species of fish, a randomised block experiment 
      was conducted. Only six preparations could be obtained from each fish, so four fish were used in order to obtain enough experimental units. The fish are the four blocks in the experiment and three preparations from each  were randomly chosen 
    	to get the NaCN treatment, the other three being controls.</p>
    
		<div class="centred"><table border="0" class="centred" cellpadding="5" cellspacing="0">
			<tr>
				<th>&nbsp;</th>
				<th colspan="4">Fish</th>
			</tr>
			<tr>
				<th valign="bottom">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Treatment&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
				<th>&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;<sub></sub></th>
				<th>&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;</th>
				<th>&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;<sub></sub></th>
				<th>&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;</th>
			</tr>
			<tr align="center">
				<td>With NaCN</td>
				<td bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-left:1px solid #999999;"><table border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td align="right">1.74<br>1.92<br>2.26</td>
						</tr>
				</table></td>
				<td bgcolor="#FFFFFF" style="border-top:1px solid #999999;"><table border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td align="right">1.52<br>
							2.02<br>
							1.91</td>
						</tr>
				</table></td>
				<td bgcolor="#FFFFFF" style="border-top:1px solid #999999;"><table border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td align="right">1.00<br>
							1.12<br>
							1.13</td>
						</tr>
				</table></td>
				<td bgcolor="#FFFFFF" style="border-top:1px solid #999999; border-right:1px solid #999999;"><table border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td align="right">1.58<br>
							1.78<br>
							1.52</td>
						</tr>
				</table></td>
			</tr>
			<tr align="center">
				<td>Without NaCN</td>
				<td bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-left:1px solid #999999;"><table border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td align="right">1.60<br>
								1.92<br>
							1.54</td>
						</tr>
				</table></td>
				<td bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;"><table border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td align="right">1.31<br>
								1.15<br>
							1.51</td>
						</tr>
				</table></td>
				<td bgcolor="#FFFFFF" style="border-bottom:1px solid #999999;"><table border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td align="right">0.79<br>
								0.84<br>
							0.86</td>
						</tr>
				</table></td>
				<td bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-right:1px solid #999999;"><table border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td align="right">1.24<br>
								0.81<br>
							1.32</td>
						</tr>
				</table></td>
			</tr>
		</table></div>
		
    <p>The coloured vertical lines on the diagram below show the mean uptakes for the different fish &mdash; clearly  some fish have much higher amino acid uptake than others. (Click on any cross to see the 6 response values from that fish.)</p>
    <div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="450" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="pairBlockProg.RemoveBlockEffectApplet">
<param name="yVarName" value="Amino acid uptake">
<param name="yValues" value="1.74 1.92 2.26 1.60 1.92 1.54 1.52 2.02 1.91 1.31 1.15 1.51 1.00 1.12 1.13 0.79 0.84 0.86 1.58 1.78 1.52 1.24 0.81 1.32">
<param name="xVarName" value="Treatment">
<param name="xLabels" value="#Without NaCN# #With NaCN#">
<param name="xValues" value="3@0 3@1 3@0 3@1 3@0 3@1 3@0 3@1">
<param name="blockVarName" value="Block (fish)">
<param name="blockLabels" value="#Fish 1# #Fish 2# #Fish 3# #Fish 4#">
<param name="blockValues" value="6@0 6@1 6@2 6@3">
<param name="yAxis" value="0.5 2.5 0.5 0.5">
<param name="maxSummaries" value="999.999 999.999 99.99 9.999">
<param name="componentName" value="Total#Between treatments#Residual">
<param name="jitter" value="0.3">
<param name="initialR2" value="0.0">
<param name="customText" value="Make all block means equal=Make all block means equal">
</applet>
</div>

    <p>The analysis of variance table is the one that is appropriate for a completely randomised design ignoring the existence of blocks. Observe that:</p>
    <div class="centred"><div class="boxed">
    	<p>If the blocks are ignored,  there is only moderately strong evidence that the treatments differ (p-value = 0.0209).</p>
    </div></div>
    <p>Click <strong>Make all block means equal</strong> to 'correct' the data for differences between the blocks. Observe that:</p>
    <ul>
      <li>The treatment (between observers) sum of squares, degrees of freedom 
        and mean sum of squares remain the same.</li>
      <li>The residual sum of squares decreases considerably.</li>
    </ul>
    <p>Because the residual sum of squares decreases so much, the F-ratio becomes 
      large and the p-value becomes close to zero. From this anova table,</p>
    <div class="centred"><div class="boxed">
    	<p>We would 
    		now conclude that it is almost certain that the NaCN treatment affects 
    		amino acid uptake.</p>
    </div></div>

<br>
</div>

  <p>The treatment and residual sums of squares shown above are the <strong>basis</strong> 
    for testing whether the treatment means are all equal. However:</p>
  <div class="centred"><div class="boxed" style="background-color:#FFFF00">
  	<p><strong>The analysis described 
  		on this page is not completely correct &mdash; the residual degrees of freedom 
  		are too high.</strong></p>
  </div></div>
	
  <p>In the next section, we describe the correct anova table for testing whether the treatment 
  means are equal in data from a randomised block experiment.</p>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
