<!DOCTYPE HTML>
<html>
<head>
	<title>Comparing groups of treatments</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="constraint, anova, analysis of variance">
	<meta name="dataset" content="Wheat variety and yield">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Structure within factor levels</p>
<p>We again consider the usual model for a single factor,</p>
<div class="centred"><table border="0" class="centred" cellpadding="2" cellspacing="0">
  <tr>
    <td align="center"><br>
        <span class="black em">y<sub>ij</sub></span> &nbsp;= &nbsp;<span class="blue">µ</span></td>
    <td align="center"><br>
      &nbsp;+&nbsp;</td>
    <td align="center"><span class="red">(<em>explained by </em>X)<br>
      β<em><sub>i</sub></em></span></td>
    <td align="center"><br>
      &nbsp;+&nbsp;</td>
    <td align="center">(<em>unexplained</em>)<br>
      ε<em><sub>ij</sub></em></td>
  </tr>
</table></div>
<p>where <span class="red">β<sub>1</sub> = 0</span>. If there are several levels for the factor, there is often some internal structure within these levels. On the previous two pages, one factor level corresponded to a control treatments. We now extend this to experiments where the treatments can be grouped into two sets.</p>
<p>For example, in experiment about different crop varieties, it is often known that some varieties are relatively similar to each other &mdash; perhaps they were developed in the same region or are hybrids with similar 'parents'. Irrigation systems being compared may include several variations on drip-feeding  and also different schedules for delivering water through sprays.</p>
<p class="heading">Special cases of the general model</p>
<p>In experiments where the factor levels can be meaningfully grouped into groups A and B, questions about the factor levels might be:</p>
<ul>
	<li>Are all factor level means in group A equal?</li>
	<li>Are all factor level means in group B equal?</li>
	<li>Is there any difference between the mean response in groups A and B?</li>
</ul>
<p>Each of these questions can be examined using  constraints on the model parameters:</p>
<ul>
	<li>Constrain all levels in group A to have the same parameters</li>
	<li>Constrain all levels in group B to have the same parameters</li>
	<li>Constrain the average parameter values for group A to be the same as the average value for group B.</li>
</ul>
<p>The questions are answered using analysis of variance based on the sums of squares explained by the constraints.</p>
<div class="diagram">
<p class="heading">Yields of wheat</p>
<p>The diagram below shows the yields of wheat in an experiment involving five varieties that are grouped into two A-varieties and two B-varieties.</p>
<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="510" height="460">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="exper2Prog.ApplyConstraintsApplet">
<param name="yVarName" value="Yield">
<param name="yValues" value="9.71 11.51 9.81 10.24 8.91 13.79 13.29 13.72 11.70 12.42 13.29 13.32 15.04 12.40 12.95 14.09 13.73 16.54 13.48 14.39 16.60 14.27 14.44 14.55 14.48">
<param name="yAxis" value="8 17 8 1">
<param name="xVarName" value="Variety">
<param name="xLabels" value="A1 A2 B1 B2 B3">
<param name="xValues" value="5@0 5@1 5@2 5@3 5@4">
<param name="maxRss" value="999.999">
<param name="showResiduals" value="true">
<param name="constraint1" value="0 3 -2 -2 -2 0">
<param name="constraint2" value="0 1 0 0 0 0">
<param name="constraint3" value="0 0 1 -1 0 0">
<param name="constraint4" value="0 0 1 0 -1 0">
<param name="constraintGroup1" value="2*0*#beta##sub1# = #beta##sub2#*All A varieties same">
<param name="constraintGroup2" value="3 4*0*#beta##sub3# = #beta##sub4# = #beta##sub5#*All B varieties same">
<param name="constraintGroup3" value="1*0*3#beta##sub1# + 3#beta##sub2# = 2#beta##sub3# + 2#beta##sub4# + 2#beta##sub5#*Mean of A varieties*same as mean of B varieties">
<param name="paramDecimals" value="3">
<param name="nColumns" value="2">
</applet>
</div>
<p>Use the checkboxes to impose the three sets of constraint described above.</p>
<p>(Note that dividing the constraint on the right by 6 makes it clearer that the average <span class="red">β</span>-value for the A varieties is the same as the average value for the B varieties.)</p>
</div>

<p class="heading">Analysis of variance</p>
<p>Each linear constraint on the model parameters increases the residual sum of squares. This corresponds to an explained sum of squares (explained by going in the opposite direction and releasing the constraint) that has 1 degree of freedom.</p>
<p>The constraints can therefore be described by explained sums of squares in an analysis of variance table. These explained sums of squares can be used to answer questions about differences  between the groups and between the levels within each group.</p>

<div class="diagram">
<p>The following analysis of variance table initially shows a combined sum of squares explained by the five treatments.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="450" height="200">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="glmAnovaProg.CombineSsqApplet">
<param name="yVarName" value="Yield">
<param name="yValues" value="9.71 11.51 9.81 10.24 8.91 13.79 13.29 13.72 11.70 12.42 13.29 13.32 15.04 12.40 12.95 14.09 13.73 16.54 13.48 14.39 16.60 14.27 14.44 14.55 14.48">
<param name="xVariables" value="AB A B">
<param name="ABVarName" value="A vs B">
<param name="ABValues" value="10@0 15@1">
<param name="ABLabels" value="A B">
<param name="AVarName" value="Between A levels">
<param name="AValues" value="5@0 5@1 15@0">
<param name="ALabels" value="A1 A2B">
<param name="BVarName" value="Between B levels">
<param name="BValues" value="15@0 5@1 5@2">
<param name="BLabels" value="others B2 B3">
<param name="maxSsq" value="999.99 99 99.99 99.99">
<param name="componentNames" value="A vs B#Between A varieties#Between B varieties">
<param name="split" value="1:3:Split varieties:Between all varieties">
</applet>
</div>

<p>Click <strong>Split varieties</strong> to separate the treatment sum of squares into three components, corresponding to the three sets of constraints that were described above.</p>
<p>Note that the constraint of all B-varieties being equal corresponds to <strong>two</strong> linear constraints since there are three of the B-varieties &mdash; count the number of equals signs in the constraint:</p>
<p class="eqn"><span class="red">β<sub>3</sub></span> &nbsp; = &nbsp; <span class="red">β<sub>4</sub></span> &nbsp; = &nbsp; <span class="red">β<sub>5</sub></span></p>
<p>This constraint therefore has <strong>two</strong> degrees of freedom.</p>
<p>From the p-values, we would conclude that there is only weak evidence of any difference between the three B-varieties. However there is very strong evidence of a difference between the two A-varieties. It is also almost certain that the average yield from the A-varieties differes from that of the B-varieties.</p>
</div>


<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
