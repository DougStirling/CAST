<!DOCTYPE HTML>
<html>
<head>
	<title>Defining models with constraints</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="constraint">
	<meta name="dataset" content="Fertiliser and maize variety">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Defining models directly with terms</p>
<p>The most general model for the effect of two factors with interaction is usually written in the form</p>
<div class="centred"><table border="0" class="centred" cellpadding="2" cellspacing="0">
  <tr>
    <td align="center"><br>
        <span class="black em">y<sub>ijk</sub></span> &nbsp;= &nbsp;<span class="blue">µ</span></td>
    <td align="center"><br>
      &nbsp;+&nbsp;</td>
    <td align="center"><span class="red">(<em>explained by </em>X)<br>
      β<em><sub>i</sub></em></span></td>
    <td align="center"><br>
      &nbsp;+&nbsp;</td>
    <td align="center" class="green">(<em>explained by </em>Z)<br>
      γ<em><sub>j</sub></em></td>
    <td align="center"><br>
      &nbsp;+&nbsp;</td>
    <td align="center" class="purple">(<em>interaction</em>)<br>δ<em><sub>ij</sub></em></td>
    <td align="center"><br>
      &nbsp;+&nbsp;</td>
    <td align="center">(<em>unexplained</em>)<br>
      ε<em><sub>ijk</sub></em></td>
  </tr>
</table></div>
<p>where <span class="black em">y<sub>ijk</sub></span> is the response from the <em>k</em>'th of the replicate observations with factor X at level <em>i</em> and factor Z at level <em>j</em>. When written in this way,</p>
<div class="centred"><div class="boxed">
  <p>The important special cases where there is no interaction, no main effect for X and no main effect for Z all correspond to <strong>adding or deleting terms</strong>. </p>
</div></div>
<p class="heading">Defining models with constraints</p>
<p>An alternative way to define  models places constraints on the allowable parameters, <span class="red">µ<em><sub>ij</sub></em></span>, of the most general model, when it is written in the form</p>
<div class="centred"><table border="0" class="centred" cellpadding="2" cellspacing="0">
	<tr>
		<td align="center"><br>
				<span class="black em">y<sub>ijk</sub></span> &nbsp;= </td>
		<td align="center"><span class="red">(<em>explained by </em>X &amp; Z)<br>
			µ<em><sub>ij</sub></em></span></td>
		<td align="center"><br>
			&nbsp;+&nbsp;</td>
		<td align="center">(<em>unexplained</em>)<br>
			ε<em><sub>ijk</sub></em></td>
	</tr>
</table></div>
<p>It is not particularly difficult to specify the constraints on the <span class="red">µ<em><sub>ij</sub></em></span>   to define models without interaction and without main effects for X and Z, but we will only give  details for the simplest situation in which X and Z  only two levels.</p>
<p class="heading">Alternative definitions of models for factors with two levels</p>
<p>If the  factors each have two levels, the  mean responses for  the four combinations of factor levels are:</p>
<div class="centred"><table border="0" class="centred" cellpadding="5" cellspacing="1">
  <tr>
    <th>&nbsp;</th>
    <th colspan="2"><span class="red">Factor X</span></th>
  </tr>
  <tr>
    <th>Factor Z</th>
    <th><span class="red">&nbsp;&nbsp;&nbsp;&nbsp;Level 1&nbsp;&nbsp;&nbsp;&nbsp;</span></th>
    <th><span class="red">&nbsp;&nbsp;&nbsp;&nbsp;Level 2&nbsp;&nbsp;&nbsp;&nbsp;</span></th>
    <th><span class="red">&nbsp;&nbsp;Total&nbsp;&nbsp;</span></th>
  </tr>
  <tr align="center">
    <th class="purple">Level 1</th>
    <td bgcolor="#FFFFFF"><span class="blue"><strong>µ<sub>11</sub></strong></span> </td>
    <td bgcolor="#FFFFFF"><span class="blue"><strong>µ<sub>21</sub></strong></span> </td>
    <td><span class="blue"><strong>µ<sub>11</sub> + µ<sub>21</sub></strong></span> </td>
  </tr>
  <tr align="center">
    <th class="purple">Level 2</th>
    <td bgcolor="#FFFFFF"><span class="blue"><strong>µ<sub>12</sub></strong></span> </td>
    <td bgcolor="#FFFFFF"><span class="blue"><strong>µ<sub>22</sub></strong></span> </td>
    <td><span class="blue"><strong>µ<sub>12</sub> + µ<sub>22</sub></strong></span> </td>
  </tr>
  <tr align="center">
    <th class="purple">Total</th>
    <td><span class="blue"><strong>µ<sub>11</sub> + µ<sub>12</sub></strong></span> </td>
    <td><span class="blue"><strong>µ<sub>21</sub> + µ<sub>22</sub></strong></span> </td>
  </tr>
</table></div>
<p>The diagram below shows how some of the important models can be defined by:</p>
<ul>
  <li>adding terms to a model in which neither factor affects the response, or</li>
  <li>applying constraints to the most general model with mean response µ<em><sub>ij</sub></em>.</li>
</ul>
<br>

<div class="centred"><table class="centred" cellpadding="4" width="100%">
  <tr>
    <td colspan="4" align="center"><table border="1" cellspacing="0" cellpadding="10">
      <tr>
        <td align="center" bgcolor="#CCCCFF" class="black bold"><em><span class="bigger">Neither factor affects Y</span><br>
        y<sub>ijk</sub> &nbsp; = &nbsp; <span class="blue">µ</span> &nbsp; + &nbsp; ε<sub>ijk</sub></em></td>
      </tr>
    </table></td>
  </tr>
  <tr>
    <td align="right" width="40%"><span class="red"><strong>add term β<em><sub>i</sub></em></strong> </span><img src="images/downArrow.gif" width="24" height="42" align="absmiddle"></td>
    <td width="50">&nbsp;</td>
    <td width="24" align="right"><img src="images/upArrow.gif" width="24" height="42" align="absmiddle"></td>
    <td align="center" width="40%"><span class="red"><strong>Constrain <span class="blue">µ<sub>11</sub></span> + <span class="blue">µ<sub>12</sub></span> = <span class="blue">µ<sub>21</sub></span> + <span class="blue">µ<sub>22</sub></span></strong><br>
          <em>(The total of the response means is the same when X has level 1 and level 2)</em></span></td>
  </tr>
  <tr>
    <td colspan="4" align="center"><table border="1" cellspacing="0" cellpadding="10">
      <tr>
        <td bgcolor="#CCCCFF" class="black em bold bigger">Only factor X affects Y</td>
      </tr>
    </table></td>
  </tr>
  <tr>
    <td align="right"><span class="green bold">add term </span>  <span class="bold green">γ<em><sub>j</sub></em></span>  <img src="images/downArrow.gif" width="24" height="42" align="absmiddle"></td>
    <td width="50">&nbsp;</td>
    <td width="24" align="right"><img src="images/upArrow.gif" width="24" height="42" align="absmiddle"></td>
    <td align="center" class="green"><strong>Constrain <span class="blue">µ<sub>11</sub></span> +<span class="blue"> µ<sub>21</sub></span> = <span class="blue">µ<sub>12</sub></span> + <span class="blue">µ<sub>22</sub></span></strong><br>
          <em>(The total of the response means is the same when Z has level 1 and level 2)</em></td>
  </tr>
  <tr>
    <td colspan="4" align="center"><table border="1" cellspacing="0" cellpadding="10">
      <tr>
        <td bgcolor="#CCCCFF" class="black em bold bigger">Factors X and Z affect Y without interaction</td>
      </tr>
    </table></td>
  </tr>
  <tr>
    <td align="right" class="purple bold">add term δ<em><sub>ij</sub></em> <img src="images/downArrow.gif" width="24" height="42" align="absmiddle"></td>
    <td width="50">&nbsp;</td>
    <td width="24" align="right"><img src="images/upArrow.gif" width="24" height="42" align="absmiddle"></td>
    <td align="center" class="purple"><strong>Constrain <span class="blue">µ<sub>21</sub></span> - <span class="blue">µ<sub>11</sub></span> = <span class="blue">µ<sub>22</sub></span> - <span class="blue">µ<sub>12</sub></span></strong><br>
          <em>(Changing X from level 1 to 2 has same effect when Z&nbsp;=&nbsp;1 as when Z&nbsp;=&nbsp;2)</em></td>
  </tr>
  <tr>
    <td colspan="4" align="center"><table border="1" cellspacing="0" cellpadding="10">
      <tr>
        <td align="center" bgcolor="#CCCCFF" class="black bold em"><span class="bigger">Factors X and Z interact in how they affect Y</span><br>y<sub>ijk</sub> &nbsp; = &nbsp; <span class="blue">µ<sub>ij</sub></span> &nbsp; + &nbsp; ε<sub>ijk</sub></td>
      </tr>
    </table></td>
  </tr>
</table></div>

<p>Although nothing has been gained by the use of constraints to define these important models,</p>
<div class="centred"><div class="boxed">
  <p>The idea of defining special cases of models using linear constraints will be used to answer other questions in the following pages.</p>
</div></div>
<br>

<div class="diagram"> 
<p class="heading">Effect of fertiliser on two varieties of maize</p>

<p>Consider the following experimental data about the yield of maize in plots where two types of fertiliser and two maize varieties were randomly allocated.</p>

<div class="centred"><table border="0" class="centred" cellpadding="3" cellspacing="1">
  <tr>
    <th colspan="4">Yield of maize</th>
  </tr>
  <tr>
    <th>&nbsp;&nbsp;Fertiliser A <br>
    	&nbsp;&nbsp;on variety V1&nbsp;&nbsp;&nbsp;</th>
    <th>&nbsp;&nbsp;Fertiliser B <br>
&nbsp;&nbsp;on variety V1&nbsp;&nbsp;</th>
    <th>Fertiliser A <br>
&nbsp;&nbsp;on variety V2&nbsp;&nbsp;</th>
    <th>&nbsp;&nbsp;Fertiliser B <br>
&nbsp;&nbsp;on variety V2&nbsp;&nbsp;</th>
  </tr>
  <tr align="center">
    <td bgcolor="#FFFFFF"><table border="0" cellpadding="0" cellspacing="0" style="margin-top:0; margin-bottom:0">
      <tr>
        <td align="right">9.71<br>11.51<br>9.81<br>10.24<br>8.91</td>
      </tr>
    </table></td>
    <td bgcolor="#FFFFFF"><table border="0" cellpadding="0" cellspacing="0" style="margin-top:0; margin-bottom:0">
      <tr>
        <td align="right">13.79<br>13.29<br>13.72<br>11.70<br>12.42</td>
      </tr>
    </table></td>
    <td bgcolor="#FFFFFF"><table border="0" cellpadding="0" cellspacing="0" style="margin-top:0; margin-bottom:0">
      <tr>
        <td align="right">13.29<br>13.32<br>15.04<br>12.40<br>12.95</td>
      </tr>
    </table></td>
    <td bgcolor="#FFFFFF"><table border="0" cellpadding="0" cellspacing="0" style="margin-top:0; margin-bottom:0">
      <tr>
        <td align="right">14.09<br>13.73<br>16.54<br>13.48<br>14.39</td>
      </tr>
    </table></td>
  </tr>
</table></div>

<p>The diagram below initially shows the mean yield for each of the four treatments &mdash; the parameter estimates for the most general model allowing interaction between the fertiliser and variety.</p>
<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="510" height="460">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="exper2Prog.ApplyConstraintsApplet">
<param name="yVarName" value="Yield of maize">
<param name="yValues" value="9.71 11.51 9.81 10.24 8.91 13.79 13.29 13.72 11.70 12.42 13.29 13.32 15.04 12.40 12.95 14.09 13.73 16.54 13.48 14.39">
<param name="yAxis" value="8 17 8 1">
<param name="xVarName" value="Treatments">
<!param name="xLabels" value="X=1,Z=1 X=2,Z=1 X=1,Z=2 X=2,Z=2">
<param name="xLabels" value="#Fert A,V1# #Fert B,V1# #Fert A,V2# #Fert B,V2#">
<param name="xValues" value="5@0 5@1 5@2 5@3">
<param name="maxRss" value="999.999">
<param name="showResiduals" value="true">
<param name="constraint1" value="0 -1 1 -1 0">
<param name="constraint2" value="0 1 -1 -1 0">
<param name="constraint3" value="0 1 1 -1 0">
<param name="constraintGroup1" value="1*3*#mu##sub1##sub1# + #mu##sub1##sub2# = #mu##sub2##sub1# + #mu##sub2##sub2#*No main effect for Fertiliser">
<param name="constraintGroup2" value="2*3*#mu##sub1##sub1# + #mu##sub2##sub1# = #mu##sub1##sub2# + #mu##sub2##sub2#*No main effect for Variety">
<param name="constraintGroup3" value="3*0*#mu##sub2##sub1# - #mu##sub1##sub1# = #mu##sub2##sub2# - #mu##sub1##sub2#*No interaction">
<param name="paramDecimals" value="3">
<param name="nColumns" value="2">
<param name="paramNames" value="#mu##sub1##sub1# #mu##sub2##sub1# #mu##sub1##sub2# #mu##sub2##sub2#">
</applet>
</div>

<p>Click the checkbox on the right to apply a constraint to the parameters that removes the interaction between fertiliser and variety. Note that the difference between the estimated mean yields for fertilisers A and B is now the same for varieties V1 and V2.</p>
<p>The  two checkboxes on the left can be used to impose further constraints that remove the main effects for the fertilisers and the varieties.</p>
</div>


<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
