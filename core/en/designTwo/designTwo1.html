<!DOCTYPE HTML>
<html>
<head>
	<title>Experiments with 2 factors</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="crossed design, factorial design">
	<meta name="dataset" content="Blood pressure after operation">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Separate experiments to assess the effects of two factors</p>
<p>Sometimes the response of interest is influenced by two or more factors, each 
of which can be controlled in an experiment.</p>

<ul>
<li>In a chemical reaction, both temperature and pressure may influence the purity 
of the product.</li>
<li>In an agricultural experiment, both nitrogen and phosphorous fertilisers affect 
crop yield.</li>
<li>In a biological experiment examining what attracts bees to flowers, both the 
shape and colour of an artificial flower may influence how many bees visit it.</li>
</ul>

<p>The simplest way to study two factors is with two separate completely randomised 
experiments. In each of these experiments, one factor is kept constant (e.g. the 
colour of an artificial flower) and the other factor is varied (e.g. the flower's 
shape). However...</p>

<div class="centred"><div class="boxed">
<p>Assessing each factor in a separate experiment is inefficient.</p>
</div></div>

  <p class="heading">Adding a second factor to a 1-factor design</p>
	<p>Consider an experiment   to compare the three levels of a single factor with 6 replicates &mdash; each factor level is applied to a randomly selected 6 of the 18 experimental units. The table below illustrates the type of data that would arise from this experiment.</p>
	<div class="centred"><table border="0" class="centred" cellpadding="4" cellspacing="0">
		<tr>
			<th colspan="3">Factor X</th>
		</tr>
		<tr>
			<td align="center">&nbsp;&nbsp;X&nbsp;=&nbsp;<span class="red"><strong>A</strong></span> &nbsp;&nbsp;</td>
			<td align="center">&nbsp;&nbsp;X&nbsp;=&nbsp;<span class="red"><strong>B</strong></span> &nbsp;&nbsp;</td>
			<td align="center">&nbsp;&nbsp;X&nbsp;=&nbsp;<span class="red"><strong>C</strong></span> &nbsp;&nbsp;</td>
		</tr>
		<tr>
			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999;"><em>x</em><sub>A1</sub><br>
					<em>x</em><sub>A2</sub><br>
					<em>x</em><sub>A3</sub><br>
					<em>x</em><sub>A4</sub><br>
					<em>x</em><sub>A5</sub><br>
					<em>x</em><sub>A6</sub><br></td>
			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999; border-left:0px;"><em>x</em><sub>B1</sub><br>
					<em>x</em><sub>B2</sub><br>
					<em>x</em><sub>B3</sub><br>
					<em>x</em><sub>B4</sub><br>
					<em>x</em><sub>B5</sub><br>
					<em>x</em><sub>B6</sub></td>
			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999; border-left:0px;"><em>x</em><sub>C1</sub><br>
					<em>x</em><sub>C2</sub><br>
					<em>x</em><sub>C3</sub><br>
					<em>x</em><sub>C4</sub><br>
					<em>x</em><sub>C5</sub><br>
					<em>x</em><sub>C6</sub></td>
		</tr>
	</table></div>
	<p>Now consider a modification to this experiment that also varies a second factor, Y. The table below describes an  experiment with 3 replicates for each combination of the levels of factors X and Y. This experiment uses the <strong>same number of experimental units</strong> as the earlier experiment.</p>
	<div class="centred"><table border="0" class="centred" cellpadding="4" cellspacing="0">
<tr>
			<td>&nbsp;</td>
			<th colspan="3">Factor X</th>
		</tr>
		<tr>
			<th valign="bottom">Factor Y</th>
			<td align="center">&nbsp;&nbsp;X&nbsp;=&nbsp;<span class="red"><strong>A</strong></span> &nbsp;&nbsp;</td>
			<td align="center">&nbsp;&nbsp;X&nbsp;=&nbsp;<span class="red"><strong>B</strong></span> &nbsp;&nbsp;</td>
			<td align="center">&nbsp;&nbsp;X&nbsp;=&nbsp;<span class="red"><strong>C</strong></span> &nbsp;&nbsp;</td>
		</tr>
		<tr>
			<td align="center">Y&nbsp;=<span class="blue">&nbsp;<strong>S</strong></span> </td>
			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999;"><em>x</em><sub>AS1</sub><br>
					<em>x</em><sub>AS2</sub><br>
					<em>x</em><sub>AS3</sub></td>
			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999; border-left:0px;"><em>x</em><sub>BS1</sub><br>
					<em>x</em><sub>BS2</sub><br>
					<em>x</em><sub>BS3</sub></td>
			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999; border-left:0px;"><em>x</em><sub>CS1</sub><br>
					<em>x</em><sub>CS2</sub><br>
					<em>x</em><sub>CS3</sub></td>
		</tr>
		<tr>
			<td align="center">Y&nbsp;=<span class="blue">&nbsp;<strong>T</strong></span> </td>
			<td align="center" bgcolor="#FFFFFF" style="border:1px solid #999999; border-top:0px;"><em>x</em><sub>AT1</sub><br>
					<em>x</em><sub>AT2</sub><br>
					<em>x</em><sub>AT3</sub></td>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-right:1px solid #999999;"><em>x</em><sub>BT1</sub><br>
					<em>x</em><sub>BT2</sub><br>
					<em>x</em><sub>BT3</sub></td>
			<td align="center" bgcolor="#FFFFFF" style="border-bottom:1px solid #999999; border-right:1px solid #999999;"><em>x</em><sub>CT1</sub><br>
					<em>x</em><sub>CT2</sub><br>
					<em>x</em><sub>CT3</sub></td>
		</tr>
	</table></div>
<p>Although it is not intuitively obvious, the effect of changing the levels of factor X is estimated equally accurately in both experiments.</p>
	<div class="centred"><div class="boxed">
		<p>A second factor, Y, can be added by using a factorial design <strong>without reducing the accuracy of estimating the effect of X</strong>. </p>
	</div></div>
	<p>In the factorial experiment however, we can also estimate the effect of changing factor Y, so the factorial design provides a 'free' estimate of the effect of Y.</p>
	<p>It might initially seem that each factor will be estimated less accurately 
because the other factor is also varied, but this is not so.</p>

<div class="centred"><div class="boxed">
<p style="text-align:left">In a complete factorial experiment, the effect of each factor 
				can be estimated as accurately as in a completely randomised experiment 
				with one factor and the same number of experimental units.</p>
</div></div>


<dl>
		<p>A complete factorial experiment therefore estimates the effects of two 
			factors as accurately as two completely randomised experiments involving 
			double the total number of experimental units.</p>
</dl>

<div class="diagram" title="Illustration: Blood pressure after an operation">

<p class=heading>Blood pressure after an operation</p>

<p>The diagram below simulates a completely randomised experiment in which two 
surgical procedures (operations by keyhole surgery and a standard surgical method) are compared. Initially, all patients are given the same dose 
of a drug that is intended to reduce their blood pressure after the operation. 
The response variable is the systolic blood pressure of the patients two hours 
later.</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="600" height="380">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="experProg.TwoTreatments2Applet">
<param name="catName" value="Gender">
<param name="catLabels" value="Male Female">
<param name="treat2Name" value="Amount of drug">
<param name="treat2Values" value="6@0 6@1 6@2">
<param name="treat2Labels" value="X Y Z">
<param name="treat2Effect" value="10.0 0.0 -20.0">
<param name="treat1Name" value="Operation">
<param name="treat1Values" value="3@0 3@1 3@0 3@1 3@0 3@1">
<param name="treat1Labels" value="Std Keyhole">
<param name="treat1Effect" value="10.0 0">
<param name="randomSeeds" value="483645095 323087542">
<param name="constant" value="120">
<param name="errorSD" value="4">
<param name="responseName" value="Systolic blood pressure">
<param name="responseAxis" value="90 160 90 10">
<param name="maxRowTreatment" value="20.0">
<param name="treatEffectScaling" value="10.0 0.5">
<param name="diffAxis" value="-20 0 -20 5">
<param name="diffName" value="Keyhole-Std">
<param name="customText" value="Unused (all same)=Unused (all same)#Varying=Varying">
</applet> 
</div>

	  
<p>Click <strong>Repeat experiment</strong> to randomise the patients, perform 
the surgery and record blood pressures. Click <strong>Accumulate</strong> then repeat the experiment several times to see the variability in the estimated difference between blood pressures using keyhole and standard operations.</p>
<p>Initially all patients receive the same drug dose, so the experiment is completely 
	randomised with only a single factor (the type of operation). <strong>Drag the slider</strong> to vary the amount of drug, effectively turning 
	the experiment into a factorial design with two factors &mdash; operation type and amount of drug.</p>
<p>Reducing the amount of drug for 3 patients getting each operation type increases their blood pressure and increasing the drug dose for 3 others decreases their blood pressure. However since this happens for the same number of patients getting each operation type,</p>
<div class="centred"><div class="boxed">
	<p>The difference between the mean blood pressures for the two operation types remains the same.</p>
</div></div>
<p>With the <strong>Accumulate </strong>checkbox still selected, repeat the experiment several more times. (Unchecking the<strong> Animation</strong> checkbox speeds up the simulations.) Observe that the variability (accuracy) of the estimated difference between the operation types is the same as for the experiment using the same amount of drug for everyone.</p>
<div class="centred"><div class="boxed">
	<p>The experiment can also vary the amount of drug and estimate its effect without affecting the accuracy of estimating the difference between the two operation types.</p>
</div></div>
<p>In a similar way, the effect of the drug on blood pressure would be estimated 
	equally accurately whether or not two operation types were used.</p>
</div>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
