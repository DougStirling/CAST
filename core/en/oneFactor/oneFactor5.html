<!DOCTYPE HTML>
<html>
<head>
	<title>Confidence intervals for treatment means</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="treatment means, factor means, confidence interval, parameter estimate">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Taking account of unexplained variation</p>

<p>The best estimate of the mean response at each factor level is the corresponding sample mean,</p>
<p class=eqn><img src="images/groupMeanEst.gif" width="52" height="22"> </p>
<p>However point estimates give no indication of the accuracy of the estimates, so 95% confidence intervals are often reported to give a better indication of randomness caused by unexplained variability in the experiment.</p>
<p class="heading">Confidence intervals</p>
<p>It would be possible to independently calculate  95% confidence intervals using the means and standard deviations for each factor level,</p>
<p class=eqn><img src="images/ciSeparate.gif" width="130" height="38"> </p>
<p>However since we assume that the standard deviation is the same for all factor levels, it is better to use the pooled estimate of the common standard deviation for <strong>all</strong> confidence intervals. Since the pooled estimate is based on all the data, it is more accurate and the confidence intervals are narrower. When the pooled estimate of the standard deviation is used, the t-value in the formula should use the residual degrees of freedom &mdash; the sum of those at the different individual levels. The t-value is therefore smaller (reflecting the increased accuracy of the estimate).</p>
<p class=eqn><img src="images/ciPooled.gif" width="168" height="38"></p>
	<p>The confidence intervals are often displayed graphically, as shown in the diagram below.</p>
	<div class="diagram"> 
<p class="heading">Comparing varieties of wheat</p>
<p>The diagram below simulates the wheat yields in an experiment involving four varieties of wheat. There are initially 3 replicates for all varieties.</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="450" height="450">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="exper2Prog.LevelCisApplet">
<param name="yVarName" value="Yield per hectare">
<param name="xVarName" value="Type of wheat">
<param name="xLabels" value="#Variety A# #Variety B# #Variety C# #Variety D#">
<param name="anovaModel" value="3.5 1.2 7.5 1.2 7.0 1.2 5.5 1.2">
<param name="randomSeed" value="223945782">
<param name="yAxis" value="0.0 11 0 1">
<param name="decimals" value="3">
<param name="customText" value="Use pooled st devn=Use pooled st devn">

<param name="noOfDataSets" value="4">
<param name="dataName" value="3 replicates">
<param name="xValues" value="3@0 3@1 3@2 3@3">
<param name="dataName2" value="10 replicates">
<param name="xValues2" value="10@0 10@1 10@2 10@3">
<param name="dataName3" value="20 replicates">
<param name="xValues3" value="20@0 20@1 20@2 20@3">
<param name="dataName4" value="40 replicates">
<param name="xValues4" value="40@0 40@1 40@2 40@3">
</applet>
</div>

<p>The 95% confidence intervals are initially calculated using the separate means and standard deviations for each variety, and they are shown as blue rectangles in the diagram. Note that they vary in width since the sample standard deviations are (by chance) different.</p>
<p>Select the checkbox <strong>Use pooled standard deviation</strong> to use the same standard deviation for all varieties. Note that all all confidence intervals now have the same width and are (on average) narrower.</p>
<p>Repeat with more replicates. Observe that there is little difference between the two formulae when the number of replicates is high.</p>
	</div>

	
<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
