<!DOCTYPE HTML>
<html>
<head>
	<title>Inference for models with interaction</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="interaction, least squares, t test, f test, analysis of variance">
	<meta name="dataset" content="Bee energy expenditure">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Least squares estimation</p>
  <p>The model with interaction,</p>
	<p class=eqn><img src="images/interactModel.gif" width="496" height="21"></p>
	<p>is a general linear model, so it can be fitted by least squares &mdash; the parameters 
		of the model are chosen to give the smallest possible value for the sum of 
		squared residuals.</p>
	<div class="diagram">
<p class="heading">Energy expenditure of bees</p>
		<p>In an experiment, an entomologist recorded energy expenditure (joules/sec) 
			for bees drinking water with different sucrose concentrations (%) and at 
			different temperatures.</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="450">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="curveInteractProg.DragQuadCrossApplet">
<param name="yAxis" value="0 20 0 5">
<param name="xAxis" value="17 43 20 10">
<param name="zAxis" value="15 65 20 20">
<param name="yVarName" value="y">
<param name="xVarName" value="x">
<param name="zVarName" value="z">
<param name="longYVarName" value="energy (y)">
<param name="longXVarName" value="temperature (x)">
<param name="longZVarName" value="sucrose (z)">
<param name="yValues" value="3.1 3.7 4.7 5.5 6.7 7.3 7.9 9.2 9.3 6.0 6.9 7.5 11.5 12.9 13.4 17.5 15.8 14.7 7.7 8.3 9.5 15.7 14.3 15.9 19.1 18.0 19.9">
<param name="xValues" value="9@20 9@30 9@40">
<param name="zValues" value="3@20 3@40 3@60 3@20 3@40 3@60 3@20 3@40 3@60">
<param name="initialParams" value="10.0 0.0 0.0 0.0 0.0 0.0 0">
<param name="paramMinMax" value="-100.0 100.0 -100.00 100.00 -100.00 100.00 -100.00 100.00 -100.00 100.00 -100.00 100.00">
<param name="shadeCutoff" value="0 10 20">
<param name="interact" value="check">
<param name="maxRss" value="99999.9">
<param name="customText" value="resid=resid#Don't show=Don't show#Show as lines=Show as lines#Show as squares=Show as squares#Interaction=Interaction">
</applet> 
</div>

		<p>The diagram initially shows the least squares estimates for the model without 
			interaction. Rotate the diagram to get a feel for the positions of the points 
			in relation to the plane.</p>
		<p>Now click the checkbox <strong>Interaction</strong> and choose <strong>Show 
			as squares</strong> from the pop-up menu. <strong>Drag</strong> the four 
			red arrows to make the sum of squared residuals (red area) as small as possible. 
			Finally, click <strong>Least squares</strong> to see the least squares estimates.</p>
		<p>After clicking <strong>Least squares</strong>, click the <strong>y-x</strong> 
			rotation button. Observe that the fitted model shows that energy expenditure 
			rises more slowly with temperature at low sucrose levels than at high sucrose 
			levels.</p>
		<p>Click the <strong>y-z</strong> rotation button and observe that energy 
			expenditure rises more slowly as sucrose increases at low temperatures than 
			at high temperatures.</p>
		
<div class="centred"><div class="boxed">
<p>Increasing sucrose and temperature together 
					has a particularly high effect on energy expenditure.</p>
</div></div>

		<br>
</div>


  <p class="heading">Testing for interaction</p>
  <p>In the following model, the interaction is modelled by the term involving 
		the product of <em>x</em> and <em>z</em>.</p>
	<p class=eqn><img src="images/interactModel.gif" width="496" height="21"></p>
	<p>The test for interaction therefore asks whether the coefficient of this term 
		is zero.</p>
	<p>Since the model is a general linear model, the method that was described 
		earlier for testing the parameters of any GLM can be applied to test whether 
		the parameters of this model are zero. Interaction can therefore be tested 
		with a t-test for the interaction term. As in other t-tests, this is based 
		on a t statistic that divides the parameter estimate by its standard error.</p>
	<div class="diagram">
<p class="heading">Energy expenditure of bees</p>
		<p>We will now test whether the interaction between sucrose and temperature 
			that is apparent in the least squares estimates could have arisen by chance.</p>

<div class="centred"> 
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="520">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="curveInteractProg.QuadParamTestApplet">
<param name="dataName" value="Energy expenditure of bees">
<param name="yAxis" value="0 20 0 5">
<param name="xAxis" value="17 43 20 10">
<param name="zAxis" value="15 65 20 20">
<param name="longYVarName" value="energy (y)">
<param name="longXVarName" value="temperature (x)">
<param name="longZVarName" value="sucrose (z)">
<param name="yVarName" value="y">
<param name="xVarName" value="x">
<param name="zVarName" value="z">
<param name="yValues" value="3.1 3.7 4.7 5.5 6.7 7.3 7.9 9.2 9.3 6.0 6.9 7.5 11.5 12.9 13.4 17.5 15.8 14.7 7.7 8.3 9.5 15.7 14.3 15.9 19.1 18.0 19.9">
<param name="xValues" value="9@20 9@30 9@40">
<param name="zValues" value="3@20 3@40 3@60 3@20 3@40 3@60 3@20 3@40 3@60">
<param name="initialParams" value="6.00 0.000 0.000 0.0000 0.0000 0.0000 0">
<param name="paramMinMax" value="-99.99 99.99 0.999 9.999 -9.999 9.999 -9.9999 9.9999 -9.9999 9.9999 0.0000 9.9999">
<param name="shadeCutoff" value="0 10 20">
<param name="paramNames" value="Intercept Temperature Sucrose ? ? Interaction">
<param name="maxTableEntries" value="-99.999 9.999 99.99">
<param name="initialRotation" value="45 40">
<param name="customText" value="param=param#se=se">
</applet> 
</div>

		
    <p>The table shows the parameter estimates, their standard errors, t-statistics 
      and p-values. The p-values show the strength of evidence for whether the 
      corresponding parameters are non-zero.</p>
		
    <p>The p-value for the interaction term is 0.0013, giving very strong evidence 
      that there is interaction between the effects of sucrose and temperature.</p>
		<p>The other p-values should not be interpreted since it does not make sense 
			to drop the linear terms in sucrose or temperature when there is an interaction 
			in the model.</p>

	</div>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
