<!DOCTYPE HTML>
<html>
<head>
	<title>Beta-binomial distribution</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>
	
	<link rel='stylesheet' href='../../structure/maths/mathStyles.css' type='text/css'>
	<script src='../../structure/videoControls/jquery.js'></script>
	<script src='../../structure/maths/theorems.js'></script>
	<script src='../../structure/maths/mathJax/MathJax.js?config=TeX-AMS-MML_SVG,statMacros.js'></script>

	<meta name="index" content="overdispersion, binomial distribution, beta-binomial distribution, probability function, discrete distribution, mean, variance">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Model for overdispersion in success/failure data</p>

<p>The most commonly used model that generalises the binomial distribution to allow for overdispersion is the <strong>beta-binomial</strong> distribution.</p>

<div class="definition">
<p class='definitionTitle'>Definition</p>
<p>A random variable, \(X\), has a <strong>beta-binomial</strong> distribution if its probability function is</p>
\[
p(x) \;\;=\;\; \begin{cases} \displaystyle {n \choose x} \frac {B(x + \alpha, n - x + \beta)}{B(\alpha, \beta)}  &amp;\text{for }x = 0, 1, 2, \dots, n \\[0.4em]
0 &amp; \text{otherwise}
\end{cases} \]
<p>where \(\alpha \gt 0\), \(\beta \gt 0\) and</p>
\[
B(a, b) \;\;=\;\; \frac {\Gamma(a)\Gamma(b)}{\Gamma(a+b)}
\]
</div>

<p>This distribution can be derived as the distribution of the number of successes in a binomial experiment in which the probability of success varies (with a distribution called a <a href="javascript:showNamedPage('sec_beta')">beta distribution</a>). However we will just use it here as an empirical distribution whose two parameters, \(\alpha\) and \(\beta\) give it flexibility to cope with overdispersion.</p>
<p>The probability function for the beta-binomial distribution looks complex, but its probabilities can be found in Excel using.</p>

<div class="centred">
<table border="0" cellpadding="5" cellspacing="0" class="centred">
	<tr>
		<th>Maths function</th>
		<th>In Excel</th>
	</tr>
	<tr>
		<td>\(\displaystyle {n \choose x}\)</td>
		<td>=COMBIN(n, x)</td>
	</tr>
	<tr>
		<td>\(\Gamma(k)\)</td>
		<td>=EXP(GAMMALN(k))</td>
	</tr>
</table>
</div>

<p>The mean and variance of the beta-binomial distribution are stated without proof below.</p>
<div class="theoremProof">
	<div class="theorem">
		<p class="theoremTitle">Mean and variance</p>
		<p>The mean and variance of the beta-binomial distribution are</p>
		<p>\[
			E[X] = \frac {n\alpha}{\alpha + \beta} \spaced{and} \Var(X) =   \frac {n\alpha\beta}{(\alpha + \beta)^2}\times \frac {\alpha + \beta + n} {\alpha + \beta + 1}
			\]</p>
	</div>
</div>
<p>If we write</p>
<p>\[
	\pi = \frac {\alpha}{\alpha + \beta} \spaced{so} (1-\pi) =    \frac {\beta}{\alpha + \beta}
	\]</p>
<p>then</p>
<p>\[
	E[X] = n\pi \spaced{and} \Var(X) =   n\pi (1 - \pi) \times \frac {\alpha + \beta + n} {\alpha + \beta + 1}
	\]</p>
<p>The variance of the beta-binomial distribution is therefore \(\frac {\alpha + \beta + n} {\alpha + \beta + 1}\) times the variance of the binomial distribution with the same mean. Since this factor is greater than 1, the beta-binomial distribution can be used as a model when there is overdispersion.</p>
<p class="heading">Relationship to binomial distribution</p>
<p>The beta-binomial distribution can be made arbitrarily close to a binomial distribution with suitable choice of \(\alpha\) and \(\beta\). The following result is stated without proof.</p>
<div class="theoremProof">
	<div class="theorem">
		<p class="theoremTitle">Asymptotic distribution</p>
		<p>If \(\alpha \to \infty\) and \(\beta \to \infty\) simultaneously with \(\dfrac {\alpha}{\alpha + \beta} = \pi\), the beta-binomial distribution approaches a \(\BinomDistn(n, \pi)\) distribution.</p>
	</div>
</div>
<p class="heading">Shape of beta-binomial distribution</p>
<p>The following diagram shows the possible shapes of the beta-binomial distribution and illustrates the properties stated above.</p>


<div class="example" title="Shape of beta-binomial distribution">
	<p class="exampleHeading">Shape of beta-binomial distribution</p>
	<p>The diagram below initially shows the probability function for a binomial distribution with \(n = 10\); the top slider can be used to adjust its probability of success, \(\pi\).</p>
	<div class="centred">
		<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="500" height="500">
			<script type="text/javascript">writeAppletParams();</script>
			<param name="appletName" value="distributionProg.BetaBinomDistnApplet">
			<param name="backgroundColor" value="FFFBF3">
			<param name="pLimits" value="0.00 1.00 0.50">
			<param name="n" value="10">
			<param name="paramDecimals" value="4 4">
			<param name="xAxis" value="-0.2 10.2 0 1">
			<param name="xAxisName" value="Number of successes">
			<param name="maxAlpha" value="999.0000">
			<param name="maxBeta" value="999.0000">
			<param name="customText" value="success=success#All 0 or n=All 0 or n">
		</applet>
	</div>
	<p>For any binomial distribution with probability of success \(\pi\) and mean \(E[X] = n \pi\) the variance is \(\Var(X) = n \pi (1 - \pi)\). The beta-binomial has two parameters, allowing it more flexibility. <strong>Drag the bottom slider</strong> to make the variance a greater multiple of the corresponding binomial distribution's variance. Observe that whatever the value of \(\pi\),</p>
	<ul>
		<li>Increasing the variance increases the probability of &quot;extreme&quot; counts at \(x = 0\) and  \(x = n\).</li>
		<li>At the extreme, only \(x = 0\) and  \(x = n\) are possible, with probabilities \((1 - \pi)\) and \(\pi\) respectively.</li>
	</ul>
</div>

<script type='text/javascript'>writePageEnd();</script>
</body>
</html>
