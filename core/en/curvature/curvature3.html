<!DOCTYPE HTML>
<html>
<head>
	<title>Quadratic models</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="regression model, nonlinear model, curvature, quadratic model">
	<meta name="dataset" content="Pressure and boiling point of water">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Adding a quadratic term</p>
	
	<p>An alternative solution to the problem of curvature is to extend the simple 
		linear model with the addition of a quadratic term, </p>

<p class=eqn><span class="black"><em>y</em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x</em>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>2 </sub><em>x</em><sup>2</sup></span>
</p>

  <p>Fitted values and residuals are defined (and interpreted) in a similar way 
    to those for a linear model,</p>

<p class=eqn><span class="black"><span style="position:relative; top:4"><img src="../../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x<sub>i</sub></em>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x<sub>i</sub></em><sup>2</sup></span>
<br><span class="black"><em>e<sub>i</sub></em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>y<sub>i</sub></em> &minus; <span style="position:relative; top:4"><img src="../../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span></span>
</p>

  <p>As in a linear model, the quadratic model's residuals are the vertical distances 
		between the crosses in a scatterplot and the curve. We again use <strong>least 
		squares</strong> to estimate the unknown parameters &mdash; choose values of the 
		three parameters to minimise the residual sum of squares, </p>

<p class=eqn><img class="gif" src="../curvature/images/residSsqEqn.gif" width="369" height="28">
</p>

<div class="diagram" title="Illustration of a quadratic model">
<p>The scatterplot below shows a data set with a nonlinear relationship.
</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="370" height="400">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="regnProg.DragQuadraticApplet">
<param name="xVarName" value="x">
<param name="yVarName" value="y">
<param name="xValues" value="1.5 22.5 6.4 8.5 18.9 14.5 37.4 20.6 22.9 7.7 29.9 31.5 35.9 38 7 20 19.5 18.3 37.4 5.4 36.8 27.4 25.7 1.1 9.8 17.1 39.1 32.3 28.7 29.6">
<param name="yValues" value="0.4 3.9 1.8 2.1 5.1 4.2 12.9 4.9 4.1 1.3 10.9 10.4 9.8 10.4 0.5 6.5 2.9 5.8 16.7 1.3 14.8 7.2 8 0.4 3 4.5 17 12.7 6.2 8.2">
<param name="horizAxis" value="0 40 0 5">
<param name="vertAxis" value="0 20 0 2">
<param name="interceptLimits" value="0.0 20.0 5.0">
<param name="slopeLimits" value="-0.50 0.50 0.20">
<param name="curvatureLimits" value="-0.050 0.050 0.000">
<param name="labelAxes" value="true">
</applet>
</div>

    <p><strong>Drag</strong> the three red arrows to adjust the position of the 
      quadratic curve. Observe that&nbsp;... </p>

<ul>
  <li>The constant term is the y-value corresponding to <i>x</i> = 0.</li>
  <li>The coefficient of <i>x</i> is the slope of the curve at <i>x</i> = 0.</li>
  <li>The third coefficient describes the curvature; it is small when the curve is
  nearly linear.</li>
</ul>

<p>Click the checkbox <strong>Show residuals</strong>. The residuals are displayed with
blue vertical lines on the scatterplot. Adjust the coefficients using the red arrows to
make the residuals as small as possible, then click the button <strong>Least squares</strong>
to minimise the residual sum of squares.
</p>

</div>

  <p>If a relationship is nonlinear, residuals from a quadratic model are likely 
    to be smaller than those for a linear model. This also suggests that the errors 
    are likely to be smaller if the model is used to predict future response values.</p>
	<p>The next example illustrates the potential improvement from using a quadratic 
    model.</p>

<div class="diagram" title="Example: Atmospheric pressure and boiling point">
		<p class="heading">Forbes' data</p>

		<p>We tried earlier to use a linear model to explain the relationship between 
			barometric pressure and the boiling point of water. The scatterplot of residuals 
			on the right below shows the problems with this linear model.</p>

	<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="330">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="regnProg.Residual2PlotApplet">
<param name="xVarName" value="Boiling point">
<param name="yVarName" value="Pressure">
<param name="xValues" value="194.5 194.3 197.9 198.4 199.4 199.9 200.9 201.1 201.4 201.3 203.6 204.6 209.5 208.6 210.7 211.9 212.2">
<param name="yValues" value="20.79 20.79 22.40 22.67 23.15 23.35 23.89 23.99 24.02 24.01 25.14 26.57 28.49 27.76 29.04 29.88 30.06">
<param name="horizAxis" value="194 213 195 5">
<param name="vertAxis" value="20 31 20 2">
<param name="residAxis" value="-0.4 0.8 -0.4 0.2">
<param name="change1" value="#11 204.6 *#">
<param name="change1Name" value="Delete outlier">
<param name="customText" value="Residual, e=Residual, e#Linear fit=Linear fit#Quadratic fit=Quadratic fit">
</applet>
</div>

<p>Firstly, click the checkbox <strong>Delete outlier</strong> to remove the outlier
that we identified earlier. Note again the strong impression of curvature in the
residual plot on the right.
</p>

<p>Next choose the option <strong>Quadratic fit</strong> from the pull-down menu.
The least squares quadratic curve is displayed on the left, and the residual plot on the
right displays the residuals from the quadratic model. Note that ...
</p>

<ul>
  <li>The magnitude of the residuals is smaller, so the quadratic model predicts
  	pressure more accurately.</li>
      <li>There is no pattern in the residuals that would throw doubt on the quadratic 
        model.</li>
</ul>

</div>



<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
