<!DOCTYPE HTML>
<html>
<head>
	<title>CIs from simulation (advanced)</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="confidence interval, simulation">
	<meta name="dataset" content="Silkworm poisoning">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Confidence intervals for other parameters</p>

  <p>Statistical theory can provide formulae for the standard errors of most commonly 
		used parameter estimates. These can be used to form approximate 95% confidence 
		intervals in a similar way to those for means and proportions,</p>
	<p class="eqn"><strong><font color="#000000"><em>estimate</em> - 2 <em>s.e.</em><em>&nbsp; 
		</em><strong>&nbsp;to</strong><em> &nbsp;&nbsp;estimate</em> + 2 <em>s.e.</em></font></strong></p>
	<p>However the standard errors for some estimators cannot be so easily derived 
		(or cannot be evaluated by readily available software).</p>
		
		
	<div class="diagram"> 
		<p class=heading>Silkworm poisoning</p>

	  <p>In an experiment to investigate the toxic action of arsenic, 80 fourth-instar 
			silkworm larvae weighing between 0.41 and 0.45 grams were given 0.10 mg 
			of sodium arsenate per gram of body weight.</p>
		
    <p class=eqn><object data="images/silkwormUQ.svg" width="396" height="136"></object></p>
		<p>We would like to form a 95% confidence interval to answer the following 
			question.</p>
		<center>
			<table border="1" cellspacing="0" cellpadding="10" bgcolor="white" width="75%">
				<tr> 
					<td><strong>How long will one in four similar larvae survive?<strong> 
						</strong></strong></td>
				</tr>
			</table>
		</center>
		<p>There is no easy formula for a confidence interval for the upper quartile, 
			so a different approach is needed.</p>
	</div>
		
	<p class="heading">Confidence interval from simulation</p>
	<p>95% confidence intervals can be found directly from the error distribution.</p>
	<p class=eqn> <object data="../KciMean/images/errorBounds.svg" width="276" height="114"></object>
	</p>
	<p>From the value <em>e*</em>,</p>
	<p class=eqn> <font color="#000000">Prob (&nbsp;-<em>e*&nbsp; </em>&lt;&nbsp; 
		<em>error</em> &nbsp;&lt;<em> &nbsp;e*</em> ) &nbsp;= &nbsp;0.95</font></p>
  <p>and therefore</p>
	<p class=eqn> <font color="#000000"><em>estimate</em> - <em>e*&nbsp; </em><strong>&nbsp;to</strong><em> 
		&nbsp;&nbsp;estimate</em> + <em>e*</em></font></p>
	<p>is a <strong>95% confidence interval</strong> for the parameter.</p>
	<center>
		<table border="1" cellspacing="0" cellpadding="10" bgcolor="white" width="75%">
			<tr> 
				<td align="center"><strong>If the error distribution (or standard error) 
					cannot be found from statistical theory, a simulation may provide an 
					approximate error distribution.</strong></td>
			</tr>
		</table>
	</center>
	
	<p>The method is illustrated below.</p>
	
	<div class="diagram"> 
		<p class="heading">Simulated error distribution for upper quartile</p>
		<p>We will conduct a simulation to find the error distribution for the upper 
			quartile of the silkworm larvae survival distribution. A normal population 
			seems a reasonable model and the best-fitting normal distribution is shown 
			below. </p>
		
    <p class=eqn><object data="images/silkwormModel.svg" width="396" height="130"></object></p>
		
		<p>We now forget about our data and perform a simulation based on samples 
			from this best-fitting normal population. The upper quartile of this population 
			is 293.3, so this is the 'target' parameter that we will be trying to estimate 
			from our simulated samples.</p>
		<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="350">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="stdErrorProg.ErrorBoundsApplet">
<param name="varName" value="Silkworm survival times (sec)">
<param name="random" value="80 272.6 30.7 875636431 2.5">
<param name="dataAxis" value="180 380 200 50">
<param name="errorName" value="Error in estimate (sec)">
<param name="errorAxis" value="-15 15 -15 5">
<param name="percentile" value="0.75">
<param name="paramName" value="Target (normal UQ)">
<param name="statisticName" value="Estimate (sample UQ)">
<param name="decimals" value="2">
<param name="maxErrorBound" value="-9.9">
<param name="customText" value="Show 95% bounds for error=Show 95% bounds for error#P( -* < error < * )=P( -* < error < * )">
</applet>
</div>

		
    <p>Click <strong>Accumulate</strong> and take 100 or more samples to build 
			up the error distribution for estimation of the population upper quartile 
			from a sample of 80 silkworm larvae. (Hold down the <strong>Take sample</strong> 
			button to repeatedly take samples.)</p>

		<p>When the error distribution contains 100 or more crosses, click the checkbox 
			<strong>Show 95% bounds for error</strong>. This displays the interval of 
			errors that occurred in 95% of samples.</p>
		<center>
			<table border="1" cellspacing="0" cellpadding="10" bgcolor="white" width="75%">
				<tr> 
					<td align="center"><strong>You should have observed that 95% of estimation 
						errors for this type of estimator were within about Â±8 seconds.</strong></td>
				</tr>
			</table>
		</center>
		<p>(The exact value varies with the simulation.)</p>
		<p class="heading">95% confidence interval for upper quartile</p>
		<p>From the simulation, we are 95% confident that the error from this type 
			of estimator will be no more than 8 seconds.</p>
		<p>We can now apply this error bound to our actual data. Since the upper quartile 
			from our actual silkworm survival data was 292 seconds,</p>
		<center>
			<table border="1" cellspacing="0" cellpadding="10" bgcolor="white" width="75%">
				<tr> 
					<td align="center"><strong>We are 95% confidence that the population 
						upper quartile is between (292&nbsp;-&nbsp;8)&nbsp;=&nbsp;284 and 
						(292&nbsp;+&nbsp;8)&nbsp;=&nbsp;300 seconds</strong></td>
				</tr>
			</table>
		</center>
		<br>
		</div>

<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
