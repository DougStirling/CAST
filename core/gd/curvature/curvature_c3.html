<!DOCTYPE HTML>
<html>
<head>
	<title>Quadratic models</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="../../pageStyles.css" type="text/css">
	<script src="../../releaseInfo.js"></script>
	<script src="../../structure/pageSetup.js"></script>

	<meta name="index" content="regression model, nonlinear model, curvature, quadratic model">
	<meta name="dataset" content="GDP in the USA">
</head>


<body>
<script type="text/javascript">writePageStart();</script>

<p class="heading">Adding a quadratic term</p>  <p>An alternative solution to the problem of curvature is to extend the simple 
		linear model with the addition of a quadratic term, </p>

<p class=eqn><span class="black"><em>y</em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x</em>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>2 </sub><em>x</em><sup>2</sup></span>
</p>

  <p>Fitted values and residuals are defined (and interpreted) in a similar way 
    to those for a linear model,</p>

<p class=eqn><span class="black"><span style="position:relative; top:4"><img src="../../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span>&nbsp;&nbsp;=&nbsp;&nbsp;<em>b</em><sub>0</sub>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x<sub>i</sub></em>&nbsp;&nbsp;+&nbsp;&nbsp;<em>b</em><sub>1 </sub><em>x<sub>i</sub></em><sup>2</sup></span>
<br><span class="black"><em>e<sub>i</sub></em>&nbsp;&nbsp;=&nbsp;&nbsp;<em>y<sub>i</sub></em> &minus; <span style="position:relative; top:4"><img src="../../images/symbol.yiHat.png" width="11" height="18" align="baseline"></span></span>
</p>

  <p>As in a linear model, the quadratic model's residuals are the vertical distances 
		between the crosses in a scatterplot and the curve. We again use <strong>least 
		squares</strong> to estimate the unknown parameters &mdash; choose values of the 
		three parameters to minimise the residual sum of squares, </p>

<p class=eqn><img class="gif" width="369" height="28">
</p>

<div class="diagram">

<p>The scatterplot below shows a data set with a nonlinear relationship.
</p>

<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="370" height="400">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="regnProg.DragQuadraticApplet">
<param name="xVarName" value="x">
<param name="yVarName" value="y">
<param name="xValues" value="1.5 22.5 6.4 8.5 18.9 14.5 37.4 20.6 22.9 7.7 29.9 31.5 35.9 38 7 20 19.5 18.3 37.4 5.4 36.8 27.4 25.7 1.1 9.8 17.1 39.1 32.3 28.7 29.6">
<param name="yValues" value="0.4 3.9 1.8 2.1 5.1 4.2 12.9 4.9 4.1 1.3 10.9 10.4 9.8 10.4 0.5 6.5 2.9 5.8 16.7 1.3 14.8 7.2 8 0.4 3 4.5 17 12.7 6.2 8.2">
<param name="horizAxis" value="0 40 0 5">
<param name="vertAxis" value="0 20 0 2">
<param name="interceptLimits" value="0.0 20.0 5.0">
<param name="slopeLimits" value="-0.50 0.50 0.20">
<param name="curvatureLimits" value="-0.050 0.050 0.000">
<param name="labelAxes" value="true">
</applet>
</div>

    <p><strong>Drag</strong> the three red arrows to adjust the position of the 
      quadratic curve. Observe that&nbsp;... </p>

<ul>
  <li>The constant term is the y-value corresponding to <i>x</i> = 0.</li>
  <li>The coefficient of <i>x</i> is the slope of the curve at <i>x</i> = 0.</li>
  <li>The third coefficient describes the curvature; it is small when the curve is
  nearly linear.</li>
</ul>

<p>Click the checkbox <strong>Show residuals</strong>. The residuals are displayed with
blue vertical lines on the scatterplot. Adjust the coefficients using the red arrows to
make the residuals as small as possible, then click the button <strong>Least squares</strong>
to minimise the residual sum of squares.
</p>

</div>

  <p>If a relationship is nonlinear, residuals from a quadratic model are likely 
    to be smaller than those for a linear model. This also suggests that the errors 
    are likely to be smaller if the model is used to predict future response values.</p>
	<p>The next example illustrates the potential improvement from using a quadratic 
    model.</p>

  <div class="diagram">

		<p class="heading">GDP in the USA</p>

<p>We tried earlier to use a linear model to explain how the Gross Domestic 
			Product (GDP) in the USA changed between 1960 and 2001. The curvature in 
			the scatterplot of residuals on the right below shows that a linear model 
			is not appropriate.</p>

	<div class="centred">
<applet codebase="../../java" code="dataView.CastApplet.class" archive="coreCAST.jar" width="550" height="330">
<script type="text/javascript">writeAppletParams();</script>
<param name="appletName" value="regnProg.Residual2PlotApplet">
<param name="yVarName" value="GDP">
<param name="yUnits" value="billion dollars">
<param name="xVarName" value="Year">
<param name="yValues" value="2376.7 2432 2578.9 2690.4 2846.5 3028.5 3227.5 3308.3 3466.1 3571.4 3578 3697.7 3898.4 4123.4 4099 4084.4 4311.7 4511.8 4760.6 4912.1 4900.9 5021 4919.3 5132.3 5505.2 5717.1 5912.4 6113.3 6368.4 6591.8 6707.9 6676.4 6880 7062.6 7347.7 7543.8 7813.2 8159.5 8508.9 8856.5 9224 9332.3">
<param name="xValues" value="1960 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001">
<param name="vertAxis" value="2000 9500 2000 1000">
<param name="horizAxis" value="1960 2002 1960 10">
<param name="residAxis" value="-600 900 -600 200">
<param name="customText" value="Residual, e=Residual, e#Linear fit=Linear fit#Quadratic fit=Quadratic fit">
</applet>
</div>

<p>Choose the option <strong>Quadratic fit</strong> from the pull-down menu. The 
	least squares quadratic curve is displayed on the left, and the residual 
	plot on the right displays the residuals from the quadratic model. Note 
	that ... </p>

<ul>
  <li>The magnitude of the residuals is smaller, so the quadratic model predicts
  	pressure more accurately.</li>
	<li>There is no systematic pattern in the residuals to suggest that a different 
		shape of curve would fit the data better.</li>
</ul>

</div>

<script type='text/javascript'>writePageEnd();</script>

</body>
</html>
